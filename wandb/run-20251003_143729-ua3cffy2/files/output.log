Epoch    1/30, time: 11.42 s, training_loss: 0.635
Epoch    1/30, time: 11.47 s, training_loss: 0.357Epoch    1/30, time: 11.49 s, training_loss: 0.518Epoch    1/30, time: 11.50 s, training_loss: 0.461


Epoch    1/30, time: 1.54 s, val_loss: 0.586
Epoch    1/30, time: 1.74 s, val_loss: 0.303
Epoch    1/30, time: 1.77 s, val_loss: 0.430
Epoch    1/30, time: 2.21 s, val_loss: 0.413
Training Metrics:
Accuracy: 0.8646
Precision: 0.8904
Recall: 0.3352
F1 Score: 0.4871
IoU: 0.3219
Dice Coefficient: 0.4871
Validation Metrics:
Accuracy: 0.8982
Precision: 0.8735
Recall: 0.5470
F1 Score: 0.6728
IoU: 0.5069
Dice Coefficient: 0.6728
Training Metrics:
Accuracy: 0.9401
Precision: 0.7763
Recall: 0.9662
F1 Score: 0.8609
IoU: 0.7558
Dice Coefficient: 0.8609
Validation Metrics:
Accuracy: 0.9431
Precision: 0.7865
Recall: 0.9644
F1 Score: 0.8664
IoU: 0.7643
Dice Coefficient: 0.8664
Training Metrics:
Accuracy: 0.8834
Precision: 0.6262
Recall: 0.9721
F1 Score: 0.7617
IoU: 0.6152
Dice Coefficient: 0.7617
Validation Metrics:
Accuracy: 0.8857
Precision: 0.6313
Recall: 0.9681
F1 Score: 0.7643
IoU: 0.6185
Dice Coefficient: 0.7643
Training Metrics:
Accuracy: 0.9109
Precision: 0.9104
Recall: 0.5938
F1 Score: 0.7188
IoU: 0.5610
Dice Coefficient: 0.7188
Validation Metrics:
Accuracy: 0.9430
Precision: 0.8796
Recall: 0.8137
F1 Score: 0.8454
IoU: 0.7322
Dice Coefficient: 0.8454
Epoch    2/30, time: 1.92 s, training_loss: 0.217
Epoch    2/30, time: 0.84 s, val_loss: 0.187
Epoch    2/30, time: 4.26 s, training_loss: 0.508
Epoch    3/30, time: 1.81 s, training_loss: 0.162
Epoch    2/30, time: 4.44 s, training_loss: 0.373
Epoch    3/30, time: 0.71 s, val_loss: 0.130
Epoch    2/30, time: 4.75 s, training_loss: 0.353
Epoch    2/30, time: 1.80 s, val_loss: 0.433
Epoch    2/30, time: 1.51 s, val_loss: 0.349
Epoch    4/30, time: 1.67 s, training_loss: 0.131
Epoch    2/30, time: 1.69 s, val_loss: 0.343
Epoch    4/30, time: 0.77 s, val_loss: 0.108
Epoch    5/30, time: 1.60 s, training_loss: 0.110
Epoch    5/30, time: 0.70 s, val_loss: 0.104
Epoch    3/30, time: 4.59 s, training_loss: 0.447
Epoch    3/30, time: 4.47 s, training_loss: 0.317
Epoch    6/30, time: 1.66 s, training_loss: 0.099
Epoch    3/30, time: 1.71 s, val_loss: 0.409
Epoch    3/30, time: 4.90 s, training_loss: 0.318
Epoch    6/30, time: 0.90 s, val_loss: 0.098
Epoch    3/30, time: 1.87 s, val_loss: 0.305
Epoch    3/30, time: 1.85 s, val_loss: 0.322
Epoch    7/30, time: 1.81 s, training_loss: 0.091
Epoch    7/30, time: 0.87 s, val_loss: 0.086
Epoch    4/30, time: 4.31 s, training_loss: 0.411
Epoch    4/30, time: 4.16 s, training_loss: 0.286
Epoch    8/30, time: 1.88 s, training_loss: 0.086
Epoch    4/30, time: 1.44 s, val_loss: 0.390
Epoch    8/30, time: 0.90 s, val_loss: 0.081
Epoch    4/30, time: 1.63 s, val_loss: 0.275
Epoch    4/30, time: 4.78 s, training_loss: 0.286
Epoch    9/30, time: 1.89 s, training_loss: 0.081
Epoch    4/30, time: 1.56 s, val_loss: 0.283
Epoch    9/30, time: 0.78 s, val_loss: 0.078
Epoch    5/30, time: 4.61 s, training_loss: 0.388
Epoch   10/30, time: 2.11 s, training_loss: 0.076
Epoch    5/30, time: 4.70 s, training_loss: 0.268
Epoch   10/30, time: 0.66 s, val_loss: 0.075
Epoch    5/30, time: 1.60 s, val_loss: 0.373
Epoch    5/30, time: 1.60 s, val_loss: 0.260
Epoch    5/30, time: 4.87 s, training_loss: 0.258
Epoch   11/30, time: 2.08 s, training_loss: 0.075
Epoch   11/30, time: 0.68 s, val_loss: 0.074
Epoch    5/30, time: 1.61 s, val_loss: 0.241
Epoch    6/30, time: 4.70 s, training_loss: 0.367
Training Metrics:
Accuracy: 0.9773
Precision: 0.9398
Recall: 0.9418
F1 Score: 0.9408
IoU: 0.8883
Dice Coefficient: 0.9408
Validation Metrics:
Accuracy: 0.9761
Precision: 0.9281
Recall: 0.9485
F1 Score: 0.9382
IoU: 0.8836
Dice Coefficient: 0.9382
Epoch    6/30, time: 4.73 s, training_loss: 0.254
Epoch    6/30, time: 1.59 s, val_loss: 0.356
Epoch   12/30, time: 1.63 s, training_loss: 0.072
Epoch    6/30, time: 1.71 s, val_loss: 0.241
Epoch   12/30, time: 0.73 s, val_loss: 0.071
Epoch    6/30, time: 5.10 s, training_loss: 0.237
Epoch   13/30, time: 1.74 s, training_loss: 0.071
Epoch    6/30, time: 1.72 s, val_loss: 0.224
Epoch   13/30, time: 0.90 s, val_loss: 0.077
Epoch    7/30, time: 4.55 s, training_loss: 0.351
Epoch    7/30, time: 4.40 s, training_loss: 0.243
Epoch   14/30, time: 1.89 s, training_loss: 0.070
Epoch    7/30, time: 1.59 s, val_loss: 0.349
Epoch   14/30, time: 0.69 s, val_loss: 0.074
Epoch    7/30, time: 1.58 s, val_loss: 0.223
Epoch   15/30, time: 1.62 s, training_loss: 0.069
Epoch    7/30, time: 4.88 s, training_loss: 0.213
Epoch   15/30, time: 0.78 s, val_loss: 0.066
Epoch    7/30, time: 1.53 s, val_loss: 0.204
Epoch   16/30, time: 1.71 s, training_loss: 0.067
Epoch    8/30, time: 4.77 s, training_loss: 0.340
Epoch   16/30, time: 0.69 s, val_loss: 0.072
Epoch    8/30, time: 4.53 s, training_loss: 0.234
Epoch    8/30, time: 1.58 s, val_loss: 0.345
Epoch   17/30, time: 1.67 s, training_loss: 0.065
Epoch    8/30, time: 1.60 s, val_loss: 0.220
Epoch   17/30, time: 0.90 s, val_loss: 0.067
Epoch    8/30, time: 4.74 s, training_loss: 0.190
Epoch   18/30, time: 1.71 s, training_loss: 0.063
Epoch    8/30, time: 1.64 s, val_loss: 0.174
Epoch   18/30, time: 0.96 s, val_loss: 0.067
Epoch    9/30, time: 4.41 s, training_loss: 0.330
Epoch    9/30, time: 4.48 s, training_loss: 0.225
Epoch   19/30, time: 1.67 s, training_loss: 0.064
Epoch    9/30, time: 1.63 s, val_loss: 0.338
Epoch   19/30, time: 0.73 s, val_loss: 0.063
Epoch    9/30, time: 1.67 s, val_loss: 0.208
Epoch   20/30, time: 1.71 s, training_loss: 0.063
Epoch    9/30, time: 4.79 s, training_loss: 0.174
Epoch   20/30, time: 0.93 s, val_loss: 0.066
Epoch    9/30, time: 1.50 s, val_loss: 0.173
Epoch   10/30, time: 4.60 s, training_loss: 0.319
Epoch   21/30, time: 1.76 s, training_loss: 0.063
Epoch   10/30, time: 4.53 s, training_loss: 0.218
Epoch   21/30, time: 0.71 s, val_loss: 0.064
Epoch   10/30, time: 1.66 s, val_loss: 0.328
Epoch   10/30, time: 1.47 s, val_loss: 0.198
Training Metrics:
Accuracy: 0.9788
Precision: 0.9445
Recall: 0.9449
F1 Score: 0.9447
IoU: 0.8952
Dice Coefficient: 0.9447
Validation Metrics:
Accuracy: 0.9777
Precision: 0.9383
Recall: 0.9455
F1 Score: 0.9419
IoU: 0.8902
Dice Coefficient: 0.9419
Epoch   10/30, time: 4.87 s, training_loss: 0.158
Epoch   22/30, time: 1.62 s, training_loss: 0.062
Epoch   10/30, time: 1.62 s, val_loss: 0.154
Epoch   22/30, time: 0.75 s, val_loss: 0.071
Epoch   11/30, time: 4.77 s, training_loss: 0.312
Epoch   11/30, time: 4.74 s, training_loss: 0.211
Epoch   11/30, time: 1.54 s, val_loss: 0.320
Epoch   11/30, time: 1.47 s, val_loss: 0.198
Epoch   23/30, time: 4.46 s, training_loss: 0.063
Epoch   11/30, time: 4.66 s, training_loss: 0.146
Epoch   23/30, time: 0.88 s, val_loss: 0.064
Epoch   11/30, time: 1.68 s, val_loss: 0.135
Epoch   24/30, time: 2.23 s, training_loss: 0.060
Training Metrics:
Accuracy: 0.9302
Precision: 0.7541
Recall: 0.9438
F1 Score: 0.8383
IoU: 0.7217
Dice Coefficient: 0.8383
Validation Metrics:
Accuracy: 0.9194
Precision: 0.7188
Recall: 0.9506
F1 Score: 0.8186
IoU: 0.6929
Dice Coefficient: 0.8186
Epoch   24/30, time: 0.79 s, val_loss: 0.061
Training Metrics:
Accuracy: 0.9620
Precision: 0.8755
Recall: 0.9345
F1 Score: 0.9040
IoU: 0.8249
Dice Coefficient: 0.9040
Validation Metrics:
Accuracy: 0.9629
Precision: 0.8724
Recall: 0.9443
F1 Score: 0.9069
IoU: 0.8297
Dice Coefficient: 0.9069
Epoch   25/30, time: 1.82 s, training_loss: 0.059
Epoch   25/30, time: 0.71 s, val_loss: 0.063
Epoch   12/30, time: 4.43 s, training_loss: 0.304
Epoch   26/30, time: 1.85 s, training_loss: 0.059
Epoch   12/30, time: 4.48 s, training_loss: 0.205
Training Metrics:
Accuracy: 0.9732
Precision: 0.9201
Recall: 0.9421
F1 Score: 0.9310
IoU: 0.8709
Dice Coefficient: 0.9310
Validation Metrics:
Accuracy: 0.9728
Precision: 0.9217
Recall: 0.9375
F1 Score: 0.9296
IoU: 0.8684
Dice Coefficient: 0.9296
Epoch   26/30, time: 1.11 s, val_loss: 0.060
Epoch   12/30, time: 1.66 s, val_loss: 0.313
Epoch   12/30, time: 1.57 s, val_loss: 0.196
Epoch   27/30, time: 1.81 s, training_loss: 0.058
Epoch   27/30, time: 0.82 s, val_loss: 0.060
Epoch   28/30, time: 1.71 s, training_loss: 0.059
Epoch   12/30, time: 4.95 s, training_loss: 0.137
Epoch   13/30, time: 4.58 s, training_loss: 0.298
Epoch   13/30, time: 4.26 s, training_loss: 0.199
Epoch   28/30, time: 1.06 s, val_loss: 0.061
Epoch   12/30, time: 1.48 s, val_loss: 0.131
Epoch   13/30, time: 1.52 s, val_loss: 0.304
Epoch   13/30, time: 1.72 s, val_loss: 0.187
Epoch   29/30, time: 1.97 s, training_loss: 0.058
Epoch   29/30, time: 0.77 s, val_loss: 0.057
Epoch   30/30, time: 1.77 s, training_loss: 0.056
Epoch   30/30, time: 0.77 s, val_loss: 0.057
Epoch   14/30, time: 4.46 s, training_loss: 0.292
Epoch   13/30, time: 4.99 s, training_loss: 0.128
Epoch   14/30, time: 4.63 s, training_loss: 0.194
Epoch   14/30, time: 1.86 s, val_loss: 0.299
Epoch   13/30, time: 1.86 s, val_loss: 0.125
Epoch   14/30, time: 1.83 s, val_loss: 0.188
Training Metrics:
Accuracy: 0.9811
Precision: 0.9502
Recall: 0.9513
F1 Score: 0.9507
IoU: 0.9061
Dice Coefficient: 0.9507
Validation Metrics:
Accuracy: 0.9803
Precision: 0.9427
Recall: 0.9549
F1 Score: 0.9488
IoU: 0.9025
Dice Coefficient: 0.9488
Test Metrics:
Accuracy: 0.9803
Precision: 0.9427
Recall: 0.9549
F1 Score: 0.9488
IoU: 0.9025
Dice Coefficient: 0.9488
wandb:
wandb: üöÄ View run trial_3_bs32_lr6e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/q8gfk1dw
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251003_143729-q8gfk1dw/logs
[I 2025-10-03 14:39:21,758] Trial 3 finished with value: 0.9487766915583847 and parameters: {'batch_size': 32, 'lr': 0.0006089239689096104, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 1, 'in_channels': 100, 'att_channels': 64}. Best is trial 3 with value: 0.9487766915583847.
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 0-0, summary, console lines 264-295
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0.94878
wandb:      trial 3
wandb:
wandb: üöÄ View run trial_0_bs64_lr3e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/epbm599s
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251003_143729-epbm599s/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251003_143921-7juqm32b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_4_bs32_lr4e-05_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/7juqm32b
Epoch   15/30, time: 4.69 s, training_loss: 0.287
Epoch   15/30, time: 4.17 s, training_loss: 0.188
Epoch   14/30, time: 5.28 s, training_loss: 0.120
Epoch   15/30, time: 1.62 s, val_loss: 0.175
Epoch   15/30, time: 1.90 s, val_loss: 0.298
Epoch    1/30, time: 1.99 s, training_loss: 0.518
Epoch   14/30, time: 1.83 s, val_loss: 0.117
Epoch   16/30, time: 4.02 s, training_loss: 0.185
Epoch    1/30, time: 4.46 s, val_loss: 0.457
Epoch   16/30, time: 4.58 s, training_loss: 0.282
Epoch   15/30, time: 4.48 s, training_loss: 0.114
Epoch   16/30, time: 1.63 s, val_loss: 0.183
Epoch   16/30, time: 1.70 s, val_loss: 0.289
Epoch   15/30, time: 1.57 s, val_loss: 0.114
Training Metrics:
Accuracy: 0.9239
Precision: 0.7421
Recall: 0.9241
F1 Score: 0.8232
IoU: 0.6995
Dice Coefficient: 0.8232
Validation Metrics:
Accuracy: 0.9145
Precision: 0.7109
Recall: 0.9321
F1 Score: 0.8066
IoU: 0.6759
Dice Coefficient: 0.8066
Epoch    2/30, time: 1.73 s, training_loss: 0.347
Epoch   17/30, time: 4.44 s, training_loss: 0.179
Epoch    2/30, time: 0.85 s, val_loss: 0.340
Epoch   17/30, time: 4.55 s, training_loss: 0.278
Epoch   16/30, time: 4.56 s, training_loss: 0.109
Epoch   17/30, time: 1.69 s, val_loss: 0.173
Epoch    3/30, time: 1.90 s, training_loss: 0.303
Epoch   17/30, time: 1.69 s, val_loss: 0.282
Epoch   16/30, time: 1.69 s, val_loss: 0.111
Epoch    3/30, time: 0.82 s, val_loss: 0.284
Epoch    4/30, time: 1.77 s, training_loss: 0.275
Epoch    4/30, time: 0.88 s, val_loss: 0.256
Epoch   18/30, time: 4.52 s, training_loss: 0.175
Epoch   18/30, time: 4.36 s, training_loss: 0.273
Epoch    5/30, time: 1.93 s, training_loss: 0.254
Epoch   17/30, time: 4.97 s, training_loss: 0.106
Epoch   18/30, time: 1.89 s, val_loss: 0.170
Epoch    5/30, time: 0.79 s, val_loss: 0.245
Epoch   18/30, time: 1.59 s, val_loss: 0.283
Epoch   17/30, time: 1.69 s, val_loss: 0.112
Epoch    6/30, time: 1.96 s, training_loss: 0.239
Epoch    6/30, time: 0.82 s, val_loss: 0.216
Epoch   19/30, time: 4.23 s, training_loss: 0.172
Epoch    7/30, time: 1.87 s, training_loss: 0.226
Epoch   19/30, time: 4.87 s, training_loss: 0.269
Epoch    7/30, time: 0.73 s, val_loss: 0.211
Epoch   19/30, time: 1.63 s, val_loss: 0.158
Epoch   18/30, time: 4.88 s, training_loss: 0.103
Epoch   19/30, time: 1.59 s, val_loss: 0.274
Epoch   18/30, time: 1.46 s, val_loss: 0.107
Epoch    8/30, time: 4.40 s, training_loss: 0.216
Epoch   20/30, time: 4.49 s, training_loss: 0.168
Epoch    8/30, time: 0.76 s, val_loss: 0.195
Epoch   20/30, time: 4.34 s, training_loss: 0.264
Epoch   20/30, time: 1.60 s, val_loss: 0.164
Epoch   19/30, time: 4.52 s, training_loss: 0.095
Epoch   20/30, time: 1.48 s, val_loss: 0.270
Epoch    9/30, time: 2.24 s, training_loss: 0.206
Epoch    9/30, time: 0.72 s, val_loss: 0.182
Epoch   19/30, time: 1.56 s, val_loss: 0.096
Epoch   10/30, time: 1.85 s, training_loss: 0.201
Epoch   21/30, time: 4.51 s, training_loss: 0.164
Epoch   10/30, time: 1.07 s, val_loss: 0.187
Epoch   21/30, time: 4.66 s, training_loss: 0.261
Epoch   21/30, time: 1.59 s, val_loss: 0.161
Epoch   11/30, time: 1.78 s, training_loss: 0.194
Epoch   21/30, time: 1.56 s, val_loss: 0.259Epoch   20/30, time: 4.97 s, training_loss: 0.094

Epoch   11/30, time: 1.01 s, val_loss: 0.179
Training Metrics:
Accuracy: 0.9620
Precision: 0.8684
Recall: 0.9449
F1 Score: 0.9050
IoU: 0.8265
Dice Coefficient: 0.9050
Validation Metrics:
Accuracy: 0.9664
Precision: 0.9067
Recall: 0.9189
F1 Score: 0.9128
IoU: 0.8395
Dice Coefficient: 0.9128
Epoch   20/30, time: 4.48 s, val_loss: 0.095
Training Metrics:
Accuracy: 0.9679
Precision: 0.8954
Recall: 0.9428
F1 Score: 0.9185
IoU: 0.8493Epoch   12/30, time: 2.18 s, training_loss: 0.187

Dice Coefficient: 0.9185
Validation Metrics:
Accuracy: 0.9663
Precision: 0.8745
Recall: 0.9616
F1 Score: 0.9160
IoU: 0.8450
Dice Coefficient: 0.9160
Epoch   12/30, time: 0.96 s, val_loss: 0.193
Training Metrics:
Accuracy: 0.9493
Precision: 0.8226
Recall: 0.9376
F1 Score: 0.8763
IoU: 0.7799
Dice Coefficient: 0.8763
Validation Metrics:
Accuracy: 0.9467
Precision: 0.8120
Recall: 0.9385
F1 Score: 0.8707
IoU: 0.7710
Dice Coefficient: 0.8707
Epoch   13/30, time: 1.90 s, training_loss: 0.182
Epoch   13/30, time: 0.85 s, val_loss: 0.171
Epoch   21/30, time: 4.82 s, training_loss: 0.090
Epoch   22/30, time: 4.88 s, training_loss: 0.161
Epoch   21/30, time: 1.79 s, val_loss: 0.089
Epoch   14/30, time: 2.18 s, training_loss: 0.176
Epoch   22/30, time: 4.90 s, training_loss: 0.257
Epoch   14/30, time: 0.87 s, val_loss: 0.166
Epoch   22/30, time: 1.79 s, val_loss: 0.155
Epoch   22/30, time: 1.60 s, val_loss: 0.262
Epoch   15/30, time: 2.11 s, training_loss: 0.173
Epoch   15/30, time: 0.97 s, val_loss: 0.158
Epoch   23/30, time: 4.61 s, training_loss: 0.158
Epoch   16/30, time: 2.10 s, training_loss: 0.166
Epoch   16/30, time: 0.71 s, val_loss: 0.158
Training Metrics:
Accuracy: 0.9768
Precision: 0.9352
Recall: 0.9445
F1 Score: 0.9398
IoU: 0.8865
Dice Coefficient: 0.9398
Validation Metrics:
Accuracy: 0.9755
Precision: 0.9277
Recall: 0.9459
F1 Score: 0.9367
IoU: 0.8809
Dice Coefficient: 0.9367
Epoch   23/30, time: 1.78 s, val_loss: 0.154
Epoch   23/30, time: 5.39 s, training_loss: 0.254
Epoch   17/30, time: 1.90 s, training_loss: 0.163
Epoch   17/30, time: 0.82 s, val_loss: 0.152
Epoch   18/30, time: 1.55 s, training_loss: 0.159
Epoch   23/30, time: 4.25 s, val_loss: 0.257
Epoch   24/30, time: 4.46 s, training_loss: 0.155Epoch   18/30, time: 0.79 s, val_loss: 0.152

Epoch   22/30, time: 4.83 s, training_loss: 0.087
Epoch   22/30, time: 1.96 s, val_loss: 0.091
Epoch   19/30, time: 1.97 s, training_loss: 0.157
Epoch   24/30, time: 2.05 s, val_loss: 0.148
Epoch   24/30, time: 4.35 s, training_loss: 0.250
Epoch   24/30, time: 1.50 s, val_loss: 0.249
Epoch   25/30, time: 4.71 s, training_loss: 0.151
Epoch   19/30, time: 5.10 s, val_loss: 0.147
Epoch   23/30, time: 5.24 s, training_loss: 0.085
Epoch   25/30, time: 1.49 s, val_loss: 0.147
Epoch   23/30, time: 1.63 s, val_loss: 0.086
Epoch   20/30, time: 1.83 s, training_loss: 0.153
Epoch   25/30, time: 4.62 s, training_loss: 0.247
Epoch   25/30, time: 1.48 s, val_loss: 0.240
Epoch   26/30, time: 4.25 s, training_loss: 0.148
Epoch   20/30, time: 4.69 s, val_loss: 0.150
Epoch   24/30, time: 4.90 s, training_loss: 0.083
Epoch   26/30, time: 1.70 s, val_loss: 0.137
Epoch   21/30, time: 1.83 s, training_loss: 0.149
Epoch   24/30, time: 2.07 s, val_loss: 0.084
Epoch   21/30, time: 0.74 s, val_loss: 0.140
Epoch   26/30, time: 4.79 s, training_loss: 0.245
Epoch   26/30, time: 1.85 s, val_loss: 0.243
Training Metrics:
Accuracy: 0.9704
Precision: 0.8985
Recall: 0.9530
F1 Score: 0.9250
IoU: 0.8604
Dice Coefficient: 0.9250
Validation Metrics:
Accuracy: 0.9703
Precision: 0.9037
Recall: 0.9455
F1 Score: 0.9241
IoU: 0.8590
Dice Coefficient: 0.9241
Epoch   27/30, time: 4.80 s, training_loss: 0.147
Epoch   22/30, time: 1.72 s, training_loss: 0.146
Epoch   25/30, time: 4.93 s, training_loss: 0.080
Epoch   27/30, time: 2.15 s, val_loss: 0.147
Epoch   22/30, time: 1.03 s, val_loss: 0.143
Epoch   25/30, time: 1.92 s, val_loss: 0.086
Epoch   27/30, time: 4.72 s, training_loss: 0.242
Epoch   23/30, time: 2.03 s, training_loss: 0.143
Epoch   23/30, time: 0.78 s, val_loss: 0.137
Epoch   27/30, time: 1.90 s, val_loss: 0.246
Epoch   28/30, time: 4.75 s, training_loss: 0.144
Epoch   24/30, time: 2.35 s, training_loss: 0.140
Epoch   26/30, time: 5.04 s, training_loss: 0.081
Epoch   28/30, time: 2.11 s, val_loss: 0.135
Epoch   24/30, time: 1.42 s, val_loss: 0.138
Epoch   26/30, time: 1.83 s, val_loss: 0.084
Epoch   28/30, time: 4.62 s, training_loss: 0.238
Epoch   25/30, time: 2.55 s, training_loss: 0.137
Epoch   25/30, time: 0.76 s, val_loss: 0.125
Epoch   28/30, time: 2.29 s, val_loss: 0.234
Epoch   29/30, time: 5.01 s, training_loss: 0.141
Epoch   26/30, time: 2.00 s, training_loss: 0.134
Epoch   26/30, time: 0.71 s, val_loss: 0.127
Epoch   27/30, time: 5.19 s, training_loss: 0.080
Epoch   29/30, time: 1.73 s, val_loss: 0.132
Epoch   27/30, time: 1.89 s, training_loss: 0.132
Epoch   29/30, time: 4.57 s, training_loss: 0.235
Epoch   27/30, time: 1.86 s, val_loss: 0.081
Epoch   27/30, time: 0.91 s, val_loss: 0.128
Epoch   29/30, time: 1.94 s, val_loss: 0.239
Epoch   28/30, time: 1.83 s, training_loss: 0.129
Epoch   28/30, time: 0.83 s, val_loss: 0.124
Epoch   30/30, time: 5.09 s, training_loss: 0.138
Epoch   29/30, time: 1.67 s, training_loss: 0.128
Epoch   28/30, time: 4.85 s, training_loss: 0.076
Epoch   30/30, time: 2.13 s, val_loss: 0.138
Epoch   29/30, time: 0.92 s, val_loss: 0.122
Epoch   30/30, time: 4.33 s, training_loss: 0.233
Epoch   28/30, time: 1.70 s, val_loss: 0.080
Epoch   30/30, time: 1.87 s, training_loss: 0.124
Epoch   30/30, time: 1.76 s, val_loss: 0.233
Epoch   30/30, time: 0.81 s, val_loss: 0.119
Training Metrics:
Accuracy: 0.9732
Precision: 0.9136
Recall: 0.9498
F1 Score: 0.9314
IoU: 0.8715
Dice Coefficient: 0.9314
Validation Metrics:
Accuracy: 0.9724
Precision: 0.9140
Recall: 0.9444
F1 Score: 0.9290
IoU: 0.8673
Dice Coefficient: 0.9290
Epoch   29/30, time: 5.02 s, training_loss: 0.075
Test Metrics:
Accuracy: 0.9724
Precision: 0.9140
Recall: 0.9444
F1 Score: 0.9290
IoU: 0.8673
Dice Coefficient: 0.9290
Training Metrics:
Accuracy: 0.9707
Precision: 0.9043
Recall: 0.9477
F1 Score: 0.9255
IoU: 0.8613
Dice Coefficient: 0.9255
Validation Metrics:
Accuracy: 0.9695
Precision: 0.8879
Recall: 0.9619
F1 Score: 0.9234
IoU: 0.8578
Dice Coefficient: 0.9234
Epoch   29/30, time: 1.59 s, val_loss: 0.077
wandb: uploading history steps 0-0, summary, console lines 234-259
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0.92896
wandb:      trial 4
wandb:
wandb: üöÄ View run trial_4_bs32_lr4e-05_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/7juqm32b
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251003_143921-7juqm32b/logs
[I 2025-10-03 14:41:15,926] Trial 4 finished with value: 0.9289585317288547 and parameters: {'batch_size': 32, 'lr': 4.3274083550160354e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 2, 'in_channels': 100, 'att_channels': 32}. Best is trial 3 with value: 0.9487766915583847.
Test Metrics:
Accuracy: 0.9695
Precision: 0.8879
Recall: 0.9619
F1 Score: 0.9234
IoU: 0.8578
Dice Coefficient: 0.9234
[W 2025-10-03 14:41:16,374] Trial 1 failed with parameters: {'batch_size': 16, 'lr': 1.9245473232952455e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 1, 'in_channels': 400, 'att_channels': 16} because of the following error: Error('You must call wandb.init() before wandb.log()').
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 171, in <lambda>
    lambda t: objective(t, config, gpu_queue, args.use_wandb),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 132, in objective
    wandb.log({"final_dice": final_dice, "trial": trial.number})
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.errors.Error: You must call wandb.init() before wandb.log()
[W 2025-10-03 14:41:16,377] Trial 1 failed with value None.
Training Metrics:
Accuracy: 0.9560
Precision: 0.8464
Recall: 0.9411
F1 Score: 0.8912
IoU: 0.8038
Dice Coefficient: 0.8912
Validation Metrics:
Accuracy: 0.9537
Precision: 0.8301
Recall: 0.9531
F1 Score: 0.8874
IoU: 0.7975
Dice Coefficient: 0.8874
Test Metrics:
Accuracy: 0.9537
Precision: 0.8301
Recall: 0.9531
F1 Score: 0.8874
IoU: 0.7975
Dice Coefficient: 0.8874
[W 2025-10-03 14:41:18,259] Trial 2 failed with parameters: {'batch_size': 32, 'lr': 1.3905994802543921e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 400, 'att_channels': 16} because of the following error: Error('You must call wandb.init() before wandb.log()').
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 171, in <lambda>
    lambda t: objective(t, config, gpu_queue, args.use_wandb),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 132, in objective
    wandb.log({"final_dice": final_dice, "trial": trial.number})
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.errors.Error: You must call wandb.init() before wandb.log()
[W 2025-10-03 14:41:18,259] Trial 2 failed with value None.
Epoch   30/30, time: 4.27 s, training_loss: 0.073
Epoch   30/30, time: 1.34 s, val_loss: 0.079
Training Metrics:
Accuracy: 0.9776
Precision: 0.9485
Recall: 0.9340
F1 Score: 0.9412
IoU: 0.8889
Dice Coefficient: 0.9412
Validation Metrics:
Accuracy: 0.9761
Precision: 0.9431
Recall: 0.9314
F1 Score: 0.9372
IoU: 0.8818
Dice Coefficient: 0.9372
Test Metrics:
Accuracy: 0.9761
Precision: 0.9431
Recall: 0.9314
F1 Score: 0.9372
IoU: 0.8818
Dice Coefficient: 0.9372
[W 2025-10-03 14:41:28,401] Trial 0 failed with parameters: {'batch_size': 64, 'lr': 0.0003461372859567763, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 400, 'att_channels': 16} because of the following error: Error('You must call wandb.init() before wandb.log()').
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 171, in <lambda>
    lambda t: objective(t, config, gpu_queue, args.use_wandb),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 132, in objective
    wandb.log({"final_dice": final_dice, "trial": trial.number})
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.errors.Error: You must call wandb.init() before wandb.log()
[W 2025-10-03 14:41:28,402] Trial 0 failed with value None.
Optuna results saving
Trials logged to /scratch/phys/sin/sethih1/runs_ters/all_group_plane_fchk_split_images_ters/32x32/posnet_hyperopt_all_50_epochs_just_aug_val/augmented/config_hypopt_all//optuna_trials.csv
Best params: {'batch_size': 32, 'lr': 0.0006089239689096104, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 1, 'in_channels': 100, 'att_channels': 64}
Best dice: 0.9487766915583847
Best model saved to /scratch/phys/sin/sethih1/models/all_group_plane_fchk_split_images_ters/32x32/posnet_hyperopt_all_50_epochs_just_aug_val/augmented/config_hypopt_all/best_model.pt
[W 2025-10-03 14:41:36,638] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,638] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,639] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,640] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param augmentation unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param batch_size unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param in_channels unique value length is less than 2.
[W 2025-10-03 14:41:36,641] Param loss_fn unique value length is less than 2.
[W 2025-10-03 14:41:37,014] You need to set up the pruning feature to utilize `plot_intermediate_values()`
Visualizations saved to /scratch/phys/sin/sethih1/runs_ters/all_group_plane_fchk_split_images_ters/32x32/posnet_hyperopt_all_50_epochs_just_aug_val/augmented/config_hypopt_all/visualizations
