Trial 0 using GPU 0
wandb: creating run
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251208_160918-rnqqg5xa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_1_bs128_lr5e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0/runs/rnqqg5xa
Trial 1 using GPU 1
wandb: 409 encountered ({"errors":[{"message":"project may already be created, please retry","path":["upsertBucket"]}],"data":{"upsertBucket":null}}), retrying request
Epoch    1/50, time: 404.06 s, training_loss: 0.886
Epoch    1/50, time: 57.05 s, val_loss: 0.856
Epoch    1/50, time: 736.64 s, training_loss: 0.804
Training Metrics:
Accuracy: 0.9259
Precision: 0.1390
Recall: 0.6190
F1 Score: 0.2271
IoU: 0.1281
Dice Coefficient: 0.2271
Validation Metrics:
Accuracy: 0.9215
Precision: 0.1418
Recall: 0.6701
F1 Score: 0.2341
IoU: 0.1326
Dice Coefficient: 0.2341
Epoch    1/50, time: 73.98 s, val_loss: 0.780
Epoch    2/50, time: 228.60 s, training_loss: 0.827
Epoch    2/50, time: 27.67 s, val_loss: 0.816
Epoch    3/50, time: 225.95 s, training_loss: 0.789
Epoch    3/50, time: 27.94 s, val_loss: 0.766
Epoch    4/50, time: 223.08 s, training_loss: 0.755
Epoch    4/50, time: 27.58 s, val_loss: 0.723
Training Metrics:
Accuracy: 0.9528
Precision: 0.1701
Recall: 0.4350
F1 Score: 0.2446
IoU: 0.1393
Dice Coefficient: 0.2446
Validation Metrics:
Accuracy: 0.9507
Precision: 0.1692
Recall: 0.4489
F1 Score: 0.2457
IoU: 0.1401
Dice Coefficient: 0.2457
Epoch    5/50, time: 222.86 s, training_loss: 0.712
Epoch    5/50, time: 27.44 s, val_loss: 0.670
Epoch    6/50, time: 223.78 s, training_loss: 0.660
Epoch    6/50, time: 26.59 s, val_loss: 0.636
Epoch    7/50, time: 222.88 s, training_loss: 0.623
Epoch    7/50, time: 27.97 s, val_loss: 0.602
Epoch    2/50, time: 681.34 s, training_loss: 0.713
Epoch    2/50, time: 73.21 s, val_loss: 0.632
Epoch    8/50, time: 226.67 s, training_loss: 0.592
Epoch    8/50, time: 26.82 s, val_loss: 0.572
Epoch    9/50, time: 224.59 s, training_loss: 0.570
Epoch    9/50, time: 25.99 s, val_loss: 0.573
Epoch   10/50, time: 223.27 s, training_loss: 0.542
Epoch   10/50, time: 26.78 s, val_loss: 0.532
Epoch    3/50, time: 668.74 s, training_loss: 0.573
Epoch    3/50, time: 73.36 s, val_loss: 0.511
Epoch   11/50, time: 223.34 s, training_loss: 0.526
Epoch   11/50, time: 26.50 s, val_loss: 0.525
Training Metrics:
Accuracy: 0.9774
Precision: 0.4077
Recall: 0.6362
F1 Score: 0.4969
IoU: 0.3306
Dice Coefficient: 0.4969
Validation Metrics:
Accuracy: 0.9776
Precision: 0.4196
Recall: 0.6557
F1 Score: 0.5117
IoU: 0.3438
Dice Coefficient: 0.5117
Epoch    4/50, time: 660.17 s, training_loss: 0.488
Epoch   12/50, time: 224.23 s, training_loss: 0.515
Epoch    4/50, time: 72.08 s, val_loss: 0.450
Epoch   12/50, time: 25.69 s, val_loss: 0.501
Epoch   13/50, time: 226.20 s, training_loss: 0.503
Epoch   13/50, time: 26.72 s, val_loss: 0.483
Epoch   14/50, time: 224.04 s, training_loss: 0.489
Epoch   14/50, time: 26.95 s, val_loss: 0.478
Epoch    5/50, time: 664.64 s, training_loss: 0.444
Epoch   15/50, time: 223.39 s, training_loss: 0.482
Epoch    5/50, time: 71.69 s, val_loss: 0.487
Epoch   15/50, time: 27.72 s, val_loss: 0.467
Epoch   16/50, time: 226.54 s, training_loss: 0.473
Epoch   16/50, time: 26.71 s, val_loss: 0.466
Epoch   17/50, time: 223.94 s, training_loss: 0.465
Epoch   17/50, time: 26.87 s, val_loss: 0.467
Epoch    6/50, time: 670.03 s, training_loss: 0.416
Epoch    6/50, time: 74.37 s, val_loss: 0.390
Epoch   18/50, time: 226.19 s, training_loss: 0.465
Epoch   18/50, time: 27.10 s, val_loss: 0.489
Epoch   19/50, time: 222.18 s, training_loss: 0.457
Epoch   19/50, time: 26.64 s, val_loss: 0.434
Epoch   20/50, time: 223.65 s, training_loss: 0.447
Epoch   20/50, time: 26.87 s, val_loss: 0.435
Epoch    7/50, time: 661.88 s, training_loss: 0.399
Epoch    7/50, time: 74.09 s, val_loss: 0.362
Epoch   21/50, time: 224.81 s, training_loss: 0.444
Epoch   21/50, time: 26.69 s, val_loss: 0.427
Training Metrics:
Accuracy: 0.9857
Precision: 0.5947
Recall: 0.5923
F1 Score: 0.5935
IoU: 0.4220
Dice Coefficient: 0.5935
Validation Metrics:
Accuracy: 0.9862
Precision: 0.6145
Recall: 0.6068
F1 Score: 0.6106
IoU: 0.4395
Dice Coefficient: 0.6106
Epoch   22/50, time: 226.70 s, training_loss: 0.441
Epoch   22/50, time: 27.55 s, val_loss: 0.419
Epoch    8/50, time: 667.11 s, training_loss: 0.383
Epoch    8/50, time: 72.49 s, val_loss: 0.436
Epoch   23/50, time: 223.27 s, training_loss: 0.434
Epoch   23/50, time: 27.13 s, val_loss: 0.440
Epoch   24/50, time: 224.16 s, training_loss: 0.431
Epoch   24/50, time: 27.46 s, val_loss: 0.413
Epoch   25/50, time: 223.58 s, training_loss: 0.426
Epoch   25/50, time: 26.71 s, val_loss: 0.401
Epoch    9/50, time: 669.18 s, training_loss: 0.372
Epoch    9/50, time: 74.57 s, val_loss: 0.385
Epoch   26/50, time: 225.68 s, training_loss: 0.422
Epoch   26/50, time: 26.93 s, val_loss: 0.412
Epoch   27/50, time: 231.38 s, training_loss: 0.421
Epoch   27/50, time: 27.50 s, val_loss: 0.405
Epoch   28/50, time: 230.08 s, training_loss: 0.418
Epoch   28/50, time: 26.30 s, val_loss: 0.392
Epoch   10/50, time: 675.82 s, training_loss: 0.365
Epoch   10/50, time: 73.03 s, val_loss: 0.346
Epoch   29/50, time: 229.27 s, training_loss: 0.413
Epoch   29/50, time: 26.20 s, val_loss: 0.404
Epoch   30/50, time: 226.25 s, training_loss: 0.412
Epoch   30/50, time: 26.32 s, val_loss: 0.408
Epoch   31/50, time: 227.11 s, training_loss: 0.407
Epoch   11/50, time: 667.84 s, training_loss: 0.354
Epoch   31/50, time: 25.46 s, val_loss: 0.395
Epoch   11/50, time: 76.20 s, val_loss: 0.340
Training Metrics:
Accuracy: 0.9862
Precision: 0.6013
Recall: 0.6313
F1 Score: 0.6159
IoU: 0.4450
Dice Coefficient: 0.6159
Validation Metrics:
Accuracy: 0.9865
Precision: 0.6134
Recall: 0.6652
F1 Score: 0.6383
IoU: 0.4687
Dice Coefficient: 0.6383
Epoch   32/50, time: 230.29 s, training_loss: 0.408
Epoch   32/50, time: 28.80 s, val_loss: 0.386
Epoch   33/50, time: 225.20 s, training_loss: 0.405
Epoch   33/50, time: 27.22 s, val_loss: 0.388
Training Metrics:
Accuracy: 0.9887
Precision: 0.6614
Recall: 0.7264
F1 Score: 0.6923
IoU: 0.5295
Dice Coefficient: 0.6923
Validation Metrics:
Accuracy: 0.9885
Precision: 0.6614
Recall: 0.7318
F1 Score: 0.6948
IoU: 0.5323
Dice Coefficient: 0.6948
Epoch   34/50, time: 226.68 s, training_loss: 0.402
Epoch   34/50, time: 26.91 s, val_loss: 0.399
Epoch   35/50, time: 228.32 s, training_loss: 0.400
Epoch   35/50, time: 27.91 s, val_loss: 0.386
Epoch   12/50, time: 673.47 s, training_loss: 0.347
Epoch   36/50, time: 227.61 s, training_loss: 0.398
Epoch   36/50, time: 26.48 s, val_loss: 0.412
Epoch   12/50, time: 71.85 s, val_loss: 0.353
Epoch   37/50, time: 226.77 s, training_loss: 0.395
Epoch   37/50, time: 26.10 s, val_loss: 0.381
Epoch   38/50, time: 223.73 s, training_loss: 0.395
Epoch   38/50, time: 26.72 s, val_loss: 0.396
Epoch   13/50, time: 663.30 s, training_loss: 0.341
Epoch   39/50, time: 227.53 s, training_loss: 0.392
Epoch   39/50, time: 26.97 s, val_loss: 0.383
Epoch   13/50, time: 72.15 s, val_loss: 0.330
Epoch   40/50, time: 228.11 s, training_loss: 0.391
Epoch   40/50, time: 26.07 s, val_loss: 0.378
Epoch   41/50, time: 227.23 s, training_loss: 0.390
Epoch   41/50, time: 26.61 s, val_loss: 0.370
Epoch   14/50, time: 665.80 s, training_loss: 0.337
Epoch   14/50, time: 73.03 s, val_loss: 0.328
Training Metrics:
Accuracy: 0.9867
Precision: 0.6051
Recall: 0.6952
F1 Score: 0.6470
IoU: 0.4782
Dice Coefficient: 0.6470
Validation Metrics:
Accuracy: 0.9867
Precision: 0.6064
Recall: 0.7266
F1 Score: 0.6611
IoU: 0.4937
Dice Coefficient: 0.6611
Epoch   42/50, time: 227.22 s, training_loss: 0.384
Epoch   42/50, time: 26.96 s, val_loss: 0.388
Epoch   43/50, time: 225.61 s, training_loss: 0.386
Epoch   43/50, time: 27.44 s, val_loss: 0.395
Epoch   15/50, time: 663.79 s, training_loss: 0.332
Epoch   15/50, time: 75.05 s, val_loss: 0.326
Epoch   44/50, time: 225.68 s, training_loss: 0.380
Epoch   44/50, time: 26.69 s, val_loss: 0.385
Epoch   45/50, time: 227.23 s, training_loss: 0.385
Epoch   45/50, time: 27.33 s, val_loss: 0.372
Epoch   46/50, time: 226.36 s, training_loss: 0.381
Epoch   46/50, time: 27.14 s, val_loss: 0.381
Epoch   16/50, time: 673.29 s, training_loss: 0.328
Epoch   16/50, time: 74.19 s, val_loss: 0.325
Epoch   47/50, time: 225.37 s, training_loss: 0.379
Epoch   47/50, time: 27.18 s, val_loss: 0.361
Epoch   48/50, time: 228.83 s, training_loss: 0.377
Epoch   48/50, time: 27.20 s, val_loss: 0.385
Epoch   49/50, time: 224.20 s, training_loss: 0.376
Epoch   49/50, time: 26.43 s, val_loss: 0.377
Epoch   17/50, time: 664.93 s, training_loss: 0.322
Epoch   17/50, time: 72.69 s, val_loss: 0.314
Epoch   50/50, time: 230.17 s, training_loss: 0.375
Epoch   50/50, time: 27.05 s, val_loss: 0.364
Training Metrics:
Accuracy: 0.9866
Precision: 0.5995
Recall: 0.7133
F1 Score: 0.6515
IoU: 0.4831
Dice Coefficient: 0.6515
Validation Metrics:
Accuracy: 0.9867
Precision: 0.6053
Recall: 0.7409
F1 Score: 0.6662
IoU: 0.4995
Dice Coefficient: 0.6662
Test Metrics:
Accuracy: 0.9867
Precision: 0.6053
Recall: 0.7409
F1 Score: 0.6662
IoU: 0.4995
Dice Coefficient: 0.6662
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
wandb: uploading output.log; uploading wandb-summary.json
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0.66625
wandb:      trial 1
wandb:
wandb: üöÄ View run trial_1_bs128_lr5e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0/runs/rnqqg5xa
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251208_160918-rnqqg5xa/logs
[I 2025-12-08 20:16:49,747] Trial 1 finished with value: 0.6662498219248424 and parameters: {'batch_size': 128, 'lr': 0.0004982338039463636, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 100, 'att_channels': 16}. Best is trial 1 with value: 0.6662498219248424.
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251208_201650-ykem2qyz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_2_bs128_lr4e-05_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0/runs/ykem2qyz
Trial 2 using GPU 1
Epoch   18/50, time: 665.43 s, training_loss: 0.320
Epoch   18/50, time: 73.61 s, val_loss: 0.306
Epoch    1/50, time: 228.44 s, training_loss: 0.895
Epoch    1/50, time: 27.39 s, val_loss: 0.816
Training Metrics:
Accuracy: 0.7086
Precision: 0.0468
Recall: 0.8041
F1 Score: 0.0884
IoU: 0.0462
Dice Coefficient: 0.0884
Validation Metrics:
Accuracy: 0.9034
Precision: 0.1357
Recall: 0.8194
F1 Score: 0.2329
IoU: 0.1318
Dice Coefficient: 0.2329
Epoch    2/50, time: 227.49 s, training_loss: 0.852
Epoch    2/50, time: 26.95 s, val_loss: 0.797
Epoch   19/50, time: 662.29 s, training_loss: 0.317
Epoch   19/50, time: 72.64 s, val_loss: 0.321
Epoch    3/50, time: 230.08 s, training_loss: 0.838
Epoch    3/50, time: 26.93 s, val_loss: 0.776
Epoch    4/50, time: 231.50 s, training_loss: 0.827
Epoch    4/50, time: 26.94 s, val_loss: 0.763
Epoch    5/50, time: 227.44 s, training_loss: 0.814
Epoch    5/50, time: 26.89 s, val_loss: 0.706
Epoch   20/50, time: 677.40 s, training_loss: 0.313
Epoch   20/50, time: 72.30 s, val_loss: 0.339
Epoch    6/50, time: 225.34 s, training_loss: 0.786
Epoch    6/50, time: 26.34 s, val_loss: 0.631
Epoch    7/50, time: 229.51 s, training_loss: 0.763
Epoch    7/50, time: 27.09 s, val_loss: 0.587
Epoch    8/50, time: 229.46 s, training_loss: 0.737
Epoch    8/50, time: 26.32 s, val_loss: 0.559
Epoch   21/50, time: 687.37 s, training_loss: 0.309
Epoch   21/50, time: 74.37 s, val_loss: 0.305
Epoch    9/50, time: 227.74 s, training_loss: 0.716
Epoch    9/50, time: 27.87 s, val_loss: 0.555
Epoch   10/50, time: 231.01 s, training_loss: 0.695
Epoch   10/50, time: 27.80 s, val_loss: 0.515
Epoch   11/50, time: 228.20 s, training_loss: 0.673
Epoch   11/50, time: 27.67 s, val_loss: 0.493
Training Metrics:
Accuracy: 0.9907
Precision: 0.7320
Recall: 0.7396
F1 Score: 0.7358
IoU: 0.5820
Dice Coefficient: 0.7358
Validation Metrics:
Accuracy: 0.9903
Precision: 0.7209
Recall: 0.7480
F1 Score: 0.7342
IoU: 0.5800
Dice Coefficient: 0.7342
Training Metrics:
Accuracy: 0.6478
Precision: 0.0394
Recall: 0.8141
F1 Score: 0.0751
IoU: 0.0390
Dice Coefficient: 0.0751
Validation Metrics:
Accuracy: 0.9821
Precision: 0.4993
Recall: 0.7179
F1 Score: 0.5890
IoU: 0.4174
Dice Coefficient: 0.5890
Epoch   12/50, time: 230.80 s, training_loss: 0.652
Epoch   12/50, time: 28.54 s, val_loss: 0.468
Epoch   13/50, time: 231.12 s, training_loss: 0.636
Epoch   22/50, time: 681.39 s, training_loss: 0.305
Epoch   13/50, time: 27.90 s, val_loss: 0.471
Epoch   22/50, time: 72.92 s, val_loss: 0.321
Epoch   14/50, time: 229.73 s, training_loss: 0.620
Epoch   14/50, time: 27.16 s, val_loss: 0.447
Epoch   15/50, time: 230.72 s, training_loss: 0.604
Epoch   15/50, time: 27.22 s, val_loss: 0.433
Epoch   23/50, time: 687.82 s, training_loss: 0.301
Epoch   16/50, time: 231.15 s, training_loss: 0.589
Epoch   16/50, time: 26.97 s, val_loss: 0.434
Epoch   23/50, time: 74.17 s, val_loss: 0.299
Epoch   17/50, time: 229.17 s, training_loss: 0.575
Epoch   17/50, time: 27.97 s, val_loss: 0.418
Epoch   18/50, time: 229.38 s, training_loss: 0.565
Epoch   18/50, time: 29.18 s, val_loss: 0.405
Epoch   24/50, time: 678.59 s, training_loss: 0.303
Epoch   19/50, time: 227.41 s, training_loss: 0.554
Epoch   19/50, time: 26.63 s, val_loss: 0.406
Epoch   24/50, time: 72.96 s, val_loss: 0.350
Epoch   20/50, time: 228.87 s, training_loss: 0.546
Epoch   20/50, time: 26.85 s, val_loss: 0.367
Epoch   21/50, time: 224.08 s, training_loss: 0.532
Epoch   21/50, time: 27.16 s, val_loss: 0.439
Epoch   25/50, time: 685.93 s, training_loss: 0.297
Epoch   25/50, time: 71.85 s, val_loss: 0.326
Training Metrics:
Accuracy: 0.7792
Precision: 0.0617
Recall: 0.8142
F1 Score: 0.1147
IoU: 0.0609
Dice Coefficient: 0.1147
Validation Metrics:
Accuracy: 0.9870
Precision: 0.6095
Recall: 0.7591
F1 Score: 0.6761
IoU: 0.5107
Dice Coefficient: 0.6761
Epoch   22/50, time: 227.16 s, training_loss: 0.525
Epoch   22/50, time: 26.99 s, val_loss: 0.411
Epoch   23/50, time: 227.05 s, training_loss: 0.514
Epoch   23/50, time: 27.23 s, val_loss: 0.416
Epoch   26/50, time: 670.07 s, training_loss: 0.296
Epoch   26/50, time: 73.98 s, val_loss: 0.311
Epoch   24/50, time: 229.57 s, training_loss: 0.507
Epoch   24/50, time: 28.26 s, val_loss: 0.405
Epoch   25/50, time: 227.63 s, training_loss: 0.498
Epoch   25/50, time: 27.38 s, val_loss: 0.356
Epoch   26/50, time: 226.37 s, training_loss: 0.485
Epoch   26/50, time: 27.56 s, val_loss: 0.358
Epoch   27/50, time: 675.70 s, training_loss: 0.294
Epoch   27/50, time: 75.75 s, val_loss: 0.304
Epoch   27/50, time: 223.16 s, training_loss: 0.478
Epoch   27/50, time: 27.62 s, val_loss: 0.388
Epoch   28/50, time: 230.35 s, training_loss: 0.477
Epoch   28/50, time: 26.99 s, val_loss: 0.346
Epoch   29/50, time: 228.33 s, training_loss: 0.470
Epoch   29/50, time: 27.32 s, val_loss: 0.346
Epoch   28/50, time: 660.42 s, training_loss: 0.296
Epoch   28/50, time: 74.18 s, val_loss: 0.298
Epoch   30/50, time: 224.45 s, training_loss: 0.460
Epoch   30/50, time: 26.80 s, val_loss: 0.340
Epoch   31/50, time: 224.49 s, training_loss: 0.450
Epoch   31/50, time: 27.54 s, val_loss: 0.358
Epoch   29/50, time: 671.14 s, training_loss: 0.290
Training Metrics:
Accuracy: 0.8452
Precision: 0.0873
Recall: 0.8265
F1 Score: 0.1580
IoU: 0.0858
Dice Coefficient: 0.1580
Validation Metrics:
Accuracy: 0.9900
Precision: 0.6926
Recall: 0.7939
F1 Score: 0.7398
IoU: 0.5870
Dice Coefficient: 0.7398
Epoch   29/50, time: 74.03 s, val_loss: 0.339
Epoch   32/50, time: 226.47 s, training_loss: 0.444
Epoch   32/50, time: 27.61 s, val_loss: 0.485
Epoch   33/50, time: 226.02 s, training_loss: 0.443
Epoch   33/50, time: 26.79 s, val_loss: 0.335
Epoch   34/50, time: 225.05 s, training_loss: 0.426
Epoch   30/50, time: 678.84 s, training_loss: 0.291
Epoch   34/50, time: 28.25 s, val_loss: 0.317
Epoch   30/50, time: 76.03 s, val_loss: 0.381
Epoch   35/50, time: 227.27 s, training_loss: 0.422
Epoch   35/50, time: 28.18 s, val_loss: 0.337
Epoch   36/50, time: 228.77 s, training_loss: 0.420
Epoch   36/50, time: 27.19 s, val_loss: 0.331
Epoch   31/50, time: 675.05 s, training_loss: 0.290
Epoch   37/50, time: 223.95 s, training_loss: 0.420
Epoch   37/50, time: 26.93 s, val_loss: 0.313
Epoch   31/50, time: 75.56 s, val_loss: 0.291
Epoch   38/50, time: 228.69 s, training_loss: 0.400
Epoch   38/50, time: 27.64 s, val_loss: 0.316
Epoch   39/50, time: 225.41 s, training_loss: 0.403
Epoch   39/50, time: 28.30 s, val_loss: 0.312
Epoch   40/50, time: 226.03 s, training_loss: 0.392
Epoch   40/50, time: 28.10 s, val_loss: 0.323
Training Metrics:
Accuracy: 0.9904
Precision: 0.6925
Recall: 0.8133
F1 Score: 0.7480
IoU: 0.5975
Dice Coefficient: 0.7480
Validation Metrics:
Accuracy: 0.9901
Precision: 0.6927
Recall: 0.8026
F1 Score: 0.7436
IoU: 0.5918
Dice Coefficient: 0.7436
Epoch   41/50, time: 227.96 s, training_loss: 0.394
Epoch   41/50, time: 28.00 s, val_loss: 0.329
Training Metrics:
Accuracy: 0.9021
Precision: 0.1328
Recall: 0.8266
F1 Score: 0.2288
IoU: 0.1292
Dice Coefficient: 0.2288
Validation Metrics:
Accuracy: 0.9909
Precision: 0.7266
Recall: 0.7859
F1 Score: 0.7551
IoU: 0.6065
Dice Coefficient: 0.7551
Epoch   32/50, time: 672.48 s, training_loss: 0.285
Epoch   42/50, time: 226.92 s, training_loss: 0.379
Epoch   42/50, time: 28.87 s, val_loss: 0.317
Epoch   32/50, time: 74.06 s, val_loss: 0.328
Epoch   43/50, time: 226.08 s, training_loss: 0.378
Epoch   43/50, time: 27.94 s, val_loss: 0.295
Epoch   44/50, time: 231.79 s, training_loss: 0.379
Epoch   44/50, time: 27.53 s, val_loss: 0.307
Epoch   33/50, time: 663.88 s, training_loss: 0.283
Epoch   45/50, time: 227.77 s, training_loss: 0.367
Epoch   33/50, time: 72.50 s, val_loss: 0.312
Epoch   45/50, time: 27.35 s, val_loss: 0.303
Epoch   46/50, time: 226.37 s, training_loss: 0.361
Epoch   46/50, time: 27.60 s, val_loss: 0.298
Epoch   47/50, time: 233.07 s, training_loss: 0.359
Epoch   47/50, time: 28.22 s, val_loss: 0.317
Epoch   34/50, time: 665.71 s, training_loss: 0.281
Epoch   34/50, time: 73.59 s, val_loss: 0.296
Epoch   48/50, time: 225.52 s, training_loss: 0.359
Epoch   48/50, time: 27.56 s, val_loss: 0.323
Epoch   49/50, time: 229.31 s, training_loss: 0.352
Epoch   49/50, time: 27.08 s, val_loss: 0.293
Epoch   50/50, time: 228.68 s, training_loss: 0.343
Epoch   50/50, time: 26.85 s, val_loss: 0.292
Epoch   35/50, time: 682.64 s, training_loss: 0.281
Epoch   35/50, time: 74.20 s, val_loss: 0.280
Training Metrics:
Accuracy: 0.8897
Precision: 0.1211
Recall: 0.8431
F1 Score: 0.2118
IoU: 0.1184
Dice Coefficient: 0.2118
Validation Metrics:
Accuracy: 0.9914
Precision: 0.7353
Recall: 0.8101
F1 Score: 0.7709
IoU: 0.6273
Dice Coefficient: 0.7709
Test Metrics:
Accuracy: 0.9914
Precision: 0.7353
Recall: 0.8101
F1 Score: 0.7709
IoU: 0.6273
Dice Coefficient: 0.7709
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0.77093
wandb:      trial 2
wandb:
wandb: üöÄ View run trial_2_bs128_lr4e-05_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0/runs/ykem2qyz
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251208_201650-ykem2qyz/logs
[I 2025-12-09 00:22:47,780] Trial 2 finished with value: 0.7709331645230934 and parameters: {'batch_size': 128, 'lr': 3.757895642936234e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 3, 'in_channels': 100, 'att_channels': 64}. Best is trial 2 with value: 0.7709331645230934.
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251209_002248-9mqn1axu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_3_bs16_lr1e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_1.0/runs/9mqn1axu
Trial 3 using GPU 1
Epoch    1/50, time: 215.27 s, training_loss: 0.862
Epoch    1/50, time: 27.79 s, val_loss: 0.849
Epoch   36/50, time: 664.83 s, training_loss: 0.278
Training Metrics:
Accuracy: 0.7740
Precision: 0.0673
Recall: 0.9226
F1 Score: 0.1255
IoU: 0.0669
Dice Coefficient: 0.1255
Validation Metrics:
Accuracy: 0.6698
Precision: 0.0489
Recall: 0.9458
F1 Score: 0.0930
IoU: 0.0488
Dice Coefficient: 0.0930
Epoch   36/50, time: 75.66 s, val_loss: 0.306
Epoch    2/50, time: 213.51 s, training_loss: 0.778
Epoch    2/50, time: 27.86 s, val_loss: 0.675
Epoch    3/50, time: 212.88 s, training_loss: 0.644
Epoch    3/50, time: 28.66 s, val_loss: 0.546
Epoch    4/50, time: 210.90 s, training_loss: 0.532
Epoch   37/50, time: 662.33 s, training_loss: 0.276
Epoch    4/50, time: 27.89 s, val_loss: 0.469
Epoch   37/50, time: 73.96 s, val_loss: 0.282
Epoch    5/50, time: 214.58 s, training_loss: 0.477
Epoch    5/50, time: 28.11 s, val_loss: 0.407
Epoch    6/50, time: 221.03 s, training_loss: 0.408
Epoch    6/50, time: 28.86 s, val_loss: 0.414
Epoch    7/50, time: 216.34 s, training_loss: 0.378
Epoch   38/50, time: 671.26 s, training_loss: 0.277
Epoch    7/50, time: 27.36 s, val_loss: 0.359
Epoch   38/50, time: 74.71 s, val_loss: 0.282
Epoch    8/50, time: 218.07 s, training_loss: 0.359
Epoch    8/50, time: 29.32 s, val_loss: 0.344
Epoch    9/50, time: 216.45 s, training_loss: 0.347
Epoch    9/50, time: 28.31 s, val_loss: 0.328
Epoch   10/50, time: 216.94 s, training_loss: 0.335
Epoch   39/50, time: 668.33 s, training_loss: 0.273
Epoch   10/50, time: 26.53 s, val_loss: 0.317
Epoch   39/50, time: 72.66 s, val_loss: 0.292
Epoch   11/50, time: 217.21 s, training_loss: 0.330
Epoch   11/50, time: 27.41 s, val_loss: 0.308
Training Metrics:
Accuracy: 0.9896
Precision: 0.6888
Recall: 0.7442
F1 Score: 0.7154
IoU: 0.5569
Dice Coefficient: 0.7154
Validation Metrics:
Accuracy: 0.9896
Precision: 0.6938
Recall: 0.7522
F1 Score: 0.7218
IoU: 0.5647
Dice Coefficient: 0.7218
Epoch   40/50, time: 679.15 s, training_loss: 0.274
Epoch   12/50, time: 216.08 s, training_loss: 0.320
Epoch   12/50, time: 26.84 s, val_loss: 0.324
Epoch   40/50, time: 74.31 s, val_loss: 0.282
Epoch   13/50, time: 212.47 s, training_loss: 0.317
Epoch   13/50, time: 26.91 s, val_loss: 0.347
Epoch   14/50, time: 216.81 s, training_loss: 0.307
Epoch   14/50, time: 27.05 s, val_loss: 0.353
Epoch   41/50, time: 678.55 s, training_loss: 0.271
Epoch   15/50, time: 213.24 s, training_loss: 0.303
Epoch   15/50, time: 28.60 s, val_loss: 0.318
Epoch   41/50, time: 77.50 s, val_loss: 0.274
Epoch   16/50, time: 217.19 s, training_loss: 0.299
Epoch   16/50, time: 28.61 s, val_loss: 0.307
Epoch   17/50, time: 219.49 s, training_loss: 0.295
Epoch   17/50, time: 29.20 s, val_loss: 0.403
Epoch   18/50, time: 218.88 s, training_loss: 0.291
Epoch   18/50, time: 27.50 s, val_loss: 0.275
Training Metrics:
Accuracy: 0.9918
Precision: 0.7595
Recall: 0.7776
F1 Score: 0.7684
IoU: 0.6240
Dice Coefficient: 0.7684
Validation Metrics:
Accuracy: 0.9914
Precision: 0.7503
Recall: 0.7757
F1 Score: 0.7628
IoU: 0.6165
Dice Coefficient: 0.7628
Epoch   19/50, time: 214.26 s, training_loss: 0.288
Epoch   19/50, time: 27.99 s, val_loss: 0.329
Epoch   20/50, time: 217.37 s, training_loss: 0.285
Epoch   20/50, time: 27.87 s, val_loss: 0.275
Epoch   21/50, time: 215.68 s, training_loss: 0.280
Epoch   21/50, time: 28.58 s, val_loss: 0.268
Epoch   42/50, time: 685.35 s, training_loss: 0.271
Epoch   42/50, time: 75.86 s, val_loss: 0.295
Training Metrics:
Accuracy: 0.9915
Precision: 0.7400
Recall: 0.7954
F1 Score: 0.7667
IoU: 0.6217
Dice Coefficient: 0.7667
Validation Metrics:
Accuracy: 0.9913
Precision: 0.7395
Recall: 0.7924
F1 Score: 0.7650
IoU: 0.6194
Dice Coefficient: 0.7650
Epoch   22/50, time: 213.10 s, training_loss: 0.275
Epoch   22/50, time: 27.99 s, val_loss: 0.268
Epoch   23/50, time: 212.94 s, training_loss: 0.276
Epoch   23/50, time: 27.46 s, val_loss: 0.276
Epoch   43/50, time: 679.40 s, training_loss: 0.268
Epoch   43/50, time: 73.93 s, val_loss: 0.363
Epoch   24/50, time: 212.18 s, training_loss: 0.273
Epoch   24/50, time: 27.57 s, val_loss: 0.268
Epoch   25/50, time: 215.14 s, training_loss: 0.270
Epoch   25/50, time: 26.77 s, val_loss: 0.369
Epoch   26/50, time: 215.30 s, training_loss: 0.267
Epoch   26/50, time: 28.02 s, val_loss: 0.309
Epoch   44/50, time: 671.90 s, training_loss: 0.268
Epoch   44/50, time: 73.98 s, val_loss: 0.280
Epoch   27/50, time: 214.27 s, training_loss: 0.267
Epoch   27/50, time: 27.35 s, val_loss: 0.295
Epoch   28/50, time: 213.31 s, training_loss: 0.264
Epoch   28/50, time: 27.71 s, val_loss: 0.646
Epoch   29/50, time: 213.49 s, training_loss: 0.260
Epoch   29/50, time: 27.34 s, val_loss: 0.297
Epoch   45/50, time: 675.49 s, training_loss: 0.267
Epoch   45/50, time: 74.82 s, val_loss: 0.329
Epoch   30/50, time: 210.40 s, training_loss: 0.258
Epoch   30/50, time: 27.40 s, val_loss: 0.259
Epoch   31/50, time: 214.11 s, training_loss: 0.257
Epoch   31/50, time: 27.67 s, val_loss: 0.285
Training Metrics:
Accuracy: 0.9916
Precision: 0.7600
Recall: 0.7594
F1 Score: 0.7597
IoU: 0.6125
Dice Coefficient: 0.7597
Validation Metrics:
Accuracy: 0.9911
Precision: 0.7565
Recall: 0.7412
F1 Score: 0.7488
IoU: 0.5984
Dice Coefficient: 0.7488
Epoch   46/50, time: 671.61 s, training_loss: 0.265
Epoch   46/50, time: 74.14 s, val_loss: 0.327
Epoch   32/50, time: 213.40 s, training_loss: 0.254
Epoch   32/50, time: 28.05 s, val_loss: 0.353
Epoch   33/50, time: 213.60 s, training_loss: 0.252
Epoch   33/50, time: 29.52 s, val_loss: 0.257
Epoch   34/50, time: 218.78 s, training_loss: 0.253
Epoch   34/50, time: 28.18 s, val_loss: 0.330
Epoch   47/50, time: 669.41 s, training_loss: 0.264
Epoch   47/50, time: 73.86 s, val_loss: 0.269
Epoch   35/50, time: 212.59 s, training_loss: 0.249
Epoch   35/50, time: 28.66 s, val_loss: 0.453
Epoch   36/50, time: 215.95 s, training_loss: 0.247
Epoch   36/50, time: 28.58 s, val_loss: 0.293
Epoch   37/50, time: 216.86 s, training_loss: 0.247
Epoch   37/50, time: 28.39 s, val_loss: 0.254
Epoch   48/50, time: 669.50 s, training_loss: 0.261
Epoch   48/50, time: 74.64 s, val_loss: 0.307
Epoch   38/50, time: 216.20 s, training_loss: 0.245
Epoch   38/50, time: 28.41 s, val_loss: 0.257
Epoch   39/50, time: 216.87 s, training_loss: 0.243
Epoch   39/50, time: 27.54 s, val_loss: 0.287
Epoch   40/50, time: 218.57 s, training_loss: 0.239
Epoch   40/50, time: 27.16 s, val_loss: 0.263
Epoch   49/50, time: 669.54 s, training_loss: 0.259
Epoch   49/50, time: 74.91 s, val_loss: 0.392
Epoch   41/50, time: 218.96 s, training_loss: 0.241
Epoch   41/50, time: 27.00 s, val_loss: 0.332
Training Metrics:
Accuracy: 0.9910
Precision: 0.7687
Recall: 0.6950
F1 Score: 0.7300
IoU: 0.5749
Dice Coefficient: 0.7300
Validation Metrics:
Accuracy: 0.9902
Precision: 0.7608
Recall: 0.6634
F1 Score: 0.7088
IoU: 0.5489
Dice Coefficient: 0.7088
Epoch   42/50, time: 216.68 s, training_loss: 0.238
Epoch   42/50, time: 28.75 s, val_loss: 0.265
Epoch   50/50, time: 667.59 s, training_loss: 0.259
Epoch   50/50, time: 73.69 s, val_loss: 0.381
Epoch   43/50, time: 224.28 s, training_loss: 0.236
Epoch   43/50, time: 27.55 s, val_loss: 0.479
Epoch   44/50, time: 223.37 s, training_loss: 0.237
Epoch   44/50, time: 27.86 s, val_loss: 0.244
Epoch   45/50, time: 215.86 s, training_loss: 0.234
Epoch   45/50, time: 28.97 s, val_loss: 0.261
Training Metrics:
Accuracy: 0.9899
Precision: 0.7231
Recall: 0.6870
F1 Score: 0.7046
IoU: 0.5439
Dice Coefficient: 0.7046
Validation Metrics:
Accuracy: 0.9889
Precision: 0.7074
Recall: 0.6522
F1 Score: 0.6787
IoU: 0.5136
Dice Coefficient: 0.6787
Epoch   46/50, time: 208.08 s, training_loss: 0.232
Epoch   46/50, time: 27.07 s, val_loss: 0.245
Test Metrics:
Accuracy: 0.9889
Precision: 0.7074
Recall: 0.6522
F1 Score: 0.6787
IoU: 0.5136
Dice Coefficient: 0.6787
