Trial 3 using GPU 3
Epoch    1/50, time: 66.95 s, training_loss: 0.907
Epoch    1/50, time: 67.02 s, training_loss: 0.935
Epoch    1/50, time: 11.74 s, val_loss: 0.898
Epoch    1/50, time: 78.69 s, training_loss: 0.899
Epoch    1/50, time: 11.99 s, val_loss: 0.913
Epoch    1/50, time: 14.16 s, val_loss: 0.899
Exception in trial 0: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)

wandb:
wandb: üöÄ View run trial_0_bs32_lr2e-05_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/xgtfu1hr
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141657-xgtfu1hr/logs
[I 2025-12-04 14:18:36,968] Trial 0 finished with value: 0.0 and parameters: {'batch_size': 32, 'lr': 1.6397782915211407e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 100, 'att_channels': 16}. Best is trial 0 with value: 0.0.
wandb: Finishing previous runs because reinit is set to True.
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 0
wandb:
wandb: üöÄ View run trial_1_bs64_lr1e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/7uvk0gn7
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141657-7uvk0gn7/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251204_141836-yryrhxqr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_4_bs128_lr4e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/yryrhxqr

Trial 4 using GPU 0
Exception in trial 1: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)

[I 2025-12-04 14:18:46,887] Trial 1 finished with value: 0.0 and parameters: {'batch_size': 64, 'lr': 0.00013433661551781796, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 1, 'in_channels': 100, 'att_channels': 32}. Best is trial 0 with value: 0.0.
wandb: Finishing previous runs because reinit is set to True.
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 1
wandb:
wandb: üöÄ View run trial_4_bs128_lr4e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/yryrhxqr
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141836-yryrhxqr/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251204_141846-kx9kiyv2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_5_bs16_lr1e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/kx9kiyv2

Trial 5 using GPU 2
Exception in trial 2: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)

wandb: uploading summary, console lines 105-121
wandb:
wandb: üöÄ View run trial_2_bs64_lr3e-05_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/oiba0xkh
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141657-oiba0xkh/logs
[I 2025-12-04 14:19:00,924] Trial 2 finished with value: 0.0 and parameters: {'batch_size': 64, 'lr': 3.209577698099054e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 3, 'in_channels': 100, 'att_channels': 16}. Best is trial 0 with value: 0.0.
wandb: Finishing previous runs because reinit is set to True.
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 2
wandb:
wandb: üöÄ View run trial_5_bs16_lr1e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/kx9kiyv2
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141846-kx9kiyv2/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251204_141900-vuvter2n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_6_bs16_lr3e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/vuvter2n

Trial 6 using GPU 1
Epoch    1/50, time: 64.35 s, training_loss: 0.879
Epoch    1/50, time: 53.80 s, training_loss: 0.845
Epoch    1/50, time: 14.02 s, val_loss: 0.887
Epoch    1/50, time: 181.15 s, training_loss: 0.937
Epoch    1/50, time: 12.41 s, val_loss: 0.801
Exception in trial 6: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)

wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 6
wandb:
wandb: üöÄ View run trial_6_bs16_lr3e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/vuvter2n
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_141900-vuvter2n/logs
[I 2025-12-04 14:20:17,846] Trial 6 finished with value: 0.0 and parameters: {'batch_size': 16, 'lr': 0.0002765346979505789, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 2, 'in_channels': 100, 'att_channels': 32}. Best is trial 0 with value: 0.0.
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251204_142017-dxbvs2z9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_7_bs16_lr6e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/dxbvs2z9

Trial 7 using GPU 1
Epoch    1/50, time: 32.76 s, val_loss: 0.956
Exception in trial 4: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)

[I 2025-12-04 14:20:48,357] Trial 4 finished with value: 0.0 and parameters: {'batch_size': 128, 'lr': 0.0003548389596699933, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 3, 'in_channels': 100, 'att_channels': 32}. Best is trial 0 with value: 0.0.
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading data
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 4
wandb:
wandb: üöÄ View run trial_7_bs16_lr6e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/dxbvs2z9
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251204_142017-dxbvs2z9/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251204_142048-sbp4yttn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_8_bs16_lr1e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Extended_TERS_data_0.1/runs/sbp4yttn

Trial 8 using GPU 0
Epoch    1/50, time: 160.22 s, training_loss: 0.872
Epoch    1/50, time: 33.72 s, val_loss: 0.810
Exception in trial 3: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 206, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 172, in compute_metrics
    outputs = torch.softmax(outputs)
              ^^^^^^^^^^^^^^^^^^^^^^
TypeError: softmax() received an invalid combination of arguments - got (Tensor), but expected one of:
 * (Tensor input, int dim, torch.dtype dtype = None, *, Tensor out = None)
 * (Tensor input, name dim, *, torch.dtype dtype = None)
