Trial 17 using GPU 1
Epoch    1/50, time: 858.67 s, training_loss: 0.861
Training Metrics:
Accuracy: 0.7431
Precision: 0.0634
Recall: 0.9454
F1 Score: 0.1188
IoU: 0.0631
Dice Coefficient: 0.1188
Validation Metrics:
Accuracy: 0.6621
Precision: 0.0476
Recall: 0.9717
F1 Score: 0.0907
IoU: 0.0475
Dice Coefficient: 0.0907
Epoch    1/50, time: 84.10 s, val_loss: 0.838
Epoch    2/50, time: 890.84 s, training_loss: 0.832
Epoch    2/50, time: 104.11 s, val_loss: 0.825
Training Metrics:
Accuracy: 0.8924
Precision: 0.1361
Recall: 0.9124
F1 Score: 0.2369
IoU: 0.1344
Dice Coefficient: 0.2369
Validation Metrics:
Accuracy: 0.8957
Precision: 0.1319
Recall: 0.8990
F1 Score: 0.2301
IoU: 0.1300
Dice Coefficient: 0.2301
Epoch    3/50, time: 820.68 s, training_loss: 0.808
Epoch    2/50, time: 772.06 s, training_loss: 0.819
Epoch    3/50, time: 87.78 s, val_loss: 0.786
Epoch    2/50, time: 97.38 s, val_loss: 0.797
Epoch    4/50, time: 795.60 s, training_loss: 0.766
Epoch    3/50, time: 750.37 s, training_loss: 0.793
Epoch    4/50, time: 73.12 s, val_loss: 0.804
Epoch    3/50, time: 72.79 s, val_loss: 0.777
Epoch    5/50, time: 656.85 s, training_loss: 0.703
Epoch    4/50, time: 644.66 s, training_loss: 0.752
Epoch    5/50, time: 75.60 s, val_loss: 0.710
Epoch    4/50, time: 76.48 s, val_loss: 0.871
Epoch    6/50, time: 665.59 s, training_loss: 0.629
Epoch    5/50, time: 664.49 s, training_loss: 0.688
Epoch    6/50, time: 74.56 s, val_loss: 0.621
Epoch    5/50, time: 80.01 s, val_loss: 0.619
Epoch    7/50, time: 641.17 s, training_loss: 0.570
Epoch    6/50, time: 645.08 s, training_loss: 0.625
Epoch    7/50, time: 78.27 s, val_loss: 0.639
Epoch    6/50, time: 78.30 s, val_loss: 0.547
Epoch    7/50, time: 767.65 s, training_loss: 0.561
Epoch    8/50, time: 808.47 s, training_loss: 0.536
Epoch    7/50, time: 76.50 s, val_loss: 0.501
Epoch    8/50, time: 76.87 s, val_loss: 0.566
Epoch    8/50, time: 690.65 s, training_loss: 0.515
Epoch    9/50, time: 685.60 s, training_loss: 0.502
Epoch    8/50, time: 83.49 s, val_loss: 0.438
Epoch    9/50, time: 76.20 s, val_loss: 0.487
Epoch    9/50, time: 691.91 s, training_loss: 0.480
Epoch   10/50, time: 698.42 s, training_loss: 0.481
Epoch    9/50, time: 80.67 s, val_loss: 0.412
Epoch   10/50, time: 76.45 s, val_loss: 0.482
Epoch   11/50, time: 634.54 s, training_loss: 0.456
Epoch   10/50, time: 648.27 s, training_loss: 0.446
Epoch   11/50, time: 71.35 s, val_loss: 0.479
Epoch   10/50, time: 71.70 s, val_loss: 0.393
Epoch   11/50, time: 689.56 s, training_loss: 0.420
Epoch   11/50, time: 135.01 s, val_loss: 0.378
Training Metrics:
Accuracy: 0.9180
Precision: 0.1463
Recall: 0.7191
F1 Score: 0.2431
IoU: 0.1384
Dice Coefficient: 0.2431
Validation Metrics:
Accuracy: 0.8722
Precision: 0.0936
Recall: 0.7334
F1 Score: 0.1659
IoU: 0.0905
Dice Coefficient: 0.1659
Epoch   12/50, time: 740.35 s, training_loss: 0.435
Epoch   12/50, time: 125.81 s, val_loss: 0.492
Training Metrics:
Accuracy: 0.9397
Precision: 0.2061
Recall: 0.8045
F1 Score: 0.3281
IoU: 0.1963
Dice Coefficient: 0.3281
Validation Metrics:
Accuracy: 0.9867
Precision: 0.5861
Recall: 0.7985
F1 Score: 0.6760
IoU: 0.5106
Dice Coefficient: 0.6760
Epoch   13/50, time: 727.82 s, training_loss: 0.432
Epoch   13/50, time: 77.08 s, val_loss: 0.416
Epoch   12/50, time: 651.47 s, training_loss: 0.400
Epoch   12/50, time: 77.24 s, val_loss: 0.376
Epoch   14/50, time: 653.03 s, training_loss: 0.399
Epoch   14/50, time: 78.89 s, val_loss: 0.396
Epoch   13/50, time: 644.28 s, training_loss: 0.390
Epoch   13/50, time: 75.92 s, val_loss: 0.340
Epoch   15/50, time: 647.47 s, training_loss: 0.390
Epoch   15/50, time: 75.83 s, val_loss: 0.376
Epoch   14/50, time: 646.44 s, training_loss: 0.375
Epoch   14/50, time: 76.72 s, val_loss: 0.348
Epoch   16/50, time: 651.50 s, training_loss: 0.386
Epoch   16/50, time: 77.96 s, val_loss: 0.370
Epoch   15/50, time: 655.81 s, training_loss: 0.361
Epoch   15/50, time: 74.37 s, val_loss: 0.332
Epoch   17/50, time: 647.87 s, training_loss: 0.363
Epoch   17/50, time: 75.16 s, val_loss: 0.409
Epoch   16/50, time: 647.74 s, training_loss: 0.346
Epoch   16/50, time: 76.62 s, val_loss: 0.326
Epoch   18/50, time: 647.41 s, training_loss: 0.361
Epoch   18/50, time: 78.96 s, val_loss: 0.421
Epoch   17/50, time: 641.81 s, training_loss: 0.344
Epoch   17/50, time: 78.14 s, val_loss: 0.332
Epoch   19/50, time: 651.26 s, training_loss: 0.347
Epoch   19/50, time: 76.07 s, val_loss: 0.340
Epoch   18/50, time: 655.99 s, training_loss: 0.334
Epoch   18/50, time: 76.17 s, val_loss: 0.315
Epoch   20/50, time: 640.28 s, training_loss: 0.335
Epoch   20/50, time: 73.95 s, val_loss: 0.366
Epoch   19/50, time: 645.85 s, training_loss: 0.319
Epoch   19/50, time: 76.47 s, val_loss: 0.340
Epoch   21/50, time: 650.13 s, training_loss: 0.322
Epoch   21/50, time: 83.65 s, val_loss: 0.321
Epoch   20/50, time: 646.89 s, training_loss: 0.303
Epoch   20/50, time: 74.91 s, val_loss: 0.309
Epoch   21/50, time: 759.49 s, training_loss: 0.289
Training Metrics:
Accuracy: 0.9800
Precision: 0.4714
Recall: 0.7479
F1 Score: 0.5783
IoU: 0.4068
Dice Coefficient: 0.5783
Validation Metrics:
Accuracy: 0.9840
Precision: 0.5273
Recall: 0.7540
F1 Score: 0.6206
IoU: 0.4499
Dice Coefficient: 0.6206
Epoch   21/50, time: 76.23 s, val_loss: 0.305
Epoch   22/50, time: 718.95 s, training_loss: 0.318
Epoch   22/50, time: 133.11 s, val_loss: 0.346
Training Metrics:
Accuracy: 0.9907
Precision: 0.7269
Recall: 0.7888
F1 Score: 0.7566
IoU: 0.6084
Dice Coefficient: 0.7566
Validation Metrics:
Accuracy: 0.9909
Precision: 0.7215
Recall: 0.7745
F1 Score: 0.7470
IoU: 0.5962
Dice Coefficient: 0.7470
Epoch   23/50, time: 697.61 s, training_loss: 0.305
Epoch   23/50, time: 75.41 s, val_loss: 0.312
Epoch   22/50, time: 660.99 s, training_loss: 0.285
Epoch   22/50, time: 77.51 s, val_loss: 0.295
Epoch   24/50, time: 653.79 s, training_loss: 0.290
Epoch   24/50, time: 74.34 s, val_loss: 0.318
Epoch   23/50, time: 640.88 s, training_loss: 0.278
Epoch   23/50, time: 75.12 s, val_loss: 0.292
Epoch   25/50, time: 641.97 s, training_loss: 0.285
Epoch   25/50, time: 76.55 s, val_loss: 0.295
Epoch   24/50, time: 636.10 s, training_loss: 0.272
Epoch   24/50, time: 76.92 s, val_loss: 0.300
Epoch   26/50, time: 632.35 s, training_loss: 0.280
Epoch   26/50, time: 74.92 s, val_loss: 0.292
Epoch   25/50, time: 630.21 s, training_loss: 0.264
Epoch   25/50, time: 75.31 s, val_loss: 0.290
Epoch   27/50, time: 629.13 s, training_loss: 0.275
Epoch   27/50, time: 72.98 s, val_loss: 0.298
Epoch   26/50, time: 636.59 s, training_loss: 0.262
Epoch   26/50, time: 73.11 s, val_loss: 0.284
Epoch   28/50, time: 628.92 s, training_loss: 0.271
Epoch   28/50, time: 74.58 s, val_loss: 0.300
Epoch   27/50, time: 635.99 s, training_loss: 0.256
Epoch   27/50, time: 75.56 s, val_loss: 0.292
Epoch   29/50, time: 653.61 s, training_loss: 0.272
Epoch   29/50, time: 82.26 s, val_loss: 0.287
Epoch   28/50, time: 634.93 s, training_loss: 0.256
Epoch   28/50, time: 77.04 s, val_loss: 0.302
Epoch   30/50, time: 635.71 s, training_loss: 0.264
Epoch   30/50, time: 75.33 s, val_loss: 0.289
Epoch   29/50, time: 639.73 s, training_loss: 0.253
Epoch   29/50, time: 74.34 s, val_loss: 0.274
Epoch   31/50, time: 638.33 s, training_loss: 0.260
Epoch   31/50, time: 75.90 s, val_loss: 0.277
Epoch   30/50, time: 642.02 s, training_loss: 0.252
Epoch   30/50, time: 75.81 s, val_loss: 0.277
Epoch   31/50, time: 696.07 s, training_loss: 0.246
Exception in trial 17: DataLoader worker (pid(s) 1082937, 1082945) exited unexpectedly
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1243, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl/scibuilder-spack/aalto-rhel9-prod/2024-01/software/linux-rhel9-haswell/gcc-12.3.0/python-3.11.6-nvttrbg/lib/python3.11/multiprocessing/queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 143, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 81, in train
    epoch_loss = self.evaluate()
                 ^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 129, in evaluate
    for i, batch in enumerate(self.validation_loader):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 1082937, 1082945) exited unexpectedly
