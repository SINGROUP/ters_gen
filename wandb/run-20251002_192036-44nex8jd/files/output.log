wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ‚ñÅ‚ñÅ
wandb:      trial ‚ñà‚ñÅ‚ñÖ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 5
wandb:
wandb: üöÄ View run trial_7_bs128_lr4e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/swcs2x49
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251002_192033-swcs2x49/logs
wandb: Tracking run with wandb version 0.20.1
wandb: Run data is saved locally in /home/sethih1/masque_new/ters_gen/wandb/run-20251002_192035-ihwwowhk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trial_8_bs32_lr8e-04_dice_loss
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: üöÄ View run at https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/ihwwowhk
Exception in trial 8: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 117, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 74, in train
    epoch_loss = self.train_epoch()
                 ^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 114, in train_epoch
    loss = self.loss_fn(outputs, tgt_image)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/losses/losses.py", line 70, in dice_loss
    intersection = (pred_flat * target_flat).sum(1)
                    ~~~~~~~~~~^~~~~~~~~~~~~
RuntimeError: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
wandb:
wandb:
wandb: Run history:
wandb: final_dice ‚ñÅ
wandb:      trial ‚ñÅ
wandb:
wandb: Run summary:
wandb: final_dice 0
wandb:      trial 8
wandb:
wandb: üöÄ View run trial_8_bs32_lr8e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/ihwwowhk
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251002_192035-ihwwowhk/logs
[I 2025-10-02 19:20:39,499] Trial 8 finished with value: 0.0 and parameters: {'batch_size': 32, 'lr': 0.0007629552916370454, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 2, 'in_channels': 100, 'att_channels': 64}. Best is trial 1 with value: 0.0.
wandb: Finishing previous runs because reinit is set to True.
Exception in trial 9: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 117, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 74, in train
    epoch_loss = self.train_epoch()
                 ^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 114, in train_epoch
    loss = self.loss_fn(outputs, tgt_image)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/losses/losses.py", line 70, in dice_loss
    intersection = (pred_flat * target_flat).sum(1)
                    ~~~~~~~~~~^~~~~~~~~~~~~
RuntimeError: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
[W 2025-10-02 19:20:39,792] Trial 9 failed with parameters: {'batch_size': 64, 'lr': 0.00021410638239009443, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 400, 'att_channels': 16} because of the following error: Error('You must call wandb.init() before wandb.log()').
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 171, in <lambda>
    lambda t: objective(t, config, gpu_queue, args.use_wandb),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 132, in objective
    wandb.log({"final_dice": final_dice, "trial": trial.number})
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.errors.Error: You must call wandb.init() before wandb.log()
[W 2025-10-02 19:20:39,794] Trial 9 failed with value None.
Exception in trial 7: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 117, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 74, in train
    epoch_loss = self.train_epoch()
                 ^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 114, in train_epoch
    loss = self.loss_fn(outputs, tgt_image)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/losses/losses.py", line 70, in dice_loss
    intersection = (pred_flat * target_flat).sum(1)
                    ~~~~~~~~~~^~~~~~~~~~~~~
RuntimeError: The size of tensor a (1024) must match the size of tensor b (65536) at non-singleton dimension 1
[W 2025-10-02 19:20:39,995] Trial 7 failed with parameters: {'batch_size': 128, 'lr': 0.0003536864041628328, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 400, 'att_channels': 32} because of the following error: Error('You must call wandb.init() before wandb.log()').
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 171, in <lambda>
    lambda t: objective(t, config, gpu_queue, args.use_wandb),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 132, in objective
    wandb.log({"final_dice": final_dice, "trial": trial.number})
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/wandb/sdk/lib/preinit.py", line 36, in preinit_wrapper
    raise wandb.Error(f"You must call wandb.init() before {name}()")
wandb.errors.errors.Error: You must call wandb.init() before wandb.log()
[W 2025-10-02 19:20:39,995] Trial 7 failed with value None.
wandb:
wandb: üöÄ View run trial_9_bs64_lr2e-04_dice_loss at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32/runs/mo8tby52
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/sethih10-epfl/Posnet_50epochs_just_aug_val_32x32
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251002_192035-mo8tby52/logs
