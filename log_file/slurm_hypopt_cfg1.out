[I 2025-06-08 22:56:26,921] A new study created in memory with name: no-name-bdfcaa63-0e6b-40bb-9e0c-87956c79cd07
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
======= Loaded Configuration =======
data:
  circle_radius: 5
  split_by_id: 0
  train_path: /scratch/phys/sin/sethih1/data_files/all_group_plane_fchk_split_images/train
  val_path: /scratch/phys/sin/sethih1/data_files/all_group_plane_fchk_split_images/val
log_path: /scratch/phys/sin/sethih1/runs_ters/all_group_plane_fchk_split_images/hyperopt/config1/
model:
  att_channels: 32
  filters:
  - 16
  - 32
  - 64
  - 128
  in_channels: 400
  kernel_size:
  - 3
  - 3
  - 3
  - 3
  out_channels: 1
  type: AttentionUNet
save_path: /scratch/phys/sin/sethih1/models/all_group_plane_fchk_split_images/hyperopt/config1/
training:
  batch_sizes:
  - 16
  - 32
  - 64
  - 128
  epochs: 50
  learning_rates:
  - 0.0001
  - 0.001
  loss_functions:
  - bce_loss
  - dice_loss
  n_jobs: 1
  n_trials: 30

====================================
[Trial 0] Trying batch_size=128, lr=0.000946585916168518, loss_fn=bce_loss
Epoch    1/50, time: 111.01 s, training_loss: 0.473
Epoch    1/50, time: 153.53 s, val_loss: 0.551
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 84.80 s, training_loss: 0.310
Epoch    2/50, time: 121.38 s, val_loss: 0.376
Epoch    3/50, time: 85.46 s, training_loss: 0.245
Epoch    3/50, time: 122.46 s, val_loss: 0.275
Epoch    4/50, time: 86.04 s, training_loss: 0.217
Epoch    4/50, time: 123.01 s, val_loss: 0.231
Epoch    5/50, time: 84.88 s, training_loss: 0.198
Epoch    5/50, time: 121.44 s, val_loss: 0.201
Epoch    6/50, time: 85.37 s, training_loss: 0.181
Epoch    6/50, time: 122.28 s, val_loss: 0.186
Epoch    7/50, time: 85.50 s, training_loss: 0.168
Epoch    7/50, time: 122.11 s, val_loss: 0.171
Epoch    8/50, time: 85.15 s, training_loss: 0.157
Epoch    8/50, time: 122.69 s, val_loss: 0.153
Epoch    9/50, time: 84.95 s, training_loss: 0.147
Epoch    9/50, time: 122.44 s, val_loss: 0.141
Epoch   10/50, time: 86.26 s, training_loss: 0.138
Epoch   10/50, time: 123.91 s, val_loss: 0.133
Epoch   11/50, time: 85.60 s, training_loss: 0.130
Epoch   11/50, time: 122.46 s, val_loss: 0.125
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.3184
Recall: 0.0005
F1 Score: 0.0011
IoU: 0.0005
Dice Coefficient: 0.0011
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   12/50, time: 85.78 s, training_loss: 0.122
Epoch   12/50, time: 123.19 s, val_loss: 0.120
Epoch   13/50, time: 85.89 s, training_loss: 0.116
Epoch   13/50, time: 123.07 s, val_loss: 0.114
Epoch   14/50, time: 85.71 s, training_loss: 0.111
Epoch   14/50, time: 122.89 s, val_loss: 0.109
Epoch   15/50, time: 85.49 s, training_loss: 0.105
Epoch   15/50, time: 122.38 s, val_loss: 0.104
Epoch   16/50, time: 85.47 s, training_loss: 0.101
Epoch   16/50, time: 122.72 s, val_loss: 0.099
Epoch   17/50, time: 86.45 s, training_loss: 0.097
Epoch   17/50, time: 124.17 s, val_loss: 0.095
Epoch   18/50, time: 87.04 s, training_loss: 0.093
Epoch   18/50, time: 124.17 s, val_loss: 0.091
Epoch   19/50, time: 85.07 s, training_loss: 0.090
Epoch   19/50, time: 122.41 s, val_loss: 0.088
Epoch   20/50, time: 85.26 s, training_loss: 0.087
Epoch   20/50, time: 122.55 s, val_loss: 0.088
Epoch   21/50, time: 86.01 s, training_loss: 0.084
Epoch   21/50, time: 122.79 s, val_loss: 0.083
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   22/50, time: 84.26 s, training_loss: 0.082
Epoch   22/50, time: 121.59 s, val_loss: 0.089
Epoch   23/50, time: 85.49 s, training_loss: 0.081
Epoch   23/50, time: 122.49 s, val_loss: 0.080
Epoch   24/50, time: 85.17 s, training_loss: 0.078
Epoch   24/50, time: 122.26 s, val_loss: 0.077
Epoch   25/50, time: 86.39 s, training_loss: 0.076
Epoch   25/50, time: 123.62 s, val_loss: 0.077
Epoch   26/50, time: 84.66 s, training_loss: 0.074
Epoch   26/50, time: 121.45 s, val_loss: 0.076
Epoch   27/50, time: 86.00 s, training_loss: 0.072
Epoch   27/50, time: 123.27 s, val_loss: 0.080
Epoch   28/50, time: 91.13 s, training_loss: 0.071
Epoch   28/50, time: 128.90 s, val_loss: 0.072
Epoch   29/50, time: 85.32 s, training_loss: 0.069
Epoch   29/50, time: 122.75 s, val_loss: 0.070
Epoch   30/50, time: 85.93 s, training_loss: 0.068
Epoch   30/50, time: 123.41 s, val_loss: 0.079
Epoch   31/50, time: 85.64 s, training_loss: 0.071
Epoch   31/50, time: 123.09 s, val_loss: 0.101
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   32/50, time: 85.57 s, training_loss: 0.070
Epoch   32/50, time: 123.38 s, val_loss: 0.073
Epoch   33/50, time: 85.66 s, training_loss: 0.068
Epoch   33/50, time: 123.11 s, val_loss: 0.073
Epoch   34/50, time: 86.05 s, training_loss: 0.067
Epoch   34/50, time: 123.15 s, val_loss: 0.068
Epoch   35/50, time: 86.93 s, training_loss: 0.065
Epoch   35/50, time: 123.69 s, val_loss: 0.067
Epoch   36/50, time: 84.34 s, training_loss: 0.063
Epoch   36/50, time: 121.27 s, val_loss: 0.065
Epoch   37/50, time: 85.55 s, training_loss: 0.062
Epoch   37/50, time: 123.23 s, val_loss: 0.064
Epoch   38/50, time: 85.51 s, training_loss: 0.061
Epoch   38/50, time: 123.42 s, val_loss: 0.063
Epoch   39/50, time: 86.64 s, training_loss: 0.060
Epoch   39/50, time: 124.31 s, val_loss: 0.062
Epoch   40/50, time: 86.57 s, training_loss: 0.060
Epoch   40/50, time: 123.28 s, val_loss: 0.061
Epoch   41/50, time: 85.42 s, training_loss: 0.059
Epoch   41/50, time: 122.26 s, val_loss: 0.060
Training Metrics:
Accuracy: 0.9805
Precision: 0.5959
Recall: 0.0011
F1 Score: 0.0023
IoU: 0.0011
Dice Coefficient: 0.0023
Validation Metrics:
Accuracy: 0.9804
Precision: 0.4895
Recall: 0.0009
F1 Score: 0.0018
IoU: 0.0009
Dice Coefficient: 0.0018
Epoch   42/50, time: 86.01 s, training_loss: 0.057
Epoch   42/50, time: 123.62 s, val_loss: 0.062
Epoch   43/50, time: 84.94 s, training_loss: 0.057
Epoch   43/50, time: 121.87 s, val_loss: 0.062
Epoch   44/50, time: 85.61 s, training_loss: 0.056
Epoch   44/50, time: 122.75 s, val_loss: 0.058
Epoch   45/50, time: 86.67 s, training_loss: 0.055
Epoch   45/50, time: 123.56 s, val_loss: 0.058
Epoch   46/50, time: 85.82 s, training_loss: 0.054
Epoch   46/50, time: 123.18 s, val_loss: 0.057
Epoch   47/50, time: 85.34 s, training_loss: 0.054
Epoch   47/50, time: 122.27 s, val_loss: 0.058
Epoch   48/50, time: 85.64 s, training_loss: 0.053
Epoch   48/50, time: 123.22 s, val_loss: 0.059
Epoch   49/50, time: 85.82 s, training_loss: 0.052
Epoch   49/50, time: 122.34 s, val_loss: 0.057
Epoch   50/50, time: 87.04 s, training_loss: 0.051
Epoch   50/50, time: 124.61 s, val_loss: 0.055
Training Metrics:
Accuracy: 0.9808
Precision: 0.6766
Recall: 0.0227
F1 Score: 0.0440
IoU: 0.0225
Dice Coefficient: 0.0440
Validation Metrics:
Accuracy: 0.9805
Precision: 0.5822
Recall: 0.0221
F1 Score: 0.0425
IoU: 0.0217
Dice Coefficient: 0.0425
[I 2025-06-09 00:56:12,775] Trial 0 finished with value: 0.042528090531114345 and parameters: {'batch_size': 128, 'lr': 0.000946585916168518, 'loss_fn': 'bce_loss'}. Best is trial 0 with value: 0.042528090531114345.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9805
Precision: 0.5822
Recall: 0.0221
F1 Score: 0.0425
IoU: 0.0217
Dice Coefficient: 0.0425
[Trial 0] Finished with val_loss=inf
[Trial 0] Finished with dice_coeff=0.042528090531114345
[Trial 1] Trying batch_size=32, lr=0.00034444273735569444, loss_fn=dice_loss
Epoch    1/50, time: 75.03 s, training_loss: 0.901
Epoch    1/50, time: 112.30 s, val_loss: 0.893
Training Metrics:
Accuracy: 0.9268
Precision: 0.1524
Recall: 0.6053
F1 Score: 0.2435
IoU: 0.1386
Dice Coefficient: 0.2435
Validation Metrics:
Accuracy: 0.9288
Precision: 0.1558
Recall: 0.5960
F1 Score: 0.2470
IoU: 0.1409
Dice Coefficient: 0.2470
Epoch    2/50, time: 71.47 s, training_loss: 0.872
Epoch    2/50, time: 108.34 s, val_loss: 0.858
Epoch    3/50, time: 76.18 s, training_loss: 0.854
Epoch    3/50, time: 113.52 s, val_loss: 0.850
Epoch    4/50, time: 73.92 s, training_loss: 0.837
Epoch    4/50, time: 110.82 s, val_loss: 0.832
Epoch    5/50, time: 75.56 s, training_loss: 0.820
Epoch    5/50, time: 114.03 s, val_loss: 0.812
Epoch    6/50, time: 76.39 s, training_loss: 0.804
Epoch    6/50, time: 113.96 s, val_loss: 0.797
Epoch    7/50, time: 76.66 s, training_loss: 0.788
Epoch    7/50, time: 113.84 s, val_loss: 0.780
Epoch    8/50, time: 76.29 s, training_loss: 0.770
Epoch    8/50, time: 113.65 s, val_loss: 0.760
Epoch    9/50, time: 77.22 s, training_loss: 0.750
Epoch    9/50, time: 114.67 s, val_loss: 0.743
Epoch   10/50, time: 77.69 s, training_loss: 0.728
Epoch   10/50, time: 115.19 s, val_loss: 0.724
Epoch   11/50, time: 75.34 s, training_loss: 0.707
Epoch   11/50, time: 112.92 s, val_loss: 0.704
Training Metrics:
Accuracy: 0.9381
Precision: 0.2242
Recall: 0.8857
F1 Score: 0.3578
IoU: 0.2179
Dice Coefficient: 0.3578
Validation Metrics:
Accuracy: 0.9372
Precision: 0.2191
Recall: 0.8602
F1 Score: 0.3492
IoU: 0.2115
Dice Coefficient: 0.3492
Epoch   12/50, time: 74.38 s, training_loss: 0.685
Epoch   12/50, time: 109.98 s, val_loss: 0.689
Epoch   13/50, time: 74.09 s, training_loss: 0.655
Epoch   13/50, time: 111.32 s, val_loss: 0.687
Epoch   14/50, time: 74.36 s, training_loss: 0.626
Epoch   14/50, time: 111.75 s, val_loss: 0.638
Epoch   15/50, time: 75.05 s, training_loss: 0.591
Epoch   15/50, time: 112.75 s, val_loss: 0.613
Epoch   16/50, time: 76.00 s, training_loss: 0.563
Epoch   16/50, time: 113.40 s, val_loss: 0.599
Epoch   17/50, time: 77.69 s, training_loss: 0.530
Epoch   17/50, time: 115.56 s, val_loss: 0.625
Epoch   18/50, time: 76.83 s, training_loss: 0.504
Epoch   18/50, time: 114.07 s, val_loss: 0.564
Epoch   19/50, time: 79.07 s, training_loss: 0.471
Epoch   19/50, time: 116.72 s, val_loss: 0.568
Epoch   20/50, time: 76.19 s, training_loss: 0.443
Epoch   20/50, time: 113.82 s, val_loss: 0.551
Epoch   21/50, time: 74.34 s, training_loss: 0.412
Epoch   21/50, time: 111.96 s, val_loss: 0.533
Training Metrics:
Accuracy: 0.9836
Precision: 0.5599
Recall: 0.7312
F1 Score: 0.6342
IoU: 0.4643
Dice Coefficient: 0.6342
Validation Metrics:
Accuracy: 0.9776
Precision: 0.4449
Recall: 0.5800
F1 Score: 0.5036
IoU: 0.3365
Dice Coefficient: 0.5036
Epoch   22/50, time: 72.77 s, training_loss: 0.388
Epoch   22/50, time: 110.29 s, val_loss: 0.541
Epoch   23/50, time: 78.37 s, training_loss: 0.365
Epoch   23/50, time: 115.92 s, val_loss: 0.534
Epoch   24/50, time: 73.82 s, training_loss: 0.345
Epoch   24/50, time: 111.35 s, val_loss: 0.513
Epoch   25/50, time: 75.41 s, training_loss: 0.324
Epoch   25/50, time: 112.58 s, val_loss: 0.501
Epoch   26/50, time: 81.77 s, training_loss: 0.311
Epoch   26/50, time: 119.17 s, val_loss: 0.520
Epoch   27/50, time: 74.63 s, training_loss: 0.295
Epoch   27/50, time: 112.02 s, val_loss: 0.503
Epoch   28/50, time: 75.23 s, training_loss: 0.282
Epoch   28/50, time: 113.07 s, val_loss: 0.491
Epoch   29/50, time: 75.62 s, training_loss: 0.272
Epoch   29/50, time: 112.99 s, val_loss: 0.506
Epoch   30/50, time: 74.65 s, training_loss: 0.255
Epoch   30/50, time: 111.57 s, val_loss: 0.516
Epoch   31/50, time: 74.37 s, training_loss: 0.239
Epoch   31/50, time: 112.19 s, val_loss: 0.493
Training Metrics:
Accuracy: 0.9911
Precision: 0.7576
Recall: 0.8007
F1 Score: 0.7786
IoU: 0.6375
Dice Coefficient: 0.7786
Validation Metrics:
Accuracy: 0.9813
Precision: 0.5214
Recall: 0.5387
F1 Score: 0.5299
IoU: 0.3605
Dice Coefficient: 0.5299
Epoch   32/50, time: 71.07 s, training_loss: 0.236
Epoch   32/50, time: 108.49 s, val_loss: 0.495
Epoch   33/50, time: 77.23 s, training_loss: 0.227
Epoch   33/50, time: 114.52 s, val_loss: 0.505
Epoch   34/50, time: 75.42 s, training_loss: 0.217
Epoch   34/50, time: 112.78 s, val_loss: 0.497
Epoch   35/50, time: 76.06 s, training_loss: 0.220
Epoch   35/50, time: 112.84 s, val_loss: 0.493
Epoch   36/50, time: 75.44 s, training_loss: 0.215
Epoch   36/50, time: 113.30 s, val_loss: 0.492
Epoch   37/50, time: 76.83 s, training_loss: 0.201
Epoch   37/50, time: 114.22 s, val_loss: 0.481
Epoch   38/50, time: 75.32 s, training_loss: 0.197
Epoch   38/50, time: 112.85 s, val_loss: 0.484
Epoch   39/50, time: 75.84 s, training_loss: 0.184
Epoch   39/50, time: 112.70 s, val_loss: 0.487
Epoch   40/50, time: 76.23 s, training_loss: 0.187
Epoch   40/50, time: 113.56 s, val_loss: 0.487
Epoch   41/50, time: 75.57 s, training_loss: 0.179
Epoch   41/50, time: 112.74 s, val_loss: 0.477
Training Metrics:
Accuracy: 0.9930
Precision: 0.7941
Recall: 0.8667
F1 Score: 0.8288
IoU: 0.7077
Dice Coefficient: 0.8288
Validation Metrics:
Accuracy: 0.9812
Precision: 0.5197
Recall: 0.5578
F1 Score: 0.5381
IoU: 0.3681
Dice Coefficient: 0.5381
Epoch   42/50, time: 74.57 s, training_loss: 0.181
Epoch   42/50, time: 111.77 s, val_loss: 0.490
Epoch   43/50, time: 74.69 s, training_loss: 0.180
Epoch   43/50, time: 111.50 s, val_loss: 0.490
Epoch   44/50, time: 74.76 s, training_loss: 0.173
Epoch   44/50, time: 111.66 s, val_loss: 0.479
Epoch   45/50, time: 75.10 s, training_loss: 0.166
Epoch   45/50, time: 112.86 s, val_loss: 0.489
Epoch   46/50, time: 76.95 s, training_loss: 0.167
Epoch   46/50, time: 114.85 s, val_loss: 0.475
Epoch   47/50, time: 75.77 s, training_loss: 0.162
Epoch   47/50, time: 112.65 s, val_loss: 0.483
Epoch   48/50, time: 76.29 s, training_loss: 0.164
Epoch   48/50, time: 114.05 s, val_loss: 0.480
Epoch   49/50, time: 75.67 s, training_loss: 0.161
Epoch   49/50, time: 112.92 s, val_loss: 0.473
Epoch   50/50, time: 75.56 s, training_loss: 0.155
Epoch   50/50, time: 113.16 s, val_loss: 0.473
Training Metrics:
Accuracy: 0.9945
Precision: 0.8489
Recall: 0.8700
F1 Score: 0.8593
IoU: 0.7534
Dice Coefficient: 0.8593
Validation Metrics:
Accuracy: 0.9823
Precision: 0.5492
Recall: 0.5374
F1 Score: 0.5433
IoU: 0.3729
Dice Coefficient: 0.5433
[I 2025-06-09 02:44:30,183] Trial 1 finished with value: 0.5432756004866984 and parameters: {'batch_size': 32, 'lr': 0.00034444273735569444, 'loss_fn': 'dice_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9823
Precision: 0.5492
Recall: 0.5374
F1 Score: 0.5433
IoU: 0.3729
Dice Coefficient: 0.5433
[Trial 1] Finished with val_loss=inf
[Trial 1] Finished with dice_coeff=0.5432756004866984
[Trial 2] Trying batch_size=32, lr=0.0005346506723695582, loss_fn=dice_loss
Epoch    1/50, time: 71.94 s, training_loss: 0.907
Epoch    1/50, time: 109.07 s, val_loss: 0.904
Training Metrics:
Accuracy: 0.9282
Precision: 0.1558
Recall: 0.6086
F1 Score: 0.2481
IoU: 0.1416
Dice Coefficient: 0.2481
Validation Metrics:
Accuracy: 0.9305
Precision: 0.1581
Recall: 0.5893
F1 Score: 0.2493
IoU: 0.1424
Dice Coefficient: 0.2493
Epoch    2/50, time: 73.85 s, training_loss: 0.874
Epoch    2/50, time: 109.55 s, val_loss: 0.868
Epoch    3/50, time: 74.90 s, training_loss: 0.847
Epoch    3/50, time: 113.10 s, val_loss: 0.835
Epoch    4/50, time: 77.27 s, training_loss: 0.820
Epoch    4/50, time: 115.17 s, val_loss: 0.807
Epoch    5/50, time: 75.68 s, training_loss: 0.790
Epoch    5/50, time: 113.67 s, val_loss: 0.776
Epoch    6/50, time: 75.49 s, training_loss: 0.767
Epoch    6/50, time: 113.10 s, val_loss: 0.764
Epoch    7/50, time: 76.80 s, training_loss: 0.747
Epoch    7/50, time: 114.58 s, val_loss: 0.763
Epoch    8/50, time: 74.37 s, training_loss: 0.721
Epoch    8/50, time: 112.52 s, val_loss: 0.719
Epoch    9/50, time: 76.37 s, training_loss: 0.698
Epoch    9/50, time: 113.67 s, val_loss: 0.711
Epoch   10/50, time: 74.52 s, training_loss: 0.667
Epoch   10/50, time: 112.24 s, val_loss: 0.673
Epoch   11/50, time: 76.06 s, training_loss: 0.630
Epoch   11/50, time: 113.17 s, val_loss: 0.640
Training Metrics:
Accuracy: 0.9608
Precision: 0.2978
Recall: 0.7455
F1 Score: 0.4256
IoU: 0.2703
Dice Coefficient: 0.4256
Validation Metrics:
Accuracy: 0.9590
Precision: 0.2813
Recall: 0.7019
F1 Score: 0.4016
IoU: 0.2513
Dice Coefficient: 0.4016
Epoch   12/50, time: 70.40 s, training_loss: 0.600
Epoch   12/50, time: 105.53 s, val_loss: 0.636
Epoch   13/50, time: 73.29 s, training_loss: 0.570
Epoch   13/50, time: 110.54 s, val_loss: 0.626
Epoch   14/50, time: 79.63 s, training_loss: 0.547
Epoch   14/50, time: 118.19 s, val_loss: 0.583
Epoch   15/50, time: 76.13 s, training_loss: 0.517
Epoch   15/50, time: 113.43 s, val_loss: 0.623
Epoch   16/50, time: 77.51 s, training_loss: 0.491
Epoch   16/50, time: 114.84 s, val_loss: 0.563
Epoch   17/50, time: 75.00 s, training_loss: 0.476
Epoch   17/50, time: 112.78 s, val_loss: 0.595
Epoch   18/50, time: 76.66 s, training_loss: 0.446
Epoch   18/50, time: 115.37 s, val_loss: 0.551
Epoch   19/50, time: 77.69 s, training_loss: 0.425
Epoch   19/50, time: 114.80 s, val_loss: 0.537
Epoch   20/50, time: 75.77 s, training_loss: 0.400
Epoch   20/50, time: 113.74 s, val_loss: 0.512
Epoch   21/50, time: 76.38 s, training_loss: 0.372
Epoch   21/50, time: 113.78 s, val_loss: 0.517
Training Metrics:
Accuracy: 0.9832
Precision: 0.5516
Recall: 0.7436
F1 Score: 0.6334
IoU: 0.4634
Dice Coefficient: 0.6334
Validation Metrics:
Accuracy: 0.9770
Precision: 0.4352
Recall: 0.5873
F1 Score: 0.4999
IoU: 0.3333
Dice Coefficient: 0.4999
Epoch   22/50, time: 71.03 s, training_loss: 0.361
Epoch   22/50, time: 108.62 s, val_loss: 0.519
Epoch   23/50, time: 75.07 s, training_loss: 0.338
Epoch   23/50, time: 113.03 s, val_loss: 0.501
Epoch   24/50, time: 75.31 s, training_loss: 0.321
Epoch   24/50, time: 113.09 s, val_loss: 0.498
Epoch   25/50, time: 82.28 s, training_loss: 0.305
Epoch   25/50, time: 119.50 s, val_loss: 0.505
Epoch   26/50, time: 77.23 s, training_loss: 0.296
Epoch   26/50, time: 114.27 s, val_loss: 0.487
Epoch   27/50, time: 76.64 s, training_loss: 0.285
Epoch   27/50, time: 114.43 s, val_loss: 0.500
Epoch   28/50, time: 75.87 s, training_loss: 0.275
Epoch   28/50, time: 112.86 s, val_loss: 0.514
Epoch   29/50, time: 74.76 s, training_loss: 0.273
Epoch   29/50, time: 112.26 s, val_loss: 0.491
Epoch   30/50, time: 80.00 s, training_loss: 0.257
Epoch   30/50, time: 117.05 s, val_loss: 0.477
Epoch   31/50, time: 78.04 s, training_loss: 0.243
Epoch   31/50, time: 115.95 s, val_loss: 0.490
Training Metrics:
Accuracy: 0.9909
Precision: 0.7595
Recall: 0.7770
F1 Score: 0.7681
IoU: 0.6236
Dice Coefficient: 0.7681
Validation Metrics:
Accuracy: 0.9814
Precision: 0.5266
Recall: 0.5224
F1 Score: 0.5245
IoU: 0.3555
Dice Coefficient: 0.5245
Epoch   32/50, time: 77.44 s, training_loss: 0.238
Epoch   32/50, time: 114.62 s, val_loss: 0.481
Epoch   33/50, time: 75.53 s, training_loss: 0.230
Epoch   33/50, time: 113.24 s, val_loss: 0.489
Epoch   34/50, time: 76.43 s, training_loss: 0.223
Epoch   34/50, time: 114.32 s, val_loss: 0.476
Epoch   35/50, time: 78.06 s, training_loss: 0.218
Epoch   35/50, time: 115.60 s, val_loss: 0.486
Epoch   36/50, time: 76.84 s, training_loss: 0.210
Epoch   36/50, time: 114.38 s, val_loss: 0.483
Epoch   37/50, time: 75.67 s, training_loss: 0.210
Epoch   37/50, time: 113.75 s, val_loss: 0.483
Epoch   38/50, time: 74.15 s, training_loss: 0.201
Epoch   38/50, time: 112.04 s, val_loss: 0.472
Epoch   39/50, time: 77.73 s, training_loss: 0.191
Epoch   39/50, time: 115.68 s, val_loss: 0.468
Epoch   40/50, time: 75.33 s, training_loss: 0.187
Epoch   40/50, time: 113.25 s, val_loss: 0.475
Epoch   41/50, time: 78.37 s, training_loss: 0.187
Epoch   41/50, time: 115.50 s, val_loss: 0.470
Training Metrics:
Accuracy: 0.9930
Precision: 0.7988
Recall: 0.8561
F1 Score: 0.8265
IoU: 0.7042
Dice Coefficient: 0.8265
Validation Metrics:
Accuracy: 0.9814
Precision: 0.5232
Recall: 0.5530
F1 Score: 0.5377
IoU: 0.3677
Dice Coefficient: 0.5377
Epoch   42/50, time: 75.24 s, training_loss: 0.182
Epoch   42/50, time: 112.91 s, val_loss: 0.472
Epoch   43/50, time: 75.27 s, training_loss: 0.176
Epoch   43/50, time: 112.97 s, val_loss: 0.476
Epoch   44/50, time: 77.14 s, training_loss: 0.175
Epoch   44/50, time: 114.88 s, val_loss: 0.471
Epoch   45/50, time: 76.05 s, training_loss: 0.171
Epoch   45/50, time: 113.72 s, val_loss: 0.468
Epoch   46/50, time: 75.31 s, training_loss: 0.169
Epoch   46/50, time: 112.43 s, val_loss: 0.476
Epoch   47/50, time: 78.11 s, training_loss: 0.164
Epoch   47/50, time: 116.43 s, val_loss: 0.469
Epoch   48/50, time: 73.80 s, training_loss: 0.164
Epoch   48/50, time: 111.39 s, val_loss: 0.477
Epoch   49/50, time: 74.35 s, training_loss: 0.158
Epoch   49/50, time: 111.68 s, val_loss: 0.465
Epoch   50/50, time: 75.99 s, training_loss: 0.154
Epoch   50/50, time: 114.13 s, val_loss: 0.482
Training Metrics:
Accuracy: 0.9944
Precision: 0.8666
Recall: 0.8407
F1 Score: 0.8534
IoU: 0.7443
Dice Coefficient: 0.8534
Validation Metrics:
Accuracy: 0.9826
Precision: 0.5612
Recall: 0.5114
F1 Score: 0.5351
IoU: 0.3653
Dice Coefficient: 0.5351
[I 2025-06-09 04:33:14,818] Trial 2 finished with value: 0.5351432880844645 and parameters: {'batch_size': 32, 'lr': 0.0005346506723695582, 'loss_fn': 'dice_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9826
Precision: 0.5612
Recall: 0.5114
F1 Score: 0.5351
IoU: 0.3653
Dice Coefficient: 0.5351
[Trial 2] Finished with val_loss=inf
[Trial 2] Finished with dice_coeff=0.5351432880844645
[Trial 3] Trying batch_size=64, lr=0.00037017383139387725, loss_fn=dice_loss
Epoch    1/50, time: 72.85 s, training_loss: 0.912
Epoch    1/50, time: 110.57 s, val_loss: 0.955
Training Metrics:
Accuracy: 0.9802
Precision: 0.1325
Recall: 0.0028
F1 Score: 0.0054
IoU: 0.0027
Dice Coefficient: 0.0054
Validation Metrics:
Accuracy: 0.9801
Precision: 0.1185
Recall: 0.0024
F1 Score: 0.0047
IoU: 0.0024
Dice Coefficient: 0.0047
Epoch    2/50, time: 75.64 s, training_loss: 0.881
Epoch    2/50, time: 113.00 s, val_loss: 0.919
Epoch    3/50, time: 77.35 s, training_loss: 0.865
Epoch    3/50, time: 114.98 s, val_loss: 0.867
Epoch    4/50, time: 76.94 s, training_loss: 0.853
Epoch    4/50, time: 114.17 s, val_loss: 0.851
Epoch    5/50, time: 81.12 s, training_loss: 0.841
Epoch    5/50, time: 118.82 s, val_loss: 0.849
Epoch    6/50, time: 77.01 s, training_loss: 0.831
Epoch    6/50, time: 115.01 s, val_loss: 0.831
Epoch    7/50, time: 76.26 s, training_loss: 0.820
Epoch    7/50, time: 113.98 s, val_loss: 0.821
Epoch    8/50, time: 75.80 s, training_loss: 0.810
Epoch    8/50, time: 113.58 s, val_loss: 0.809
Epoch    9/50, time: 76.36 s, training_loss: 0.800
Epoch    9/50, time: 114.09 s, val_loss: 0.795
Epoch   10/50, time: 79.43 s, training_loss: 0.790
Epoch   10/50, time: 117.07 s, val_loss: 0.785
Epoch   11/50, time: 76.71 s, training_loss: 0.782
Epoch   11/50, time: 113.83 s, val_loss: 0.785
Training Metrics:
Accuracy: 0.9155
Precision: 0.1780
Recall: 0.9227
F1 Score: 0.2984
IoU: 0.1753
Dice Coefficient: 0.2984
Validation Metrics:
Accuracy: 0.9151
Precision: 0.1760
Recall: 0.9054
F1 Score: 0.2947
IoU: 0.1728
Dice Coefficient: 0.2947
Epoch   12/50, time: 76.17 s, training_loss: 0.767
Epoch   12/50, time: 114.01 s, val_loss: 0.775
Epoch   13/50, time: 76.91 s, training_loss: 0.755
Epoch   13/50, time: 114.74 s, val_loss: 0.754
Epoch   14/50, time: 76.94 s, training_loss: 0.746
Epoch   14/50, time: 114.69 s, val_loss: 0.742
Epoch   15/50, time: 75.96 s, training_loss: 0.731
Epoch   15/50, time: 113.63 s, val_loss: 0.740
Epoch   16/50, time: 76.44 s, training_loss: 0.713
Epoch   16/50, time: 113.41 s, val_loss: 0.719
Epoch   17/50, time: 76.07 s, training_loss: 0.694
Epoch   17/50, time: 113.03 s, val_loss: 0.722
Epoch   18/50, time: 75.94 s, training_loss: 0.684
Epoch   18/50, time: 112.94 s, val_loss: 0.722
Epoch   19/50, time: 79.75 s, training_loss: 0.671
Epoch   19/50, time: 117.02 s, val_loss: 0.695
Epoch   20/50, time: 76.92 s, training_loss: 0.639
Epoch   20/50, time: 114.43 s, val_loss: 0.652
Epoch   21/50, time: 76.13 s, training_loss: 0.615
Epoch   21/50, time: 113.40 s, val_loss: 0.657
Training Metrics:
Accuracy: 0.9617
Precision: 0.3057
Recall: 0.7623
F1 Score: 0.4364
IoU: 0.2791
Dice Coefficient: 0.4364
Validation Metrics:
Accuracy: 0.9621
Precision: 0.2942
Recall: 0.6686
F1 Score: 0.4086
IoU: 0.2568
Dice Coefficient: 0.4086
Epoch   22/50, time: 73.30 s, training_loss: 0.594
Epoch   22/50, time: 111.08 s, val_loss: 0.638
Epoch   23/50, time: 75.93 s, training_loss: 0.564
Epoch   23/50, time: 112.78 s, val_loss: 0.618
Epoch   24/50, time: 76.46 s, training_loss: 0.536
Epoch   24/50, time: 114.77 s, val_loss: 0.613
Epoch   25/50, time: 77.02 s, training_loss: 0.508
Epoch   25/50, time: 115.01 s, val_loss: 0.591
Epoch   26/50, time: 76.04 s, training_loss: 0.477
Epoch   26/50, time: 112.96 s, val_loss: 0.581
Epoch   27/50, time: 75.64 s, training_loss: 0.457
Epoch   27/50, time: 112.87 s, val_loss: 0.599
Epoch   28/50, time: 78.36 s, training_loss: 0.432
Epoch   28/50, time: 115.95 s, val_loss: 0.652
Epoch   29/50, time: 79.70 s, training_loss: 0.407
Epoch   29/50, time: 117.01 s, val_loss: 0.547
Epoch   30/50, time: 78.94 s, training_loss: 0.377
Epoch   30/50, time: 115.86 s, val_loss: 0.552
Epoch   31/50, time: 80.94 s, training_loss: 0.356
Epoch   31/50, time: 118.07 s, val_loss: 0.544
Training Metrics:
Accuracy: 0.9792
Precision: 0.4794
Recall: 0.7882
F1 Score: 0.5962
IoU: 0.4247
Dice Coefficient: 0.5962
Validation Metrics:
Accuracy: 0.9755
Precision: 0.4085
Recall: 0.5637
F1 Score: 0.4737
IoU: 0.3104
Dice Coefficient: 0.4737
Epoch   32/50, time: 78.30 s, training_loss: 0.344
Epoch   32/50, time: 116.25 s, val_loss: 0.557
Epoch   33/50, time: 75.97 s, training_loss: 0.327
Epoch   33/50, time: 114.01 s, val_loss: 0.581
Epoch   34/50, time: 75.48 s, training_loss: 0.319
Epoch   34/50, time: 113.30 s, val_loss: 0.531
Epoch   35/50, time: 77.02 s, training_loss: 0.305
Epoch   35/50, time: 114.18 s, val_loss: 0.533
Epoch   36/50, time: 75.40 s, training_loss: 0.291
Epoch   36/50, time: 112.97 s, val_loss: 0.521
Epoch   37/50, time: 75.92 s, training_loss: 0.280
Epoch   37/50, time: 113.32 s, val_loss: 0.538
Epoch   38/50, time: 78.82 s, training_loss: 0.262
Epoch   38/50, time: 115.77 s, val_loss: 0.519
Epoch   39/50, time: 76.80 s, training_loss: 0.251
Epoch   39/50, time: 114.50 s, val_loss: 0.554
Epoch   40/50, time: 76.79 s, training_loss: 0.242
Epoch   40/50, time: 114.44 s, val_loss: 0.529
Epoch   41/50, time: 76.47 s, training_loss: 0.234
Epoch   41/50, time: 113.90 s, val_loss: 0.517
Training Metrics:
Accuracy: 0.9842
Precision: 0.5628
Recall: 0.8436
F1 Score: 0.6752
IoU: 0.5096
Dice Coefficient: 0.6752
Validation Metrics:
Accuracy: 0.9781
Precision: 0.4492
Recall: 0.5193
F1 Score: 0.4817
IoU: 0.3172
Dice Coefficient: 0.4817
Epoch   42/50, time: 76.60 s, training_loss: 0.235
Epoch   42/50, time: 114.11 s, val_loss: 0.522
Epoch   43/50, time: 76.79 s, training_loss: 0.219
Epoch   43/50, time: 114.57 s, val_loss: 0.506
Epoch   44/50, time: 76.14 s, training_loss: 0.217
Epoch   44/50, time: 113.81 s, val_loss: 0.515
Epoch   45/50, time: 76.61 s, training_loss: 0.205
Epoch   45/50, time: 114.51 s, val_loss: 0.511
Epoch   46/50, time: 76.32 s, training_loss: 0.214
Epoch   46/50, time: 114.38 s, val_loss: 0.516
Epoch   47/50, time: 77.52 s, training_loss: 0.210
Epoch   47/50, time: 114.52 s, val_loss: 0.500
Epoch   48/50, time: 75.90 s, training_loss: 0.201
Epoch   48/50, time: 113.91 s, val_loss: 0.503
Epoch   49/50, time: 79.25 s, training_loss: 0.190
Epoch   49/50, time: 116.43 s, val_loss: 0.514
Epoch   50/50, time: 76.05 s, training_loss: 0.190
Epoch   50/50, time: 114.08 s, val_loss: 0.499
Training Metrics:
Accuracy: 0.9845
Precision: 0.5661
Recall: 0.8740
F1 Score: 0.6871
IoU: 0.5234
Dice Coefficient: 0.6871
Validation Metrics:
Accuracy: 0.9777
Precision: 0.4423
Recall: 0.5346
F1 Score: 0.4841
IoU: 0.3194
Dice Coefficient: 0.4841
[I 2025-06-09 06:23:29,950] Trial 3 finished with value: 0.4841247201171202 and parameters: {'batch_size': 64, 'lr': 0.00037017383139387725, 'loss_fn': 'dice_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9777
Precision: 0.4423
Recall: 0.5346
F1 Score: 0.4841
IoU: 0.3194
Dice Coefficient: 0.4841
[Trial 3] Finished with val_loss=inf
[Trial 3] Finished with dice_coeff=0.4841247201171202
[Trial 4] Trying batch_size=64, lr=0.000414722627268548, loss_fn=bce_loss
Epoch    1/50, time: 77.74 s, training_loss: 0.613
Epoch    1/50, time: 115.09 s, val_loss: 0.575
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 72.36 s, training_loss: 0.375
Epoch    2/50, time: 110.66 s, val_loss: 0.367
Epoch    3/50, time: 76.11 s, training_loss: 0.321
Epoch    3/50, time: 113.80 s, val_loss: 0.332
Epoch    4/50, time: 77.45 s, training_loss: 0.297
Epoch    4/50, time: 115.40 s, val_loss: 0.280
Epoch    5/50, time: 80.10 s, training_loss: 0.269
Epoch    5/50, time: 117.90 s, val_loss: 0.268
Epoch    6/50, time: 76.03 s, training_loss: 0.251
Epoch    6/50, time: 113.25 s, val_loss: 0.250
Epoch    7/50, time: 76.57 s, training_loss: 0.236
Epoch    7/50, time: 115.29 s, val_loss: 0.234
Epoch    8/50, time: 79.42 s, training_loss: 0.225
Epoch    8/50, time: 117.78 s, val_loss: 0.219
Epoch    9/50, time: 78.52 s, training_loss: 0.210
Epoch    9/50, time: 116.29 s, val_loss: 0.190
Epoch   10/50, time: 76.10 s, training_loss: 0.198
Epoch   10/50, time: 114.35 s, val_loss: 0.195
Epoch   11/50, time: 78.29 s, training_loss: 0.186
Epoch   11/50, time: 115.78 s, val_loss: 0.189
Training Metrics:
Accuracy: 0.9805
Precision: 0.1892
Recall: 0.0013
F1 Score: 0.0025
IoU: 0.0012
Dice Coefficient: 0.0025
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0903
Recall: 0.0002
F1 Score: 0.0004
IoU: 0.0002
Dice Coefficient: 0.0004
Epoch   12/50, time: 77.91 s, training_loss: 0.176
Epoch   12/50, time: 115.66 s, val_loss: 0.169
Epoch   13/50, time: 76.83 s, training_loss: 0.166
Epoch   13/50, time: 114.68 s, val_loss: 0.161
Epoch   14/50, time: 78.93 s, training_loss: 0.157
Epoch   14/50, time: 116.70 s, val_loss: 0.155
Epoch   15/50, time: 76.45 s, training_loss: 0.150
Epoch   15/50, time: 114.39 s, val_loss: 0.145
Epoch   16/50, time: 78.75 s, training_loss: 0.143
Epoch   16/50, time: 116.09 s, val_loss: 0.139
Epoch   17/50, time: 77.27 s, training_loss: 0.136
Epoch   17/50, time: 115.18 s, val_loss: 0.134
Epoch   18/50, time: 76.62 s, training_loss: 0.130
Epoch   18/50, time: 113.78 s, val_loss: 0.128
Epoch   19/50, time: 80.05 s, training_loss: 0.124
Epoch   19/50, time: 117.57 s, val_loss: 0.121
Epoch   20/50, time: 77.23 s, training_loss: 0.119
Epoch   20/50, time: 115.02 s, val_loss: 0.118
Epoch   21/50, time: 76.63 s, training_loss: 0.115
Epoch   21/50, time: 114.36 s, val_loss: 0.112
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.3832
Recall: 0.0001
F1 Score: 0.0002
IoU: 0.0001
Dice Coefficient: 0.0002
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   22/50, time: 76.84 s, training_loss: 0.111
Epoch   22/50, time: 114.57 s, val_loss: 0.109
Epoch   23/50, time: 78.30 s, training_loss: 0.107
Epoch   23/50, time: 115.63 s, val_loss: 0.105
Epoch   24/50, time: 76.65 s, training_loss: 0.104
Epoch   24/50, time: 114.85 s, val_loss: 0.106
Epoch   25/50, time: 78.69 s, training_loss: 0.101
Epoch   25/50, time: 116.03 s, val_loss: 0.097
Epoch   26/50, time: 75.89 s, training_loss: 0.097
Epoch   26/50, time: 114.26 s, val_loss: 0.096
Epoch   27/50, time: 78.62 s, training_loss: 0.094
Epoch   27/50, time: 117.13 s, val_loss: 0.093
Epoch   28/50, time: 78.41 s, training_loss: 0.091
Epoch   28/50, time: 116.60 s, val_loss: 0.091
Epoch   29/50, time: 76.76 s, training_loss: 0.088
Epoch   29/50, time: 115.69 s, val_loss: 0.088
Epoch   30/50, time: 77.29 s, training_loss: 0.086
Epoch   30/50, time: 114.78 s, val_loss: 0.086
Epoch   31/50, time: 75.96 s, training_loss: 0.083
Epoch   31/50, time: 113.85 s, val_loss: 0.086
Training Metrics:
Accuracy: 0.9804
Precision: 0.3162
Recall: 0.0052
F1 Score: 0.0103
IoU: 0.0052
Dice Coefficient: 0.0103
Validation Metrics:
Accuracy: 0.9803
Precision: 0.3135
Recall: 0.0033
F1 Score: 0.0066
IoU: 0.0033
Dice Coefficient: 0.0066
Epoch   32/50, time: 78.33 s, training_loss: 0.081
Epoch   32/50, time: 116.08 s, val_loss: 0.082
Epoch   33/50, time: 75.32 s, training_loss: 0.078
Epoch   33/50, time: 112.55 s, val_loss: 0.080
Epoch   34/50, time: 78.05 s, training_loss: 0.076
Epoch   34/50, time: 115.72 s, val_loss: 0.079
Epoch   35/50, time: 77.02 s, training_loss: 0.074
Epoch   35/50, time: 114.92 s, val_loss: 0.075
Epoch   36/50, time: 75.97 s, training_loss: 0.072
Epoch   36/50, time: 113.06 s, val_loss: 0.075
Epoch   37/50, time: 78.81 s, training_loss: 0.070
Epoch   37/50, time: 117.91 s, val_loss: 0.075
Epoch   38/50, time: 77.74 s, training_loss: 0.068
Epoch   38/50, time: 114.63 s, val_loss: 0.072
Epoch   39/50, time: 77.07 s, training_loss: 0.066
Epoch   39/50, time: 115.08 s, val_loss: 0.070
Epoch   40/50, time: 78.03 s, training_loss: 0.063
Epoch   40/50, time: 116.03 s, val_loss: 0.069
Epoch   41/50, time: 77.83 s, training_loss: 0.061
Epoch   41/50, time: 115.44 s, val_loss: 0.070
Training Metrics:
Accuracy: 0.9816
Precision: 0.7095
Recall: 0.0931
F1 Score: 0.1645
IoU: 0.0896
Dice Coefficient: 0.1645
Validation Metrics:
Accuracy: 0.9805
Precision: 0.5168
Recall: 0.0584
F1 Score: 0.1049
IoU: 0.0554
Dice Coefficient: 0.1049
Epoch   42/50, time: 76.44 s, training_loss: 0.060
Epoch   42/50, time: 114.35 s, val_loss: 0.070
Epoch   43/50, time: 76.10 s, training_loss: 0.058
Epoch   43/50, time: 113.78 s, val_loss: 0.068
Epoch   44/50, time: 75.97 s, training_loss: 0.056
Epoch   44/50, time: 113.39 s, val_loss: 0.070
Epoch   45/50, time: 78.26 s, training_loss: 0.055
Epoch   45/50, time: 115.85 s, val_loss: 0.069
Epoch   46/50, time: 79.44 s, training_loss: 0.053
Epoch   46/50, time: 116.76 s, val_loss: 0.068
Epoch   47/50, time: 76.55 s, training_loss: 0.051
Epoch   47/50, time: 113.64 s, val_loss: 0.069
Epoch   48/50, time: 77.48 s, training_loss: 0.052
Epoch   48/50, time: 115.40 s, val_loss: 0.065
Epoch   49/50, time: 77.03 s, training_loss: 0.048
Epoch   49/50, time: 114.92 s, val_loss: 0.067
Epoch   50/50, time: 78.11 s, training_loss: 0.047
Epoch   50/50, time: 116.05 s, val_loss: 0.065
Training Metrics:
Accuracy: 0.9851
Precision: 0.7594
Recall: 0.3405
F1 Score: 0.4702
IoU: 0.3074
Dice Coefficient: 0.4702
Validation Metrics:
Accuracy: 0.9795
Precision: 0.4445
Recall: 0.1799
F1 Score: 0.2561
IoU: 0.1469
Dice Coefficient: 0.2561
[I 2025-06-09 08:14:20,613] Trial 4 finished with value: 0.2561307671313447 and parameters: {'batch_size': 64, 'lr': 0.000414722627268548, 'loss_fn': 'bce_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9795
Precision: 0.4445
Recall: 0.1799
F1 Score: 0.2561
IoU: 0.1469
Dice Coefficient: 0.2561
[Trial 4] Finished with val_loss=inf
[Trial 4] Finished with dice_coeff=0.2561307671313447
[Trial 5] Trying batch_size=64, lr=0.0008857813140795358, loss_fn=dice_loss
Epoch    1/50, time: 77.89 s, training_loss: 0.883
Epoch    1/50, time: 115.51 s, val_loss: 0.941
Training Metrics:
Accuracy: 0.9800
Precision: 0.1190
Recall: 0.0043
F1 Score: 0.0083
IoU: 0.0042
Dice Coefficient: 0.0083
Validation Metrics:
Accuracy: 0.9799
Precision: 0.1184
Recall: 0.0042
F1 Score: 0.0081
IoU: 0.0041
Dice Coefficient: 0.0081
Epoch    2/50, time: 72.98 s, training_loss: 0.834
Epoch    2/50, time: 110.66 s, val_loss: 0.873
Epoch    3/50, time: 77.47 s, training_loss: 0.801
Epoch    3/50, time: 115.57 s, val_loss: 0.785
Epoch    4/50, time: 77.61 s, training_loss: 0.777
Epoch    4/50, time: 115.12 s, val_loss: 0.782
Epoch    5/50, time: 78.63 s, training_loss: 0.756
Epoch    5/50, time: 116.64 s, val_loss: 0.765
Epoch    6/50, time: 78.65 s, training_loss: 0.743
Epoch    6/50, time: 115.92 s, val_loss: 0.750
Epoch    7/50, time: 79.67 s, training_loss: 0.732
Epoch    7/50, time: 117.83 s, val_loss: 0.734
Epoch    8/50, time: 77.04 s, training_loss: 0.722
Epoch    8/50, time: 115.27 s, val_loss: 0.728
Epoch    9/50, time: 75.79 s, training_loss: 0.708
Epoch    9/50, time: 113.76 s, val_loss: 0.717
Epoch   10/50, time: 77.60 s, training_loss: 0.686
Epoch   10/50, time: 114.62 s, val_loss: 0.695
Epoch   11/50, time: 76.30 s, training_loss: 0.656
Epoch   11/50, time: 114.37 s, val_loss: 0.687
Training Metrics:
Accuracy: 0.9704
Precision: 0.3135
Recall: 0.4384
F1 Score: 0.3656
IoU: 0.2237
Dice Coefficient: 0.3656
Validation Metrics:
Accuracy: 0.9693
Precision: 0.2987
Recall: 0.4199
F1 Score: 0.3491
IoU: 0.2114
Dice Coefficient: 0.3491
Epoch   12/50, time: 73.22 s, training_loss: 0.625
Epoch   12/50, time: 111.21 s, val_loss: 0.655
Epoch   13/50, time: 78.84 s, training_loss: 0.593
Epoch   13/50, time: 116.79 s, val_loss: 0.626
Epoch   14/50, time: 76.48 s, training_loss: 0.570
Epoch   14/50, time: 114.24 s, val_loss: 0.614
Epoch   15/50, time: 78.19 s, training_loss: 0.546
Epoch   15/50, time: 115.89 s, val_loss: 0.627
Epoch   16/50, time: 76.43 s, training_loss: 0.528
Epoch   16/50, time: 113.93 s, val_loss: 0.584
Epoch   17/50, time: 76.69 s, training_loss: 0.512
Epoch   17/50, time: 113.70 s, val_loss: 0.580
Epoch   18/50, time: 78.45 s, training_loss: 0.482
Epoch   18/50, time: 116.43 s, val_loss: 0.616
Epoch   19/50, time: 77.65 s, training_loss: 0.459
Epoch   19/50, time: 115.37 s, val_loss: 0.562
Epoch   20/50, time: 76.38 s, training_loss: 0.440
Epoch   20/50, time: 114.26 s, val_loss: 0.549
Epoch   21/50, time: 76.05 s, training_loss: 0.411
Epoch   21/50, time: 113.34 s, val_loss: 0.552
Training Metrics:
Accuracy: 0.9842
Precision: 0.5895
Recall: 0.6136
F1 Score: 0.6013
IoU: 0.4299
Dice Coefficient: 0.6013
Validation Metrics:
Accuracy: 0.9787
Precision: 0.4587
Recall: 0.4741
F1 Score: 0.4663
IoU: 0.3040
Dice Coefficient: 0.4663
Epoch   22/50, time: 72.05 s, training_loss: 0.392
Epoch   22/50, time: 110.23 s, val_loss: 0.528
Epoch   23/50, time: 75.67 s, training_loss: 0.377
Epoch   23/50, time: 113.72 s, val_loss: 0.515
Epoch   24/50, time: 77.35 s, training_loss: 0.358
Epoch   24/50, time: 115.34 s, val_loss: 0.523
Epoch   25/50, time: 77.06 s, training_loss: 0.346
Epoch   25/50, time: 114.39 s, val_loss: 0.527
Epoch   26/50, time: 79.07 s, training_loss: 0.334
Epoch   26/50, time: 116.83 s, val_loss: 0.522
Epoch   27/50, time: 77.48 s, training_loss: 0.313
Epoch   27/50, time: 114.88 s, val_loss: 0.541
Epoch   28/50, time: 76.63 s, training_loss: 0.318
Epoch   28/50, time: 114.21 s, val_loss: 0.502
Epoch   29/50, time: 79.65 s, training_loss: 0.314
Epoch   29/50, time: 117.55 s, val_loss: 0.508
Epoch   30/50, time: 76.02 s, training_loss: 0.292
Epoch   30/50, time: 114.16 s, val_loss: 0.521
Epoch   31/50, time: 77.12 s, training_loss: 0.284
Epoch   31/50, time: 115.37 s, val_loss: 0.536
Training Metrics:
Accuracy: 0.9886
Precision: 0.7131
Recall: 0.6974
F1 Score: 0.7052
IoU: 0.5446
Dice Coefficient: 0.7052
Validation Metrics:
Accuracy: 0.9803
Precision: 0.4971
Recall: 0.4575
F1 Score: 0.4765
IoU: 0.3128
Dice Coefficient: 0.4765
Epoch   32/50, time: 75.65 s, training_loss: 0.273
Epoch   32/50, time: 113.56 s, val_loss: 0.503
Epoch   33/50, time: 77.70 s, training_loss: 0.263
Epoch   33/50, time: 115.14 s, val_loss: 0.505
Epoch   34/50, time: 76.13 s, training_loss: 0.254
Epoch   34/50, time: 113.61 s, val_loss: 0.502
Epoch   35/50, time: 78.70 s, training_loss: 0.242
Epoch   35/50, time: 116.35 s, val_loss: 0.508
Epoch   36/50, time: 77.02 s, training_loss: 0.230
Epoch   36/50, time: 114.38 s, val_loss: 0.503
Epoch   37/50, time: 79.01 s, training_loss: 0.225
Epoch   37/50, time: 117.25 s, val_loss: 0.509
Epoch   38/50, time: 78.92 s, training_loss: 0.219
Epoch   38/50, time: 117.72 s, val_loss: 0.513
Epoch   39/50, time: 76.29 s, training_loss: 0.220
Epoch   39/50, time: 114.25 s, val_loss: 0.522
Epoch   40/50, time: 75.79 s, training_loss: 0.214
Epoch   40/50, time: 113.61 s, val_loss: 0.503
Epoch   41/50, time: 76.60 s, training_loss: 0.209
Epoch   41/50, time: 114.03 s, val_loss: 0.504
Training Metrics:
Accuracy: 0.9926
Precision: 0.8092
Recall: 0.8080
F1 Score: 0.8086
IoU: 0.6787
Dice Coefficient: 0.8086
Validation Metrics:
Accuracy: 0.9810
Precision: 0.5156
Recall: 0.5041
F1 Score: 0.5098
IoU: 0.3421
Dice Coefficient: 0.5098
Epoch   42/50, time: 77.48 s, training_loss: 0.200
Epoch   42/50, time: 115.01 s, val_loss: 0.502
Epoch   43/50, time: 76.16 s, training_loss: 0.202
Epoch   43/50, time: 114.08 s, val_loss: 0.505
Epoch   44/50, time: 76.24 s, training_loss: 0.192
Epoch   44/50, time: 113.85 s, val_loss: 0.484
Epoch   45/50, time: 77.60 s, training_loss: 0.190
Epoch   45/50, time: 114.97 s, val_loss: 0.515
Epoch   46/50, time: 78.16 s, training_loss: 0.198
Epoch   46/50, time: 115.63 s, val_loss: 0.507
Epoch   47/50, time: 79.55 s, training_loss: 0.194
Epoch   47/50, time: 117.08 s, val_loss: 0.508
Epoch   48/50, time: 77.32 s, training_loss: 0.181
Epoch   48/50, time: 115.17 s, val_loss: 0.502
Epoch   49/50, time: 78.47 s, training_loss: 0.176
Epoch   49/50, time: 116.09 s, val_loss: 0.502
Epoch   50/50, time: 79.81 s, training_loss: 0.180
Epoch   50/50, time: 117.59 s, val_loss: 0.509
Training Metrics:
Accuracy: 0.9928
Precision: 0.8246
Recall: 0.8029
F1 Score: 0.8136
IoU: 0.6857
Dice Coefficient: 0.8136
Validation Metrics:
Accuracy: 0.9816
Precision: 0.5331
Recall: 0.4882
F1 Score: 0.5097
IoU: 0.3420
Dice Coefficient: 0.5097
[I 2025-06-09 10:05:05,533] Trial 5 finished with value: 0.5097035416763624 and parameters: {'batch_size': 64, 'lr': 0.0008857813140795358, 'loss_fn': 'dice_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9816
Precision: 0.5331
Recall: 0.4882
F1 Score: 0.5097
IoU: 0.3420
Dice Coefficient: 0.5097
[Trial 5] Finished with val_loss=inf
[Trial 5] Finished with dice_coeff=0.5097035416763624
[Trial 6] Trying batch_size=16, lr=0.00016976526669959036, loss_fn=bce_loss
Epoch    1/50, time: 75.49 s, training_loss: 0.360
Epoch    1/50, time: 113.01 s, val_loss: 0.284
Training Metrics:
Accuracy: 0.9802
Precision: 0.1600
Recall: 0.0038
F1 Score: 0.0075
IoU: 0.0037
Dice Coefficient: 0.0075
Validation Metrics:
Accuracy: 0.9800
Precision: 0.1427
Recall: 0.0037
F1 Score: 0.0072
IoU: 0.0036
Dice Coefficient: 0.0072
Epoch    2/50, time: 70.25 s, training_loss: 0.259
Epoch    2/50, time: 106.28 s, val_loss: 0.246
Epoch    3/50, time: 71.94 s, training_loss: 0.224
Epoch    3/50, time: 109.61 s, val_loss: 0.215
Epoch    4/50, time: 72.32 s, training_loss: 0.196
Epoch    4/50, time: 110.15 s, val_loss: 0.184
Epoch    5/50, time: 74.92 s, training_loss: 0.174
Epoch    5/50, time: 112.50 s, val_loss: 0.163
Epoch    6/50, time: 73.09 s, training_loss: 0.156
Epoch    6/50, time: 110.21 s, val_loss: 0.148
Epoch    7/50, time: 72.48 s, training_loss: 0.141
Epoch    7/50, time: 109.57 s, val_loss: 0.134
Epoch    8/50, time: 72.87 s, training_loss: 0.128
Epoch    8/50, time: 110.58 s, val_loss: 0.123
Epoch    9/50, time: 71.20 s, training_loss: 0.118
Epoch    9/50, time: 108.91 s, val_loss: 0.114
Epoch   10/50, time: 74.35 s, training_loss: 0.109
Epoch   10/50, time: 111.94 s, val_loss: 0.105
Epoch   11/50, time: 72.66 s, training_loss: 0.101
Epoch   11/50, time: 110.62 s, val_loss: 0.097
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.1000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   12/50, time: 68.91 s, training_loss: 0.094
Epoch   12/50, time: 105.11 s, val_loss: 0.093
Epoch   13/50, time: 72.09 s, training_loss: 0.089
Epoch   13/50, time: 109.30 s, val_loss: 0.086
Epoch   14/50, time: 75.61 s, training_loss: 0.083
Epoch   14/50, time: 113.58 s, val_loss: 0.081
Epoch   15/50, time: 73.17 s, training_loss: 0.078
Epoch   15/50, time: 110.86 s, val_loss: 0.077
Epoch   16/50, time: 74.32 s, training_loss: 0.073
Epoch   16/50, time: 111.85 s, val_loss: 0.074
Epoch   17/50, time: 73.05 s, training_loss: 0.069
Epoch   17/50, time: 111.09 s, val_loss: 0.070
Epoch   18/50, time: 73.06 s, training_loss: 0.065
Epoch   18/50, time: 112.59 s, val_loss: 0.070
Epoch   19/50, time: 73.91 s, training_loss: 0.064
Epoch   19/50, time: 110.89 s, val_loss: 0.066
Epoch   20/50, time: 73.57 s, training_loss: 0.059
Epoch   20/50, time: 111.21 s, val_loss: 0.065
Epoch   21/50, time: 74.36 s, training_loss: 0.056
Epoch   21/50, time: 111.85 s, val_loss: 0.064
Training Metrics:
Accuracy: 0.9822
Precision: 0.7266
Recall: 0.1339
F1 Score: 0.2262
IoU: 0.1275
Dice Coefficient: 0.2262
Validation Metrics:
Accuracy: 0.9805
Precision: 0.5139
Recall: 0.0857
F1 Score: 0.1470
IoU: 0.0793
Dice Coefficient: 0.1470
Epoch   22/50, time: 68.73 s, training_loss: 0.054
Epoch   22/50, time: 104.13 s, val_loss: 0.062
Epoch   23/50, time: 72.91 s, training_loss: 0.050
Epoch   23/50, time: 110.70 s, val_loss: 0.061
Epoch   24/50, time: 71.91 s, training_loss: 0.048
Epoch   24/50, time: 109.66 s, val_loss: 0.065
Epoch   25/50, time: 74.07 s, training_loss: 0.046
Epoch   25/50, time: 112.16 s, val_loss: 0.061
Epoch   26/50, time: 73.68 s, training_loss: 0.042
Epoch   26/50, time: 111.07 s, val_loss: 0.060
Epoch   27/50, time: 71.94 s, training_loss: 0.039
Epoch   27/50, time: 109.59 s, val_loss: 0.060
Epoch   28/50, time: 72.50 s, training_loss: 0.036
Epoch   28/50, time: 110.19 s, val_loss: 0.061
Epoch   29/50, time: 72.25 s, training_loss: 0.034
Epoch   29/50, time: 109.35 s, val_loss: 0.060
Epoch   30/50, time: 72.63 s, training_loss: 0.032
Epoch   30/50, time: 110.42 s, val_loss: 0.060
Epoch   31/50, time: 73.15 s, training_loss: 0.030
Epoch   31/50, time: 111.06 s, val_loss: 0.060
Training Metrics:
Accuracy: 0.9909
Precision: 0.8538
Recall: 0.6425
F1 Score: 0.7332
IoU: 0.5788
Dice Coefficient: 0.7332
Validation Metrics:
Accuracy: 0.9804
Precision: 0.4987
Recall: 0.2851
F1 Score: 0.3628
IoU: 0.2216
Dice Coefficient: 0.3628
Epoch   32/50, time: 69.18 s, training_loss: 0.028
Epoch   32/50, time: 106.36 s, val_loss: 0.062
Epoch   33/50, time: 72.25 s, training_loss: 0.027
Epoch   33/50, time: 110.12 s, val_loss: 0.062
Epoch   34/50, time: 72.44 s, training_loss: 0.026
Epoch   34/50, time: 110.17 s, val_loss: 0.063
Epoch   35/50, time: 73.75 s, training_loss: 0.025
Epoch   35/50, time: 111.28 s, val_loss: 0.062
Epoch   36/50, time: 75.24 s, training_loss: 0.024
Epoch   36/50, time: 113.11 s, val_loss: 0.061
Epoch   37/50, time: 72.34 s, training_loss: 0.023
Epoch   37/50, time: 110.29 s, val_loss: 0.061
Epoch   38/50, time: 72.58 s, training_loss: 0.022
Epoch   38/50, time: 109.74 s, val_loss: 0.064
Epoch   39/50, time: 72.22 s, training_loss: 0.021
Epoch   39/50, time: 109.91 s, val_loss: 0.064
Epoch   40/50, time: 72.98 s, training_loss: 0.020
Epoch   40/50, time: 110.61 s, val_loss: 0.064
Epoch   41/50, time: 74.66 s, training_loss: 0.020
Epoch   41/50, time: 111.79 s, val_loss: 0.064
Training Metrics:
Accuracy: 0.9934
Precision: 0.9062
Recall: 0.7374
F1 Score: 0.8131
IoU: 0.6851
Dice Coefficient: 0.8131
Validation Metrics:
Accuracy: 0.9805
Precision: 0.5023
Recall: 0.3103
F1 Score: 0.3836
IoU: 0.2373
Dice Coefficient: 0.3836
Epoch   42/50, time: 69.83 s, training_loss: 0.019
Epoch   42/50, time: 107.86 s, val_loss: 0.064
Epoch   43/50, time: 70.84 s, training_loss: 0.018
Epoch   43/50, time: 108.39 s, val_loss: 0.066
Epoch   44/50, time: 72.39 s, training_loss: 0.018
Epoch   44/50, time: 110.47 s, val_loss: 0.063
Epoch   45/50, time: 74.08 s, training_loss: 0.017
Epoch   45/50, time: 111.24 s, val_loss: 0.067
Epoch   46/50, time: 71.55 s, training_loss: 0.017
Epoch   46/50, time: 108.60 s, val_loss: 0.066
Epoch   47/50, time: 70.97 s, training_loss: 0.017
Epoch   47/50, time: 109.12 s, val_loss: 0.066
Epoch   48/50, time: 71.28 s, training_loss: 0.016
Epoch   48/50, time: 109.06 s, val_loss: 0.067
Epoch   49/50, time: 72.26 s, training_loss: 0.016
Epoch   49/50, time: 110.07 s, val_loss: 0.069
Epoch   50/50, time: 71.84 s, training_loss: 0.015
Epoch   50/50, time: 108.87 s, val_loss: 0.065
Training Metrics:
Accuracy: 0.9945
Precision: 0.9265
Recall: 0.7810
F1 Score: 0.8475
IoU: 0.7354
Dice Coefficient: 0.8475
Validation Metrics:
Accuracy: 0.9807
Precision: 0.5104
Recall: 0.3343
F1 Score: 0.4040
IoU: 0.2531
Dice Coefficient: 0.4040
[I 2025-06-09 11:50:27,839] Trial 6 finished with value: 0.40399306116731853 and parameters: {'batch_size': 16, 'lr': 0.00016976526669959036, 'loss_fn': 'bce_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9807
Precision: 0.5104
Recall: 0.3343
F1 Score: 0.4040
IoU: 0.2531
Dice Coefficient: 0.4040
[Trial 6] Finished with val_loss=inf
[Trial 6] Finished with dice_coeff=0.40399306116731853
[Trial 7] Trying batch_size=16, lr=0.0009419373918505801, loss_fn=bce_loss
Epoch    1/50, time: 69.88 s, training_loss: 0.245
Epoch    1/50, time: 105.18 s, val_loss: 0.155
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 70.68 s, training_loss: 0.116
Epoch    2/50, time: 107.65 s, val_loss: 0.093
Epoch    3/50, time: 74.14 s, training_loss: 0.084
Epoch    3/50, time: 112.13 s, val_loss: 0.075
Epoch    4/50, time: 71.45 s, training_loss: 0.071
Epoch    4/50, time: 109.08 s, val_loss: 0.067
Epoch    5/50, time: 74.13 s, training_loss: 0.064
Epoch    5/50, time: 112.56 s, val_loss: 0.062
Epoch    6/50, time: 72.83 s, training_loss: 0.060
Epoch    6/50, time: 109.99 s, val_loss: 0.057
Epoch    7/50, time: 72.86 s, training_loss: 0.055
Epoch    7/50, time: 110.23 s, val_loss: 0.055
Epoch    8/50, time: 74.43 s, training_loss: 0.052
Epoch    8/50, time: 112.26 s, val_loss: 0.053
Epoch    9/50, time: 74.51 s, training_loss: 0.049
Epoch    9/50, time: 111.77 s, val_loss: 0.052
Epoch   10/50, time: 71.82 s, training_loss: 0.047
Epoch   10/50, time: 109.11 s, val_loss: 0.050
Epoch   11/50, time: 72.21 s, training_loss: 0.044
Epoch   11/50, time: 110.10 s, val_loss: 0.048
Training Metrics:
Accuracy: 0.9810
Precision: 0.7020
Recall: 0.0446
F1 Score: 0.0840
IoU: 0.0438
Dice Coefficient: 0.0840
Validation Metrics:
Accuracy: 0.9807
Precision: 0.5991
Recall: 0.0382
F1 Score: 0.0718
IoU: 0.0372
Dice Coefficient: 0.0718
Epoch   12/50, time: 69.92 s, training_loss: 0.042
Epoch   12/50, time: 106.65 s, val_loss: 0.051
Epoch   13/50, time: 71.79 s, training_loss: 0.041
Epoch   13/50, time: 109.51 s, val_loss: 0.049
Epoch   14/50, time: 72.34 s, training_loss: 0.039
Epoch   14/50, time: 110.19 s, val_loss: 0.045
Epoch   15/50, time: 72.42 s, training_loss: 0.036
Epoch   15/50, time: 110.28 s, val_loss: 0.045
Epoch   16/50, time: 71.53 s, training_loss: 0.034
Epoch   16/50, time: 108.48 s, val_loss: 0.046
Epoch   17/50, time: 73.64 s, training_loss: 0.032
Epoch   17/50, time: 111.25 s, val_loss: 0.045
Epoch   18/50, time: 71.59 s, training_loss: 0.031
Epoch   18/50, time: 109.18 s, val_loss: 0.043
Epoch   19/50, time: 74.54 s, training_loss: 0.029
Epoch   19/50, time: 112.61 s, val_loss: 0.045
Epoch   20/50, time: 72.54 s, training_loss: 0.028
Epoch   20/50, time: 109.52 s, val_loss: 0.045
Epoch   21/50, time: 73.13 s, training_loss: 0.026
Epoch   21/50, time: 110.74 s, val_loss: 0.044
Training Metrics:
Accuracy: 0.9894
Precision: 0.8606
Recall: 0.5422
F1 Score: 0.6652
IoU: 0.4984
Dice Coefficient: 0.6652
Validation Metrics:
Accuracy: 0.9830
Precision: 0.6195
Recall: 0.3454
F1 Score: 0.4435
IoU: 0.2849
Dice Coefficient: 0.4435
Epoch   22/50, time: 71.16 s, training_loss: 0.025
Epoch   22/50, time: 109.33 s, val_loss: 0.046
Epoch   23/50, time: 72.33 s, training_loss: 0.024
Epoch   23/50, time: 109.94 s, val_loss: 0.051
Epoch   24/50, time: 74.19 s, training_loss: 0.023
Epoch   24/50, time: 112.15 s, val_loss: 0.048
Epoch   25/50, time: 74.87 s, training_loss: 0.022
Epoch   25/50, time: 112.88 s, val_loss: 0.046
Epoch   26/50, time: 74.31 s, training_loss: 0.021
Epoch   26/50, time: 111.63 s, val_loss: 0.046
Epoch   27/50, time: 71.79 s, training_loss: 0.020
Epoch   27/50, time: 109.71 s, val_loss: 0.047
Epoch   28/50, time: 72.22 s, training_loss: 0.019
Epoch   28/50, time: 110.48 s, val_loss: 0.048
Epoch   29/50, time: 74.81 s, training_loss: 0.018
Epoch   29/50, time: 112.58 s, val_loss: 0.049
Epoch   30/50, time: 72.25 s, training_loss: 0.018
Epoch   30/50, time: 110.04 s, val_loss: 0.049
Epoch   31/50, time: 75.48 s, training_loss: 0.017
Epoch   31/50, time: 113.39 s, val_loss: 0.049
Training Metrics:
Accuracy: 0.9930
Precision: 0.8937
Recall: 0.7272
F1 Score: 0.8019
IoU: 0.6693
Dice Coefficient: 0.8019
Validation Metrics:
Accuracy: 0.9836
Precision: 0.6102
Recall: 0.4527
F1 Score: 0.5198
IoU: 0.3512
Dice Coefficient: 0.5198
Epoch   32/50, time: 68.49 s, training_loss: 0.017
Epoch   32/50, time: 105.48 s, val_loss: 0.050
Epoch   33/50, time: 71.31 s, training_loss: 0.016
Epoch   33/50, time: 108.82 s, val_loss: 0.050
Epoch   34/50, time: 73.10 s, training_loss: 0.016
Epoch   34/50, time: 110.94 s, val_loss: 0.050
Epoch   35/50, time: 72.75 s, training_loss: 0.015
Epoch   35/50, time: 110.59 s, val_loss: 0.056
Epoch   36/50, time: 77.34 s, training_loss: 0.015
Epoch   36/50, time: 114.72 s, val_loss: 0.055
Epoch   37/50, time: 71.53 s, training_loss: 0.015
Epoch   37/50, time: 108.71 s, val_loss: 0.056
Epoch   38/50, time: 72.91 s, training_loss: 0.014
Epoch   38/50, time: 110.00 s, val_loss: 0.055
Epoch   39/50, time: 73.16 s, training_loss: 0.014
Epoch   39/50, time: 111.99 s, val_loss: 0.057
Epoch   40/50, time: 73.97 s, training_loss: 0.013
Epoch   40/50, time: 110.94 s, val_loss: 0.061
Epoch   41/50, time: 73.56 s, training_loss: 0.013
Epoch   41/50, time: 110.55 s, val_loss: 0.055
Training Metrics:
Accuracy: 0.9946
Precision: 0.9177
Recall: 0.7957
F1 Score: 0.8523
IoU: 0.7427
Dice Coefficient: 0.8523
Validation Metrics:
Accuracy: 0.9834
Precision: 0.5963
Recall: 0.4766
F1 Score: 0.5298
IoU: 0.3603
Dice Coefficient: 0.5298
Epoch   42/50, time: 69.07 s, training_loss: 0.013
Epoch   42/50, time: 106.84 s, val_loss: 0.058
Epoch   43/50, time: 72.32 s, training_loss: 0.013
Epoch   43/50, time: 109.93 s, val_loss: 0.057
Epoch   44/50, time: 74.21 s, training_loss: 0.012
Epoch   44/50, time: 112.87 s, val_loss: 0.061
Epoch   45/50, time: 72.26 s, training_loss: 0.013
Epoch   45/50, time: 110.04 s, val_loss: 0.055
Epoch   46/50, time: 74.35 s, training_loss: 0.012
Epoch   46/50, time: 112.17 s, val_loss: 0.059
Epoch   47/50, time: 74.84 s, training_loss: 0.012
Epoch   47/50, time: 112.73 s, val_loss: 0.064
Epoch   48/50, time: 72.33 s, training_loss: 0.012
Epoch   48/50, time: 109.38 s, val_loss: 0.060
Epoch   49/50, time: 72.96 s, training_loss: 0.012
Epoch   49/50, time: 110.88 s, val_loss: 0.062
Epoch   50/50, time: 74.86 s, training_loss: 0.011
Epoch   50/50, time: 112.26 s, val_loss: 0.062
Training Metrics:
Accuracy: 0.9953
Precision: 0.9332
Recall: 0.8182
F1 Score: 0.8719
IoU: 0.7730
Dice Coefficient: 0.8719
Validation Metrics:
Accuracy: 0.9837
Precision: 0.6037
Recall: 0.4831
F1 Score: 0.5367
IoU: 0.3668
Dice Coefficient: 0.5367
[I 2025-06-09 13:36:05,565] Trial 7 finished with value: 0.5366766108701646 and parameters: {'batch_size': 16, 'lr': 0.0009419373918505801, 'loss_fn': 'bce_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9837
Precision: 0.6037
Recall: 0.4831
F1 Score: 0.5367
IoU: 0.3668
Dice Coefficient: 0.5367
[Trial 7] Finished with val_loss=inf
[Trial 7] Finished with dice_coeff=0.5366766108701646
[Trial 8] Trying batch_size=32, lr=0.000447325517105373, loss_fn=bce_loss
Epoch    1/50, time: 71.56 s, training_loss: 0.520
Epoch    1/50, time: 109.49 s, val_loss: 0.380
Training Metrics:
Accuracy: 0.9801
Precision: 0.1574
Recall: 0.0055
F1 Score: 0.0106
IoU: 0.0053
Dice Coefficient: 0.0106
Validation Metrics:
Accuracy: 0.9802
Precision: 0.2075
Recall: 0.0038
F1 Score: 0.0074
IoU: 0.0037
Dice Coefficient: 0.0074
Epoch    2/50, time: 72.13 s, training_loss: 0.339
Epoch    2/50, time: 109.67 s, val_loss: 0.308
Epoch    3/50, time: 77.86 s, training_loss: 0.282
Epoch    3/50, time: 115.48 s, val_loss: 0.250
Epoch    4/50, time: 75.98 s, training_loss: 0.237
Epoch    4/50, time: 113.15 s, val_loss: 0.219
Epoch    5/50, time: 74.71 s, training_loss: 0.204
Epoch    5/50, time: 112.45 s, val_loss: 0.187
Epoch    6/50, time: 76.07 s, training_loss: 0.178
Epoch    6/50, time: 113.83 s, val_loss: 0.164
Epoch    7/50, time: 75.43 s, training_loss: 0.157
Epoch    7/50, time: 113.11 s, val_loss: 0.147
Epoch    8/50, time: 74.76 s, training_loss: 0.140
Epoch    8/50, time: 112.35 s, val_loss: 0.130
Epoch    9/50, time: 77.26 s, training_loss: 0.126
Epoch    9/50, time: 114.92 s, val_loss: 0.118
Epoch   10/50, time: 75.95 s, training_loss: 0.115
Epoch   10/50, time: 113.70 s, val_loss: 0.110
Epoch   11/50, time: 74.43 s, training_loss: 0.106
Epoch   11/50, time: 111.71 s, val_loss: 0.103
Training Metrics:
Accuracy: 0.9805
Precision: 0.1882
Recall: 0.0005
F1 Score: 0.0010
IoU: 0.0005
Dice Coefficient: 0.0010
Validation Metrics:
Accuracy: 0.9804
Precision: 0.2238
Recall: 0.0007
F1 Score: 0.0014
IoU: 0.0007
Dice Coefficient: 0.0014
Epoch   12/50, time: 74.03 s, training_loss: 0.099
Epoch   12/50, time: 110.16 s, val_loss: 0.096
Epoch   13/50, time: 77.60 s, training_loss: 0.093
Epoch   13/50, time: 115.65 s, val_loss: 0.091
Epoch   14/50, time: 76.97 s, training_loss: 0.087
Epoch   14/50, time: 114.91 s, val_loss: 0.085
Epoch   15/50, time: 76.13 s, training_loss: 0.083
Epoch   15/50, time: 114.00 s, val_loss: 0.090
Epoch   16/50, time: 75.83 s, training_loss: 0.081
Epoch   16/50, time: 113.85 s, val_loss: 0.078
Epoch   17/50, time: 75.41 s, training_loss: 0.077
Epoch   17/50, time: 112.95 s, val_loss: 0.076
Epoch   18/50, time: 78.53 s, training_loss: 0.074
Epoch   18/50, time: 116.81 s, val_loss: 0.077
Epoch   19/50, time: 77.72 s, training_loss: 0.072
Epoch   19/50, time: 115.91 s, val_loss: 0.072
Epoch   20/50, time: 84.59 s, training_loss: 0.069
Epoch   20/50, time: 122.13 s, val_loss: 0.070
Epoch   21/50, time: 75.20 s, training_loss: 0.066
Epoch   21/50, time: 113.00 s, val_loss: 0.067
Training Metrics:
Accuracy: 0.9805
Precision: 0.2619
Recall: 0.0015
F1 Score: 0.0030
IoU: 0.0015
Dice Coefficient: 0.0030
Validation Metrics:
Accuracy: 0.9804
Precision: 0.1989
Recall: 0.0007
F1 Score: 0.0015
IoU: 0.0007
Dice Coefficient: 0.0015
Epoch   22/50, time: 73.99 s, training_loss: 0.063
Epoch   22/50, time: 110.48 s, val_loss: 0.064
Epoch   23/50, time: 76.46 s, training_loss: 0.061
Epoch   23/50, time: 114.74 s, val_loss: 0.061
Epoch   24/50, time: 76.72 s, training_loss: 0.058
Epoch   24/50, time: 113.75 s, val_loss: 0.059
Epoch   25/50, time: 76.34 s, training_loss: 0.056
Epoch   25/50, time: 114.46 s, val_loss: 0.059
Epoch   26/50, time: 75.79 s, training_loss: 0.054
Epoch   26/50, time: 113.98 s, val_loss: 0.058
Epoch   27/50, time: 76.40 s, training_loss: 0.052
Epoch   27/50, time: 114.23 s, val_loss: 0.058
Epoch   28/50, time: 80.50 s, training_loss: 0.050
Epoch   28/50, time: 118.83 s, val_loss: 0.056
Epoch   29/50, time: 75.11 s, training_loss: 0.048
Epoch   29/50, time: 112.57 s, val_loss: 0.056
Epoch   30/50, time: 75.30 s, training_loss: 0.046
Epoch   30/50, time: 112.97 s, val_loss: 0.057
Epoch   31/50, time: 83.03 s, training_loss: 0.047
Epoch   31/50, time: 122.72 s, val_loss: 0.058
Training Metrics:
Accuracy: 0.9807
Precision: 0.5517
Recall: 0.0555
F1 Score: 0.1008
IoU: 0.0531
Dice Coefficient: 0.1008
Validation Metrics:
Accuracy: 0.9803
Precision: 0.4709
Recall: 0.0463
F1 Score: 0.0844
IoU: 0.0440
Dice Coefficient: 0.0844
Epoch   32/50, time: 74.24 s, training_loss: 0.047
Epoch   32/50, time: 110.55 s, val_loss: 0.055
Epoch   33/50, time: 79.13 s, training_loss: 0.042
Epoch   33/50, time: 116.36 s, val_loss: 0.055
Epoch   34/50, time: 78.45 s, training_loss: 0.040
Epoch   34/50, time: 116.44 s, val_loss: 0.055
Epoch   35/50, time: 75.68 s, training_loss: 0.038
Epoch   35/50, time: 112.86 s, val_loss: 0.055
Epoch   36/50, time: 79.09 s, training_loss: 0.036
Epoch   36/50, time: 117.04 s, val_loss: 0.055
Epoch   37/50, time: 74.90 s, training_loss: 0.034
Epoch   37/50, time: 113.13 s, val_loss: 0.056
Epoch   38/50, time: 81.56 s, training_loss: 0.032
Epoch   38/50, time: 119.99 s, val_loss: 0.055
Epoch   39/50, time: 81.67 s, training_loss: 0.031
Epoch   39/50, time: 119.35 s, val_loss: 0.057
Epoch   40/50, time: 75.63 s, training_loss: 0.029
Epoch   40/50, time: 113.04 s, val_loss: 0.055
Epoch   41/50, time: 79.85 s, training_loss: 0.028
Epoch   41/50, time: 116.89 s, val_loss: 0.056
Training Metrics:
Accuracy: 0.9892
Precision: 0.8563
Recall: 0.5378
F1 Score: 0.6607
IoU: 0.4933
Dice Coefficient: 0.6607
Validation Metrics:
Accuracy: 0.9811
Precision: 0.5362
Recall: 0.2694
F1 Score: 0.3586
IoU: 0.2185
Dice Coefficient: 0.3586
Epoch   42/50, time: 80.29 s, training_loss: 0.027
Epoch   42/50, time: 118.15 s, val_loss: 0.057
Epoch   43/50, time: 75.53 s, training_loss: 0.026
Epoch   43/50, time: 113.27 s, val_loss: 0.056
Epoch   44/50, time: 75.81 s, training_loss: 0.024
Epoch   44/50, time: 113.30 s, val_loss: 0.056
Epoch   45/50, time: 77.57 s, training_loss: 0.024
Epoch   45/50, time: 115.38 s, val_loss: 0.060
Epoch   46/50, time: 78.07 s, training_loss: 0.023
Epoch   46/50, time: 115.61 s, val_loss: 0.062
Epoch   47/50, time: 78.05 s, training_loss: 0.022
Epoch   47/50, time: 115.52 s, val_loss: 0.060
Epoch   48/50, time: 78.97 s, training_loss: 0.023
Epoch   48/50, time: 116.29 s, val_loss: 0.059
Epoch   49/50, time: 77.20 s, training_loss: 0.020
Epoch   49/50, time: 114.77 s, val_loss: 0.061
Epoch   50/50, time: 74.76 s, training_loss: 0.020
Epoch   50/50, time: 111.91 s, val_loss: 0.058
Training Metrics:
Accuracy: 0.9929
Precision: 0.9075
Recall: 0.7061
F1 Score: 0.7942
IoU: 0.6587
Dice Coefficient: 0.7942
Validation Metrics:
Accuracy: 0.9815
Precision: 0.5460
Recall: 0.3235
F1 Score: 0.4063
IoU: 0.2549
Dice Coefficient: 0.4063
[I 2025-06-09 15:25:29,891] Trial 8 finished with value: 0.4062760701961319 and parameters: {'batch_size': 32, 'lr': 0.000447325517105373, 'loss_fn': 'bce_loss'}. Best is trial 1 with value: 0.5432756004866984.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9815
Precision: 0.5460
Recall: 0.3235
F1 Score: 0.4063
IoU: 0.2549
Dice Coefficient: 0.4063
[Trial 8] Finished with val_loss=inf
[Trial 8] Finished with dice_coeff=0.4062760701961319
[Trial 9] Trying batch_size=64, lr=0.0006899239477086082, loss_fn=dice_loss
Epoch    1/50, time: 72.31 s, training_loss: 0.903
Epoch    1/50, time: 110.47 s, val_loss: 0.950
Training Metrics:
Accuracy: 0.9801
Precision: 0.1450
Recall: 0.0043
F1 Score: 0.0083
IoU: 0.0042
Dice Coefficient: 0.0083
Validation Metrics:
Accuracy: 0.9799
Precision: 0.1510
Recall: 0.0052
F1 Score: 0.0101
IoU: 0.0051
Dice Coefficient: 0.0101
Epoch    2/50, time: 76.43 s, training_loss: 0.858
Epoch    2/50, time: 114.20 s, val_loss: 0.897
Epoch    3/50, time: 76.14 s, training_loss: 0.832
Epoch    3/50, time: 114.01 s, val_loss: 0.830
Epoch    4/50, time: 76.38 s, training_loss: 0.810
Epoch    4/50, time: 113.65 s, val_loss: 0.805
Epoch    5/50, time: 77.04 s, training_loss: 0.786
Epoch    5/50, time: 114.80 s, val_loss: 0.803
Epoch    6/50, time: 78.08 s, training_loss: 0.768
Epoch    6/50, time: 116.23 s, val_loss: 0.766
Epoch    7/50, time: 75.95 s, training_loss: 0.756
Epoch    7/50, time: 113.64 s, val_loss: 0.763
Epoch    8/50, time: 78.13 s, training_loss: 0.739
Epoch    8/50, time: 116.08 s, val_loss: 0.745
Epoch    9/50, time: 76.57 s, training_loss: 0.723
Epoch    9/50, time: 114.47 s, val_loss: 0.731
Epoch   10/50, time: 77.29 s, training_loss: 0.711
Epoch   10/50, time: 114.87 s, val_loss: 0.739
Epoch   11/50, time: 77.34 s, training_loss: 0.690
Epoch   11/50, time: 115.55 s, val_loss: 0.682
Training Metrics:
Accuracy: 0.9509
Precision: 0.2372
Recall: 0.6860
F1 Score: 0.3525
IoU: 0.2140
Dice Coefficient: 0.3525
Validation Metrics:
Accuracy: 0.9498
Precision: 0.2301
Recall: 0.6648
F1 Score: 0.3418
IoU: 0.2062
Dice Coefficient: 0.3418
Epoch   12/50, time: 78.43 s, training_loss: 0.661
Epoch   12/50, time: 116.42 s, val_loss: 0.652
Epoch   13/50, time: 77.06 s, training_loss: 0.629
Epoch   13/50, time: 114.41 s, val_loss: 0.673
Epoch   14/50, time: 77.74 s, training_loss: 0.600
Epoch   14/50, time: 115.48 s, val_loss: 0.620
Epoch   15/50, time: 76.05 s, training_loss: 0.577
Epoch   15/50, time: 113.79 s, val_loss: 0.617
Epoch   16/50, time: 76.09 s, training_loss: 0.546
Epoch   16/50, time: 114.00 s, val_loss: 0.578
Epoch   17/50, time: 79.82 s, training_loss: 0.515
Epoch   17/50, time: 116.97 s, val_loss: 0.584
Epoch   18/50, time: 76.11 s, training_loss: 0.493
Epoch   18/50, time: 113.57 s, val_loss: 0.558
Epoch   19/50, time: 79.13 s, training_loss: 0.464
Epoch   19/50, time: 117.29 s, val_loss: 0.549
Epoch   20/50, time: 76.48 s, training_loss: 0.439
Epoch   20/50, time: 114.64 s, val_loss: 0.564
Epoch   21/50, time: 78.54 s, training_loss: 0.419
Epoch   21/50, time: 115.83 s, val_loss: 0.519
Training Metrics:
Accuracy: 0.9800
Precision: 0.4910
Recall: 0.7741
F1 Score: 0.6009
IoU: 0.4295
Dice Coefficient: 0.6009
Validation Metrics:
Accuracy: 0.9742
Precision: 0.4009
Recall: 0.6413
F1 Score: 0.4934
IoU: 0.3275
Dice Coefficient: 0.4934
Epoch   22/50, time: 75.29 s, training_loss: 0.391
Epoch   22/50, time: 112.96 s, val_loss: 0.539
Epoch   23/50, time: 77.28 s, training_loss: 0.379
Epoch   23/50, time: 115.51 s, val_loss: 0.531
Epoch   24/50, time: 76.41 s, training_loss: 0.364
Epoch   24/50, time: 114.07 s, val_loss: 0.519
Epoch   25/50, time: 78.52 s, training_loss: 0.345
Epoch   25/50, time: 116.62 s, val_loss: 0.497
Epoch   26/50, time: 77.88 s, training_loss: 0.335
Epoch   26/50, time: 115.82 s, val_loss: 0.504
Epoch   27/50, time: 76.47 s, training_loss: 0.321
Epoch   27/50, time: 114.43 s, val_loss: 0.505
Epoch   28/50, time: 76.80 s, training_loss: 0.302
Epoch   28/50, time: 114.43 s, val_loss: 0.513
Epoch   29/50, time: 78.99 s, training_loss: 0.294
Epoch   29/50, time: 116.93 s, val_loss: 0.517
Epoch   30/50, time: 76.12 s, training_loss: 0.289
Epoch   30/50, time: 113.57 s, val_loss: 0.506
Epoch   31/50, time: 78.59 s, training_loss: 0.289
Epoch   31/50, time: 116.46 s, val_loss: 0.488
Training Metrics:
Accuracy: 0.9882
Precision: 0.6639
Recall: 0.8012
F1 Score: 0.7261
IoU: 0.5700
Dice Coefficient: 0.7261
Validation Metrics:
Accuracy: 0.9794
Precision: 0.4799
Recall: 0.5831
F1 Score: 0.5265
IoU: 0.3573
Dice Coefficient: 0.5265
Epoch   32/50, time: 80.26 s, training_loss: 0.268
Epoch   32/50, time: 117.85 s, val_loss: 0.492
Epoch   33/50, time: 77.24 s, training_loss: 0.261
Epoch   33/50, time: 115.31 s, val_loss: 0.484
Epoch   34/50, time: 76.32 s, training_loss: 0.249
Epoch   34/50, time: 113.78 s, val_loss: 0.484
Epoch   35/50, time: 76.55 s, training_loss: 0.238
Epoch   35/50, time: 114.43 s, val_loss: 0.483
Epoch   36/50, time: 76.29 s, training_loss: 0.234
Epoch   36/50, time: 114.35 s, val_loss: 0.497
Epoch   37/50, time: 79.82 s, training_loss: 0.234
Epoch   37/50, time: 117.95 s, val_loss: 0.472
Epoch   38/50, time: 77.66 s, training_loss: 0.226
Epoch   38/50, time: 115.06 s, val_loss: 0.495
Epoch   39/50, time: 76.48 s, training_loss: 0.217
Epoch   39/50, time: 114.18 s, val_loss: 0.471
Epoch   40/50, time: 77.46 s, training_loss: 0.213
Epoch   40/50, time: 115.23 s, val_loss: 0.473
Epoch   41/50, time: 78.89 s, training_loss: 0.204
Epoch   41/50, time: 116.90 s, val_loss: 0.474
Training Metrics:
Accuracy: 0.9922
Precision: 0.7846
Recall: 0.8278
F1 Score: 0.8056
IoU: 0.6745
Dice Coefficient: 0.8056
Validation Metrics:
Accuracy: 0.9816
Precision: 0.5303
Recall: 0.5486
F1 Score: 0.5393
IoU: 0.3692
Dice Coefficient: 0.5393
Epoch   42/50, time: 75.40 s, training_loss: 0.197
Epoch   42/50, time: 113.39 s, val_loss: 0.479
Epoch   43/50, time: 76.44 s, training_loss: 0.196
Epoch   43/50, time: 114.32 s, val_loss: 0.478
Epoch   44/50, time: 76.99 s, training_loss: 0.194
Epoch   44/50, time: 114.80 s, val_loss: 0.474
Epoch   45/50, time: 78.08 s, training_loss: 0.185
Epoch   45/50, time: 115.81 s, val_loss: 0.480
Epoch   46/50, time: 78.68 s, training_loss: 0.192
Epoch   46/50, time: 118.79 s, val_loss: 0.485
Epoch   47/50, time: 76.22 s, training_loss: 0.184
Epoch   47/50, time: 114.12 s, val_loss: 0.475
Epoch   48/50, time: 76.69 s, training_loss: 0.181
Epoch   48/50, time: 114.84 s, val_loss: 0.487
Epoch   49/50, time: 76.34 s, training_loss: 0.176
Epoch   49/50, time: 113.53 s, val_loss: 0.486
Epoch   50/50, time: 78.34 s, training_loss: 0.174
Epoch   50/50, time: 115.61 s, val_loss: 0.473
Training Metrics:
Accuracy: 0.9934
Precision: 0.8188
Recall: 0.8501
F1 Score: 0.8342
IoU: 0.7155
Dice Coefficient: 0.8342
Validation Metrics:
Accuracy: 0.9821
Precision: 0.5428
Recall: 0.5474
F1 Score: 0.5451
IoU: 0.3747
Dice Coefficient: 0.5451
[I 2025-06-09 17:16:19,165] Trial 9 finished with value: 0.5451053503787879 and parameters: {'batch_size': 64, 'lr': 0.0006899239477086082, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9821
Precision: 0.5428
Recall: 0.5474
F1 Score: 0.5451
IoU: 0.3747
Dice Coefficient: 0.5451
[Trial 9] Finished with val_loss=inf
[Trial 9] Finished with dice_coeff=0.5451053503787879
[Trial 10] Trying batch_size=128, lr=0.0001971685743306795, loss_fn=dice_loss
Epoch    1/50, time: 87.97 s, training_loss: 0.929
Epoch    1/50, time: 126.07 s, val_loss: 0.961
Training Metrics:
Accuracy: 0.9805
Precision: 0.0407
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 86.33 s, training_loss: 0.909
Epoch    2/50, time: 124.55 s, val_loss: 0.955
Epoch    3/50, time: 86.55 s, training_loss: 0.900
Epoch    3/50, time: 124.20 s, val_loss: 0.940
Epoch    4/50, time: 87.51 s, training_loss: 0.892
Epoch    4/50, time: 124.87 s, val_loss: 0.909
Epoch    5/50, time: 86.39 s, training_loss: 0.886
Epoch    5/50, time: 124.75 s, val_loss: 0.900
Epoch    6/50, time: 87.47 s, training_loss: 0.880
Epoch    6/50, time: 124.91 s, val_loss: 0.890
Epoch    7/50, time: 86.19 s, training_loss: 0.876
Epoch    7/50, time: 123.92 s, val_loss: 0.877
Epoch    8/50, time: 85.67 s, training_loss: 0.871
Epoch    8/50, time: 123.09 s, val_loss: 0.882
Epoch    9/50, time: 85.46 s, training_loss: 0.867
Epoch    9/50, time: 123.27 s, val_loss: 0.868
Epoch   10/50, time: 86.75 s, training_loss: 0.865
Epoch   10/50, time: 124.52 s, val_loss: 0.870
Epoch   11/50, time: 87.19 s, training_loss: 0.861
Epoch   11/50, time: 125.24 s, val_loss: 0.872
Training Metrics:
Accuracy: 0.9032
Precision: 0.1601
Recall: 0.9359
F1 Score: 0.2734
IoU: 0.1584
Dice Coefficient: 0.2734
Validation Metrics:
Accuracy: 0.9021
Precision: 0.1573
Recall: 0.9179
F1 Score: 0.2686
IoU: 0.1551
Dice Coefficient: 0.2686
Epoch   12/50, time: 87.93 s, training_loss: 0.859
Epoch   12/50, time: 125.35 s, val_loss: 0.859
Epoch   13/50, time: 86.29 s, training_loss: 0.855
Epoch   13/50, time: 123.53 s, val_loss: 0.890
Epoch   14/50, time: 87.37 s, training_loss: 0.850
Epoch   14/50, time: 124.50 s, val_loss: 0.941
Epoch   15/50, time: 86.81 s, training_loss: 0.850
Epoch   15/50, time: 124.60 s, val_loss: 0.916
Epoch   16/50, time: 86.64 s, training_loss: 0.845
Epoch   16/50, time: 124.42 s, val_loss: 0.894
Epoch   17/50, time: 87.49 s, training_loss: 0.838
Epoch   17/50, time: 125.02 s, val_loss: 0.892
Epoch   18/50, time: 86.57 s, training_loss: 0.833
Epoch   18/50, time: 123.75 s, val_loss: 0.857
Epoch   19/50, time: 86.44 s, training_loss: 0.830
Epoch   19/50, time: 124.43 s, val_loss: 0.870
Epoch   20/50, time: 85.41 s, training_loss: 0.825
Epoch   20/50, time: 123.43 s, val_loss: 0.858
Epoch   21/50, time: 86.63 s, training_loss: 0.820
Epoch   21/50, time: 124.43 s, val_loss: 0.880
Training Metrics:
Accuracy: 0.6716
Precision: 0.0522
Recall: 0.9242
F1 Score: 0.0988
IoU: 0.0519
Dice Coefficient: 0.0988
Validation Metrics:
Accuracy: 0.6868
Precision: 0.0535
Recall: 0.8978
F1 Score: 0.1010
IoU: 0.0532
Dice Coefficient: 0.1010
Epoch   22/50, time: 85.81 s, training_loss: 0.814
Epoch   22/50, time: 123.71 s, val_loss: 0.840
Epoch   23/50, time: 87.35 s, training_loss: 0.811
Epoch   23/50, time: 124.69 s, val_loss: 0.846
Epoch   24/50, time: 87.42 s, training_loss: 0.805
Epoch   24/50, time: 125.03 s, val_loss: 0.828
Epoch   25/50, time: 86.72 s, training_loss: 0.801
Epoch   25/50, time: 124.20 s, val_loss: 0.851
Epoch   26/50, time: 86.86 s, training_loss: 0.796
Epoch   26/50, time: 125.01 s, val_loss: 0.816
Epoch   27/50, time: 87.19 s, training_loss: 0.791
Epoch   27/50, time: 125.19 s, val_loss: 0.802
Epoch   28/50, time: 87.33 s, training_loss: 0.781
Epoch   28/50, time: 124.89 s, val_loss: 0.806
Epoch   29/50, time: 84.61 s, training_loss: 0.775
Epoch   29/50, time: 122.52 s, val_loss: 0.799
Epoch   30/50, time: 86.23 s, training_loss: 0.766
Epoch   30/50, time: 123.88 s, val_loss: 0.811
Epoch   31/50, time: 86.88 s, training_loss: 0.762
Epoch   31/50, time: 124.94 s, val_loss: 0.786
Training Metrics:
Accuracy: 0.8051
Precision: 0.0857
Recall: 0.9318
F1 Score: 0.1570
IoU: 0.0852
Dice Coefficient: 0.1570
Validation Metrics:
Accuracy: 0.8366
Precision: 0.0951
Recall: 0.8615
F1 Score: 0.1713
IoU: 0.0937
Dice Coefficient: 0.1713
Epoch   32/50, time: 86.48 s, training_loss: 0.753
Epoch   32/50, time: 124.38 s, val_loss: 0.804
Epoch   33/50, time: 86.94 s, training_loss: 0.742
Epoch   33/50, time: 124.86 s, val_loss: 0.784
Epoch   34/50, time: 86.61 s, training_loss: 0.734
Epoch   34/50, time: 124.57 s, val_loss: 0.768
Epoch   35/50, time: 86.48 s, training_loss: 0.723
Epoch   35/50, time: 124.00 s, val_loss: 0.771
Epoch   36/50, time: 85.96 s, training_loss: 0.711
Epoch   36/50, time: 123.88 s, val_loss: 0.746
Epoch   37/50, time: 87.16 s, training_loss: 0.704
Epoch   37/50, time: 124.43 s, val_loss: 0.769
Epoch   38/50, time: 85.75 s, training_loss: 0.690
Epoch   38/50, time: 123.45 s, val_loss: 0.753
Epoch   39/50, time: 86.58 s, training_loss: 0.680
Epoch   39/50, time: 124.52 s, val_loss: 0.765
Epoch   40/50, time: 87.58 s, training_loss: 0.671
Epoch   40/50, time: 125.44 s, val_loss: 0.724
Epoch   41/50, time: 87.72 s, training_loss: 0.656
Epoch   41/50, time: 126.00 s, val_loss: 0.755
Training Metrics:
Accuracy: 0.7979
Precision: 0.0827
Recall: 0.9292
F1 Score: 0.1518
IoU: 0.0822
Dice Coefficient: 0.1518
Validation Metrics:
Accuracy: 0.8068
Precision: 0.0757
Recall: 0.7907
F1 Score: 0.1382
IoU: 0.0742
Dice Coefficient: 0.1382
Epoch   42/50, time: 87.20 s, training_loss: 0.643
Epoch   42/50, time: 125.28 s, val_loss: 0.721
Epoch   43/50, time: 86.74 s, training_loss: 0.631
Epoch   43/50, time: 124.56 s, val_loss: 0.745
Epoch   44/50, time: 87.88 s, training_loss: 0.614
Epoch   44/50, time: 125.66 s, val_loss: 0.711
Epoch   45/50, time: 86.08 s, training_loss: 0.603
Epoch   45/50, time: 123.59 s, val_loss: 0.725
Epoch   46/50, time: 87.54 s, training_loss: 0.590
Epoch   46/50, time: 124.94 s, val_loss: 0.724
Epoch   47/50, time: 87.91 s, training_loss: 0.561
Epoch   47/50, time: 125.22 s, val_loss: 0.713
Epoch   48/50, time: 86.14 s, training_loss: 0.566
Epoch   48/50, time: 124.38 s, val_loss: 0.698
Epoch   49/50, time: 87.02 s, training_loss: 0.551
Epoch   49/50, time: 124.55 s, val_loss: 0.733
Epoch   50/50, time: 86.53 s, training_loss: 0.542
Epoch   50/50, time: 124.55 s, val_loss: 0.695
Training Metrics:
Accuracy: 0.8250
Precision: 0.0922
Recall: 0.9034
F1 Score: 0.1674
IoU: 0.0913
Dice Coefficient: 0.1674
Validation Metrics:
Accuracy: 0.8663
Precision: 0.0922
Recall: 0.6583
F1 Score: 0.1618
IoU: 0.0880
Dice Coefficient: 0.1618
[I 2025-06-09 19:16:56,870] Trial 10 finished with value: 0.16178966014719043 and parameters: {'batch_size': 128, 'lr': 0.0001971685743306795, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.8663
Precision: 0.0922
Recall: 0.6583
F1 Score: 0.1618
IoU: 0.0880
Dice Coefficient: 0.1618
[Trial 10] Finished with val_loss=inf
[Trial 10] Finished with dice_coeff=0.16178966014719043
[Trial 11] Trying batch_size=32, lr=0.00024408380370462081, loss_fn=dice_loss
Epoch    1/50, time: 79.51 s, training_loss: 0.898
Epoch    1/50, time: 117.78 s, val_loss: 0.900
Training Metrics:
Accuracy: 0.9478
Precision: 0.1602
Recall: 0.3958
F1 Score: 0.2280
IoU: 0.1287
Dice Coefficient: 0.2280
Validation Metrics:
Accuracy: 0.9470
Precision: 0.1612
Recall: 0.4056
F1 Score: 0.2308
IoU: 0.1304
Dice Coefficient: 0.2308
Epoch    2/50, time: 78.29 s, training_loss: 0.861
Epoch    2/50, time: 116.38 s, val_loss: 0.855
Epoch    3/50, time: 79.47 s, training_loss: 0.839
Epoch    3/50, time: 117.51 s, val_loss: 0.835
Epoch    4/50, time: 78.29 s, training_loss: 0.821
Epoch    4/50, time: 116.39 s, val_loss: 0.811
Epoch    5/50, time: 75.55 s, training_loss: 0.804
Epoch    5/50, time: 113.78 s, val_loss: 0.795
Epoch    6/50, time: 76.98 s, training_loss: 0.787
Epoch    6/50, time: 114.54 s, val_loss: 0.779
Epoch    7/50, time: 77.24 s, training_loss: 0.772
Epoch    7/50, time: 114.96 s, val_loss: 0.767
Epoch    8/50, time: 75.70 s, training_loss: 0.755
Epoch    8/50, time: 113.71 s, val_loss: 0.758
Epoch    9/50, time: 74.57 s, training_loss: 0.736
Epoch    9/50, time: 112.11 s, val_loss: 0.728
Epoch   10/50, time: 78.42 s, training_loss: 0.713
Epoch   10/50, time: 116.45 s, val_loss: 0.705
Epoch   11/50, time: 76.12 s, training_loss: 0.693
Epoch   11/50, time: 113.54 s, val_loss: 0.703
Training Metrics:
Accuracy: 0.9443
Precision: 0.2429
Recall: 0.8778
F1 Score: 0.3805
IoU: 0.2349
Dice Coefficient: 0.3805
Validation Metrics:
Accuracy: 0.9418
Precision: 0.2280
Recall: 0.8250
F1 Score: 0.3572
IoU: 0.2175
Dice Coefficient: 0.3572
Epoch   12/50, time: 76.61 s, training_loss: 0.664
Epoch   12/50, time: 112.34 s, val_loss: 0.681
Epoch   13/50, time: 77.69 s, training_loss: 0.628
Epoch   13/50, time: 115.76 s, val_loss: 0.662
Epoch   14/50, time: 74.33 s, training_loss: 0.596
Epoch   14/50, time: 111.66 s, val_loss: 0.640
Epoch   15/50, time: 77.00 s, training_loss: 0.568
Epoch   15/50, time: 114.64 s, val_loss: 0.632
Epoch   16/50, time: 77.62 s, training_loss: 0.536
Epoch   16/50, time: 115.64 s, val_loss: 0.602
Epoch   17/50, time: 76.05 s, training_loss: 0.509
Epoch   17/50, time: 113.91 s, val_loss: 0.590
Epoch   18/50, time: 79.27 s, training_loss: 0.474
Epoch   18/50, time: 116.96 s, val_loss: 0.596
Epoch   19/50, time: 75.93 s, training_loss: 0.443
Epoch   19/50, time: 113.64 s, val_loss: 0.566
Epoch   20/50, time: 75.43 s, training_loss: 0.413
Epoch   20/50, time: 112.96 s, val_loss: 0.578
Epoch   21/50, time: 74.68 s, training_loss: 0.382
Epoch   21/50, time: 112.37 s, val_loss: 0.585
Training Metrics:
Accuracy: 0.9861
Precision: 0.6277
Recall: 0.6987
F1 Score: 0.6613
IoU: 0.4940
Dice Coefficient: 0.6613
Validation Metrics:
Accuracy: 0.9777
Precision: 0.4354
Recall: 0.4713
F1 Score: 0.4526
IoU: 0.2925
Dice Coefficient: 0.4526
Epoch   22/50, time: 73.10 s, training_loss: 0.363
Epoch   22/50, time: 111.12 s, val_loss: 0.562
Epoch   23/50, time: 78.21 s, training_loss: 0.334
Epoch   23/50, time: 115.50 s, val_loss: 0.546
Epoch   24/50, time: 74.40 s, training_loss: 0.316
Epoch   24/50, time: 112.33 s, val_loss: 0.562
Epoch   25/50, time: 76.40 s, training_loss: 0.300
Epoch   25/50, time: 114.03 s, val_loss: 0.542
Epoch   26/50, time: 78.26 s, training_loss: 0.283
Epoch   26/50, time: 115.66 s, val_loss: 0.528
Epoch   27/50, time: 74.68 s, training_loss: 0.271
Epoch   27/50, time: 112.43 s, val_loss: 0.525
Epoch   28/50, time: 75.01 s, training_loss: 0.253
Epoch   28/50, time: 113.23 s, val_loss: 0.546
Epoch   29/50, time: 78.20 s, training_loss: 0.258
Epoch   29/50, time: 116.39 s, val_loss: 0.559
Epoch   30/50, time: 80.47 s, training_loss: 0.240
Epoch   30/50, time: 117.79 s, val_loss: 0.551
Epoch   31/50, time: 77.92 s, training_loss: 0.229
Epoch   31/50, time: 115.51 s, val_loss: 0.527
Training Metrics:
Accuracy: 0.9915
Precision: 0.7601
Recall: 0.8196
F1 Score: 0.7887
IoU: 0.6512
Dice Coefficient: 0.7887
Validation Metrics:
Accuracy: 0.9793
Precision: 0.4732
Recall: 0.5026
F1 Score: 0.4874
IoU: 0.3222
Dice Coefficient: 0.4874
Epoch   32/50, time: 70.85 s, training_loss: 0.223
Epoch   32/50, time: 109.09 s, val_loss: 0.526
Epoch   33/50, time: 81.32 s, training_loss: 0.210
Epoch   33/50, time: 119.05 s, val_loss: 0.516
Epoch   34/50, time: 80.03 s, training_loss: 0.202
Epoch   34/50, time: 117.44 s, val_loss: 0.517
Epoch   35/50, time: 75.13 s, training_loss: 0.198
Epoch   35/50, time: 112.87 s, val_loss: 0.536
Epoch   36/50, time: 77.84 s, training_loss: 0.194
Epoch   36/50, time: 115.64 s, val_loss: 0.527
Epoch   37/50, time: 77.23 s, training_loss: 0.191
Epoch   37/50, time: 115.14 s, val_loss: 0.536
Epoch   38/50, time: 77.76 s, training_loss: 0.180
Epoch   38/50, time: 116.03 s, val_loss: 0.523
Epoch   39/50, time: 76.29 s, training_loss: 0.176
Epoch   39/50, time: 113.79 s, val_loss: 0.522
Epoch   40/50, time: 79.42 s, training_loss: 0.173
Epoch   40/50, time: 117.35 s, val_loss: 0.519
Epoch   41/50, time: 77.09 s, training_loss: 0.166
Epoch   41/50, time: 114.57 s, val_loss: 0.528
Training Metrics:
Accuracy: 0.9943
Precision: 0.8479
Recall: 0.8625
F1 Score: 0.8551
IoU: 0.7469
Dice Coefficient: 0.8551
Validation Metrics:
Accuracy: 0.9804
Precision: 0.4988
Recall: 0.4890
F1 Score: 0.4938
IoU: 0.3279
Dice Coefficient: 0.4938
Epoch   42/50, time: 71.19 s, training_loss: 0.164
Epoch   42/50, time: 109.10 s, val_loss: 0.517
Epoch   43/50, time: 75.75 s, training_loss: 0.157
Epoch   43/50, time: 113.82 s, val_loss: 0.526
Epoch   44/50, time: 74.52 s, training_loss: 0.155
Epoch   44/50, time: 112.30 s, val_loss: 0.523
Epoch   45/50, time: 78.07 s, training_loss: 0.153
Epoch   45/50, time: 116.30 s, val_loss: 0.523
Epoch   46/50, time: 76.68 s, training_loss: 0.148
Epoch   46/50, time: 114.41 s, val_loss: 0.526
Epoch   47/50, time: 77.75 s, training_loss: 0.144
Epoch   47/50, time: 115.89 s, val_loss: 0.506
Epoch   48/50, time: 75.60 s, training_loss: 0.143
Epoch   48/50, time: 113.91 s, val_loss: 0.517
Epoch   49/50, time: 77.84 s, training_loss: 0.139
Epoch   49/50, time: 116.32 s, val_loss: 0.520
Epoch   50/50, time: 77.41 s, training_loss: 0.139
Epoch   50/50, time: 115.50 s, val_loss: 0.528
Training Metrics:
Accuracy: 0.9947
Precision: 0.8554
Recall: 0.8766
F1 Score: 0.8659
IoU: 0.7635
Dice Coefficient: 0.8659
Validation Metrics:
Accuracy: 0.9804
Precision: 0.5009
Recall: 0.4868
F1 Score: 0.4937
IoU: 0.3278
Dice Coefficient: 0.4937
[I 2025-06-09 21:06:19,555] Trial 11 finished with value: 0.4937406743131019 and parameters: {'batch_size': 32, 'lr': 0.00024408380370462081, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9804
Precision: 0.5009
Recall: 0.4868
F1 Score: 0.4937
IoU: 0.3278
Dice Coefficient: 0.4937
[Trial 11] Finished with val_loss=inf
[Trial 11] Finished with dice_coeff=0.4937406743131019
[Trial 12] Trying batch_size=32, lr=0.0001252974757407615, loss_fn=dice_loss
Epoch    1/50, time: 71.68 s, training_loss: 0.910
Epoch    1/50, time: 109.55 s, val_loss: 0.935
Training Metrics:
Accuracy: 0.9586
Precision: 0.1556
Recall: 0.2548
F1 Score: 0.1932
IoU: 0.1070
Dice Coefficient: 0.1932
Validation Metrics:
Accuracy: 0.9597
Precision: 0.1607
Recall: 0.2497
F1 Score: 0.1956
IoU: 0.1084
Dice Coefficient: 0.1956
Epoch    2/50, time: 71.59 s, training_loss: 0.874
Epoch    2/50, time: 107.24 s, val_loss: 0.865
Epoch    3/50, time: 78.67 s, training_loss: 0.854
Epoch    3/50, time: 116.48 s, val_loss: 0.844
Epoch    4/50, time: 75.03 s, training_loss: 0.841
Epoch    4/50, time: 113.13 s, val_loss: 0.838
Epoch    5/50, time: 79.20 s, training_loss: 0.830
Epoch    5/50, time: 116.99 s, val_loss: 0.823
Epoch    6/50, time: 77.49 s, training_loss: 0.822
Epoch    6/50, time: 115.20 s, val_loss: 0.817
Epoch    7/50, time: 77.11 s, training_loss: 0.813
Epoch    7/50, time: 115.21 s, val_loss: 0.811
Epoch    8/50, time: 79.02 s, training_loss: 0.806
Epoch    8/50, time: 117.21 s, val_loss: 0.808
Epoch    9/50, time: 79.91 s, training_loss: 0.798
Epoch    9/50, time: 117.33 s, val_loss: 0.797
Epoch   10/50, time: 77.05 s, training_loss: 0.791
Epoch   10/50, time: 115.14 s, val_loss: 0.797
Epoch   11/50, time: 76.24 s, training_loss: 0.782
Epoch   11/50, time: 114.22 s, val_loss: 0.781
Training Metrics:
Accuracy: 0.9262
Precision: 0.1937
Recall: 0.8816
F1 Score: 0.3176
IoU: 0.1888
Dice Coefficient: 0.3176
Validation Metrics:
Accuracy: 0.9246
Precision: 0.1868
Recall: 0.8482
F1 Score: 0.3061
IoU: 0.1807
Dice Coefficient: 0.3061
Epoch   12/50, time: 75.97 s, training_loss: 0.773
Epoch   12/50, time: 113.71 s, val_loss: 0.772
Epoch   13/50, time: 74.88 s, training_loss: 0.764
Epoch   13/50, time: 113.06 s, val_loss: 0.779
Epoch   14/50, time: 79.03 s, training_loss: 0.755
Epoch   14/50, time: 116.53 s, val_loss: 0.755
Epoch   15/50, time: 75.81 s, training_loss: 0.743
Epoch   15/50, time: 113.61 s, val_loss: 0.749
Epoch   16/50, time: 76.37 s, training_loss: 0.731
Epoch   16/50, time: 113.96 s, val_loss: 0.737
Epoch   17/50, time: 75.50 s, training_loss: 0.719
Epoch   17/50, time: 113.47 s, val_loss: 0.741
Epoch   18/50, time: 79.63 s, training_loss: 0.707
Epoch   18/50, time: 116.89 s, val_loss: 0.723
Epoch   19/50, time: 76.23 s, training_loss: 0.697
Epoch   19/50, time: 113.96 s, val_loss: 0.729
Epoch   20/50, time: 75.48 s, training_loss: 0.682
Epoch   20/50, time: 112.51 s, val_loss: 0.726
Epoch   21/50, time: 77.45 s, training_loss: 0.668
Epoch   21/50, time: 114.92 s, val_loss: 0.707
Training Metrics:
Accuracy: 0.9561
Precision: 0.2888
Recall: 0.8588
F1 Score: 0.4322
IoU: 0.2757
Dice Coefficient: 0.4322
Validation Metrics:
Accuracy: 0.9521
Precision: 0.2513
Recall: 0.7300
F1 Score: 0.3739
IoU: 0.2299
Dice Coefficient: 0.3739
Epoch   22/50, time: 71.69 s, training_loss: 0.655
Epoch   22/50, time: 107.62 s, val_loss: 0.705
Epoch   23/50, time: 75.82 s, training_loss: 0.641
Epoch   23/50, time: 113.63 s, val_loss: 0.691
Epoch   24/50, time: 75.49 s, training_loss: 0.620
Epoch   24/50, time: 113.13 s, val_loss: 0.677
Epoch   25/50, time: 77.05 s, training_loss: 0.600
Epoch   25/50, time: 114.24 s, val_loss: 0.668
Epoch   26/50, time: 75.61 s, training_loss: 0.584
Epoch   26/50, time: 113.48 s, val_loss: 0.668
Epoch   27/50, time: 76.46 s, training_loss: 0.563
Epoch   27/50, time: 114.57 s, val_loss: 0.681
Epoch   28/50, time: 76.90 s, training_loss: 0.536
Epoch   28/50, time: 115.14 s, val_loss: 0.635
Epoch   29/50, time: 76.72 s, training_loss: 0.513
Epoch   29/50, time: 114.55 s, val_loss: 0.654
Epoch   30/50, time: 75.59 s, training_loss: 0.494
Epoch   30/50, time: 113.60 s, val_loss: 0.652
Epoch   31/50, time: 74.87 s, training_loss: 0.468
Epoch   31/50, time: 112.89 s, val_loss: 0.623
Training Metrics:
Accuracy: 0.9818
Precision: 0.5197
Recall: 0.8702
F1 Score: 0.6508
IoU: 0.4823
Dice Coefficient: 0.6508
Validation Metrics:
Accuracy: 0.9706
Precision: 0.3505
Recall: 0.5885
F1 Score: 0.4393
IoU: 0.2815
Dice Coefficient: 0.4393
Epoch   32/50, time: 74.67 s, training_loss: 0.442
Epoch   32/50, time: 110.37 s, val_loss: 0.615
Epoch   33/50, time: 75.59 s, training_loss: 0.419
Epoch   33/50, time: 113.59 s, val_loss: 0.636
Epoch   34/50, time: 74.33 s, training_loss: 0.394
Epoch   34/50, time: 112.09 s, val_loss: 0.616
Epoch   35/50, time: 78.29 s, training_loss: 0.371
Epoch   35/50, time: 115.55 s, val_loss: 0.614
Epoch   36/50, time: 77.46 s, training_loss: 0.349
Epoch   36/50, time: 115.21 s, val_loss: 0.608
Epoch   37/50, time: 75.12 s, training_loss: 0.331
Epoch   37/50, time: 113.05 s, val_loss: 0.585
Epoch   38/50, time: 76.55 s, training_loss: 0.315
Epoch   38/50, time: 114.81 s, val_loss: 0.614
Epoch   39/50, time: 79.03 s, training_loss: 0.300
Epoch   39/50, time: 117.26 s, val_loss: 0.587
Epoch   40/50, time: 74.90 s, training_loss: 0.285
Epoch   40/50, time: 112.77 s, val_loss: 0.582
Epoch   41/50, time: 78.43 s, training_loss: 0.275
Epoch   41/50, time: 116.44 s, val_loss: 0.586
Training Metrics:
Accuracy: 0.9918
Precision: 0.7512
Recall: 0.8671
F1 Score: 0.8050
IoU: 0.6736
Dice Coefficient: 0.8050
Validation Metrics:
Accuracy: 0.9773
Precision: 0.4283
Recall: 0.4720
F1 Score: 0.4491
IoU: 0.2896
Dice Coefficient: 0.4491
Epoch   42/50, time: 72.10 s, training_loss: 0.259
Epoch   42/50, time: 107.82 s, val_loss: 0.602
Epoch   43/50, time: 76.61 s, training_loss: 0.246
Epoch   43/50, time: 114.20 s, val_loss: 0.587
Epoch   44/50, time: 77.90 s, training_loss: 0.237
Epoch   44/50, time: 115.72 s, val_loss: 0.608
Epoch   45/50, time: 76.43 s, training_loss: 0.228
Epoch   45/50, time: 114.50 s, val_loss: 0.585
Epoch   46/50, time: 75.98 s, training_loss: 0.217
Epoch   46/50, time: 113.76 s, val_loss: 0.589
Epoch   47/50, time: 78.91 s, training_loss: 0.209
Epoch   47/50, time: 116.81 s, val_loss: 0.578
Epoch   48/50, time: 77.45 s, training_loss: 0.202
Epoch   48/50, time: 114.78 s, val_loss: 0.598
Epoch   49/50, time: 77.01 s, training_loss: 0.197
Epoch   49/50, time: 114.99 s, val_loss: 0.595
Epoch   50/50, time: 77.03 s, training_loss: 0.191
Epoch   50/50, time: 114.95 s, val_loss: 0.569
Training Metrics:
Accuracy: 0.9942
Precision: 0.8221
Recall: 0.8953
F1 Score: 0.8571
IoU: 0.7500
Dice Coefficient: 0.8571
Validation Metrics:
Accuracy: 0.9784
Precision: 0.4498
Recall: 0.4618
F1 Score: 0.4557
IoU: 0.2951
Dice Coefficient: 0.4557
[I 2025-06-09 22:55:22,519] Trial 12 finished with value: 0.45574372481272696 and parameters: {'batch_size': 32, 'lr': 0.0001252974757407615, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9784
Precision: 0.4498
Recall: 0.4618
F1 Score: 0.4557
IoU: 0.2951
Dice Coefficient: 0.4557
[Trial 12] Finished with val_loss=inf
[Trial 12] Finished with dice_coeff=0.45574372481272696
[Trial 13] Trying batch_size=64, lr=0.0006114656900487721, loss_fn=dice_loss
Epoch    1/50, time: 79.77 s, training_loss: 0.890
Epoch    1/50, time: 118.09 s, val_loss: 0.953
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0133
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 79.21 s, training_loss: 0.855
Epoch    2/50, time: 117.58 s, val_loss: 0.924
Epoch    3/50, time: 78.31 s, training_loss: 0.833
Epoch    3/50, time: 115.72 s, val_loss: 0.840
Epoch    4/50, time: 78.32 s, training_loss: 0.814
Epoch    4/50, time: 116.45 s, val_loss: 0.808
Epoch    5/50, time: 77.88 s, training_loss: 0.797
Epoch    5/50, time: 116.08 s, val_loss: 0.796
Epoch    6/50, time: 79.35 s, training_loss: 0.781
Epoch    6/50, time: 117.70 s, val_loss: 0.779
Epoch    7/50, time: 81.20 s, training_loss: 0.768
Epoch    7/50, time: 119.06 s, val_loss: 0.789
Epoch    8/50, time: 80.29 s, training_loss: 0.754
Epoch    8/50, time: 118.67 s, val_loss: 0.768
Epoch    9/50, time: 79.47 s, training_loss: 0.739
Epoch    9/50, time: 117.35 s, val_loss: 0.733
Epoch   10/50, time: 79.39 s, training_loss: 0.723
Epoch   10/50, time: 117.48 s, val_loss: 0.740
Epoch   11/50, time: 76.45 s, training_loss: 0.706
Epoch   11/50, time: 114.26 s, val_loss: 0.700
Training Metrics:
Accuracy: 0.9426
Precision: 0.2217
Recall: 0.7771
F1 Score: 0.3450
IoU: 0.2085
Dice Coefficient: 0.3450
Validation Metrics:
Accuracy: 0.9418
Precision: 0.2153
Recall: 0.7458
F1 Score: 0.3342
IoU: 0.2006
Dice Coefficient: 0.3342
Epoch   12/50, time: 76.28 s, training_loss: 0.687
Epoch   12/50, time: 113.68 s, val_loss: 0.690
Epoch   13/50, time: 76.50 s, training_loss: 0.664
Epoch   13/50, time: 113.69 s, val_loss: 0.669
Epoch   14/50, time: 79.90 s, training_loss: 0.636
Epoch   14/50, time: 118.13 s, val_loss: 0.643
Epoch   15/50, time: 77.94 s, training_loss: 0.608
Epoch   15/50, time: 115.76 s, val_loss: 0.637
Epoch   16/50, time: 76.73 s, training_loss: 0.576
Epoch   16/50, time: 114.31 s, val_loss: 0.636
Epoch   17/50, time: 77.45 s, training_loss: 0.546
Epoch   17/50, time: 115.87 s, val_loss: 0.600
Epoch   18/50, time: 77.39 s, training_loss: 0.523
Epoch   18/50, time: 115.31 s, val_loss: 0.597
Epoch   19/50, time: 79.56 s, training_loss: 0.509
Epoch   19/50, time: 117.51 s, val_loss: 0.588
Epoch   20/50, time: 76.75 s, training_loss: 0.483
Epoch   20/50, time: 114.97 s, val_loss: 0.578
Epoch   21/50, time: 77.79 s, training_loss: 0.461
Epoch   21/50, time: 116.17 s, val_loss: 0.574
Training Metrics:
Accuracy: 0.9802
Precision: 0.4930
Recall: 0.6424
F1 Score: 0.5579
IoU: 0.3869
Dice Coefficient: 0.5579
Validation Metrics:
Accuracy: 0.9756
Precision: 0.4034
Recall: 0.5160
F1 Score: 0.4528
IoU: 0.2927
Dice Coefficient: 0.4528
Epoch   22/50, time: 78.75 s, training_loss: 0.437
Epoch   22/50, time: 116.33 s, val_loss: 0.581
Epoch   23/50, time: 76.83 s, training_loss: 0.416
Epoch   23/50, time: 114.61 s, val_loss: 0.548
Epoch   24/50, time: 75.82 s, training_loss: 0.394
Epoch   24/50, time: 113.69 s, val_loss: 0.540
Epoch   25/50, time: 80.12 s, training_loss: 0.375
Epoch   25/50, time: 118.26 s, val_loss: 0.542
Epoch   26/50, time: 76.52 s, training_loss: 0.360
Epoch   26/50, time: 114.46 s, val_loss: 0.525
Epoch   27/50, time: 80.57 s, training_loss: 0.333
Epoch   27/50, time: 118.21 s, val_loss: 0.514
Epoch   28/50, time: 77.61 s, training_loss: 0.327
Epoch   28/50, time: 116.11 s, val_loss: 0.517
Epoch   29/50, time: 76.47 s, training_loss: 0.313
Epoch   29/50, time: 114.79 s, val_loss: 0.532
Epoch   30/50, time: 78.75 s, training_loss: 0.293
Epoch   30/50, time: 116.30 s, val_loss: 0.526
Epoch   31/50, time: 78.47 s, training_loss: 0.283
Epoch   31/50, time: 116.32 s, val_loss: 0.512
Training Metrics:
Accuracy: 0.9884
Precision: 0.6746
Recall: 0.7817
F1 Score: 0.7242
IoU: 0.5676
Dice Coefficient: 0.7242
Validation Metrics:
Accuracy: 0.9791
Precision: 0.4718
Recall: 0.5468
F1 Score: 0.5066
IoU: 0.3392
Dice Coefficient: 0.5066
Epoch   32/50, time: 77.38 s, training_loss: 0.271
Epoch   32/50, time: 115.08 s, val_loss: 0.508
Epoch   33/50, time: 80.44 s, training_loss: 0.267
Epoch   33/50, time: 118.19 s, val_loss: 0.540
Epoch   34/50, time: 76.17 s, training_loss: 0.253
Epoch   34/50, time: 114.07 s, val_loss: 0.519
Epoch   35/50, time: 78.47 s, training_loss: 0.240
Epoch   35/50, time: 116.30 s, val_loss: 0.497
Epoch   36/50, time: 77.19 s, training_loss: 0.228
Epoch   36/50, time: 115.40 s, val_loss: 0.499
Epoch   37/50, time: 77.88 s, training_loss: 0.227
Epoch   37/50, time: 115.48 s, val_loss: 0.518
Epoch   38/50, time: 76.22 s, training_loss: 0.232
Epoch   38/50, time: 114.09 s, val_loss: 0.517
Epoch   39/50, time: 77.02 s, training_loss: 0.228
Epoch   39/50, time: 115.07 s, val_loss: 0.520
Epoch   40/50, time: 80.56 s, training_loss: 0.219
Epoch   40/50, time: 118.14 s, val_loss: 0.506
Epoch   41/50, time: 78.75 s, training_loss: 0.204
Epoch   41/50, time: 116.71 s, val_loss: 0.498
Training Metrics:
Accuracy: 0.9925
Precision: 0.7922
Recall: 0.8325
F1 Score: 0.8118
IoU: 0.6833
Dice Coefficient: 0.8118
Validation Metrics:
Accuracy: 0.9807
Precision: 0.5086
Recall: 0.5185
F1 Score: 0.5135
IoU: 0.3454
Dice Coefficient: 0.5135
Epoch   42/50, time: 77.22 s, training_loss: 0.193
Epoch   42/50, time: 115.16 s, val_loss: 0.503
Epoch   43/50, time: 78.05 s, training_loss: 0.186
Epoch   43/50, time: 116.36 s, val_loss: 0.515
Epoch   44/50, time: 77.20 s, training_loss: 0.185
Epoch   44/50, time: 115.48 s, val_loss: 0.502
Epoch   45/50, time: 78.53 s, training_loss: 0.183
Epoch   45/50, time: 116.51 s, val_loss: 0.496
Epoch   46/50, time: 76.33 s, training_loss: 0.182
Epoch   46/50, time: 114.51 s, val_loss: 0.515
Epoch   47/50, time: 76.46 s, training_loss: 0.184
Epoch   47/50, time: 114.28 s, val_loss: 0.507
Epoch   48/50, time: 76.83 s, training_loss: 0.180
Epoch   48/50, time: 114.99 s, val_loss: 0.498
Epoch   49/50, time: 79.75 s, training_loss: 0.174
Epoch   49/50, time: 118.16 s, val_loss: 0.505
Epoch   50/50, time: 81.45 s, training_loss: 0.172
Epoch   50/50, time: 119.55 s, val_loss: 0.504
Training Metrics:
Accuracy: 0.9932
Precision: 0.8120
Recall: 0.8445
F1 Score: 0.8279
IoU: 0.7064
Dice Coefficient: 0.8279
Validation Metrics:
Accuracy: 0.9812
Precision: 0.5205
Recall: 0.5122
F1 Score: 0.5163
IoU: 0.3480
Dice Coefficient: 0.5163
[I 2025-06-10 00:47:19,383] Trial 13 finished with value: 0.5162768959752656 and parameters: {'batch_size': 64, 'lr': 0.0006114656900487721, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9812
Precision: 0.5205
Recall: 0.5122
F1 Score: 0.5163
IoU: 0.3480
Dice Coefficient: 0.5163
[Trial 13] Finished with val_loss=inf
[Trial 13] Finished with dice_coeff=0.5162768959752656
[Trial 14] Trying batch_size=32, lr=0.0002915494816154933, loss_fn=dice_loss
Epoch    1/50, time: 78.41 s, training_loss: 0.884
Epoch    1/50, time: 116.28 s, val_loss: 0.918
Training Metrics:
Accuracy: 0.9641
Precision: 0.1590
Recall: 0.1963
F1 Score: 0.1757
IoU: 0.0963
Dice Coefficient: 0.1757
Validation Metrics:
Accuracy: 0.9634
Precision: 0.1624
Recall: 0.2083
F1 Score: 0.1825
IoU: 0.1004
Dice Coefficient: 0.1825
Epoch    2/50, time: 73.27 s, training_loss: 0.832
Epoch    2/50, time: 110.79 s, val_loss: 0.816
Epoch    3/50, time: 76.30 s, training_loss: 0.805
Epoch    3/50, time: 114.00 s, val_loss: 0.794
Epoch    4/50, time: 77.54 s, training_loss: 0.786
Epoch    4/50, time: 115.15 s, val_loss: 0.776
Epoch    5/50, time: 75.03 s, training_loss: 0.769
Epoch    5/50, time: 112.49 s, val_loss: 0.763
Epoch    6/50, time: 75.07 s, training_loss: 0.751
Epoch    6/50, time: 116.19 s, val_loss: 0.742
Epoch    7/50, time: 77.87 s, training_loss: 0.733
Epoch    7/50, time: 116.34 s, val_loss: 0.734
Epoch    8/50, time: 81.01 s, training_loss: 0.709
Epoch    8/50, time: 118.77 s, val_loss: 0.704
Epoch    9/50, time: 79.16 s, training_loss: 0.684
Epoch    9/50, time: 116.47 s, val_loss: 0.690
Epoch   10/50, time: 75.41 s, training_loss: 0.656
Epoch   10/50, time: 113.20 s, val_loss: 0.664
Epoch   11/50, time: 76.23 s, training_loss: 0.620
Epoch   11/50, time: 113.52 s, val_loss: 0.648
Training Metrics:
Accuracy: 0.9655
Precision: 0.3239
Recall: 0.7096
F1 Score: 0.4448
IoU: 0.2860
Dice Coefficient: 0.4448
Validation Metrics:
Accuracy: 0.9630
Precision: 0.2983
Recall: 0.6584
F1 Score: 0.4105
IoU: 0.2583
Dice Coefficient: 0.4105
Epoch   12/50, time: 78.06 s, training_loss: 0.591
Epoch   12/50, time: 115.93 s, val_loss: 0.625
Epoch   13/50, time: 75.48 s, training_loss: 0.556
Epoch   13/50, time: 112.73 s, val_loss: 0.616
Epoch   14/50, time: 76.00 s, training_loss: 0.525
Epoch   14/50, time: 113.95 s, val_loss: 0.608
Epoch   15/50, time: 74.80 s, training_loss: 0.498
Epoch   15/50, time: 112.59 s, val_loss: 0.624
Epoch   16/50, time: 75.66 s, training_loss: 0.468
Epoch   16/50, time: 112.91 s, val_loss: 0.571
Epoch   17/50, time: 75.17 s, training_loss: 0.430
Epoch   17/50, time: 112.66 s, val_loss: 0.555
Epoch   18/50, time: 74.66 s, training_loss: 0.403
Epoch   18/50, time: 112.51 s, val_loss: 0.533
Epoch   19/50, time: 74.67 s, training_loss: 0.378
Epoch   19/50, time: 112.51 s, val_loss: 0.537
Epoch   20/50, time: 77.93 s, training_loss: 0.355
Epoch   20/50, time: 115.47 s, val_loss: 0.517
Epoch   21/50, time: 74.94 s, training_loss: 0.331
Epoch   21/50, time: 112.80 s, val_loss: 0.519
Training Metrics:
Accuracy: 0.9873
Precision: 0.6467
Recall: 0.7719
F1 Score: 0.7038
IoU: 0.5430
Dice Coefficient: 0.7038
Validation Metrics:
Accuracy: 0.9782
Precision: 0.4537
Recall: 0.5525
F1 Score: 0.4983
IoU: 0.3318
Dice Coefficient: 0.4983
Epoch   22/50, time: 74.60 s, training_loss: 0.313
Epoch   22/50, time: 112.52 s, val_loss: 0.523
Epoch   23/50, time: 77.73 s, training_loss: 0.297
Epoch   23/50, time: 115.26 s, val_loss: 0.535
Epoch   24/50, time: 76.29 s, training_loss: 0.286
Epoch   24/50, time: 114.07 s, val_loss: 0.519
Epoch   25/50, time: 75.51 s, training_loss: 0.270
Epoch   25/50, time: 113.29 s, val_loss: 0.521
Epoch   26/50, time: 80.79 s, training_loss: 0.260
Epoch   26/50, time: 118.71 s, val_loss: 0.527
Epoch   27/50, time: 76.95 s, training_loss: 0.252
Epoch   27/50, time: 114.06 s, val_loss: 0.515
Epoch   28/50, time: 78.06 s, training_loss: 0.241
Epoch   28/50, time: 115.45 s, val_loss: 0.514
Epoch   29/50, time: 78.24 s, training_loss: 0.229
Epoch   29/50, time: 116.27 s, val_loss: 0.504
Epoch   30/50, time: 74.71 s, training_loss: 0.218
Epoch   30/50, time: 112.37 s, val_loss: 0.506
Epoch   31/50, time: 75.95 s, training_loss: 0.213
Epoch   31/50, time: 113.08 s, val_loss: 0.507
Training Metrics:
Accuracy: 0.9923
Precision: 0.7993
Recall: 0.8093
F1 Score: 0.8043
IoU: 0.6727
Dice Coefficient: 0.8043
Validation Metrics:
Accuracy: 0.9807
Precision: 0.5082
Recall: 0.5060
F1 Score: 0.5071
IoU: 0.3396
Dice Coefficient: 0.5071
Epoch   32/50, time: 73.48 s, training_loss: 0.202
Epoch   32/50, time: 110.85 s, val_loss: 0.502
Epoch   33/50, time: 76.84 s, training_loss: 0.199
Epoch   33/50, time: 114.66 s, val_loss: 0.500
Epoch   34/50, time: 78.42 s, training_loss: 0.195
Epoch   34/50, time: 116.14 s, val_loss: 0.505
Epoch   35/50, time: 75.83 s, training_loss: 0.189
Epoch   35/50, time: 113.88 s, val_loss: 0.495
Epoch   36/50, time: 77.18 s, training_loss: 0.183
Epoch   36/50, time: 115.23 s, val_loss: 0.501
Epoch   37/50, time: 76.96 s, training_loss: 0.175
Epoch   37/50, time: 115.02 s, val_loss: 0.508
Epoch   38/50, time: 74.79 s, training_loss: 0.172
Epoch   38/50, time: 112.56 s, val_loss: 0.497
Epoch   39/50, time: 75.89 s, training_loss: 0.179
Epoch   39/50, time: 114.21 s, val_loss: 0.507
Epoch   40/50, time: 75.80 s, training_loss: 0.174
Epoch   40/50, time: 113.63 s, val_loss: 0.496
Epoch   41/50, time: 74.45 s, training_loss: 0.168
Epoch   41/50, time: 112.49 s, val_loss: 0.501
Training Metrics:
Accuracy: 0.9936
Precision: 0.8241
Recall: 0.8554
F1 Score: 0.8395
IoU: 0.7233
Dice Coefficient: 0.8395
Validation Metrics:
Accuracy: 0.9809
Precision: 0.5120
Recall: 0.5150
F1 Score: 0.5135
IoU: 0.3455
Dice Coefficient: 0.5135
Epoch   42/50, time: 72.59 s, training_loss: 0.164
Epoch   42/50, time: 108.79 s, val_loss: 0.508
Epoch   43/50, time: 81.21 s, training_loss: 0.159
Epoch   43/50, time: 118.45 s, val_loss: 0.500
Epoch   44/50, time: 75.09 s, training_loss: 0.156
Epoch   44/50, time: 112.36 s, val_loss: 0.493
Epoch   45/50, time: 75.24 s, training_loss: 0.151
Epoch   45/50, time: 112.99 s, val_loss: 0.501
Epoch   46/50, time: 76.53 s, training_loss: 0.149
Epoch   46/50, time: 114.36 s, val_loss: 0.503
Epoch   47/50, time: 77.38 s, training_loss: 0.152
Epoch   47/50, time: 114.59 s, val_loss: 0.503
Epoch   48/50, time: 75.52 s, training_loss: 0.146
Epoch   48/50, time: 113.60 s, val_loss: 0.500
Epoch   49/50, time: 75.04 s, training_loss: 0.143
Epoch   49/50, time: 112.77 s, val_loss: 0.497
Epoch   50/50, time: 75.52 s, training_loss: 0.142
Epoch   50/50, time: 113.51 s, val_loss: 0.503
Training Metrics:
Accuracy: 0.9947
Precision: 0.8643
Recall: 0.8656
F1 Score: 0.8650
IoU: 0.7620
Dice Coefficient: 0.8650
Validation Metrics:
Accuracy: 0.9816
Precision: 0.5328
Recall: 0.4899
F1 Score: 0.5105
IoU: 0.3427
Dice Coefficient: 0.5105
[I 2025-06-10 02:36:26,882] Trial 14 finished with value: 0.5104763556247803 and parameters: {'batch_size': 32, 'lr': 0.0002915494816154933, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9816
Precision: 0.5328
Recall: 0.4899
F1 Score: 0.5105
IoU: 0.3427
Dice Coefficient: 0.5105
[Trial 14] Finished with val_loss=inf
[Trial 14] Finished with dice_coeff=0.5104763556247803
[Trial 15] Trying batch_size=64, lr=0.0006458239175850222, loss_fn=dice_loss
Epoch    1/50, time: 77.13 s, training_loss: 0.900
Epoch    1/50, time: 115.25 s, val_loss: 0.955
Training Metrics:
Accuracy: 0.9789
Precision: 0.1474
Recall: 0.0178
F1 Score: 0.0317
IoU: 0.0161
Dice Coefficient: 0.0317
Validation Metrics:
Accuracy: 0.9789
Precision: 0.1443
Recall: 0.0154
F1 Score: 0.0278
IoU: 0.0141
Dice Coefficient: 0.0278
Epoch    2/50, time: 76.76 s, training_loss: 0.868
Epoch    2/50, time: 114.60 s, val_loss: 0.882
Epoch    3/50, time: 80.49 s, training_loss: 0.845
Epoch    3/50, time: 118.44 s, val_loss: 0.842
Epoch    4/50, time: 77.76 s, training_loss: 0.823
Epoch    4/50, time: 115.30 s, val_loss: 0.821
Epoch    5/50, time: 77.98 s, training_loss: 0.803
Epoch    5/50, time: 115.91 s, val_loss: 0.799
Epoch    6/50, time: 76.98 s, training_loss: 0.783
Epoch    6/50, time: 114.41 s, val_loss: 0.799
Epoch    7/50, time: 77.56 s, training_loss: 0.763
Epoch    7/50, time: 115.14 s, val_loss: 0.768
Epoch    8/50, time: 76.45 s, training_loss: 0.749
Epoch    8/50, time: 114.29 s, val_loss: 0.744
Epoch    9/50, time: 76.49 s, training_loss: 0.733
Epoch    9/50, time: 114.34 s, val_loss: 0.736
Epoch   10/50, time: 76.75 s, training_loss: 0.712
Epoch   10/50, time: 114.25 s, val_loss: 0.713
Epoch   11/50, time: 78.37 s, training_loss: 0.688
Epoch   11/50, time: 116.17 s, val_loss: 0.698
Training Metrics:
Accuracy: 0.9470
Precision: 0.2327
Recall: 0.7488
F1 Score: 0.3551
IoU: 0.2159
Dice Coefficient: 0.3551
Validation Metrics:
Accuracy: 0.9455
Precision: 0.2264
Recall: 0.7369
F1 Score: 0.3464
IoU: 0.2095
Dice Coefficient: 0.3464
Epoch   12/50, time: 76.60 s, training_loss: 0.657
Epoch   12/50, time: 115.10 s, val_loss: 0.653
Epoch   13/50, time: 80.48 s, training_loss: 0.621
Epoch   13/50, time: 118.82 s, val_loss: 0.637
Epoch   14/50, time: 80.44 s, training_loss: 0.590
Epoch   14/50, time: 118.61 s, val_loss: 0.629
Epoch   15/50, time: 75.94 s, training_loss: 0.559
Epoch   15/50, time: 114.13 s, val_loss: 0.599
Epoch   16/50, time: 76.24 s, training_loss: 0.540
Epoch   16/50, time: 114.42 s, val_loss: 0.610
Epoch   17/50, time: 76.57 s, training_loss: 0.511
Epoch   17/50, time: 114.46 s, val_loss: 0.576
Epoch   18/50, time: 81.21 s, training_loss: 0.500
Epoch   18/50, time: 118.97 s, val_loss: 0.588
Epoch   19/50, time: 76.90 s, training_loss: 0.473
Epoch   19/50, time: 114.82 s, val_loss: 0.571
Epoch   20/50, time: 80.81 s, training_loss: 0.437
Epoch   20/50, time: 118.78 s, val_loss: 0.563
Epoch   21/50, time: 79.12 s, training_loss: 0.415
Epoch   21/50, time: 117.64 s, val_loss: 0.529
Training Metrics:
Accuracy: 0.9815
Precision: 0.5173
Recall: 0.7321
F1 Score: 0.6062
IoU: 0.4350
Dice Coefficient: 0.6062
Validation Metrics:
Accuracy: 0.9756
Precision: 0.4150
Recall: 0.6007
F1 Score: 0.4908
IoU: 0.3252
Dice Coefficient: 0.4908
Epoch   22/50, time: 77.19 s, training_loss: 0.390
Epoch   22/50, time: 114.95 s, val_loss: 0.523
Epoch   23/50, time: 76.57 s, training_loss: 0.384
Epoch   23/50, time: 114.85 s, val_loss: 0.527
Epoch   24/50, time: 75.98 s, training_loss: 0.365
Epoch   24/50, time: 113.29 s, val_loss: 0.519
Epoch   25/50, time: 76.91 s, training_loss: 0.346
Epoch   25/50, time: 115.61 s, val_loss: 0.496
Epoch   26/50, time: 80.47 s, training_loss: 0.330
Epoch   26/50, time: 117.84 s, val_loss: 0.498
Epoch   27/50, time: 77.12 s, training_loss: 0.309
Epoch   27/50, time: 114.78 s, val_loss: 0.502
Epoch   28/50, time: 79.09 s, training_loss: 0.305
Epoch   28/50, time: 119.45 s, val_loss: 0.492
Epoch   29/50, time: 75.55 s, training_loss: 0.289
Epoch   29/50, time: 112.80 s, val_loss: 0.495
Epoch   30/50, time: 80.37 s, training_loss: 0.279
Epoch   30/50, time: 118.86 s, val_loss: 0.490
Epoch   31/50, time: 77.06 s, training_loss: 0.270
Epoch   31/50, time: 115.07 s, val_loss: 0.501
Training Metrics:
Accuracy: 0.9900
Precision: 0.7396
Recall: 0.7508
F1 Score: 0.7451
IoU: 0.5938
Dice Coefficient: 0.7451
Validation Metrics:
Accuracy: 0.9815
Precision: 0.5285
Recall: 0.5198
F1 Score: 0.5241
IoU: 0.3551
Dice Coefficient: 0.5241
Epoch   32/50, time: 79.18 s, training_loss: 0.256
Epoch   32/50, time: 117.36 s, val_loss: 0.482
Epoch   33/50, time: 78.27 s, training_loss: 0.251
Epoch   33/50, time: 115.98 s, val_loss: 0.493
Epoch   34/50, time: 78.01 s, training_loss: 0.243
Epoch   34/50, time: 116.24 s, val_loss: 0.490
Epoch   35/50, time: 77.40 s, training_loss: 0.233
Epoch   35/50, time: 115.48 s, val_loss: 0.493
Epoch   36/50, time: 78.76 s, training_loss: 0.228
Epoch   36/50, time: 117.12 s, val_loss: 0.504
Epoch   37/50, time: 78.84 s, training_loss: 0.229
Epoch   37/50, time: 116.98 s, val_loss: 0.485
Epoch   38/50, time: 78.18 s, training_loss: 0.220
Epoch   38/50, time: 116.19 s, val_loss: 0.499
Epoch   39/50, time: 77.36 s, training_loss: 0.211
Epoch   39/50, time: 115.34 s, val_loss: 0.482
Epoch   40/50, time: 77.36 s, training_loss: 0.205
Epoch   40/50, time: 114.55 s, val_loss: 0.491
Epoch   41/50, time: 76.85 s, training_loss: 0.202
Epoch   41/50, time: 114.83 s, val_loss: 0.496
Training Metrics:
Accuracy: 0.9916
Precision: 0.7753
Recall: 0.8000
F1 Score: 0.7875
IoU: 0.6494
Dice Coefficient: 0.7875
Validation Metrics:
Accuracy: 0.9814
Precision: 0.5260
Recall: 0.5279
F1 Score: 0.5269
IoU: 0.3577
Dice Coefficient: 0.5269
Epoch   42/50, time: 73.05 s, training_loss: 0.205
Epoch   42/50, time: 110.17 s, val_loss: 0.491
Epoch   43/50, time: 77.01 s, training_loss: 0.193
Epoch   43/50, time: 115.30 s, val_loss: 0.488
Epoch   44/50, time: 77.07 s, training_loss: 0.188
Epoch   44/50, time: 114.78 s, val_loss: 0.485
Epoch   45/50, time: 78.55 s, training_loss: 0.182
Epoch   45/50, time: 116.44 s, val_loss: 0.482
Epoch   46/50, time: 77.66 s, training_loss: 0.178
Epoch   46/50, time: 114.91 s, val_loss: 0.488
Epoch   47/50, time: 77.62 s, training_loss: 0.175
Epoch   47/50, time: 114.89 s, val_loss: 0.486
Epoch   48/50, time: 78.11 s, training_loss: 0.179
Epoch   48/50, time: 115.89 s, val_loss: 0.486
Epoch   49/50, time: 77.42 s, training_loss: 0.177
Epoch   49/50, time: 115.69 s, val_loss: 0.483
Epoch   50/50, time: 77.45 s, training_loss: 0.164
Epoch   50/50, time: 115.57 s, val_loss: 0.477
Training Metrics:
Accuracy: 0.9940
Precision: 0.8394
Recall: 0.8540
F1 Score: 0.8467
IoU: 0.7341
Dice Coefficient: 0.8467
Validation Metrics:
Accuracy: 0.9821
Precision: 0.5446
Recall: 0.5399
F1 Score: 0.5423
IoU: 0.3720
Dice Coefficient: 0.5423
[I 2025-06-10 04:27:39,864] Trial 15 finished with value: 0.5422604682955077 and parameters: {'batch_size': 64, 'lr': 0.0006458239175850222, 'loss_fn': 'dice_loss'}. Best is trial 9 with value: 0.5451053503787879.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9821
Precision: 0.5446
Recall: 0.5399
F1 Score: 0.5423
IoU: 0.3720
Dice Coefficient: 0.5423
[Trial 15] Finished with val_loss=inf
[Trial 15] Finished with dice_coeff=0.5422604682955077
[Trial 16] Trying batch_size=16, lr=0.00029429828763649857, loss_fn=dice_loss
Epoch    1/50, time: 75.38 s, training_loss: 0.888
Epoch    1/50, time: 113.38 s, val_loss: 0.866
Training Metrics:
Accuracy: 0.9079
Precision: 0.1474
Recall: 0.7797
F1 Score: 0.2479
IoU: 0.1415
Dice Coefficient: 0.2479
Validation Metrics:
Accuracy: 0.9076
Precision: 0.1472
Recall: 0.7750
F1 Score: 0.2475
IoU: 0.1412
Dice Coefficient: 0.2475
Epoch    2/50, time: 71.42 s, training_loss: 0.839
Epoch    2/50, time: 109.71 s, val_loss: 0.814
Epoch    3/50, time: 77.36 s, training_loss: 0.801
Epoch    3/50, time: 115.65 s, val_loss: 0.786
Epoch    4/50, time: 72.04 s, training_loss: 0.770
Epoch    4/50, time: 110.08 s, val_loss: 0.755
Epoch    5/50, time: 72.23 s, training_loss: 0.737
Epoch    5/50, time: 110.20 s, val_loss: 0.717
Epoch    6/50, time: 72.61 s, training_loss: 0.698
Epoch    6/50, time: 111.00 s, val_loss: 0.687
Epoch    7/50, time: 73.29 s, training_loss: 0.651
Epoch    7/50, time: 110.78 s, val_loss: 0.643
Epoch    8/50, time: 73.41 s, training_loss: 0.605
Epoch    8/50, time: 111.44 s, val_loss: 0.614
Epoch    9/50, time: 72.42 s, training_loss: 0.567
Epoch    9/50, time: 110.27 s, val_loss: 0.604
Epoch   10/50, time: 75.63 s, training_loss: 0.533
Epoch   10/50, time: 113.69 s, val_loss: 0.557
Epoch   11/50, time: 73.07 s, training_loss: 0.497
Epoch   11/50, time: 111.28 s, val_loss: 0.577
Training Metrics:
Accuracy: 0.9790
Precision: 0.4702
Recall: 0.6100
F1 Score: 0.5311
IoU: 0.3615
Dice Coefficient: 0.5311
Validation Metrics:
Accuracy: 0.9754
Precision: 0.4027
Recall: 0.5260
F1 Score: 0.4562
IoU: 0.2955
Dice Coefficient: 0.4562
Epoch   12/50, time: 68.30 s, training_loss: 0.463
Epoch   12/50, time: 106.07 s, val_loss: 0.549
Epoch   13/50, time: 73.14 s, training_loss: 0.426
Epoch   13/50, time: 111.23 s, val_loss: 0.520
Epoch   14/50, time: 73.21 s, training_loss: 0.402
Epoch   14/50, time: 111.04 s, val_loss: 0.508
Epoch   15/50, time: 72.43 s, training_loss: 0.377
Epoch   15/50, time: 110.64 s, val_loss: 0.518
Epoch   16/50, time: 74.94 s, training_loss: 0.356
Epoch   16/50, time: 113.06 s, val_loss: 0.504
Epoch   17/50, time: 75.41 s, training_loss: 0.341
Epoch   17/50, time: 112.95 s, val_loss: 0.496
Epoch   18/50, time: 76.39 s, training_loss: 0.323
Epoch   18/50, time: 114.36 s, val_loss: 0.487
Epoch   19/50, time: 71.35 s, training_loss: 0.301
Epoch   19/50, time: 109.05 s, val_loss: 0.482
Epoch   20/50, time: 72.62 s, training_loss: 0.291
Epoch   20/50, time: 110.74 s, val_loss: 0.483
Epoch   21/50, time: 74.23 s, training_loss: 0.275
Epoch   21/50, time: 112.05 s, val_loss: 0.483
Training Metrics:
Accuracy: 0.9899
Precision: 0.7185
Recall: 0.7907
F1 Score: 0.7529
IoU: 0.6037
Dice Coefficient: 0.7529
Validation Metrics:
Accuracy: 0.9808
Precision: 0.5089
Recall: 0.5511
F1 Score: 0.5292
IoU: 0.3598
Dice Coefficient: 0.5292
Epoch   22/50, time: 68.14 s, training_loss: 0.262
Epoch   22/50, time: 108.36 s, val_loss: 0.481
Epoch   23/50, time: 71.94 s, training_loss: 0.254
Epoch   23/50, time: 110.07 s, val_loss: 0.486
Epoch   24/50, time: 73.56 s, training_loss: 0.245
Epoch   24/50, time: 111.88 s, val_loss: 0.484
Epoch   25/50, time: 72.33 s, training_loss: 0.234
Epoch   25/50, time: 110.24 s, val_loss: 0.486
Epoch   26/50, time: 72.48 s, training_loss: 0.227
Epoch   26/50, time: 110.85 s, val_loss: 0.478
Epoch   27/50, time: 73.35 s, training_loss: 0.215
Epoch   27/50, time: 111.64 s, val_loss: 0.476
Epoch   28/50, time: 73.95 s, training_loss: 0.211
Epoch   28/50, time: 111.49 s, val_loss: 0.475
Epoch   29/50, time: 71.43 s, training_loss: 0.204
Epoch   29/50, time: 108.99 s, val_loss: 0.467
Epoch   30/50, time: 72.62 s, training_loss: 0.199
Epoch   30/50, time: 110.60 s, val_loss: 0.478
Epoch   31/50, time: 71.60 s, training_loss: 0.198
Epoch   31/50, time: 109.33 s, val_loss: 0.479
Training Metrics:
Accuracy: 0.9924
Precision: 0.7974
Recall: 0.8187
F1 Score: 0.8079
IoU: 0.6777
Dice Coefficient: 0.8079
Validation Metrics:
Accuracy: 0.9817
Precision: 0.5337
Recall: 0.5319
F1 Score: 0.5328
IoU: 0.3632
Dice Coefficient: 0.5328
Epoch   32/50, time: 69.97 s, training_loss: 0.198
Epoch   32/50, time: 105.48 s, val_loss: 0.479
Epoch   33/50, time: 73.38 s, training_loss: 0.190
Epoch   33/50, time: 110.89 s, val_loss: 0.476
Epoch   34/50, time: 72.10 s, training_loss: 0.186
Epoch   34/50, time: 110.12 s, val_loss: 0.470
Epoch   35/50, time: 72.90 s, training_loss: 0.178
Epoch   35/50, time: 110.89 s, val_loss: 0.477
Epoch   36/50, time: 72.33 s, training_loss: 0.175
Epoch   36/50, time: 110.09 s, val_loss: 0.475
Epoch   37/50, time: 73.92 s, training_loss: 0.175
Epoch   37/50, time: 112.00 s, val_loss: 0.481
Epoch   38/50, time: 72.56 s, training_loss: 0.173
Epoch   38/50, time: 110.63 s, val_loss: 0.467
Epoch   39/50, time: 72.79 s, training_loss: 0.165
Epoch   39/50, time: 110.96 s, val_loss: 0.466
Epoch   40/50, time: 74.31 s, training_loss: 0.164
Epoch   40/50, time: 112.66 s, val_loss: 0.474
Epoch   41/50, time: 73.10 s, training_loss: 0.163
Epoch   41/50, time: 111.10 s, val_loss: 0.473
Training Metrics:
Accuracy: 0.9942
Precision: 0.8464
Recall: 0.8554
F1 Score: 0.8509
IoU: 0.7405
Dice Coefficient: 0.8509
Validation Metrics:
Accuracy: 0.9823
Precision: 0.5483
Recall: 0.5364
F1 Score: 0.5423
IoU: 0.3720
Dice Coefficient: 0.5423
Epoch   42/50, time: 69.44 s, training_loss: 0.155
Epoch   42/50, time: 107.69 s, val_loss: 0.476
Epoch   43/50, time: 76.83 s, training_loss: 0.150
Epoch   43/50, time: 115.18 s, val_loss: 0.468
Epoch   44/50, time: 73.50 s, training_loss: 0.151
Epoch   44/50, time: 111.92 s, val_loss: 0.471
Epoch   45/50, time: 73.72 s, training_loss: 0.150
Epoch   45/50, time: 112.13 s, val_loss: 0.470
Epoch   46/50, time: 74.17 s, training_loss: 0.147
Epoch   46/50, time: 112.52 s, val_loss: 0.472
Epoch   47/50, time: 74.07 s, training_loss: 0.146
Epoch   47/50, time: 112.40 s, val_loss: 0.465
Epoch   48/50, time: 74.36 s, training_loss: 0.144
Epoch   48/50, time: 112.61 s, val_loss: 0.472
Epoch   49/50, time: 72.76 s, training_loss: 0.144
Epoch   49/50, time: 110.67 s, val_loss: 0.473
Epoch   50/50, time: 75.42 s, training_loss: 0.144
Epoch   50/50, time: 113.39 s, val_loss: 0.463
Training Metrics:
Accuracy: 0.9948
Precision: 0.8615
Recall: 0.8718
F1 Score: 0.8666
IoU: 0.7647
Dice Coefficient: 0.8666
Validation Metrics:
Accuracy: 0.9828
Precision: 0.5622
Recall: 0.5530
F1 Score: 0.5576
IoU: 0.3866
Dice Coefficient: 0.5576
[I 2025-06-10 06:13:53,065] Trial 16 finished with value: 0.5575753035739701 and parameters: {'batch_size': 16, 'lr': 0.00029429828763649857, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9828
Precision: 0.5622
Recall: 0.5530
F1 Score: 0.5576
IoU: 0.3866
Dice Coefficient: 0.5576
[Trial 16] Finished with val_loss=inf
[Trial 16] Finished with dice_coeff=0.5575753035739701
[Trial 17] Trying batch_size=16, lr=0.0001036120761530405, loss_fn=dice_loss
Epoch    1/50, time: 71.64 s, training_loss: 0.900
Epoch    1/50, time: 107.74 s, val_loss: 0.876
Training Metrics:
Accuracy: 0.8436
Precision: 0.1062
Recall: 0.9478
F1 Score: 0.1910
IoU: 0.1056
Dice Coefficient: 0.1910
Validation Metrics:
Accuracy: 0.8427
Precision: 0.1061
Recall: 0.9471
F1 Score: 0.1909
IoU: 0.1055
Dice Coefficient: 0.1909
Epoch    2/50, time: 71.15 s, training_loss: 0.871
Epoch    2/50, time: 107.24 s, val_loss: 0.860
Epoch    3/50, time: 77.61 s, training_loss: 0.854
Epoch    3/50, time: 115.30 s, val_loss: 0.842
Epoch    4/50, time: 75.24 s, training_loss: 0.838
Epoch    4/50, time: 113.71 s, val_loss: 0.833
Epoch    5/50, time: 72.92 s, training_loss: 0.825
Epoch    5/50, time: 111.77 s, val_loss: 0.819
Epoch    6/50, time: 71.77 s, training_loss: 0.811
Epoch    6/50, time: 110.53 s, val_loss: 0.806
Epoch    7/50, time: 72.95 s, training_loss: 0.799
Epoch    7/50, time: 111.07 s, val_loss: 0.791
Epoch    8/50, time: 73.27 s, training_loss: 0.785
Epoch    8/50, time: 111.06 s, val_loss: 0.775
Epoch    9/50, time: 73.78 s, training_loss: 0.768
Epoch    9/50, time: 112.89 s, val_loss: 0.763
Epoch   10/50, time: 72.82 s, training_loss: 0.749
Epoch   10/50, time: 111.00 s, val_loss: 0.738
Epoch   11/50, time: 73.93 s, training_loss: 0.731
Epoch   11/50, time: 111.76 s, val_loss: 0.719
Training Metrics:
Accuracy: 0.9395
Precision: 0.2261
Recall: 0.8693
F1 Score: 0.3589
IoU: 0.2187
Dice Coefficient: 0.3589
Validation Metrics:
Accuracy: 0.9381
Precision: 0.2181
Recall: 0.8360
F1 Score: 0.3460
IoU: 0.2092
Dice Coefficient: 0.3460
Epoch   12/50, time: 71.97 s, training_loss: 0.713
Epoch   12/50, time: 110.42 s, val_loss: 0.716
Epoch   13/50, time: 73.94 s, training_loss: 0.694
Epoch   13/50, time: 112.59 s, val_loss: 0.706
Epoch   14/50, time: 72.90 s, training_loss: 0.677
Epoch   14/50, time: 110.89 s, val_loss: 0.683
Epoch   15/50, time: 73.38 s, training_loss: 0.658
Epoch   15/50, time: 112.00 s, val_loss: 0.665
Epoch   16/50, time: 74.36 s, training_loss: 0.632
Epoch   16/50, time: 111.98 s, val_loss: 0.659
Epoch   17/50, time: 73.88 s, training_loss: 0.609
Epoch   17/50, time: 112.24 s, val_loss: 0.650
Epoch   18/50, time: 77.16 s, training_loss: 0.581
Epoch   18/50, time: 115.61 s, val_loss: 0.628
Epoch   19/50, time: 75.21 s, training_loss: 0.557
Epoch   19/50, time: 113.87 s, val_loss: 0.649
Epoch   20/50, time: 74.25 s, training_loss: 0.532
Epoch   20/50, time: 112.54 s, val_loss: 0.596
Epoch   21/50, time: 73.23 s, training_loss: 0.496
Epoch   21/50, time: 111.59 s, val_loss: 0.585
Training Metrics:
Accuracy: 0.9775
Precision: 0.4571
Recall: 0.8303
F1 Score: 0.5896
IoU: 0.4180
Dice Coefficient: 0.5896
Validation Metrics:
Accuracy: 0.9705
Precision: 0.3609
Recall: 0.6556
F1 Score: 0.4655
IoU: 0.3034
Dice Coefficient: 0.4655
Epoch   22/50, time: 71.86 s, training_loss: 0.468
Epoch   22/50, time: 108.80 s, val_loss: 0.584
Epoch   23/50, time: 73.19 s, training_loss: 0.438
Epoch   23/50, time: 111.44 s, val_loss: 0.567
Epoch   24/50, time: 72.77 s, training_loss: 0.408
Epoch   24/50, time: 111.42 s, val_loss: 0.552
Epoch   25/50, time: 72.32 s, training_loss: 0.385
Epoch   25/50, time: 110.40 s, val_loss: 0.558
Epoch   26/50, time: 72.25 s, training_loss: 0.361
Epoch   26/50, time: 110.38 s, val_loss: 0.539
Epoch   27/50, time: 72.58 s, training_loss: 0.342
Epoch   27/50, time: 110.83 s, val_loss: 0.573
Epoch   28/50, time: 72.23 s, training_loss: 0.318
Epoch   28/50, time: 110.48 s, val_loss: 0.532
Epoch   29/50, time: 72.89 s, training_loss: 0.302
Epoch   29/50, time: 111.69 s, val_loss: 0.540
Epoch   30/50, time: 74.65 s, training_loss: 0.284
Epoch   30/50, time: 112.96 s, val_loss: 0.525
Epoch   31/50, time: 72.37 s, training_loss: 0.278
Epoch   31/50, time: 109.86 s, val_loss: 0.533
Training Metrics:
Accuracy: 0.9887
Precision: 0.6712
Recall: 0.8223
F1 Score: 0.7391
IoU: 0.5862
Dice Coefficient: 0.7391
Validation Metrics:
Accuracy: 0.9776
Precision: 0.4414
Recall: 0.5430
F1 Score: 0.4869
IoU: 0.3218
Dice Coefficient: 0.4869
Epoch   32/50, time: 68.74 s, training_loss: 0.260
Epoch   32/50, time: 107.51 s, val_loss: 0.532
Epoch   33/50, time: 72.82 s, training_loss: 0.248
Epoch   33/50, time: 111.31 s, val_loss: 0.523
Epoch   34/50, time: 72.14 s, training_loss: 0.241
Epoch   34/50, time: 110.47 s, val_loss: 0.539
Epoch   35/50, time: 72.11 s, training_loss: 0.229
Epoch   35/50, time: 110.11 s, val_loss: 0.520
Epoch   36/50, time: 72.46 s, training_loss: 0.221
Epoch   36/50, time: 110.04 s, val_loss: 0.524
Epoch   37/50, time: 73.21 s, training_loss: 0.215
Epoch   37/50, time: 111.33 s, val_loss: 0.534
Epoch   38/50, time: 73.57 s, training_loss: 0.215
Epoch   38/50, time: 111.76 s, val_loss: 0.522
Epoch   39/50, time: 72.57 s, training_loss: 0.202
Epoch   39/50, time: 110.42 s, val_loss: 0.524
Epoch   40/50, time: 73.90 s, training_loss: 0.196
Epoch   40/50, time: 113.25 s, val_loss: 0.525
Epoch   41/50, time: 75.89 s, training_loss: 0.194
Epoch   41/50, time: 114.52 s, val_loss: 0.513
Training Metrics:
Accuracy: 0.9932
Precision: 0.8018
Recall: 0.8665
F1 Score: 0.8329
IoU: 0.7136
Dice Coefficient: 0.8329
Validation Metrics:
Accuracy: 0.9802
Precision: 0.4945
Recall: 0.5152
F1 Score: 0.5047
IoU: 0.3375
Dice Coefficient: 0.5047
Epoch   42/50, time: 69.79 s, training_loss: 0.188
Epoch   42/50, time: 107.41 s, val_loss: 0.521
Epoch   43/50, time: 78.43 s, training_loss: 0.184
Epoch   43/50, time: 116.19 s, val_loss: 0.513
Epoch   44/50, time: 73.22 s, training_loss: 0.176
Epoch   44/50, time: 111.33 s, val_loss: 0.511
Epoch   45/50, time: 72.60 s, training_loss: 0.172
Epoch   45/50, time: 110.79 s, val_loss: 0.509
Epoch   46/50, time: 72.75 s, training_loss: 0.172
Epoch   46/50, time: 112.52 s, val_loss: 0.513
Epoch   47/50, time: 75.35 s, training_loss: 0.165
Epoch   47/50, time: 114.83 s, val_loss: 0.522
Epoch   48/50, time: 72.46 s, training_loss: 0.162
Epoch   48/50, time: 110.64 s, val_loss: 0.527
Epoch   49/50, time: 74.71 s, training_loss: 0.161
Epoch   49/50, time: 112.63 s, val_loss: 0.512
Epoch   50/50, time: 75.65 s, training_loss: 0.156
Epoch   50/50, time: 113.84 s, val_loss: 0.512
Training Metrics:
Accuracy: 0.9938
Precision: 0.8234
Recall: 0.8687
F1 Score: 0.8454
IoU: 0.7322
Dice Coefficient: 0.8454
Validation Metrics:
Accuracy: 0.9805
Precision: 0.5017
Recall: 0.5085
F1 Score: 0.5051
IoU: 0.3379
Dice Coefficient: 0.5051
[I 2025-06-10 08:00:31,375] Trial 17 finished with value: 0.5050781463326794 and parameters: {'batch_size': 16, 'lr': 0.0001036120761530405, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9805
Precision: 0.5017
Recall: 0.5085
F1 Score: 0.5051
IoU: 0.3379
Dice Coefficient: 0.5051
[Trial 17] Finished with val_loss=inf
[Trial 17] Finished with dice_coeff=0.5050781463326794
[Trial 18] Trying batch_size=16, lr=0.00020370527399804977, loss_fn=dice_loss
Epoch    1/50, time: 75.78 s, training_loss: 0.856
Epoch    1/50, time: 114.04 s, val_loss: 0.818
Training Metrics:
Accuracy: 0.9057
Precision: 0.1478
Recall: 0.8065
F1 Score: 0.2498
IoU: 0.1427
Dice Coefficient: 0.2498
Validation Metrics:
Accuracy: 0.9054
Precision: 0.1476
Recall: 0.8020
F1 Score: 0.2494
IoU: 0.1424
Dice Coefficient: 0.2494
Epoch    2/50, time: 67.77 s, training_loss: 0.806
Epoch    2/50, time: 103.99 s, val_loss: 0.788
Epoch    3/50, time: 77.20 s, training_loss: 0.779
Epoch    3/50, time: 114.98 s, val_loss: 0.766
Epoch    4/50, time: 72.77 s, training_loss: 0.756
Epoch    4/50, time: 110.57 s, val_loss: 0.750
Epoch    5/50, time: 75.71 s, training_loss: 0.736
Epoch    5/50, time: 113.78 s, val_loss: 0.733
Epoch    6/50, time: 71.58 s, training_loss: 0.713
Epoch    6/50, time: 109.20 s, val_loss: 0.697
Epoch    7/50, time: 70.72 s, training_loss: 0.680
Epoch    7/50, time: 106.99 s, val_loss: 0.686
Epoch    8/50, time: 71.42 s, training_loss: 0.645
Epoch    8/50, time: 108.24 s, val_loss: 0.649
Epoch    9/50, time: 74.69 s, training_loss: 0.604
Epoch    9/50, time: 124.19 s, val_loss: 0.626
Epoch   10/50, time: 96.27 s, training_loss: 0.573
Epoch   10/50, time: 134.24 s, val_loss: 0.623
Epoch   11/50, time: 73.84 s, training_loss: 0.541
Epoch   11/50, time: 111.72 s, val_loss: 0.595
Training Metrics:
Accuracy: 0.9746
Precision: 0.4082
Recall: 0.6746
F1 Score: 0.5086
IoU: 0.3410
Dice Coefficient: 0.5086
Validation Metrics:
Accuracy: 0.9707
Precision: 0.3497
Recall: 0.5759
F1 Score: 0.4352
IoU: 0.2781
Dice Coefficient: 0.4352
Epoch   12/50, time: 75.89 s, training_loss: 0.511
Epoch   12/50, time: 113.74 s, val_loss: 0.585
Epoch   13/50, time: 75.90 s, training_loss: 0.480
Epoch   13/50, time: 113.95 s, val_loss: 0.568
Epoch   14/50, time: 73.54 s, training_loss: 0.450
Epoch   14/50, time: 111.45 s, val_loss: 0.544
Epoch   15/50, time: 73.64 s, training_loss: 0.419
Epoch   15/50, time: 111.45 s, val_loss: 0.527
Epoch   16/50, time: 72.63 s, training_loss: 0.394
Epoch   16/50, time: 110.52 s, val_loss: 0.530
Epoch   17/50, time: 71.97 s, training_loss: 0.374
Epoch   17/50, time: 110.03 s, val_loss: 0.526
Epoch   18/50, time: 72.14 s, training_loss: 0.351
Epoch   18/50, time: 109.93 s, val_loss: 0.520
Epoch   19/50, time: 76.85 s, training_loss: 0.326
Epoch   19/50, time: 114.23 s, val_loss: 0.509
Epoch   20/50, time: 77.34 s, training_loss: 0.315
Epoch   20/50, time: 115.35 s, val_loss: 0.513
Epoch   21/50, time: 71.80 s, training_loss: 0.296
Epoch   21/50, time: 110.00 s, val_loss: 0.511
Training Metrics:
Accuracy: 0.9892
Precision: 0.6986
Recall: 0.7803
F1 Score: 0.7372
IoU: 0.5838
Dice Coefficient: 0.7372
Validation Metrics:
Accuracy: 0.9796
Precision: 0.4814
Recall: 0.5336
F1 Score: 0.5062
IoU: 0.3388
Dice Coefficient: 0.5062
Epoch   22/50, time: 72.32 s, training_loss: 0.282
Epoch   22/50, time: 110.11 s, val_loss: 0.515
Epoch   23/50, time: 71.11 s, training_loss: 0.272
Epoch   23/50, time: 108.92 s, val_loss: 0.502
Epoch   24/50, time: 71.74 s, training_loss: 0.260
Epoch   24/50, time: 109.23 s, val_loss: 0.513
Epoch   25/50, time: 71.72 s, training_loss: 0.251
Epoch   25/50, time: 109.19 s, val_loss: 0.516
Epoch   26/50, time: 74.67 s, training_loss: 0.240
Epoch   26/50, time: 115.57 s, val_loss: 0.515
Epoch   27/50, time: 73.98 s, training_loss: 0.234
Epoch   27/50, time: 114.01 s, val_loss: 0.508
Epoch   28/50, time: 74.15 s, training_loss: 0.225
Epoch   28/50, time: 112.17 s, val_loss: 0.505
Epoch   29/50, time: 73.78 s, training_loss: 0.214
Epoch   29/50, time: 111.33 s, val_loss: 0.502
Epoch   30/50, time: 72.54 s, training_loss: 0.211
Epoch   30/50, time: 109.98 s, val_loss: 0.504
Epoch   31/50, time: 72.14 s, training_loss: 0.207
Epoch   31/50, time: 111.70 s, val_loss: 0.512
Training Metrics:
Accuracy: 0.9925
Precision: 0.8188
Recall: 0.7886
F1 Score: 0.8034
IoU: 0.6714
Dice Coefficient: 0.8034
Validation Metrics:
Accuracy: 0.9812
Precision: 0.5229
Recall: 0.4777
F1 Score: 0.4993
IoU: 0.3327
Dice Coefficient: 0.4993
Epoch   32/50, time: 70.33 s, training_loss: 0.205
Epoch   32/50, time: 107.66 s, val_loss: 0.499
Epoch   33/50, time: 72.83 s, training_loss: 0.195
Epoch   33/50, time: 110.82 s, val_loss: 0.510
Epoch   34/50, time: 75.45 s, training_loss: 0.192
Epoch   34/50, time: 113.66 s, val_loss: 0.504
Epoch   35/50, time: 72.20 s, training_loss: 0.197
Epoch   35/50, time: 110.42 s, val_loss: 0.512
Epoch   36/50, time: 70.60 s, training_loss: 0.193
Epoch   36/50, time: 108.70 s, val_loss: 0.505
Epoch   37/50, time: 72.51 s, training_loss: 0.184
Epoch   37/50, time: 110.81 s, val_loss: 0.504
Epoch   38/50, time: 75.58 s, training_loss: 0.176
Epoch   38/50, time: 116.28 s, val_loss: 0.500
Epoch   39/50, time: 72.91 s, training_loss: 0.171
Epoch   39/50, time: 111.33 s, val_loss: 0.496
Epoch   40/50, time: 72.25 s, training_loss: 0.167
Epoch   40/50, time: 110.92 s, val_loss: 0.506
Epoch   41/50, time: 73.66 s, training_loss: 0.163
Epoch   41/50, time: 112.46 s, val_loss: 0.495
Training Metrics:
Accuracy: 0.9942
Precision: 0.8387
Recall: 0.8685
F1 Score: 0.8533
IoU: 0.7441
Dice Coefficient: 0.8533
Validation Metrics:
Accuracy: 0.9811
Precision: 0.5176
Recall: 0.5200
F1 Score: 0.5188
IoU: 0.3503
Dice Coefficient: 0.5188
Epoch   42/50, time: 70.03 s, training_loss: 0.157
Epoch   42/50, time: 108.72 s, val_loss: 0.497
Epoch   43/50, time: 70.99 s, training_loss: 0.157
Epoch   43/50, time: 109.17 s, val_loss: 0.513
Epoch   44/50, time: 73.81 s, training_loss: 0.156
Epoch   44/50, time: 112.61 s, val_loss: 0.501
Epoch   45/50, time: 73.16 s, training_loss: 0.161
Epoch   45/50, time: 111.42 s, val_loss: 0.495
Epoch   46/50, time: 75.93 s, training_loss: 0.160
Epoch   46/50, time: 113.97 s, val_loss: 0.505
Epoch   47/50, time: 85.74 s, training_loss: 0.153
Epoch   47/50, time: 127.58 s, val_loss: 0.488
Epoch   48/50, time: 78.62 s, training_loss: 0.148
Epoch   48/50, time: 120.32 s, val_loss: 0.494
Epoch   49/50, time: 76.45 s, training_loss: 0.150
Epoch   49/50, time: 115.70 s, val_loss: 0.494
Epoch   50/50, time: 72.44 s, training_loss: 0.146
Epoch   50/50, time: 110.79 s, val_loss: 0.511
Training Metrics:
Accuracy: 0.9946
Precision: 0.8430
Recall: 0.8863
F1 Score: 0.8641
IoU: 0.7607
Dice Coefficient: 0.8641
Validation Metrics:
Accuracy: 0.9814
Precision: 0.5245
Recall: 0.5247
F1 Score: 0.5246
IoU: 0.3556
Dice Coefficient: 0.5246
[I 2025-06-10 09:47:58,599] Trial 18 finished with value: 0.5246134005301256 and parameters: {'batch_size': 16, 'lr': 0.00020370527399804977, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9814
Precision: 0.5245
Recall: 0.5247
F1 Score: 0.5246
IoU: 0.3556
Dice Coefficient: 0.5246
[Trial 18] Finished with val_loss=inf
[Trial 18] Finished with dice_coeff=0.5246134005301256
[Trial 19] Trying batch_size=16, lr=0.00026248503019655513, loss_fn=dice_loss
Epoch    1/50, time: 74.02 s, training_loss: 0.880
Epoch    1/50, time: 112.04 s, val_loss: 0.850
Training Metrics:
Accuracy: 0.9206
Precision: 0.1560
Recall: 0.6983
F1 Score: 0.2550
IoU: 0.1461
Dice Coefficient: 0.2550
Validation Metrics:
Accuracy: 0.9188
Precision: 0.1571
Recall: 0.7207
F1 Score: 0.2580
IoU: 0.1481
Dice Coefficient: 0.2580
Epoch    2/50, time: 68.08 s, training_loss: 0.834
Epoch    2/50, time: 105.80 s, val_loss: 0.817
Epoch    3/50, time: 74.68 s, training_loss: 0.805
Epoch    3/50, time: 112.64 s, val_loss: 0.796
Epoch    4/50, time: 72.77 s, training_loss: 0.780
Epoch    4/50, time: 110.72 s, val_loss: 0.779
Epoch    5/50, time: 73.31 s, training_loss: 0.756
Epoch    5/50, time: 111.73 s, val_loss: 0.749
Epoch    6/50, time: 71.46 s, training_loss: 0.734
Epoch    6/50, time: 109.95 s, val_loss: 0.729
Epoch    7/50, time: 72.43 s, training_loss: 0.704
Epoch    7/50, time: 110.68 s, val_loss: 0.698
Epoch    8/50, time: 73.17 s, training_loss: 0.672
Epoch    8/50, time: 111.04 s, val_loss: 0.659
Epoch    9/50, time: 72.02 s, training_loss: 0.633
Epoch    9/50, time: 110.13 s, val_loss: 0.636
Epoch   10/50, time: 73.17 s, training_loss: 0.598
Epoch   10/50, time: 111.16 s, val_loss: 0.610
Epoch   11/50, time: 75.65 s, training_loss: 0.570
Epoch   11/50, time: 114.15 s, val_loss: 0.613
Training Metrics:
Accuracy: 0.9590
Precision: 0.3043
Recall: 0.8582
F1 Score: 0.4493
IoU: 0.2898
Dice Coefficient: 0.4493
Validation Metrics:
Accuracy: 0.9554
Precision: 0.2773
Recall: 0.7934
F1 Score: 0.4110
IoU: 0.2586
Dice Coefficient: 0.4110
Epoch   12/50, time: 69.55 s, training_loss: 0.539
Epoch   12/50, time: 107.95 s, val_loss: 0.586
Epoch   13/50, time: 73.75 s, training_loss: 0.501
Epoch   13/50, time: 112.44 s, val_loss: 0.559
Epoch   14/50, time: 71.68 s, training_loss: 0.475
Epoch   14/50, time: 110.03 s, val_loss: 0.562
Epoch   15/50, time: 75.74 s, training_loss: 0.444
Epoch   15/50, time: 113.51 s, val_loss: 0.537
Epoch   16/50, time: 76.61 s, training_loss: 0.415
Epoch   16/50, time: 114.91 s, val_loss: 0.542
Epoch   17/50, time: 73.26 s, training_loss: 0.386
Epoch   17/50, time: 111.16 s, val_loss: 0.525
Epoch   18/50, time: 71.85 s, training_loss: 0.363
Epoch   18/50, time: 110.22 s, val_loss: 0.506
Epoch   19/50, time: 73.27 s, training_loss: 0.345
Epoch   19/50, time: 111.25 s, val_loss: 0.510
Epoch   20/50, time: 72.45 s, training_loss: 0.324
Epoch   20/50, time: 109.84 s, val_loss: 0.515
Epoch   21/50, time: 73.99 s, training_loss: 0.314
Epoch   21/50, time: 112.17 s, val_loss: 0.513
Training Metrics:
Accuracy: 0.9880
Precision: 0.6686
Recall: 0.7559
F1 Score: 0.7096
IoU: 0.5499
Dice Coefficient: 0.7096
Validation Metrics:
Accuracy: 0.9797
Precision: 0.4840
Recall: 0.5394
F1 Score: 0.5102
IoU: 0.3424
Dice Coefficient: 0.5102
Epoch   22/50, time: 70.96 s, training_loss: 0.298
Epoch   22/50, time: 109.98 s, val_loss: 0.507
Epoch   23/50, time: 74.50 s, training_loss: 0.286
Epoch   23/50, time: 112.68 s, val_loss: 0.490
Epoch   24/50, time: 74.29 s, training_loss: 0.276
Epoch   24/50, time: 112.08 s, val_loss: 0.484
Epoch   25/50, time: 72.93 s, training_loss: 0.261
Epoch   25/50, time: 111.09 s, val_loss: 0.497
Epoch   26/50, time: 73.55 s, training_loss: 0.247
Epoch   26/50, time: 111.87 s, val_loss: 0.487
Epoch   27/50, time: 73.84 s, training_loss: 0.242
Epoch   27/50, time: 112.40 s, val_loss: 0.492
Epoch   28/50, time: 72.56 s, training_loss: 0.233
Epoch   28/50, time: 110.87 s, val_loss: 0.489
Epoch   29/50, time: 72.64 s, training_loss: 0.226
Epoch   29/50, time: 111.05 s, val_loss: 0.486
Epoch   30/50, time: 72.82 s, training_loss: 0.216
Epoch   30/50, time: 110.74 s, val_loss: 0.479
Epoch   31/50, time: 72.75 s, training_loss: 0.208
Epoch   31/50, time: 110.68 s, val_loss: 0.477
Training Metrics:
Accuracy: 0.9925
Precision: 0.7910
Recall: 0.8377
F1 Score: 0.8137
IoU: 0.6859
Dice Coefficient: 0.8137
Validation Metrics:
Accuracy: 0.9813
Precision: 0.5213
Recall: 0.5527
F1 Score: 0.5365
IoU: 0.3666
Dice Coefficient: 0.5365
Epoch   32/50, time: 68.83 s, training_loss: 0.204
Epoch   32/50, time: 104.99 s, val_loss: 0.487
Epoch   33/50, time: 72.10 s, training_loss: 0.205
Epoch   33/50, time: 110.48 s, val_loss: 0.483
Epoch   34/50, time: 72.60 s, training_loss: 0.193
Epoch   34/50, time: 110.35 s, val_loss: 0.487
Epoch   35/50, time: 76.29 s, training_loss: 0.190
Epoch   35/50, time: 114.78 s, val_loss: 0.487
Epoch   36/50, time: 73.03 s, training_loss: 0.191
Epoch   36/50, time: 111.41 s, val_loss: 0.493
Epoch   37/50, time: 74.53 s, training_loss: 0.182
Epoch   37/50, time: 113.02 s, val_loss: 0.478
Epoch   38/50, time: 73.58 s, training_loss: 0.183
Epoch   38/50, time: 111.35 s, val_loss: 0.496
Epoch   39/50, time: 71.64 s, training_loss: 0.175
Epoch   39/50, time: 110.08 s, val_loss: 0.490
Epoch   40/50, time: 72.56 s, training_loss: 0.174
Epoch   40/50, time: 110.86 s, val_loss: 0.484
Epoch   41/50, time: 72.00 s, training_loss: 0.165
Epoch   41/50, time: 110.17 s, val_loss: 0.477
Training Metrics:
Accuracy: 0.9941
Precision: 0.8295
Recall: 0.8773
F1 Score: 0.8528
IoU: 0.7433
Dice Coefficient: 0.8528
Validation Metrics:
Accuracy: 0.9818
Precision: 0.5358
Recall: 0.5391
F1 Score: 0.5374
IoU: 0.3674
Dice Coefficient: 0.5374
Epoch   42/50, time: 69.80 s, training_loss: 0.165
Epoch   42/50, time: 107.98 s, val_loss: 0.472
Epoch   43/50, time: 74.63 s, training_loss: 0.160
Epoch   43/50, time: 112.84 s, val_loss: 0.473
Epoch   44/50, time: 75.90 s, training_loss: 0.159
Epoch   44/50, time: 114.07 s, val_loss: 0.488
Epoch   45/50, time: 73.60 s, training_loss: 0.154
Epoch   45/50, time: 111.11 s, val_loss: 0.486
Epoch   46/50, time: 73.63 s, training_loss: 0.150
Epoch   46/50, time: 112.45 s, val_loss: 0.481
Epoch   47/50, time: 77.11 s, training_loss: 0.155
Epoch   47/50, time: 115.23 s, val_loss: 0.469
Epoch   48/50, time: 74.05 s, training_loss: 0.152
Epoch   48/50, time: 112.61 s, val_loss: 0.472
Epoch   49/50, time: 75.93 s, training_loss: 0.150
Epoch   49/50, time: 114.40 s, val_loss: 0.471
Epoch   50/50, time: 72.85 s, training_loss: 0.152
Epoch   50/50, time: 111.07 s, val_loss: 0.484
Training Metrics:
Accuracy: 0.9948
Precision: 0.8567
Recall: 0.8795
F1 Score: 0.8680
IoU: 0.7667
Dice Coefficient: 0.8680
Validation Metrics:
Accuracy: 0.9823
Precision: 0.5494
Recall: 0.5265
F1 Score: 0.5377
IoU: 0.3677
Dice Coefficient: 0.5377
[I 2025-06-10 11:34:29,739] Trial 19 finished with value: 0.5377195272235005 and parameters: {'batch_size': 16, 'lr': 0.00026248503019655513, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9823
Precision: 0.5494
Recall: 0.5265
F1 Score: 0.5377
IoU: 0.3677
Dice Coefficient: 0.5377
[Trial 19] Finished with val_loss=inf
[Trial 19] Finished with dice_coeff=0.5377195272235005
[Trial 20] Trying batch_size=128, lr=0.0006834878360360831, loss_fn=dice_loss
Epoch    1/50, time: 84.00 s, training_loss: 0.915
Epoch    1/50, time: 122.45 s, val_loss: 0.957
Training Metrics:
Accuracy: 0.9804
Precision: 0.0931
Recall: 0.0007
F1 Score: 0.0014
IoU: 0.0007
Dice Coefficient: 0.0014
Validation Metrics:
Accuracy: 0.9803
Precision: 0.0399
Recall: 0.0002
F1 Score: 0.0003
IoU: 0.0002
Dice Coefficient: 0.0003
Epoch    2/50, time: 83.07 s, training_loss: 0.883
Epoch    2/50, time: 121.41 s, val_loss: 0.946
Epoch    3/50, time: 86.07 s, training_loss: 0.865
Epoch    3/50, time: 123.73 s, val_loss: 0.906
Epoch    4/50, time: 88.04 s, training_loss: 0.848
Epoch    4/50, time: 126.12 s, val_loss: 0.864
Epoch    5/50, time: 87.34 s, training_loss: 0.834
Epoch    5/50, time: 125.49 s, val_loss: 0.838
Epoch    6/50, time: 87.48 s, training_loss: 0.818
Epoch    6/50, time: 126.05 s, val_loss: 0.843
Epoch    7/50, time: 88.52 s, training_loss: 0.807
Epoch    7/50, time: 126.77 s, val_loss: 0.807
Epoch    8/50, time: 87.84 s, training_loss: 0.795
Epoch    8/50, time: 126.32 s, val_loss: 0.805
Epoch    9/50, time: 85.97 s, training_loss: 0.783
Epoch    9/50, time: 124.18 s, val_loss: 0.793
Epoch   10/50, time: 86.36 s, training_loss: 0.776
Epoch   10/50, time: 125.05 s, val_loss: 0.794
Epoch   11/50, time: 88.51 s, training_loss: 0.767
Epoch   11/50, time: 127.90 s, val_loss: 0.779
Training Metrics:
Accuracy: 0.9295
Precision: 0.1740
Recall: 0.6994
F1 Score: 0.2787
IoU: 0.1619
Dice Coefficient: 0.2787
Validation Metrics:
Accuracy: 0.9296
Precision: 0.1751
Recall: 0.6992
F1 Score: 0.2801
IoU: 0.1628
Dice Coefficient: 0.2801
Epoch   12/50, time: 87.58 s, training_loss: 0.760
Epoch   12/50, time: 125.11 s, val_loss: 0.794
Epoch   13/50, time: 88.26 s, training_loss: 0.746
Epoch   13/50, time: 126.55 s, val_loss: 0.742
Epoch   14/50, time: 86.51 s, training_loss: 0.737
Epoch   14/50, time: 124.18 s, val_loss: 0.738
Epoch   15/50, time: 87.07 s, training_loss: 0.725
Epoch   15/50, time: 124.94 s, val_loss: 0.740
Epoch   16/50, time: 87.38 s, training_loss: 0.709
Epoch   16/50, time: 125.28 s, val_loss: 0.767
Epoch   17/50, time: 86.57 s, training_loss: 0.694
Epoch   17/50, time: 124.65 s, val_loss: 0.718
Epoch   18/50, time: 86.65 s, training_loss: 0.676
Epoch   18/50, time: 124.49 s, val_loss: 0.702
Epoch   19/50, time: 90.12 s, training_loss: 0.658
Epoch   19/50, time: 128.57 s, val_loss: 0.659
Epoch   20/50, time: 87.22 s, training_loss: 0.633
Epoch   20/50, time: 125.05 s, val_loss: 0.652
Epoch   21/50, time: 87.70 s, training_loss: 0.614
Epoch   21/50, time: 125.61 s, val_loss: 0.738
Training Metrics:
Accuracy: 0.9729
Precision: 0.3482
Recall: 0.4515
F1 Score: 0.3932
IoU: 0.2447
Dice Coefficient: 0.3932
Validation Metrics:
Accuracy: 0.9711
Precision: 0.3194
Recall: 0.4190
F1 Score: 0.3625
IoU: 0.2214
Dice Coefficient: 0.3625
Epoch   22/50, time: 88.23 s, training_loss: 0.626
Epoch   22/50, time: 126.47 s, val_loss: 0.681
Epoch   23/50, time: 86.77 s, training_loss: 0.596
Epoch   23/50, time: 124.67 s, val_loss: 0.656
Epoch   24/50, time: 87.76 s, training_loss: 0.576
Epoch   24/50, time: 126.17 s, val_loss: 0.612
Epoch   25/50, time: 85.53 s, training_loss: 0.545
Epoch   25/50, time: 123.53 s, val_loss: 0.601
Epoch   26/50, time: 86.57 s, training_loss: 0.523
Epoch   26/50, time: 124.83 s, val_loss: 0.610
Epoch   27/50, time: 87.52 s, training_loss: 0.503
Epoch   27/50, time: 125.44 s, val_loss: 0.585
Epoch   28/50, time: 89.17 s, training_loss: 0.475
Epoch   28/50, time: 126.79 s, val_loss: 0.594
Epoch   29/50, time: 88.58 s, training_loss: 0.466
Epoch   29/50, time: 126.71 s, val_loss: 0.564
Epoch   30/50, time: 85.85 s, training_loss: 0.439
Epoch   30/50, time: 124.54 s, val_loss: 0.559
Epoch   31/50, time: 87.12 s, training_loss: 0.416
Epoch   31/50, time: 125.52 s, val_loss: 0.541
Training Metrics:
Accuracy: 0.9827
Precision: 0.5436
Recall: 0.7017
F1 Score: 0.6126
IoU: 0.4416
Dice Coefficient: 0.6126
Validation Metrics:
Accuracy: 0.9771
Precision: 0.4355
Recall: 0.5635
F1 Score: 0.4913
IoU: 0.3256
Dice Coefficient: 0.4913
Epoch   32/50, time: 87.41 s, training_loss: 0.401
Epoch   32/50, time: 125.69 s, val_loss: 0.538
Epoch   33/50, time: 86.75 s, training_loss: 0.397
Epoch   33/50, time: 125.45 s, val_loss: 0.530
Epoch   34/50, time: 86.34 s, training_loss: 0.382
Epoch   34/50, time: 124.10 s, val_loss: 0.567
Epoch   35/50, time: 87.28 s, training_loss: 0.371
Epoch   35/50, time: 125.46 s, val_loss: 0.551
Epoch   36/50, time: 87.69 s, training_loss: 0.354
Epoch   36/50, time: 125.32 s, val_loss: 0.529
Epoch   37/50, time: 86.87 s, training_loss: 0.338
Epoch   37/50, time: 125.47 s, val_loss: 0.561
Epoch   38/50, time: 88.74 s, training_loss: 0.340
Epoch   38/50, time: 127.04 s, val_loss: 0.503
Epoch   39/50, time: 87.81 s, training_loss: 0.314
Epoch   39/50, time: 126.10 s, val_loss: 0.512
Epoch   40/50, time: 87.37 s, training_loss: 0.299
Epoch   40/50, time: 125.68 s, val_loss: 0.497
Epoch   41/50, time: 88.48 s, training_loss: 0.289
Epoch   41/50, time: 126.41 s, val_loss: 0.496
Training Metrics:
Accuracy: 0.9873
Precision: 0.6350
Recall: 0.8219
F1 Score: 0.7165
IoU: 0.5582
Dice Coefficient: 0.7165
Validation Metrics:
Accuracy: 0.9780
Precision: 0.4538
Recall: 0.5983
F1 Score: 0.5161
IoU: 0.3478
Dice Coefficient: 0.5161
Epoch   42/50, time: 88.08 s, training_loss: 0.293
Epoch   42/50, time: 126.56 s, val_loss: 0.507
Epoch   43/50, time: 87.31 s, training_loss: 0.275
Epoch   43/50, time: 124.96 s, val_loss: 0.503
Epoch   44/50, time: 87.35 s, training_loss: 0.267
Epoch   44/50, time: 125.96 s, val_loss: 0.510
Epoch   45/50, time: 87.50 s, training_loss: 0.257
Epoch   45/50, time: 125.84 s, val_loss: 0.509
Epoch   46/50, time: 86.76 s, training_loss: 0.259
Epoch   46/50, time: 124.61 s, val_loss: 0.507
Epoch   47/50, time: 86.83 s, training_loss: 0.261
Epoch   47/50, time: 124.84 s, val_loss: 0.520
Epoch   48/50, time: 87.46 s, training_loss: 0.243
Epoch   48/50, time: 125.51 s, val_loss: 0.505
Epoch   49/50, time: 87.70 s, training_loss: 0.238
Epoch   49/50, time: 126.10 s, val_loss: 0.506
Epoch   50/50, time: 88.02 s, training_loss: 0.223
Epoch   50/50, time: 125.88 s, val_loss: 0.493
Training Metrics:
Accuracy: 0.9912
Precision: 0.7585
Recall: 0.8016
F1 Score: 0.7795
IoU: 0.6386
Dice Coefficient: 0.7795
Validation Metrics:
Accuracy: 0.9808
Precision: 0.5107
Recall: 0.5276
F1 Score: 0.5190
IoU: 0.3504
Dice Coefficient: 0.5190
[I 2025-06-10 13:36:00,858] Trial 20 finished with value: 0.5190104730105081 and parameters: {'batch_size': 128, 'lr': 0.0006834878360360831, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9808
Precision: 0.5107
Recall: 0.5276
F1 Score: 0.5190
IoU: 0.3504
Dice Coefficient: 0.5190
[Trial 20] Finished with val_loss=inf
[Trial 20] Finished with dice_coeff=0.5190104730105081
[Trial 21] Trying batch_size=64, lr=0.00033497065263064167, loss_fn=dice_loss
Epoch    1/50, time: 77.91 s, training_loss: 0.914
Epoch    1/50, time: 116.19 s, val_loss: 0.954
Training Metrics:
Accuracy: 0.9799
Precision: 0.1499
Recall: 0.0065
F1 Score: 0.0124
IoU: 0.0062
Dice Coefficient: 0.0124
Validation Metrics:
Accuracy: 0.9799
Precision: 0.1405
Recall: 0.0046
F1 Score: 0.0089
IoU: 0.0045
Dice Coefficient: 0.0089
Epoch    2/50, time: 78.53 s, training_loss: 0.890
Epoch    2/50, time: 116.37 s, val_loss: 0.906
Epoch    3/50, time: 78.79 s, training_loss: 0.878
Epoch    3/50, time: 117.27 s, val_loss: 0.867
Epoch    4/50, time: 80.05 s, training_loss: 0.867
Epoch    4/50, time: 119.90 s, val_loss: 0.867
Epoch    5/50, time: 77.53 s, training_loss: 0.856
Epoch    5/50, time: 115.16 s, val_loss: 0.856
Epoch    6/50, time: 79.84 s, training_loss: 0.847
Epoch    6/50, time: 118.66 s, val_loss: 0.854
Epoch    7/50, time: 77.17 s, training_loss: 0.836
Epoch    7/50, time: 115.37 s, val_loss: 0.856
Epoch    8/50, time: 81.63 s, training_loss: 0.826
Epoch    8/50, time: 119.61 s, val_loss: 0.907
Epoch    9/50, time: 222.06 s, training_loss: 0.815
Epoch    9/50, time: 259.83 s, val_loss: 0.839
Epoch   10/50, time: 79.58 s, training_loss: 0.806
Epoch   10/50, time: 241.13 s, val_loss: 0.837
Epoch   11/50, time: 77.26 s, training_loss: 0.792
Epoch   11/50, time: 115.43 s, val_loss: 0.919
Training Metrics:
Accuracy: 0.6556
Precision: 0.0334
Recall: 0.5981
F1 Score: 0.0633
IoU: 0.0327
Dice Coefficient: 0.0633
Validation Metrics:
Accuracy: 0.6724
Precision: 0.0352
Recall: 0.5945
F1 Score: 0.0664
IoU: 0.0343
Dice Coefficient: 0.0664
Epoch   12/50, time: 77.90 s, training_loss: 0.780
Epoch   12/50, time: 116.10 s, val_loss: 0.916
Epoch   13/50, time: 78.11 s, training_loss: 0.769
Epoch   13/50, time: 116.44 s, val_loss: 0.769
Epoch   14/50, time: 75.83 s, training_loss: 0.754
Epoch   14/50, time: 114.06 s, val_loss: 0.848
Epoch   15/50, time: 265.25 s, training_loss: 0.736
Epoch   15/50, time: 392.42 s, val_loss: 0.746
Epoch   16/50, time: 76.72 s, training_loss: 0.720
Epoch   16/50, time: 114.96 s, val_loss: 0.773
Epoch   17/50, time: 79.83 s, training_loss: 0.706
Epoch   17/50, time: 117.67 s, val_loss: 0.785
Epoch   18/50, time: 80.90 s, training_loss: 0.681
Epoch   18/50, time: 118.95 s, val_loss: 0.701
Epoch   19/50, time: 80.10 s, training_loss: 0.658
Epoch   19/50, time: 118.44 s, val_loss: 0.731
Epoch   20/50, time: 77.95 s, training_loss: 0.635
Epoch   20/50, time: 116.11 s, val_loss: 0.784
Epoch   21/50, time: 79.96 s, training_loss: 0.614
Epoch   21/50, time: 117.73 s, val_loss: 0.647
Training Metrics:
Accuracy: 0.9057
Precision: 0.1481
Recall: 0.8087
F1 Score: 0.2503
IoU: 0.1431
Dice Coefficient: 0.2503
Validation Metrics:
Accuracy: 0.9297
Precision: 0.1776
Recall: 0.7125
F1 Score: 0.2843
IoU: 0.1657
Dice Coefficient: 0.2843
Epoch   22/50, time: 87.80 s, training_loss: 0.591
Epoch   22/50, time: 126.50 s, val_loss: 0.629
Epoch   23/50, time: 79.51 s, training_loss: 0.566
Epoch   23/50, time: 117.72 s, val_loss: 0.648
Epoch   24/50, time: 77.45 s, training_loss: 0.549
Epoch   24/50, time: 115.48 s, val_loss: 0.927
Epoch   25/50, time: 77.52 s, training_loss: 0.518
Epoch   25/50, time: 115.23 s, val_loss: 0.791
Epoch   26/50, time: 79.57 s, training_loss: 0.495
Epoch   26/50, time: 117.19 s, val_loss: 0.590
Epoch   27/50, time: 78.76 s, training_loss: 0.474
Epoch   27/50, time: 115.96 s, val_loss: 0.610
Epoch   28/50, time: 77.28 s, training_loss: 0.496
Epoch   28/50, time: 114.93 s, val_loss: 0.695
Epoch   29/50, time: 76.71 s, training_loss: 0.450
Epoch   29/50, time: 114.95 s, val_loss: 0.586
Epoch   30/50, time: 77.72 s, training_loss: 0.422
Epoch   30/50, time: 116.71 s, val_loss: 0.594
Epoch   31/50, time: 77.86 s, training_loss: 0.401
Epoch   31/50, time: 116.37 s, val_loss: 0.566
Training Metrics:
Accuracy: 0.9416
Precision: 0.2231
Recall: 0.8056
F1 Score: 0.3495
IoU: 0.2117
Dice Coefficient: 0.3495
Validation Metrics:
Accuracy: 0.9612
Precision: 0.2679
Recall: 0.5664
F1 Score: 0.3637
IoU: 0.2223
Dice Coefficient: 0.3637
Epoch   32/50, time: 77.18 s, training_loss: 0.378
Epoch   32/50, time: 115.21 s, val_loss: 0.548
Epoch   33/50, time: 78.35 s, training_loss: 0.365
Epoch   33/50, time: 116.99 s, val_loss: 0.561
Epoch   34/50, time: 78.31 s, training_loss: 0.362
Epoch   34/50, time: 116.29 s, val_loss: 0.565
Epoch   35/50, time: 76.65 s, training_loss: 0.340
Epoch   35/50, time: 114.43 s, val_loss: 0.548
Epoch   36/50, time: 76.56 s, training_loss: 0.324
Epoch   36/50, time: 114.12 s, val_loss: 0.560
Epoch   37/50, time: 78.23 s, training_loss: 0.318
Epoch   37/50, time: 116.37 s, val_loss: 0.554
Epoch   38/50, time: 79.78 s, training_loss: 0.306
Epoch   38/50, time: 118.32 s, val_loss: 0.537
Epoch   39/50, time: 81.69 s, training_loss: 0.294
Epoch   39/50, time: 120.38 s, val_loss: 0.554
Epoch   40/50, time: 79.99 s, training_loss: 0.289
Epoch   40/50, time: 118.09 s, val_loss: 0.554
Epoch   41/50, time: 77.35 s, training_loss: 0.274
Epoch   41/50, time: 115.11 s, val_loss: 0.550
Training Metrics:
Accuracy: 0.9302
Precision: 0.1938
Recall: 0.8176
F1 Score: 0.3133
IoU: 0.1857
Dice Coefficient: 0.3133
Validation Metrics:
Accuracy: 0.9519
Precision: 0.2011
Recall: 0.4896
F1 Score: 0.2851
IoU: 0.1662
Dice Coefficient: 0.2851
Epoch   42/50, time: 76.15 s, training_loss: 0.266
Epoch   42/50, time: 114.59 s, val_loss: 0.533
Epoch   43/50, time: 76.78 s, training_loss: 0.276
Epoch   43/50, time: 117.26 s, val_loss: 0.555
Epoch   44/50, time: 77.38 s, training_loss: 0.259
Epoch   44/50, time: 115.94 s, val_loss: 0.548
Epoch   45/50, time: 77.82 s, training_loss: 0.245
Epoch   45/50, time: 115.42 s, val_loss: 0.532
Epoch   46/50, time: 79.19 s, training_loss: 0.252
Epoch   46/50, time: 116.90 s, val_loss: 0.543
Epoch   47/50, time: 77.16 s, training_loss: 0.248
Epoch   47/50, time: 115.27 s, val_loss: 0.543
Epoch   48/50, time: 79.26 s, training_loss: 0.236
Epoch   48/50, time: 117.37 s, val_loss: 0.539
Epoch   49/50, time: 77.08 s, training_loss: 0.234
Epoch   49/50, time: 114.93 s, val_loss: 0.535
Epoch   50/50, time: 77.01 s, training_loss: 0.227
Epoch   50/50, time: 115.65 s, val_loss: 0.545
Training Metrics:
Accuracy: 0.9437
Precision: 0.2312
Recall: 0.8131
F1 Score: 0.3600
IoU: 0.2195
Dice Coefficient: 0.3600
Validation Metrics:
Accuracy: 0.9622
Precision: 0.2530
Recall: 0.4754
F1 Score: 0.3302
IoU: 0.1978
Dice Coefficient: 0.3302
[I 2025-06-10 15:40:39,178] Trial 21 finished with value: 0.3302164028509643 and parameters: {'batch_size': 64, 'lr': 0.00033497065263064167, 'loss_fn': 'dice_loss'}. Best is trial 16 with value: 0.5575753035739701.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9622
Precision: 0.2530
Recall: 0.4754
F1 Score: 0.3302
IoU: 0.1978
Dice Coefficient: 0.3302
[Trial 21] Finished with val_loss=inf
[Trial 21] Finished with dice_coeff=0.3302164028509643
[Trial 22] Trying batch_size=16, lr=0.0004936693806581748, loss_fn=dice_loss
Epoch    1/50, time: 74.22 s, training_loss: 0.863
Epoch    1/50, time: 112.15 s, val_loss: 0.837
Training Metrics:
Accuracy: 0.9085
Precision: 0.1511
Recall: 0.8007
F1 Score: 0.2542
IoU: 0.1456
Dice Coefficient: 0.2542
Validation Metrics:
Accuracy: 0.9087
Precision: 0.1519
Recall: 0.7985
F1 Score: 0.2553
IoU: 0.1463
Dice Coefficient: 0.2553
Epoch    2/50, time: 71.92 s, training_loss: 0.797
Epoch    2/50, time: 109.56 s, val_loss: 0.783
Epoch    3/50, time: 72.68 s, training_loss: 0.758
Epoch    3/50, time: 111.07 s, val_loss: 0.768
Epoch    4/50, time: 73.65 s, training_loss: 0.730
Epoch    4/50, time: 111.34 s, val_loss: 0.732
Epoch    5/50, time: 72.77 s, training_loss: 0.700
Epoch    5/50, time: 110.23 s, val_loss: 0.702
Epoch    6/50, time: 72.17 s, training_loss: 0.661
Epoch    6/50, time: 110.23 s, val_loss: 0.678
Epoch    7/50, time: 75.42 s, training_loss: 0.614
Epoch    7/50, time: 113.17 s, val_loss: 0.620
Epoch    8/50, time: 75.58 s, training_loss: 0.582
Epoch    8/50, time: 114.00 s, val_loss: 0.601
Epoch    9/50, time: 72.91 s, training_loss: 0.559
Epoch    9/50, time: 111.39 s, val_loss: 0.581
Epoch   10/50, time: 74.43 s, training_loss: 0.527
Epoch   10/50, time: 111.89 s, val_loss: 0.592
Epoch   11/50, time: 75.37 s, training_loss: 0.499
Epoch   11/50, time: 113.81 s, val_loss: 0.613
Training Metrics:
Accuracy: 0.9807
Precision: 0.5048
Recall: 0.4317
F1 Score: 0.4654
IoU: 0.3033
Dice Coefficient: 0.4654
Validation Metrics:
Accuracy: 0.9781
Precision: 0.4295
Recall: 0.3645
F1 Score: 0.3943
IoU: 0.2456
Dice Coefficient: 0.3943
Epoch   12/50, time: 72.37 s, training_loss: 0.467
Epoch   12/50, time: 110.87 s, val_loss: 0.557
Epoch   13/50, time: 72.50 s, training_loss: 0.441
Epoch   13/50, time: 110.35 s, val_loss: 0.521
Epoch   14/50, time: 72.52 s, training_loss: 0.418
Epoch   14/50, time: 110.35 s, val_loss: 0.513
Epoch   15/50, time: 73.95 s, training_loss: 0.394
Epoch   15/50, time: 112.22 s, val_loss: 0.480
Epoch   16/50, time: 72.23 s, training_loss: 0.378
Epoch   16/50, time: 109.68 s, val_loss: 0.494
Epoch   17/50, time: 73.18 s, training_loss: 0.360
Epoch   17/50, time: 112.39 s, val_loss: 0.467
Epoch   18/50, time: 75.53 s, training_loss: 0.340
Epoch   18/50, time: 112.89 s, val_loss: 0.466
Epoch   19/50, time: 73.26 s, training_loss: 0.328
Epoch   19/50, time: 111.64 s, val_loss: 0.475
Epoch   20/50, time: 72.38 s, training_loss: 0.315
Epoch   20/50, time: 110.60 s, val_loss: 0.472
Epoch   21/50, time: 74.59 s, training_loss: 0.307
Epoch   21/50, time: 112.57 s, val_loss: 0.465
Training Metrics:
Accuracy: 0.9883
Precision: 0.6849
Recall: 0.7400
F1 Score: 0.7113
IoU: 0.5520
Dice Coefficient: 0.7113
Validation Metrics:
Accuracy: 0.9815
Precision: 0.5266
Recall: 0.5590
F1 Score: 0.5423
IoU: 0.3721
Dice Coefficient: 0.5423
Epoch   22/50, time: 67.75 s, training_loss: 0.297
Epoch   22/50, time: 104.45 s, val_loss: 0.457
Epoch   23/50, time: 71.93 s, training_loss: 0.283
Epoch   23/50, time: 109.66 s, val_loss: 0.457
Epoch   24/50, time: 72.58 s, training_loss: 0.275
Epoch   24/50, time: 110.62 s, val_loss: 0.455
Epoch   25/50, time: 76.14 s, training_loss: 0.264
Epoch   25/50, time: 113.90 s, val_loss: 0.452
Epoch   26/50, time: 76.54 s, training_loss: 0.256
Epoch   26/50, time: 114.83 s, val_loss: 0.476
Epoch   27/50, time: 74.52 s, training_loss: 0.248
Epoch   27/50, time: 112.40 s, val_loss: 0.460
Epoch   28/50, time: 72.66 s, training_loss: 0.249
Epoch   28/50, time: 110.83 s, val_loss: 0.445
Epoch   29/50, time: 72.40 s, training_loss: 0.236
Epoch   29/50, time: 110.35 s, val_loss: 0.450
Epoch   30/50, time: 71.81 s, training_loss: 0.236
Epoch   30/50, time: 110.08 s, val_loss: 0.459
Epoch   31/50, time: 73.29 s, training_loss: 0.235
Epoch   31/50, time: 111.31 s, val_loss: 0.455
Training Metrics:
Accuracy: 0.9916
Precision: 0.7804
Recall: 0.7918
F1 Score: 0.7860
IoU: 0.6475
Dice Coefficient: 0.7860
Validation Metrics:
Accuracy: 0.9829
Precision: 0.5654
Recall: 0.5546
F1 Score: 0.5599
IoU: 0.3888
Dice Coefficient: 0.5599
Epoch   32/50, time: 67.50 s, training_loss: 0.220
Epoch   32/50, time: 105.88 s, val_loss: 0.448
Epoch   33/50, time: 72.64 s, training_loss: 0.212
Epoch   33/50, time: 111.05 s, val_loss: 0.450
Epoch   34/50, time: 73.69 s, training_loss: 0.213
Epoch   34/50, time: 111.70 s, val_loss: 0.454
Epoch   35/50, time: 72.74 s, training_loss: 0.211
Epoch   35/50, time: 110.34 s, val_loss: 0.444
Epoch   36/50, time: 73.04 s, training_loss: 0.202
Epoch   36/50, time: 111.15 s, val_loss: 0.449
Epoch   37/50, time: 75.88 s, training_loss: 0.202
Epoch   37/50, time: 113.80 s, val_loss: 0.444
Epoch   38/50, time: 72.72 s, training_loss: 0.198
Epoch   38/50, time: 111.69 s, val_loss: 0.451
Epoch   39/50, time: 71.90 s, training_loss: 0.192
Epoch   39/50, time: 110.12 s, val_loss: 0.460
Epoch   40/50, time: 73.48 s, training_loss: 0.188
Epoch   40/50, time: 111.90 s, val_loss: 0.447
Epoch   41/50, time: 73.15 s, training_loss: 0.187
Epoch   41/50, time: 111.78 s, val_loss: 0.450
Training Metrics:
Accuracy: 0.9924
Precision: 0.7886
Recall: 0.8341
F1 Score: 0.8107
IoU: 0.6817
Dice Coefficient: 0.8107
Validation Metrics:
Accuracy: 0.9820
Precision: 0.5388
Recall: 0.5718
F1 Score: 0.5548
IoU: 0.3839
Dice Coefficient: 0.5548
Epoch   42/50, time: 74.51 s, training_loss: 0.186
Epoch   42/50, time: 112.12 s, val_loss: 0.438
Epoch   43/50, time: 71.91 s, training_loss: 0.178
Epoch   43/50, time: 110.04 s, val_loss: 0.454
Epoch   44/50, time: 74.91 s, training_loss: 0.176
Epoch   44/50, time: 112.80 s, val_loss: 0.449
Epoch   45/50, time: 72.41 s, training_loss: 0.172
Epoch   45/50, time: 110.66 s, val_loss: 0.443
Epoch   46/50, time: 73.40 s, training_loss: 0.175
Epoch   46/50, time: 111.49 s, val_loss: 0.450
Epoch   47/50, time: 71.97 s, training_loss: 0.176
Epoch   47/50, time: 110.13 s, val_loss: 0.454
Epoch   48/50, time: 71.48 s, training_loss: 0.165
Epoch   48/50, time: 109.72 s, val_loss: 0.439
Epoch   49/50, time: 74.33 s, training_loss: 0.162
Epoch   49/50, time: 112.71 s, val_loss: 0.440
Epoch   50/50, time: 71.27 s, training_loss: 0.165
Epoch   50/50, time: 109.49 s, val_loss: 0.452
Training Metrics:
Accuracy: 0.9936
Precision: 0.8341
Recall: 0.8358
F1 Score: 0.8349
IoU: 0.7166
Dice Coefficient: 0.8349
Validation Metrics:
Accuracy: 0.9832
Precision: 0.5733
Recall: 0.5585
F1 Score: 0.5658
IoU: 0.3945
Dice Coefficient: 0.5658
[I 2025-06-10 17:26:47,740] Trial 22 finished with value: 0.5657689123071132 and parameters: {'batch_size': 16, 'lr': 0.0004936693806581748, 'loss_fn': 'dice_loss'}. Best is trial 22 with value: 0.5657689123071132.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9832
Precision: 0.5733
Recall: 0.5585
F1 Score: 0.5658
IoU: 0.3945
Dice Coefficient: 0.5658
[Trial 22] Finished with val_loss=inf
[Trial 22] Finished with dice_coeff=0.5657689123071132
[Trial 23] Trying batch_size=16, lr=0.0007294200663600085, loss_fn=dice_loss
Epoch    1/50, time: 70.78 s, training_loss: 0.886
Epoch    1/50, time: 108.91 s, val_loss: 0.852
Training Metrics:
Accuracy: 0.9019
Precision: 0.1446
Recall: 0.8224
F1 Score: 0.2460
IoU: 0.1403
Dice Coefficient: 0.2460
Validation Metrics:
Accuracy: 0.9021
Precision: 0.1455
Recall: 0.8198
F1 Score: 0.2471
IoU: 0.1410
Dice Coefficient: 0.2471
Epoch    2/50, time: 67.82 s, training_loss: 0.816
Epoch    2/50, time: 105.50 s, val_loss: 0.795
Epoch    3/50, time: 72.06 s, training_loss: 0.760
Epoch    3/50, time: 109.84 s, val_loss: 0.738
Epoch    4/50, time: 72.64 s, training_loss: 0.727
Epoch    4/50, time: 110.75 s, val_loss: 0.724
Epoch    5/50, time: 71.24 s, training_loss: 0.701
Epoch    5/50, time: 109.43 s, val_loss: 0.700
Epoch    6/50, time: 73.48 s, training_loss: 0.646
Epoch    6/50, time: 111.48 s, val_loss: 0.631
Epoch    7/50, time: 71.11 s, training_loss: 0.605
Epoch    7/50, time: 108.83 s, val_loss: 0.607
Epoch    8/50, time: 71.61 s, training_loss: 0.580
Epoch    8/50, time: 109.15 s, val_loss: 0.595
Epoch    9/50, time: 72.04 s, training_loss: 0.552
Epoch    9/50, time: 110.13 s, val_loss: 0.581
Epoch   10/50, time: 71.29 s, training_loss: 0.528
Epoch   10/50, time: 109.52 s, val_loss: 0.559
Epoch   11/50, time: 71.44 s, training_loss: 0.502
Epoch   11/50, time: 108.94 s, val_loss: 0.557
Training Metrics:
Accuracy: 0.9673
Precision: 0.3500
Recall: 0.7931
F1 Score: 0.4857
IoU: 0.3207
Dice Coefficient: 0.4857
Validation Metrics:
Accuracy: 0.9646
Precision: 0.3247
Recall: 0.7472
F1 Score: 0.4527
IoU: 0.2926
Dice Coefficient: 0.4527
Epoch   12/50, time: 67.70 s, training_loss: 0.476
Epoch   12/50, time: 103.41 s, val_loss: 0.529
Epoch   13/50, time: 72.74 s, training_loss: 0.456
Epoch   13/50, time: 110.56 s, val_loss: 0.636
Epoch   14/50, time: 72.90 s, training_loss: 0.441
Epoch   14/50, time: 110.93 s, val_loss: 0.518
Epoch   15/50, time: 71.84 s, training_loss: 0.419
Epoch   15/50, time: 110.04 s, val_loss: 0.487
Epoch   16/50, time: 71.86 s, training_loss: 0.399
Epoch   16/50, time: 110.00 s, val_loss: 0.485
Epoch   17/50, time: 73.39 s, training_loss: 0.390
Epoch   17/50, time: 111.39 s, val_loss: 0.490
Epoch   18/50, time: 72.66 s, training_loss: 0.371
Epoch   18/50, time: 110.12 s, val_loss: 0.474
Epoch   19/50, time: 73.33 s, training_loss: 0.354
Epoch   19/50, time: 111.10 s, val_loss: 0.468
Epoch   20/50, time: 73.00 s, training_loss: 0.337
Epoch   20/50, time: 111.28 s, val_loss: 0.491
Epoch   21/50, time: 72.91 s, training_loss: 0.348
Epoch   21/50, time: 110.78 s, val_loss: 0.479
Training Metrics:
Accuracy: 0.9866
Precision: 0.6492
Recall: 0.6766
F1 Score: 0.6626
IoU: 0.4955
Dice Coefficient: 0.6626
Validation Metrics:
Accuracy: 0.9814
Precision: 0.5249
Recall: 0.5434
F1 Score: 0.5340
IoU: 0.3642
Dice Coefficient: 0.5340
Epoch   22/50, time: 73.88 s, training_loss: 0.337
Epoch   22/50, time: 111.80 s, val_loss: 0.475
Epoch   23/50, time: 74.75 s, training_loss: 0.314
Epoch   23/50, time: 111.98 s, val_loss: 0.451
Epoch   24/50, time: 74.22 s, training_loss: 0.300
Epoch   24/50, time: 112.19 s, val_loss: 0.461
Epoch   25/50, time: 72.08 s, training_loss: 0.293
Epoch   25/50, time: 109.64 s, val_loss: 0.456
Epoch   26/50, time: 74.71 s, training_loss: 0.279
Epoch   26/50, time: 112.43 s, val_loss: 0.480
Epoch   27/50, time: 73.30 s, training_loss: 0.279
Epoch   27/50, time: 112.17 s, val_loss: 0.465
Epoch   28/50, time: 72.82 s, training_loss: 0.277
Epoch   28/50, time: 110.68 s, val_loss: 0.456
Epoch   29/50, time: 72.32 s, training_loss: 0.266
Epoch   29/50, time: 110.44 s, val_loss: 0.448
Epoch   30/50, time: 71.80 s, training_loss: 0.255
Epoch   30/50, time: 109.79 s, val_loss: 0.436
Epoch   31/50, time: 76.07 s, training_loss: 0.253
Epoch   31/50, time: 113.94 s, val_loss: 0.445
Training Metrics:
Accuracy: 0.9901
Precision: 0.7374
Recall: 0.7668
F1 Score: 0.7518
IoU: 0.6023
Dice Coefficient: 0.7518
Validation Metrics:
Accuracy: 0.9826
Precision: 0.5545
Recall: 0.5690
F1 Score: 0.5616
IoU: 0.3905
Dice Coefficient: 0.5616
Epoch   32/50, time: 70.14 s, training_loss: 0.247
Epoch   32/50, time: 108.02 s, val_loss: 0.431
Epoch   33/50, time: 72.12 s, training_loss: 0.240
Epoch   33/50, time: 109.57 s, val_loss: 0.439
Epoch   34/50, time: 71.15 s, training_loss: 0.232
Epoch   34/50, time: 108.93 s, val_loss: 0.443
Epoch   35/50, time: 72.99 s, training_loss: 0.230
Epoch   35/50, time: 110.42 s, val_loss: 0.433
Epoch   36/50, time: 72.75 s, training_loss: 0.224
Epoch   36/50, time: 110.78 s, val_loss: 0.436
Epoch   37/50, time: 73.30 s, training_loss: 0.222
Epoch   37/50, time: 111.14 s, val_loss: 0.440
Epoch   38/50, time: 72.48 s, training_loss: 0.220
Epoch   38/50, time: 110.36 s, val_loss: 0.431
Epoch   39/50, time: 71.76 s, training_loss: 0.214
Epoch   39/50, time: 109.33 s, val_loss: 0.441
Epoch   40/50, time: 72.95 s, training_loss: 0.208
Epoch   40/50, time: 110.66 s, val_loss: 0.424
Epoch   41/50, time: 74.35 s, training_loss: 0.205
Epoch   41/50, time: 112.71 s, val_loss: 0.430
Training Metrics:
Accuracy: 0.9920
Precision: 0.7741
Recall: 0.8309
F1 Score: 0.8015
IoU: 0.6687
Dice Coefficient: 0.8015
Validation Metrics:
Accuracy: 0.9830
Precision: 0.5624
Recall: 0.6006
F1 Score: 0.5809
IoU: 0.4094
Dice Coefficient: 0.5809
Epoch   42/50, time: 74.66 s, training_loss: 0.200
Epoch   42/50, time: 112.26 s, val_loss: 0.441
Epoch   43/50, time: 74.27 s, training_loss: 0.198
Epoch   43/50, time: 111.66 s, val_loss: 0.439
Epoch   44/50, time: 74.14 s, training_loss: 0.198
Epoch   44/50, time: 111.67 s, val_loss: 0.430
Epoch   45/50, time: 72.58 s, training_loss: 0.195
Epoch   45/50, time: 110.65 s, val_loss: 0.431
Epoch   46/50, time: 73.61 s, training_loss: 0.186
Epoch   46/50, time: 111.82 s, val_loss: 0.432
Epoch   47/50, time: 74.51 s, training_loss: 0.187
Epoch   47/50, time: 112.37 s, val_loss: 0.453
Epoch   48/50, time: 71.88 s, training_loss: 0.185
Epoch   48/50, time: 110.14 s, val_loss: 0.437
Epoch   49/50, time: 76.50 s, training_loss: 0.184
Epoch   49/50, time: 114.89 s, val_loss: 0.427
Epoch   50/50, time: 72.16 s, training_loss: 0.179
Epoch   50/50, time: 110.86 s, val_loss: 0.433
Training Metrics:
Accuracy: 0.9933
Precision: 0.8238
Recall: 0.8336
F1 Score: 0.8287
IoU: 0.7075
Dice Coefficient: 0.8287
Validation Metrics:
Accuracy: 0.9836
Precision: 0.5835
Recall: 0.5776
F1 Score: 0.5806
IoU: 0.4090
Dice Coefficient: 0.5806
[I 2025-06-10 19:12:25,439] Trial 23 finished with value: 0.5805646996970982 and parameters: {'batch_size': 16, 'lr': 0.0007294200663600085, 'loss_fn': 'dice_loss'}. Best is trial 23 with value: 0.5805646996970982.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9836
Precision: 0.5835
Recall: 0.5776
F1 Score: 0.5806
IoU: 0.4090
Dice Coefficient: 0.5806
[Trial 23] Finished with val_loss=inf
[Trial 23] Finished with dice_coeff=0.5805646996970982
[Trial 24] Trying batch_size=16, lr=0.0004978927072114192, loss_fn=dice_loss
Epoch    1/50, time: 72.58 s, training_loss: 0.875
Epoch    1/50, time: 111.65 s, val_loss: 0.841
Training Metrics:
Accuracy: 0.8835
Precision: 0.1343
Recall: 0.9149
F1 Score: 0.2341
IoU: 0.1326
Dice Coefficient: 0.2341
Validation Metrics:
Accuracy: 0.8824
Precision: 0.1340
Recall: 0.9161
F1 Score: 0.2339
IoU: 0.1324
Dice Coefficient: 0.2339
Epoch    2/50, time: 69.55 s, training_loss: 0.815
Epoch    2/50, time: 108.11 s, val_loss: 0.794
Epoch    3/50, time: 76.12 s, training_loss: 0.772
Epoch    3/50, time: 114.19 s, val_loss: 0.768
Epoch    4/50, time: 75.59 s, training_loss: 0.739
Epoch    4/50, time: 113.31 s, val_loss: 0.742
Epoch    5/50, time: 71.89 s, training_loss: 0.716
Epoch    5/50, time: 109.82 s, val_loss: 0.709
Epoch    6/50, time: 73.16 s, training_loss: 0.681
Epoch    6/50, time: 110.63 s, val_loss: 0.673
Epoch    7/50, time: 71.70 s, training_loss: 0.642
Epoch    7/50, time: 109.84 s, val_loss: 0.678
Epoch    8/50, time: 72.11 s, training_loss: 0.607
Epoch    8/50, time: 110.89 s, val_loss: 0.637
Epoch    9/50, time: 72.08 s, training_loss: 0.579
Epoch    9/50, time: 110.00 s, val_loss: 0.601
Epoch   10/50, time: 75.74 s, training_loss: 0.562
Epoch   10/50, time: 113.02 s, val_loss: 0.598
Epoch   11/50, time: 72.54 s, training_loss: 0.533
Epoch   11/50, time: 110.13 s, val_loss: 0.571
Training Metrics:
Accuracy: 0.9711
Precision: 0.3735
Recall: 0.7140
F1 Score: 0.4905
IoU: 0.3249
Dice Coefficient: 0.4905
Validation Metrics:
Accuracy: 0.9682
Precision: 0.3380
Recall: 0.6504
F1 Score: 0.4448
IoU: 0.2860
Dice Coefficient: 0.4448
Epoch   12/50, time: 71.60 s, training_loss: 0.512
Epoch   12/50, time: 109.44 s, val_loss: 0.572
Epoch   13/50, time: 73.31 s, training_loss: 0.490
Epoch   13/50, time: 111.38 s, val_loss: 0.557
Epoch   14/50, time: 74.78 s, training_loss: 0.468
Epoch   14/50, time: 112.75 s, val_loss: 0.537
Epoch   15/50, time: 71.56 s, training_loss: 0.444
Epoch   15/50, time: 109.37 s, val_loss: 0.538
Epoch   16/50, time: 73.40 s, training_loss: 0.427
Epoch   16/50, time: 111.64 s, val_loss: 0.513
Epoch   17/50, time: 71.87 s, training_loss: 0.404
Epoch   17/50, time: 109.10 s, val_loss: 0.505
Epoch   18/50, time: 75.63 s, training_loss: 0.387
Epoch   18/50, time: 112.71 s, val_loss: 0.504
Epoch   19/50, time: 74.25 s, training_loss: 0.375
Epoch   19/50, time: 111.94 s, val_loss: 0.500
Epoch   20/50, time: 71.03 s, training_loss: 0.366
Epoch   20/50, time: 108.73 s, val_loss: 0.516
Epoch   21/50, time: 72.82 s, training_loss: 0.351
Epoch   21/50, time: 110.36 s, val_loss: 0.493
Training Metrics:
Accuracy: 0.9851
Precision: 0.5937
Recall: 0.7398
F1 Score: 0.6587
IoU: 0.4911
Dice Coefficient: 0.6587
Validation Metrics:
Accuracy: 0.9787
Precision: 0.4641
Recall: 0.5741
F1 Score: 0.5133
IoU: 0.3452
Dice Coefficient: 0.5133
Epoch   22/50, time: 67.91 s, training_loss: 0.332
Epoch   22/50, time: 105.56 s, val_loss: 0.494
Epoch   23/50, time: 73.28 s, training_loss: 0.320
Epoch   23/50, time: 110.84 s, val_loss: 0.482
Epoch   24/50, time: 71.13 s, training_loss: 0.310
Epoch   24/50, time: 108.35 s, val_loss: 0.483
Epoch   25/50, time: 75.32 s, training_loss: 0.308
Epoch   25/50, time: 112.80 s, val_loss: 0.465
Epoch   26/50, time: 71.27 s, training_loss: 0.296
Epoch   26/50, time: 109.14 s, val_loss: 0.477
Epoch   27/50, time: 70.98 s, training_loss: 0.288
Epoch   27/50, time: 108.86 s, val_loss: 0.469
Epoch   28/50, time: 73.40 s, training_loss: 0.278
Epoch   28/50, time: 110.17 s, val_loss: 0.460
Epoch   29/50, time: 70.80 s, training_loss: 0.265
Epoch   29/50, time: 108.32 s, val_loss: 0.466
Epoch   30/50, time: 75.10 s, training_loss: 0.259
Epoch   30/50, time: 115.30 s, val_loss: 0.465
Epoch   31/50, time: 81.70 s, training_loss: 0.257
Epoch   31/50, time: 119.49 s, val_loss: 0.453
Training Metrics:
Accuracy: 0.9894
Precision: 0.7000
Recall: 0.7978
F1 Score: 0.7457
IoU: 0.5945
Dice Coefficient: 0.7457
Validation Metrics:
Accuracy: 0.9810
Precision: 0.5125
Recall: 0.5744
F1 Score: 0.5417
IoU: 0.3714
Dice Coefficient: 0.5417
Epoch   32/50, time: 69.22 s, training_loss: 0.247
Epoch   32/50, time: 105.01 s, val_loss: 0.457
Epoch   33/50, time: 73.97 s, training_loss: 0.243
Epoch   33/50, time: 111.37 s, val_loss: 0.453
Epoch   34/50, time: 72.50 s, training_loss: 0.239
Epoch   34/50, time: 109.82 s, val_loss: 0.469
Epoch   35/50, time: 71.15 s, training_loss: 0.229
Epoch   35/50, time: 108.53 s, val_loss: 0.450
Epoch   36/50, time: 71.96 s, training_loss: 0.225
Epoch   36/50, time: 109.47 s, val_loss: 0.447
Epoch   37/50, time: 76.46 s, training_loss: 0.224
Epoch   37/50, time: 113.86 s, val_loss: 0.478
Epoch   38/50, time: 72.68 s, training_loss: 0.218
Epoch   38/50, time: 110.33 s, val_loss: 0.454
Epoch   39/50, time: 70.24 s, training_loss: 0.218
Epoch   39/50, time: 107.83 s, val_loss: 0.465
Epoch   40/50, time: 73.28 s, training_loss: 0.213
Epoch   40/50, time: 111.05 s, val_loss: 0.454
Epoch   41/50, time: 73.61 s, training_loss: 0.208
Epoch   41/50, time: 111.25 s, val_loss: 0.455
Training Metrics:
Accuracy: 0.9928
Precision: 0.8180
Recall: 0.8085
F1 Score: 0.8132
IoU: 0.6852
Dice Coefficient: 0.8132
Validation Metrics:
Accuracy: 0.9831
Precision: 0.5732
Recall: 0.5376
F1 Score: 0.5548
IoU: 0.3839
Dice Coefficient: 0.5548
Epoch   42/50, time: 68.55 s, training_loss: 0.198
Epoch   42/50, time: 105.66 s, val_loss: 0.439
Epoch   43/50, time: 71.14 s, training_loss: 0.195
Epoch   43/50, time: 108.62 s, val_loss: 0.439
Epoch   44/50, time: 73.80 s, training_loss: 0.192
Epoch   44/50, time: 111.82 s, val_loss: 0.451
Epoch   45/50, time: 75.92 s, training_loss: 0.191
Epoch   45/50, time: 113.54 s, val_loss: 0.450
Epoch   46/50, time: 72.05 s, training_loss: 0.186
Epoch   46/50, time: 109.56 s, val_loss: 0.446
Epoch   47/50, time: 72.48 s, training_loss: 0.182
Epoch   47/50, time: 110.28 s, val_loss: 0.434
Epoch   48/50, time: 74.91 s, training_loss: 0.176
Epoch   48/50, time: 115.60 s, val_loss: 0.440
Epoch   49/50, time: 74.96 s, training_loss: 0.179
Epoch   49/50, time: 112.08 s, val_loss: 0.437
Epoch   50/50, time: 75.22 s, training_loss: 0.180
Epoch   50/50, time: 112.79 s, val_loss: 0.447
Training Metrics:
Accuracy: 0.9939
Precision: 0.8491
Recall: 0.8379
F1 Score: 0.8434
IoU: 0.7293
Dice Coefficient: 0.8434
Validation Metrics:
Accuracy: 0.9832
Precision: 0.5765
Recall: 0.5410
F1 Score: 0.5582
IoU: 0.3871
Dice Coefficient: 0.5582
[I 2025-06-10 20:58:10,547] Trial 24 finished with value: 0.5581557228125963 and parameters: {'batch_size': 16, 'lr': 0.0004978927072114192, 'loss_fn': 'dice_loss'}. Best is trial 23 with value: 0.5805646996970982.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9832
Precision: 0.5765
Recall: 0.5410
F1 Score: 0.5582
IoU: 0.3871
Dice Coefficient: 0.5582
[Trial 24] Finished with val_loss=inf
[Trial 24] Finished with dice_coeff=0.5581557228125963
[Trial 25] Trying batch_size=16, lr=0.0005197812926077875, loss_fn=dice_loss
Epoch    1/50, time: 70.68 s, training_loss: 0.873
Epoch    1/50, time: 108.58 s, val_loss: 0.845
Training Metrics:
Accuracy: 0.9064
Precision: 0.1485
Recall: 0.8049
F1 Score: 0.2508
IoU: 0.1434
Dice Coefficient: 0.2508
Validation Metrics:
Accuracy: 0.9063
Precision: 0.1500
Recall: 0.8105
F1 Score: 0.2531
IoU: 0.1449
Dice Coefficient: 0.2531
Epoch    2/50, time: 72.86 s, training_loss: 0.808
Epoch    2/50, time: 110.18 s, val_loss: 0.794
Epoch    3/50, time: 72.05 s, training_loss: 0.763
Epoch    3/50, time: 110.23 s, val_loss: 0.752
Epoch    4/50, time: 77.03 s, training_loss: 0.734
Epoch    4/50, time: 116.08 s, val_loss: 0.724
Epoch    5/50, time: 76.20 s, training_loss: 0.704
Epoch    5/50, time: 113.77 s, val_loss: 0.719
Epoch    6/50, time: 73.42 s, training_loss: 0.664
Epoch    6/50, time: 110.88 s, val_loss: 0.696
Epoch    7/50, time: 71.68 s, training_loss: 0.616
Epoch    7/50, time: 109.36 s, val_loss: 0.630
Epoch    8/50, time: 74.30 s, training_loss: 0.585
Epoch    8/50, time: 112.20 s, val_loss: 0.597
Epoch    9/50, time: 73.56 s, training_loss: 0.559
Epoch    9/50, time: 111.27 s, val_loss: 0.577
Epoch   10/50, time: 72.34 s, training_loss: 0.526
Epoch   10/50, time: 110.05 s, val_loss: 0.583
Epoch   11/50, time: 73.80 s, training_loss: 0.493
Epoch   11/50, time: 111.58 s, val_loss: 0.555
Training Metrics:
Accuracy: 0.9790
Precision: 0.4687
Recall: 0.5738
F1 Score: 0.5160
IoU: 0.3477
Dice Coefficient: 0.5160
Validation Metrics:
Accuracy: 0.9762
Precision: 0.4139
Recall: 0.5097
F1 Score: 0.4568
IoU: 0.2960
Dice Coefficient: 0.4568
Epoch   12/50, time: 68.17 s, training_loss: 0.472
Epoch   12/50, time: 105.98 s, val_loss: 0.523
Epoch   13/50, time: 72.05 s, training_loss: 0.444
Epoch   13/50, time: 109.79 s, val_loss: 0.525
Epoch   14/50, time: 74.88 s, training_loss: 0.423
Epoch   14/50, time: 117.24 s, val_loss: 0.524
Epoch   15/50, time: 75.25 s, training_loss: 0.401
Epoch   15/50, time: 114.23 s, val_loss: 0.500
Epoch   16/50, time: 72.23 s, training_loss: 0.386
Epoch   16/50, time: 110.57 s, val_loss: 0.508
Epoch   17/50, time: 75.04 s, training_loss: 0.369
Epoch   17/50, time: 113.45 s, val_loss: 0.478
Epoch   18/50, time: 73.04 s, training_loss: 0.348
Epoch   18/50, time: 111.25 s, val_loss: 0.489
Epoch   19/50, time: 77.10 s, training_loss: 0.341
Epoch   19/50, time: 115.07 s, val_loss: 0.477
Epoch   20/50, time: 72.39 s, training_loss: 0.319
Epoch   20/50, time: 111.12 s, val_loss: 0.458
Epoch   21/50, time: 72.55 s, training_loss: 0.311
Epoch   21/50, time: 111.20 s, val_loss: 0.481
Training Metrics:
Accuracy: 0.9878
Precision: 0.6715
Recall: 0.7292
F1 Score: 0.6992
IoU: 0.5375
Dice Coefficient: 0.6992
Validation Metrics:
Accuracy: 0.9810
Precision: 0.5133
Recall: 0.5497
F1 Score: 0.5309
IoU: 0.3614
Dice Coefficient: 0.5309
Epoch   22/50, time: 68.73 s, training_loss: 0.310
Epoch   22/50, time: 106.28 s, val_loss: 0.462
Epoch   23/50, time: 71.55 s, training_loss: 0.293
Epoch   23/50, time: 109.60 s, val_loss: 0.481
Epoch   24/50, time: 73.16 s, training_loss: 0.286
Epoch   24/50, time: 111.08 s, val_loss: 0.457
Epoch   25/50, time: 75.03 s, training_loss: 0.275
Epoch   25/50, time: 113.19 s, val_loss: 0.461
Epoch   26/50, time: 74.14 s, training_loss: 0.267
Epoch   26/50, time: 112.71 s, val_loss: 0.460
Epoch   27/50, time: 75.90 s, training_loss: 0.263
Epoch   27/50, time: 113.68 s, val_loss: 0.464
Epoch   28/50, time: 75.45 s, training_loss: 0.251
Epoch   28/50, time: 112.75 s, val_loss: 0.454
Epoch   29/50, time: 74.64 s, training_loss: 0.239
Epoch   29/50, time: 112.71 s, val_loss: 0.456
Epoch   30/50, time: 71.22 s, training_loss: 0.240
Epoch   30/50, time: 109.31 s, val_loss: 0.466
Epoch   31/50, time: 73.38 s, training_loss: 0.233
Epoch   31/50, time: 111.61 s, val_loss: 0.453
Training Metrics:
Accuracy: 0.9914
Precision: 0.7743
Recall: 0.7844
F1 Score: 0.7793
IoU: 0.6385
Dice Coefficient: 0.7793
Validation Metrics:
Accuracy: 0.9830
Precision: 0.5666
Recall: 0.5597
F1 Score: 0.5632
IoU: 0.3919
Dice Coefficient: 0.5632
Epoch   32/50, time: 70.75 s, training_loss: 0.223
Epoch   32/50, time: 106.66 s, val_loss: 0.445
Epoch   33/50, time: 73.63 s, training_loss: 0.218
Epoch   33/50, time: 111.60 s, val_loss: 0.463
Epoch   34/50, time: 73.34 s, training_loss: 0.218
Epoch   34/50, time: 111.19 s, val_loss: 0.459
Epoch   35/50, time: 72.02 s, training_loss: 0.212
Epoch   35/50, time: 109.45 s, val_loss: 0.452
Epoch   36/50, time: 72.96 s, training_loss: 0.204
Epoch   36/50, time: 110.36 s, val_loss: 0.456
Epoch   37/50, time: 70.55 s, training_loss: 0.201
Epoch   37/50, time: 108.06 s, val_loss: 0.452
Epoch   38/50, time: 76.28 s, training_loss: 0.201
Epoch   38/50, time: 113.20 s, val_loss: 0.447
Epoch   39/50, time: 73.28 s, training_loss: 0.194
Epoch   39/50, time: 111.47 s, val_loss: 0.458
Epoch   40/50, time: 76.63 s, training_loss: 0.194
Epoch   40/50, time: 113.38 s, val_loss: 0.443
Epoch   41/50, time: 71.78 s, training_loss: 0.188
Epoch   41/50, time: 109.16 s, val_loss: 0.454
Training Metrics:
Accuracy: 0.9924
Precision: 0.7944
Recall: 0.8220
F1 Score: 0.8080
IoU: 0.6778
Dice Coefficient: 0.8080
Validation Metrics:
Accuracy: 0.9829
Precision: 0.5648
Recall: 0.5532
F1 Score: 0.5590
IoU: 0.3879
Dice Coefficient: 0.5590
Epoch   42/50, time: 70.47 s, training_loss: 0.183
Epoch   42/50, time: 108.11 s, val_loss: 0.457
Epoch   43/50, time: 71.54 s, training_loss: 0.180
Epoch   43/50, time: 108.60 s, val_loss: 0.450
Epoch   44/50, time: 75.72 s, training_loss: 0.181
Epoch   44/50, time: 112.98 s, val_loss: 0.457
Epoch   45/50, time: 73.22 s, training_loss: 0.178
Epoch   45/50, time: 110.86 s, val_loss: 0.449
Epoch   46/50, time: 73.17 s, training_loss: 0.177
Epoch   46/50, time: 110.41 s, val_loss: 0.438
Epoch   47/50, time: 71.80 s, training_loss: 0.166
Epoch   47/50, time: 109.20 s, val_loss: 0.448
Epoch   48/50, time: 71.57 s, training_loss: 0.165
Epoch   48/50, time: 109.05 s, val_loss: 0.439
Epoch   49/50, time: 71.62 s, training_loss: 0.162
Epoch   49/50, time: 109.38 s, val_loss: 0.441
Epoch   50/50, time: 74.27 s, training_loss: 0.164
Epoch   50/50, time: 111.30 s, val_loss: 0.438
Training Metrics:
Accuracy: 0.9940
Precision: 0.8307
Recall: 0.8720
F1 Score: 0.8508
IoU: 0.7404
Dice Coefficient: 0.8508
Validation Metrics:
Accuracy: 0.9832
Precision: 0.5696
Recall: 0.5815
F1 Score: 0.5755
IoU: 0.4040
Dice Coefficient: 0.5755
[I 2025-06-10 22:44:20,008] Trial 25 finished with value: 0.5754705882352941 and parameters: {'batch_size': 16, 'lr': 0.0005197812926077875, 'loss_fn': 'dice_loss'}. Best is trial 23 with value: 0.5805646996970982.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9832
Precision: 0.5696
Recall: 0.5815
F1 Score: 0.5755
IoU: 0.4040
Dice Coefficient: 0.5755
[Trial 25] Finished with val_loss=inf
[Trial 25] Finished with dice_coeff=0.5754705882352941
[Trial 26] Trying batch_size=16, lr=0.0005448883758422191, loss_fn=bce_loss
Epoch    1/50, time: 68.87 s, training_loss: 0.400
Epoch    1/50, time: 104.78 s, val_loss: 0.303
Training Metrics:
Accuracy: 0.9805
Precision: 0.1456
Recall: 0.0002
F1 Score: 0.0005
IoU: 0.0002
Dice Coefficient: 0.0005
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0512
Recall: 0.0001
F1 Score: 0.0001
IoU: 0.0001
Dice Coefficient: 0.0001
Epoch    2/50, time: 67.67 s, training_loss: 0.247
Epoch    2/50, time: 102.91 s, val_loss: 0.208
Epoch    3/50, time: 75.89 s, training_loss: 0.172
Epoch    3/50, time: 113.24 s, val_loss: 0.148
Epoch    4/50, time: 71.15 s, training_loss: 0.129
Epoch    4/50, time: 108.52 s, val_loss: 0.117
Epoch    5/50, time: 72.48 s, training_loss: 0.105
Epoch    5/50, time: 109.35 s, val_loss: 0.097
Epoch    6/50, time: 73.47 s, training_loss: 0.090
Epoch    6/50, time: 111.27 s, val_loss: 0.085
Epoch    7/50, time: 71.64 s, training_loss: 0.080
Epoch    7/50, time: 110.11 s, val_loss: 0.077
Epoch    8/50, time: 74.87 s, training_loss: 0.074
Epoch    8/50, time: 115.38 s, val_loss: 0.072
Epoch    9/50, time: 77.04 s, training_loss: 0.068
Epoch    9/50, time: 115.17 s, val_loss: 0.068
Epoch   10/50, time: 72.62 s, training_loss: 0.065
Epoch   10/50, time: 110.64 s, val_loss: 0.065
Epoch   11/50, time: 74.88 s, training_loss: 0.061
Epoch   11/50, time: 112.68 s, val_loss: 0.064
Training Metrics:
Accuracy: 0.9805
Precision: 0.4184
Recall: 0.0009
F1 Score: 0.0019
IoU: 0.0009
Dice Coefficient: 0.0019
Validation Metrics:
Accuracy: 0.9804
Precision: 0.3557
Recall: 0.0006
F1 Score: 0.0013
IoU: 0.0006
Dice Coefficient: 0.0013
Epoch   12/50, time: 71.81 s, training_loss: 0.057
Epoch   12/50, time: 109.61 s, val_loss: 0.060
Epoch   13/50, time: 75.86 s, training_loss: 0.054
Epoch   13/50, time: 113.84 s, val_loss: 0.164
Epoch   14/50, time: 73.48 s, training_loss: 0.054
Epoch   14/50, time: 111.54 s, val_loss: 0.055
Epoch   15/50, time: 72.61 s, training_loss: 0.050
Epoch   15/50, time: 110.68 s, val_loss: 0.053
Epoch   16/50, time: 73.03 s, training_loss: 0.048
Epoch   16/50, time: 112.22 s, val_loss: 0.051
Epoch   17/50, time: 73.91 s, training_loss: 0.046
Epoch   17/50, time: 112.22 s, val_loss: 0.051
Epoch   18/50, time: 72.48 s, training_loss: 0.044
Epoch   18/50, time: 110.43 s, val_loss: 0.052
Epoch   19/50, time: 74.55 s, training_loss: 0.042
Epoch   19/50, time: 112.61 s, val_loss: 0.051
Epoch   20/50, time: 71.86 s, training_loss: 0.044
Epoch   20/50, time: 109.81 s, val_loss: 0.048
Epoch   21/50, time: 73.11 s, training_loss: 0.040
Epoch   21/50, time: 110.96 s, val_loss: 0.049
Training Metrics:
Accuracy: 0.9826
Precision: 0.7613
Recall: 0.1579
F1 Score: 0.2615
IoU: 0.1504
Dice Coefficient: 0.2615
Validation Metrics:
Accuracy: 0.9811
Precision: 0.5918
Recall: 0.1186
F1 Score: 0.1977
IoU: 0.1097
Dice Coefficient: 0.1977
Epoch   22/50, time: 73.81 s, training_loss: 0.037
Epoch   22/50, time: 111.76 s, val_loss: 0.046
Epoch   23/50, time: 73.24 s, training_loss: 0.035
Epoch   23/50, time: 111.28 s, val_loss: 0.047
Epoch   24/50, time: 73.60 s, training_loss: 0.033
Epoch   24/50, time: 114.02 s, val_loss: 0.047
Epoch   25/50, time: 74.78 s, training_loss: 0.032
Epoch   25/50, time: 112.84 s, val_loss: 0.047
Epoch   26/50, time: 72.10 s, training_loss: 0.030
Epoch   26/50, time: 109.74 s, val_loss: 0.048
Epoch   27/50, time: 73.38 s, training_loss: 0.028
Epoch   27/50, time: 111.32 s, val_loss: 0.047
Epoch   28/50, time: 73.01 s, training_loss: 0.026
Epoch   28/50, time: 110.82 s, val_loss: 0.049
Epoch   29/50, time: 72.13 s, training_loss: 0.024
Epoch   29/50, time: 109.33 s, val_loss: 0.050
Epoch   30/50, time: 72.71 s, training_loss: 0.023
Epoch   30/50, time: 110.32 s, val_loss: 0.049
Epoch   31/50, time: 71.93 s, training_loss: 0.022
Epoch   31/50, time: 109.37 s, val_loss: 0.052
Training Metrics:
Accuracy: 0.9905
Precision: 0.8836
Recall: 0.5899
F1 Score: 0.7075
IoU: 0.5473
Dice Coefficient: 0.7075
Validation Metrics:
Accuracy: 0.9826
Precision: 0.6009
Recall: 0.3352
F1 Score: 0.4304
IoU: 0.2742
Dice Coefficient: 0.4304
Epoch   32/50, time: 70.04 s, training_loss: 0.021
Epoch   32/50, time: 108.10 s, val_loss: 0.050
Epoch   33/50, time: 74.75 s, training_loss: 0.021
Epoch   33/50, time: 113.07 s, val_loss: 0.051
Epoch   34/50, time: 72.21 s, training_loss: 0.019
Epoch   34/50, time: 110.26 s, val_loss: 0.053
Epoch   35/50, time: 72.98 s, training_loss: 0.018
Epoch   35/50, time: 111.59 s, val_loss: 0.053
Epoch   36/50, time: 76.21 s, training_loss: 0.018
Epoch   36/50, time: 114.68 s, val_loss: 0.055
Epoch   37/50, time: 73.54 s, training_loss: 0.017
Epoch   37/50, time: 112.00 s, val_loss: 0.053
Epoch   38/50, time: 73.34 s, training_loss: 0.017
Epoch   38/50, time: 111.04 s, val_loss: 0.055
Epoch   39/50, time: 72.35 s, training_loss: 0.016
Epoch   39/50, time: 110.15 s, val_loss: 0.056
Epoch   40/50, time: 72.30 s, training_loss: 0.017
Epoch   40/50, time: 110.39 s, val_loss: 0.055
Epoch   41/50, time: 71.29 s, training_loss: 0.016
Epoch   41/50, time: 109.02 s, val_loss: 0.055
Training Metrics:
Accuracy: 0.9931
Precision: 0.9407
Recall: 0.6890
F1 Score: 0.7954
IoU: 0.6603
Dice Coefficient: 0.7954
Validation Metrics:
Accuracy: 0.9832
Precision: 0.6184
Recall: 0.3754
F1 Score: 0.4672
IoU: 0.3048
Dice Coefficient: 0.4672
Epoch   42/50, time: 72.24 s, training_loss: 0.015
Epoch   42/50, time: 110.08 s, val_loss: 0.054
Epoch   43/50, time: 76.86 s, training_loss: 0.015
Epoch   43/50, time: 115.11 s, val_loss: 0.055
Epoch   44/50, time: 73.08 s, training_loss: 0.014
Epoch   44/50, time: 110.67 s, val_loss: 0.057
Epoch   45/50, time: 77.32 s, training_loss: 0.014
Epoch   45/50, time: 115.12 s, val_loss: 0.060
Epoch   46/50, time: 73.13 s, training_loss: 0.014
Epoch   46/50, time: 111.40 s, val_loss: 0.055
Epoch   47/50, time: 73.42 s, training_loss: 0.013
Epoch   47/50, time: 110.99 s, val_loss: 0.062
Epoch   48/50, time: 71.81 s, training_loss: 0.013
Epoch   48/50, time: 110.03 s, val_loss: 0.062
Epoch   49/50, time: 71.13 s, training_loss: 0.013
Epoch   49/50, time: 109.23 s, val_loss: 0.063
Epoch   50/50, time: 72.07 s, training_loss: 0.013
Epoch   50/50, time: 109.85 s, val_loss: 0.061
Training Metrics:
Accuracy: 0.9948
Precision: 0.9073
Recall: 0.8158
F1 Score: 0.8591
IoU: 0.7531
Dice Coefficient: 0.8591
Validation Metrics:
Accuracy: 0.9830
Precision: 0.5817
Recall: 0.4685
F1 Score: 0.5190
IoU: 0.3504
Dice Coefficient: 0.5190
[I 2025-06-11 00:30:27,246] Trial 26 finished with value: 0.5189810485835825 and parameters: {'batch_size': 16, 'lr': 0.0005448883758422191, 'loss_fn': 'bce_loss'}. Best is trial 23 with value: 0.5805646996970982.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9830
Precision: 0.5817
Recall: 0.4685
F1 Score: 0.5190
IoU: 0.3504
Dice Coefficient: 0.5190
[Trial 26] Finished with val_loss=inf
[Trial 26] Finished with dice_coeff=0.5189810485835825
[Trial 27] Trying batch_size=16, lr=0.0007400396420951435, loss_fn=dice_loss
Epoch    1/50, time: 70.08 s, training_loss: 0.846
Epoch    1/50, time: 105.98 s, val_loss: 0.801
Training Metrics:
Accuracy: 0.8898
Precision: 0.1370
Recall: 0.8790
F1 Score: 0.2370
IoU: 0.1344
Dice Coefficient: 0.2370
Validation Metrics:
Accuracy: 0.8890
Precision: 0.1372
Recall: 0.8818
F1 Score: 0.2375
IoU: 0.1347
Dice Coefficient: 0.2375
Epoch    2/50, time: 69.47 s, training_loss: 0.770
Epoch    2/50, time: 107.07 s, val_loss: 0.758
Epoch    3/50, time: 72.75 s, training_loss: 0.737
Epoch    3/50, time: 110.81 s, val_loss: 0.741
Epoch    4/50, time: 70.42 s, training_loss: 0.723
Epoch    4/50, time: 108.78 s, val_loss: 0.721
Epoch    5/50, time: 72.93 s, training_loss: 0.705
Epoch    5/50, time: 110.75 s, val_loss: 0.695
Epoch    6/50, time: 72.88 s, training_loss: 0.672
Epoch    6/50, time: 111.32 s, val_loss: 0.671
Epoch    7/50, time: 73.35 s, training_loss: 0.631
Epoch    7/50, time: 111.52 s, val_loss: 0.645
Epoch    8/50, time: 74.56 s, training_loss: 0.599
Epoch    8/50, time: 112.53 s, val_loss: 0.603
Epoch    9/50, time: 73.25 s, training_loss: 0.575
Epoch    9/50, time: 110.84 s, val_loss: 0.601
Epoch   10/50, time: 72.15 s, training_loss: 0.557
Epoch   10/50, time: 110.10 s, val_loss: 0.575
Epoch   11/50, time: 72.53 s, training_loss: 0.537
Epoch   11/50, time: 110.16 s, val_loss: 0.560
Training Metrics:
Accuracy: 0.9733
Precision: 0.3873
Recall: 0.6424
F1 Score: 0.4832
IoU: 0.3186
Dice Coefficient: 0.4832
Validation Metrics:
Accuracy: 0.9711
Precision: 0.3566
Recall: 0.5885
F1 Score: 0.4441
IoU: 0.2854
Dice Coefficient: 0.4441
Epoch   12/50, time: 68.75 s, training_loss: 0.516
Epoch   12/50, time: 105.83 s, val_loss: 0.554
Epoch   13/50, time: 74.39 s, training_loss: 0.498
Epoch   13/50, time: 112.71 s, val_loss: 0.534
Epoch   14/50, time: 73.36 s, training_loss: 0.475
Epoch   14/50, time: 111.59 s, val_loss: 0.658
Epoch   15/50, time: 73.17 s, training_loss: 0.457
Epoch   15/50, time: 111.45 s, val_loss: 0.534
Epoch   16/50, time: 72.01 s, training_loss: 0.435
Epoch   16/50, time: 109.81 s, val_loss: 0.523
Epoch   17/50, time: 71.74 s, training_loss: 0.418
Epoch   17/50, time: 109.47 s, val_loss: 0.523
Epoch   18/50, time: 75.70 s, training_loss: 0.404
Epoch   18/50, time: 113.94 s, val_loss: 0.505
Epoch   19/50, time: 75.40 s, training_loss: 0.384
Epoch   19/50, time: 114.79 s, val_loss: 0.510
Epoch   20/50, time: 75.20 s, training_loss: 0.372
Epoch   20/50, time: 113.60 s, val_loss: 0.516
Epoch   21/50, time: 74.57 s, training_loss: 0.358
Epoch   21/50, time: 113.06 s, val_loss: 0.503
Training Metrics:
Accuracy: 0.9836
Precision: 0.5563
Recall: 0.7782
F1 Score: 0.6488
IoU: 0.4801
Dice Coefficient: 0.6488
Validation Metrics:
Accuracy: 0.9765
Precision: 0.4303
Recall: 0.6131
F1 Score: 0.5057
IoU: 0.3384
Dice Coefficient: 0.5057
Epoch   22/50, time: 69.60 s, training_loss: 0.350
Epoch   22/50, time: 107.86 s, val_loss: 0.506
Epoch   23/50, time: 71.81 s, training_loss: 0.335
Epoch   23/50, time: 109.88 s, val_loss: 0.505
Epoch   24/50, time: 73.20 s, training_loss: 0.327
Epoch   24/50, time: 111.22 s, val_loss: 0.488
Epoch   25/50, time: 72.34 s, training_loss: 0.315
Epoch   25/50, time: 110.30 s, val_loss: 0.493
Epoch   26/50, time: 71.79 s, training_loss: 0.303
Epoch   26/50, time: 109.57 s, val_loss: 0.487
Epoch   27/50, time: 76.00 s, training_loss: 0.290
Epoch   27/50, time: 114.07 s, val_loss: 0.490
Epoch   28/50, time: 74.88 s, training_loss: 0.280
Epoch   28/50, time: 112.71 s, val_loss: 0.490
Epoch   29/50, time: 71.34 s, training_loss: 0.274
Epoch   29/50, time: 109.44 s, val_loss: 0.487
Epoch   30/50, time: 73.21 s, training_loss: 0.262
Epoch   30/50, time: 111.12 s, val_loss: 0.491
Epoch   31/50, time: 74.11 s, training_loss: 0.258
Epoch   31/50, time: 111.95 s, val_loss: 0.486
Training Metrics:
Accuracy: 0.9906
Precision: 0.7483
Recall: 0.7780
F1 Score: 0.7629
IoU: 0.6166
Dice Coefficient: 0.7629
Validation Metrics:
Accuracy: 0.9813
Precision: 0.5230
Recall: 0.5280
F1 Score: 0.5255
IoU: 0.3564
Dice Coefficient: 0.5255
Epoch   32/50, time: 71.25 s, training_loss: 0.253
Epoch   32/50, time: 109.28 s, val_loss: 0.499
Epoch   33/50, time: 73.04 s, training_loss: 0.248
Epoch   33/50, time: 111.96 s, val_loss: 0.493
Epoch   34/50, time: 72.85 s, training_loss: 0.243
Epoch   34/50, time: 111.08 s, val_loss: 0.523
Epoch   35/50, time: 71.40 s, training_loss: 0.238
Epoch   35/50, time: 109.63 s, val_loss: 0.488
Epoch   36/50, time: 72.08 s, training_loss: 0.226
Epoch   36/50, time: 112.78 s, val_loss: 0.478
Epoch   37/50, time: 74.16 s, training_loss: 0.219
Epoch   37/50, time: 112.04 s, val_loss: 0.484
Epoch   38/50, time: 72.28 s, training_loss: 0.227
Epoch   38/50, time: 110.37 s, val_loss: 0.481
Epoch   39/50, time: 72.15 s, training_loss: 0.211
Epoch   39/50, time: 109.86 s, val_loss: 0.485
Epoch   40/50, time: 71.83 s, training_loss: 0.211
Epoch   40/50, time: 110.61 s, val_loss: 0.493
Epoch   41/50, time: 73.70 s, training_loss: 0.216
Epoch   41/50, time: 111.51 s, val_loss: 0.482
Training Metrics:
Accuracy: 0.9918
Precision: 0.7666
Recall: 0.8318
F1 Score: 0.7978
IoU: 0.6637
Dice Coefficient: 0.7978
Validation Metrics:
Accuracy: 0.9808
Precision: 0.5089
Recall: 0.5450
F1 Score: 0.5263
IoU: 0.3572
Dice Coefficient: 0.5263
Epoch   42/50, time: 72.64 s, training_loss: 0.205
Epoch   42/50, time: 110.66 s, val_loss: 0.492
Epoch   43/50, time: 71.73 s, training_loss: 0.197
Epoch   43/50, time: 109.46 s, val_loss: 0.484
Epoch   44/50, time: 75.80 s, training_loss: 0.190
Epoch   44/50, time: 114.30 s, val_loss: 0.472
Epoch   45/50, time: 73.00 s, training_loss: 0.188
Epoch   45/50, time: 111.16 s, val_loss: 0.482
Epoch   46/50, time: 72.33 s, training_loss: 0.189
Epoch   46/50, time: 110.25 s, val_loss: 0.480
Epoch   47/50, time: 72.97 s, training_loss: 0.186
Epoch   47/50, time: 110.85 s, val_loss: 0.483
Epoch   48/50, time: 71.82 s, training_loss: 0.185
Epoch   48/50, time: 110.18 s, val_loss: 0.489
Epoch   49/50, time: 73.82 s, training_loss: 0.185
Epoch   49/50, time: 112.30 s, val_loss: 0.476
Epoch   50/50, time: 71.17 s, training_loss: 0.177
Epoch   50/50, time: 109.02 s, val_loss: 0.475
Training Metrics:
Accuracy: 0.9934
Precision: 0.8391
Recall: 0.8203
F1 Score: 0.8296
IoU: 0.7088
Dice Coefficient: 0.8296
Validation Metrics:
Accuracy: 0.9824
Precision: 0.5532
Recall: 0.5189
F1 Score: 0.5355
IoU: 0.3656
Dice Coefficient: 0.5355
[I 2025-06-11 02:16:24,192] Trial 27 finished with value: 0.5354714938344116 and parameters: {'batch_size': 16, 'lr': 0.0007400396420951435, 'loss_fn': 'dice_loss'}. Best is trial 23 with value: 0.5805646996970982.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9824
Precision: 0.5532
Recall: 0.5189
F1 Score: 0.5355
IoU: 0.3656
Dice Coefficient: 0.5355
[Trial 27] Finished with val_loss=inf
[Trial 27] Finished with dice_coeff=0.5354714938344116
[Trial 28] Trying batch_size=16, lr=0.0007915766564914117, loss_fn=dice_loss
Epoch    1/50, time: 68.97 s, training_loss: 0.876
Epoch    1/50, time: 107.35 s, val_loss: 0.840
Training Metrics:
Accuracy: 0.8885
Precision: 0.1378
Recall: 0.8993
F1 Score: 0.2390
IoU: 0.1357
Dice Coefficient: 0.2390
Validation Metrics:
Accuracy: 0.8876
Precision: 0.1374
Recall: 0.8974
F1 Score: 0.2383
IoU: 0.1353
Dice Coefficient: 0.2383
Epoch    2/50, time: 69.79 s, training_loss: 0.792
Epoch    2/50, time: 106.16 s, val_loss: 0.768
Epoch    3/50, time: 72.99 s, training_loss: 0.741
Epoch    3/50, time: 111.49 s, val_loss: 0.756
Epoch    4/50, time: 72.42 s, training_loss: 0.718
Epoch    4/50, time: 110.42 s, val_loss: 0.717
Epoch    5/50, time: 72.19 s, training_loss: 0.689
Epoch    5/50, time: 110.03 s, val_loss: 0.689
Epoch    6/50, time: 78.47 s, training_loss: 0.646
Epoch    6/50, time: 116.64 s, val_loss: 0.672
Epoch    7/50, time: 74.91 s, training_loss: 0.605
Epoch    7/50, time: 112.96 s, val_loss: 0.613
Epoch    8/50, time: 72.97 s, training_loss: 0.571
Epoch    8/50, time: 110.60 s, val_loss: 0.744
Epoch    9/50, time: 73.30 s, training_loss: 0.557
Epoch    9/50, time: 111.89 s, val_loss: 0.597
Epoch   10/50, time: 74.86 s, training_loss: 0.525
Epoch   10/50, time: 113.26 s, val_loss: 0.547
Epoch   11/50, time: 75.97 s, training_loss: 0.502
Epoch   11/50, time: 114.21 s, val_loss: 0.576
Training Metrics:
Accuracy: 0.9808
Precision: 0.5082
Recall: 0.4823
F1 Score: 0.4949
IoU: 0.3288
Dice Coefficient: 0.4949
Validation Metrics:
Accuracy: 0.9784
Precision: 0.4474
Recall: 0.4275
F1 Score: 0.4372
IoU: 0.2798
Dice Coefficient: 0.4372
Epoch   12/50, time: 74.11 s, training_loss: 0.474
Epoch   12/50, time: 112.85 s, val_loss: 0.522
Epoch   13/50, time: 73.16 s, training_loss: 0.474
Epoch   13/50, time: 111.19 s, val_loss: 0.543
Epoch   14/50, time: 72.84 s, training_loss: 0.451
Epoch   14/50, time: 110.80 s, val_loss: 0.504
Epoch   15/50, time: 72.67 s, training_loss: 0.422
Epoch   15/50, time: 110.76 s, val_loss: 0.502
Epoch   16/50, time: 72.34 s, training_loss: 0.412
Epoch   16/50, time: 111.33 s, val_loss: 0.535
Epoch   17/50, time: 72.61 s, training_loss: 0.393
Epoch   17/50, time: 110.07 s, val_loss: 0.500
Epoch   18/50, time: 74.19 s, training_loss: 0.375
Epoch   18/50, time: 111.49 s, val_loss: 0.486
Epoch   19/50, time: 74.48 s, training_loss: 0.367
Epoch   19/50, time: 112.54 s, val_loss: 0.502
Epoch   20/50, time: 75.17 s, training_loss: 0.355
Epoch   20/50, time: 113.23 s, val_loss: 0.459
Epoch   21/50, time: 72.39 s, training_loss: 0.342
Epoch   21/50, time: 111.06 s, val_loss: 0.467
Training Metrics:
Accuracy: 0.9846
Precision: 0.5826
Recall: 0.7360
F1 Score: 0.6503
IoU: 0.4818
Dice Coefficient: 0.6503
Validation Metrics:
Accuracy: 0.9791
Precision: 0.4739
Recall: 0.6014
F1 Score: 0.5301
IoU: 0.3606
Dice Coefficient: 0.5301
Epoch   22/50, time: 70.75 s, training_loss: 0.337
Epoch   22/50, time: 109.35 s, val_loss: 0.472
Epoch   23/50, time: 71.82 s, training_loss: 0.330
Epoch   23/50, time: 109.59 s, val_loss: 0.463
Epoch   24/50, time: 73.67 s, training_loss: 0.319
Epoch   24/50, time: 111.78 s, val_loss: 0.455
Epoch   25/50, time: 71.67 s, training_loss: 0.305
Epoch   25/50, time: 109.82 s, val_loss: 0.457
Epoch   26/50, time: 74.72 s, training_loss: 0.296
Epoch   26/50, time: 112.62 s, val_loss: 0.438
Epoch   27/50, time: 73.27 s, training_loss: 0.286
Epoch   27/50, time: 111.16 s, val_loss: 0.441
Epoch   28/50, time: 75.46 s, training_loss: 0.279
Epoch   28/50, time: 113.63 s, val_loss: 0.428
Epoch   29/50, time: 73.86 s, training_loss: 0.274
Epoch   29/50, time: 111.89 s, val_loss: 0.439
Epoch   30/50, time: 72.70 s, training_loss: 0.265
Epoch   30/50, time: 110.16 s, val_loss: 0.459
Epoch   31/50, time: 71.62 s, training_loss: 0.262
Epoch   31/50, time: 109.40 s, val_loss: 0.440
Training Metrics:
Accuracy: 0.9890
Precision: 0.7062
Recall: 0.7431
F1 Score: 0.7242
IoU: 0.5676
Dice Coefficient: 0.7242
Validation Metrics:
Accuracy: 0.9824
Precision: 0.5501
Recall: 0.5697
F1 Score: 0.5598
IoU: 0.3887
Dice Coefficient: 0.5598
Epoch   32/50, time: 73.97 s, training_loss: 0.257
Epoch   32/50, time: 111.26 s, val_loss: 0.453
Epoch   33/50, time: 73.25 s, training_loss: 0.250
Epoch   33/50, time: 110.98 s, val_loss: 0.441
Epoch   34/50, time: 73.84 s, training_loss: 0.241
Epoch   34/50, time: 112.32 s, val_loss: 0.424
Epoch   35/50, time: 73.26 s, training_loss: 0.237
Epoch   35/50, time: 111.07 s, val_loss: 0.435
Epoch   36/50, time: 74.97 s, training_loss: 0.228
Epoch   36/50, time: 112.91 s, val_loss: 0.430
Epoch   37/50, time: 74.06 s, training_loss: 0.225
Epoch   37/50, time: 112.12 s, val_loss: 0.441
Epoch   38/50, time: 71.79 s, training_loss: 0.220
Epoch   38/50, time: 109.12 s, val_loss: 0.425
Epoch   39/50, time: 73.17 s, training_loss: 0.225
Epoch   39/50, time: 111.34 s, val_loss: 0.437
Epoch   40/50, time: 75.68 s, training_loss: 0.210
Epoch   40/50, time: 113.94 s, val_loss: 0.434
Epoch   41/50, time: 72.73 s, training_loss: 0.214
Epoch   41/50, time: 110.80 s, val_loss: 0.429
Training Metrics:
Accuracy: 0.9920
Precision: 0.7839
Recall: 0.8100
F1 Score: 0.7967
IoU: 0.6622
Dice Coefficient: 0.7967
Validation Metrics:
Accuracy: 0.9836
Precision: 0.5810
Recall: 0.5817
F1 Score: 0.5813
IoU: 0.4098
Dice Coefficient: 0.5813
Epoch   42/50, time: 70.19 s, training_loss: 0.209
Epoch   42/50, time: 107.88 s, val_loss: 0.418
Epoch   43/50, time: 72.74 s, training_loss: 0.206
Epoch   43/50, time: 110.93 s, val_loss: 0.439
Epoch   44/50, time: 72.45 s, training_loss: 0.199
Epoch   44/50, time: 110.78 s, val_loss: 0.419
Epoch   45/50, time: 71.69 s, training_loss: 0.194
Epoch   45/50, time: 109.71 s, val_loss: 0.415
Epoch   46/50, time: 74.95 s, training_loss: 0.194
Epoch   46/50, time: 113.00 s, val_loss: 0.421
Epoch   47/50, time: 71.12 s, training_loss: 0.190
Epoch   47/50, time: 109.13 s, val_loss: 0.422
Epoch   48/50, time: 71.75 s, training_loss: 0.193
Epoch   48/50, time: 109.34 s, val_loss: 0.438
Epoch   49/50, time: 73.11 s, training_loss: 0.188
Epoch   49/50, time: 111.06 s, val_loss: 0.418
Epoch   50/50, time: 72.64 s, training_loss: 0.184
Epoch   50/50, time: 112.31 s, val_loss: 0.420
Training Metrics:
Accuracy: 0.9922
Precision: 0.7882
Recall: 0.8203
F1 Score: 0.8039
IoU: 0.6721
Dice Coefficient: 0.8039
Validation Metrics:
Accuracy: 0.9838
Precision: 0.5872
Recall: 0.5918
F1 Score: 0.5895
IoU: 0.4179
Dice Coefficient: 0.5895
[I 2025-06-11 04:02:42,080] Trial 28 finished with value: 0.5894661738387731 and parameters: {'batch_size': 16, 'lr': 0.0007915766564914117, 'loss_fn': 'dice_loss'}. Best is trial 28 with value: 0.5894661738387731.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9838
Precision: 0.5872
Recall: 0.5918
F1 Score: 0.5895
IoU: 0.4179
Dice Coefficient: 0.5895
[Trial 28] Finished with val_loss=inf
[Trial 28] Finished with dice_coeff=0.5894661738387731
[Trial 29] Trying batch_size=128, lr=0.0008163352069570567, loss_fn=bce_loss
Epoch    1/50, time: 84.31 s, training_loss: 0.446
Epoch    1/50, time: 121.82 s, val_loss: 0.604
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch    2/50, time: 82.83 s, training_loss: 0.288
Epoch    2/50, time: 121.35 s, val_loss: 0.428
Epoch    3/50, time: 85.79 s, training_loss: 0.235
Epoch    3/50, time: 123.68 s, val_loss: 0.268
Epoch    4/50, time: 87.18 s, training_loss: 0.208
Epoch    4/50, time: 124.63 s, val_loss: 0.224
Epoch    5/50, time: 87.46 s, training_loss: 0.191
Epoch    5/50, time: 125.11 s, val_loss: 0.192
Epoch    6/50, time: 87.08 s, training_loss: 0.174
Epoch    6/50, time: 124.92 s, val_loss: 0.172
Epoch    7/50, time: 87.33 s, training_loss: 0.161
Epoch    7/50, time: 124.84 s, val_loss: 0.167
Epoch    8/50, time: 88.00 s, training_loss: 0.150
Epoch    8/50, time: 126.31 s, val_loss: 0.153
Epoch    9/50, time: 87.07 s, training_loss: 0.140
Epoch    9/50, time: 125.63 s, val_loss: 0.138
Epoch   10/50, time: 86.27 s, training_loss: 0.131
Epoch   10/50, time: 124.89 s, val_loss: 0.130
Epoch   11/50, time: 86.55 s, training_loss: 0.123
Epoch   11/50, time: 125.33 s, val_loss: 0.117
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.2047
Recall: 0.0001
F1 Score: 0.0001
IoU: 0.0001
Dice Coefficient: 0.0001
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   12/50, time: 86.74 s, training_loss: 0.117
Epoch   12/50, time: 124.97 s, val_loss: 0.116
Epoch   13/50, time: 87.10 s, training_loss: 0.111
Epoch   13/50, time: 125.62 s, val_loss: 0.106
Epoch   14/50, time: 87.01 s, training_loss: 0.105
Epoch   14/50, time: 124.93 s, val_loss: 0.103
Epoch   15/50, time: 85.58 s, training_loss: 0.101
Epoch   15/50, time: 123.11 s, val_loss: 0.101
Epoch   16/50, time: 86.64 s, training_loss: 0.097
Epoch   16/50, time: 124.17 s, val_loss: 0.093
Epoch   17/50, time: 86.36 s, training_loss: 0.093
Epoch   17/50, time: 124.47 s, val_loss: 0.092
Epoch   18/50, time: 85.96 s, training_loss: 0.090
Epoch   18/50, time: 124.45 s, val_loss: 0.088
Epoch   19/50, time: 86.60 s, training_loss: 0.086
Epoch   19/50, time: 124.74 s, val_loss: 0.086
Epoch   20/50, time: 86.15 s, training_loss: 0.084
Epoch   20/50, time: 124.82 s, val_loss: 0.082
Epoch   21/50, time: 87.92 s, training_loss: 0.081
Epoch   21/50, time: 125.82 s, val_loss: 0.083
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.9805
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.0000
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Epoch   22/50, time: 87.92 s, training_loss: 0.079
Epoch   22/50, time: 125.59 s, val_loss: 0.080
Epoch   23/50, time: 87.44 s, training_loss: 0.078
Epoch   23/50, time: 125.32 s, val_loss: 0.077
Epoch   24/50, time: 87.48 s, training_loss: 0.075
Epoch   24/50, time: 125.50 s, val_loss: 0.075
Epoch   25/50, time: 85.78 s, training_loss: 0.074
Epoch   25/50, time: 124.08 s, val_loss: 0.074
Epoch   26/50, time: 86.78 s, training_loss: 0.071
Epoch   26/50, time: 125.79 s, val_loss: 0.074
Epoch   27/50, time: 86.85 s, training_loss: 0.070
Epoch   27/50, time: 124.44 s, val_loss: 0.077
Epoch   28/50, time: 86.93 s, training_loss: 0.070
Epoch   28/50, time: 125.13 s, val_loss: 0.072
Epoch   29/50, time: 87.21 s, training_loss: 0.068
Epoch   29/50, time: 125.50 s, val_loss: 0.068
Epoch   30/50, time: 86.36 s, training_loss: 0.067
Epoch   30/50, time: 124.13 s, val_loss: 0.069
Epoch   31/50, time: 86.58 s, training_loss: 0.065
Epoch   31/50, time: 124.98 s, val_loss: 0.069
Training Metrics:
Accuracy: 0.9805
Precision: 0.9231
Recall: 0.0000
F1 Score: 0.0000
IoU: 0.0000
Dice Coefficient: 0.0000
Validation Metrics:
Accuracy: 0.9804
Precision: 0.2963
Recall: 0.0001
F1 Score: 0.0001
IoU: 0.0001
Dice Coefficient: 0.0001
Epoch   32/50, time: 86.21 s, training_loss: 0.064
Epoch   32/50, time: 123.64 s, val_loss: 0.067
Epoch   33/50, time: 86.60 s, training_loss: 0.062
Epoch   33/50, time: 124.91 s, val_loss: 0.066
Epoch   34/50, time: 87.14 s, training_loss: 0.061
Epoch   34/50, time: 124.81 s, val_loss: 0.063
Epoch   35/50, time: 88.18 s, training_loss: 0.060
Epoch   35/50, time: 125.99 s, val_loss: 0.067
Epoch   36/50, time: 85.37 s, training_loss: 0.061
Epoch   36/50, time: 123.47 s, val_loss: 0.064
Epoch   37/50, time: 87.26 s, training_loss: 0.059
Epoch   37/50, time: 125.55 s, val_loss: 0.063
Epoch   38/50, time: 87.61 s, training_loss: 0.058
Epoch   38/50, time: 125.01 s, val_loss: 0.064
Epoch   39/50, time: 85.70 s, training_loss: 0.057
Epoch   39/50, time: 123.64 s, val_loss: 0.059
Epoch   40/50, time: 87.68 s, training_loss: 0.056
Epoch   40/50, time: 126.23 s, val_loss: 0.059
Epoch   41/50, time: 86.70 s, training_loss: 0.054
Epoch   41/50, time: 124.57 s, val_loss: 0.062
Training Metrics:
Accuracy: 0.9806
Precision: 0.6621
Recall: 0.0021
F1 Score: 0.0043
IoU: 0.0021
Dice Coefficient: 0.0043
Validation Metrics:
Accuracy: 0.9804
Precision: 0.5420
Recall: 0.0016
F1 Score: 0.0033
IoU: 0.0016
Dice Coefficient: 0.0033
Epoch   42/50, time: 87.37 s, training_loss: 0.053
Epoch   42/50, time: 125.18 s, val_loss: 0.057
Epoch   43/50, time: 86.72 s, training_loss: 0.051
Epoch   43/50, time: 124.92 s, val_loss: 0.060
Epoch   44/50, time: 86.51 s, training_loss: 0.050
Epoch   44/50, time: 124.63 s, val_loss: 0.061
Epoch   45/50, time: 86.53 s, training_loss: 0.050
Epoch   45/50, time: 124.16 s, val_loss: 0.059
Epoch   46/50, time: 88.95 s, training_loss: 0.049
Epoch   46/50, time: 126.62 s, val_loss: 0.058
Epoch   47/50, time: 87.30 s, training_loss: 0.048
Epoch   47/50, time: 124.78 s, val_loss: 0.056
Epoch   48/50, time: 87.40 s, training_loss: 0.047
Epoch   48/50, time: 124.78 s, val_loss: 0.057
Epoch   49/50, time: 86.68 s, training_loss: 0.046
Epoch   49/50, time: 124.64 s, val_loss: 0.056
Epoch   50/50, time: 86.12 s, training_loss: 0.045
Epoch   50/50, time: 124.03 s, val_loss: 0.056
Training Metrics:
Accuracy: 0.9814
Precision: 0.8002
Recall: 0.0599
F1 Score: 0.1115
IoU: 0.0590
Dice Coefficient: 0.1115
Validation Metrics:
Accuracy: 0.9807
Precision: 0.5902
Recall: 0.0418
F1 Score: 0.0780
IoU: 0.0406
Dice Coefficient: 0.0780
[I 2025-06-11 06:03:28,582] Trial 29 finished with value: 0.07800512928689589 and parameters: {'batch_size': 128, 'lr': 0.0008163352069570567, 'loss_fn': 'bce_loss'}. Best is trial 28 with value: 0.5894661738387731.
Test Metrics:
Accuracy: 0.9807
Precision: 0.5902
Recall: 0.0418
F1 Score: 0.0780
IoU: 0.0406
Dice Coefficient: 0.0780
[Trial 29] Finished with val_loss=inf
[Trial 29] Finished with dice_coeff=0.07800512928689589
Best params: {'batch_size': 16, 'lr': 0.0007915766564914117, 'loss_fn': 'dice_loss'}
Best val loss: 0.5894661738387731
