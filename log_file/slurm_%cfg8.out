slurmstepd: error: *** JOB 8190518 ON gpu17 CANCELLED AT 2025-06-16T19:31:15 ***
Epoch    1/50, time: 203.68 s, training_loss: 0.981
Epoch    1/50, time: 28.67 s, val_loss: 0.989
Training Metrics:
Accuracy: 0.2476
Precision: 0.5017
Recall: 0.5626
F1 Score: 0.2020
IoU: 0.0057
Dice Coefficient: 0.0114
Validation Metrics:
Accuracy: 0.2469
Precision: 0.5015
Recall: 0.5604
F1 Score: 0.2014
IoU: 0.0055
Dice Coefficient: 0.0109
Epoch    2/50, time: 188.10 s, training_loss: 0.974
Epoch    2/50, time: 33.09 s, val_loss: 0.977
Epoch    3/50, time: 192.28 s, training_loss: 0.968
Epoch    3/50, time: 32.14 s, val_loss: 0.976
Epoch    4/50, time: 208.49 s, training_loss: 0.964
Epoch    4/50, time: 28.93 s, val_loss: 0.951
Epoch    5/50, time: 181.21 s, training_loss: 0.957
Epoch    5/50, time: 30.39 s, val_loss: 0.918
Epoch    6/50, time: 188.64 s, training_loss: 0.952
Epoch    6/50, time: 32.25 s, val_loss: 0.948
Epoch    7/50, time: 187.92 s, training_loss: 0.945
Epoch    7/50, time: 31.76 s, val_loss: 0.941
Epoch    8/50, time: 184.24 s, training_loss: 0.939
Epoch    8/50, time: 30.72 s, val_loss: 0.976
Epoch    9/50, time: 171.75 s, training_loss: 0.938
Epoch    9/50, time: 30.89 s, val_loss: 0.943
Epoch   10/50, time: 181.85 s, training_loss: 0.932
Epoch   10/50, time: 31.04 s, val_loss: 0.918
Epoch   11/50, time: 192.09 s, training_loss: 0.926
Epoch   11/50, time: 30.79 s, val_loss: 0.913
Training Metrics:
Accuracy: 0.7052
Precision: 0.5061
Recall: 0.7593
F1 Score: 0.4263
IoU: 0.0134
Dice Coefficient: 0.0264
Validation Metrics:
Accuracy: 0.7817
Precision: 0.5078
Recall: 0.7837
F1 Score: 0.4550
IoU: 0.0168
Dice Coefficient: 0.0330
Epoch   12/50, time: 203.16 s, training_loss: 0.920
Epoch   12/50, time: 32.96 s, val_loss: 0.972
Epoch   13/50, time: 197.76 s, training_loss: 0.917
Epoch   13/50, time: 33.45 s, val_loss: 0.898
Epoch   14/50, time: 190.28 s, training_loss: 0.904
Epoch   14/50, time: 31.62 s, val_loss: 0.923
Epoch   15/50, time: 225.88 s, training_loss: 0.888
Epoch   15/50, time: 33.51 s, val_loss: 0.959
Epoch   16/50, time: 200.00 s, training_loss: 0.881
Epoch   16/50, time: 35.12 s, val_loss: 0.901
Epoch   17/50, time: 183.67 s, training_loss: 0.865
Epoch   17/50, time: 31.87 s, val_loss: 0.845
Epoch   18/50, time: 186.55 s, training_loss: 0.861
Epoch   18/50, time: 30.26 s, val_loss: 0.857
Epoch   19/50, time: 228.32 s, training_loss: 0.851
Epoch   19/50, time: 32.30 s, val_loss: 0.840
Epoch   20/50, time: 191.38 s, training_loss: 0.851
Epoch   20/50, time: 33.91 s, val_loss: 0.935
Epoch   21/50, time: 193.61 s, training_loss: 0.842
Epoch   21/50, time: 27.37 s, val_loss: 0.970
Training Metrics:
Accuracy: 0.4584
Precision: 0.5013
Recall: 0.5684
F1 Score: 0.3195
IoU: 0.0061
Dice Coefficient: 0.0122
Validation Metrics:
Accuracy: 0.1556
Precision: 0.5016
Recall: 0.5437
F1 Score: 0.1370
IoU: 0.0052
Dice Coefficient: 0.0104
Epoch   22/50, time: 175.96 s, training_loss: 0.836
Epoch   22/50, time: 30.76 s, val_loss: 0.827
Epoch   23/50, time: 182.29 s, training_loss: 0.817
Epoch   23/50, time: 34.34 s, val_loss: 0.802
Epoch   24/50, time: 198.49 s, training_loss: 0.817
Epoch   24/50, time: 33.82 s, val_loss: 0.843
Epoch   25/50, time: 183.67 s, training_loss: 0.807
Epoch   25/50, time: 31.79 s, val_loss: 0.811
Epoch   26/50, time: 171.73 s, training_loss: 0.801
Epoch   26/50, time: 30.82 s, val_loss: 0.771
Epoch   27/50, time: 186.63 s, training_loss: 0.795
Epoch   27/50, time: 30.23 s, val_loss: 0.773
Epoch   28/50, time: 204.19 s, training_loss: 0.788
Epoch   28/50, time: 32.38 s, val_loss: 0.780
Epoch   29/50, time: 203.88 s, training_loss: 0.782
Epoch   29/50, time: 34.23 s, val_loss: 0.785
Epoch   30/50, time: 193.11 s, training_loss: 0.782
Epoch   30/50, time: 31.26 s, val_loss: 0.779
Epoch   31/50, time: 184.03 s, training_loss: 0.780
Epoch   31/50, time: 33.57 s, val_loss: 0.769
Training Metrics:
Accuracy: 0.8638
Precision: 0.5069
Recall: 0.6657
F1 Score: 0.4796
IoU: 0.0165
Dice Coefficient: 0.0325
Validation Metrics:
Accuracy: 0.8836
Precision: 0.5085
Recall: 0.6857
F1 Score: 0.4881
IoU: 0.0194
Dice Coefficient: 0.0381
Epoch   32/50, time: 182.87 s, training_loss: 0.777
Epoch   32/50, time: 30.82 s, val_loss: 0.747
Epoch   33/50, time: 175.09 s, training_loss: 0.762
Epoch   33/50, time: 24.96 s, val_loss: 0.756
Epoch   34/50, time: 141.13 s, training_loss: 0.761
Epoch   34/50, time: 24.16 s, val_loss: 0.755
Epoch   35/50, time: 144.82 s, training_loss: 0.755
Epoch   35/50, time: 26.00 s, val_loss: 0.749
Epoch   36/50, time: 159.20 s, training_loss: 0.749
Epoch   36/50, time: 24.93 s, val_loss: 0.748
Epoch   37/50, time: 154.33 s, training_loss: 0.749
Epoch   37/50, time: 22.67 s, val_loss: 0.787
Epoch   38/50, time: 172.61 s, training_loss: 0.745
Epoch   38/50, time: 40.32 s, val_loss: 0.725
Epoch   39/50, time: 183.71 s, training_loss: 0.740
Epoch   39/50, time: 31.13 s, val_loss: 0.728
Epoch   40/50, time: 170.05 s, training_loss: 0.727
Epoch   40/50, time: 22.54 s, val_loss: 0.722
Epoch   41/50, time: 141.22 s, training_loss: 0.727
Epoch   41/50, time: 26.32 s, val_loss: 0.739
Training Metrics:
Accuracy: 0.9411
Precision: 0.5172
Recall: 0.6933
F1 Score: 0.5192
IoU: 0.0356
Dice Coefficient: 0.0688
Validation Metrics:
Accuracy: 0.9352
Precision: 0.5152
Recall: 0.6939
F1 Score: 0.5142
IoU: 0.0319
Dice Coefficient: 0.0619
Epoch   42/50, time: 189.52 s, training_loss: 0.725
Epoch   42/50, time: 32.04 s, val_loss: 0.727
Epoch   43/50, time: 179.63 s, training_loss: 0.721
Epoch   43/50, time: 30.53 s, val_loss: 0.751
Epoch   44/50, time: 183.11 s, training_loss: 0.714
Epoch   44/50, time: 32.17 s, val_loss: 0.732
Epoch   45/50, time: 174.96 s, training_loss: 0.725
Epoch   45/50, time: 32.65 s, val_loss: 0.704
Epoch   46/50, time: 171.71 s, training_loss: 0.754
Epoch   46/50, time: 24.79 s, val_loss: 0.795
Epoch   47/50, time: 160.86 s, training_loss: 0.746
Epoch   47/50, time: 22.35 s, val_loss: 0.756
Epoch   48/50, time: 138.41 s, training_loss: 0.734
Epoch   48/50, time: 25.40 s, val_loss: 0.721
Epoch   49/50, time: 216.14 s, training_loss: 0.724
Epoch   49/50, time: 30.92 s, val_loss: 0.727
Epoch   50/50, time: 179.24 s, training_loss: 0.720
Epoch   50/50, time: 29.75 s, val_loss: 0.723
Training Metrics:
Accuracy: 0.9293
Precision: 0.5199
Recall: 0.7718
F1 Score: 0.5208
IoU: 0.0408
Dice Coefficient: 0.0784
Validation Metrics:
Accuracy: 0.9282
Precision: 0.5187
Recall: 0.7668
F1 Score: 0.5183
IoU: 0.0384
Dice Coefficient: 0.0739
[I 2025-06-17 02:29:39,220] Trial 0 finished with value: 0.0738760437877655 and parameters: {'batch_size': 128, 'lr': 0.0006794999537965634, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.0738760437877655.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9282
Precision: 0.5187
Recall: 0.7668
F1 Score: 0.5183
IoU: 0.0384
Dice Coefficient: 0.0739
[Trial 0] Finished with val_loss=inf
[Trial 0] Finished with dice_coeff=0.0738760437877655
[Trial 1] Trying batch_size=128, lr=0.0001491122467609156, loss_fn=dice_loss
Epoch    1/50, time: 194.33 s, training_loss: 0.983
Epoch    1/50, time: 38.10 s, val_loss: 0.989
Training Metrics:
Accuracy: 0.5405
Precision: 0.5033
Recall: 0.6686
F1 Score: 0.3585
IoU: 0.0084
Dice Coefficient: 0.0168
Validation Metrics:
Accuracy: 0.5376
Precision: 0.5034
Recall: 0.6768
F1 Score: 0.3571
IoU: 0.0083
Dice Coefficient: 0.0165
Epoch    2/50, time: 162.70 s, training_loss: 0.981
Epoch    2/50, time: 31.29 s, val_loss: 0.985
Epoch    3/50, time: 183.93 s, training_loss: 0.980
Epoch    3/50, time: 31.06 s, val_loss: 0.987
Epoch    4/50, time: 179.79 s, training_loss: 0.978
Epoch    4/50, time: 30.61 s, val_loss: 0.985
Epoch    5/50, time: 188.66 s, training_loss: 0.977
Epoch    5/50, time: 31.44 s, val_loss: 0.975
Epoch    6/50, time: 166.14 s, training_loss: 0.974
Epoch    6/50, time: 31.37 s, val_loss: 0.976
Epoch    7/50, time: 166.43 s, training_loss: 0.973
Epoch    7/50, time: 30.07 s, val_loss: 0.945
Epoch    8/50, time: 162.73 s, training_loss: 0.969
Epoch    8/50, time: 29.41 s, val_loss: 0.981
Epoch    9/50, time: 166.94 s, training_loss: 0.967
Epoch    9/50, time: 31.06 s, val_loss: 0.964
Epoch   10/50, time: 168.96 s, training_loss: 0.966
Epoch   10/50, time: 30.24 s, val_loss: 0.985
Epoch   11/50, time: 179.27 s, training_loss: 0.963
Epoch   11/50, time: 30.96 s, val_loss: 0.943
Training Metrics:
Accuracy: 0.2517
Precision: 0.5020
Recall: 0.5749
F1 Score: 0.2048
IoU: 0.0059
Dice Coefficient: 0.0117
Validation Metrics:
Accuracy: 0.3556
Precision: 0.5020
Recall: 0.5991
F1 Score: 0.2671
IoU: 0.0062
Dice Coefficient: 0.0123
Epoch   12/50, time: 171.69 s, training_loss: 0.963
Epoch   12/50, time: 29.50 s, val_loss: 0.963
Epoch   13/50, time: 177.24 s, training_loss: 0.960
Epoch   13/50, time: 30.71 s, val_loss: 0.965
Epoch   14/50, time: 198.85 s, training_loss: 0.960
Epoch   14/50, time: 29.01 s, val_loss: 0.963
Epoch   15/50, time: 170.51 s, training_loss: 0.958
Epoch   15/50, time: 31.95 s, val_loss: 0.964
Epoch   16/50, time: 185.00 s, training_loss: 0.956
Epoch   16/50, time: 31.76 s, val_loss: 0.944
Epoch   17/50, time: 188.51 s, training_loss: 0.954
Epoch   17/50, time: 29.37 s, val_loss: 0.941
Epoch   18/50, time: 183.62 s, training_loss: 0.954
Epoch   18/50, time: 30.61 s, val_loss: 0.965
Epoch   19/50, time: 168.20 s, training_loss: 0.951
Epoch   19/50, time: 32.34 s, val_loss: 0.917
Epoch   20/50, time: 190.31 s, training_loss: 0.950
Epoch   20/50, time: 32.36 s, val_loss: 0.956
Epoch   21/50, time: 176.91 s, training_loss: 0.948
Epoch   21/50, time: 33.56 s, val_loss: 0.979
Training Metrics:
Accuracy: 0.1475
Precision: 0.5022
Recall: 0.5543
F1 Score: 0.1309
IoU: 0.0055
Dice Coefficient: 0.0110
Validation Metrics:
Accuracy: 0.0836
Precision: 0.5021
Recall: 0.5319
F1 Score: 0.0785
IoU: 0.0051
Dice Coefficient: 0.0101
Epoch   22/50, time: 177.96 s, training_loss: 0.948
Epoch   22/50, time: 30.94 s, val_loss: 0.940
Epoch   23/50, time: 180.03 s, training_loss: 0.945
Epoch   23/50, time: 31.91 s, val_loss: 0.964
Epoch   24/50, time: 175.39 s, training_loss: 0.942
Epoch   24/50, time: 30.76 s, val_loss: 0.929
Epoch   25/50, time: 166.43 s, training_loss: 0.939
Epoch   25/50, time: 30.83 s, val_loss: 0.953
Epoch   26/50, time: 174.23 s, training_loss: 0.939
Epoch   26/50, time: 38.93 s, val_loss: 0.956
Epoch   27/50, time: 178.82 s, training_loss: 0.936
Epoch   27/50, time: 32.29 s, val_loss: 0.924
Epoch   28/50, time: 168.73 s, training_loss: 0.934
Epoch   28/50, time: 30.56 s, val_loss: 0.935
Epoch   29/50, time: 170.75 s, training_loss: 0.931
Epoch   29/50, time: 31.68 s, val_loss: 0.924
Epoch   30/50, time: 198.97 s, training_loss: 0.930
Epoch   30/50, time: 31.45 s, val_loss: 0.928
Epoch   31/50, time: 186.25 s, training_loss: 0.926
Epoch   31/50, time: 31.08 s, val_loss: 0.956
Training Metrics:
Accuracy: 0.2222
Precision: 0.5014
Recall: 0.5506
F1 Score: 0.1850
IoU: 0.0055
Dice Coefficient: 0.0110
Validation Metrics:
Accuracy: 0.1943
Precision: 0.5016
Recall: 0.5509
F1 Score: 0.1655
IoU: 0.0053
Dice Coefficient: 0.0106
Epoch   32/50, time: 183.42 s, training_loss: 0.925
Epoch   32/50, time: 38.61 s, val_loss: 0.890
Epoch   33/50, time: 159.57 s, training_loss: 0.921
Epoch   33/50, time: 31.18 s, val_loss: 0.904
Epoch   34/50, time: 171.97 s, training_loss: 0.915
Epoch   34/50, time: 30.16 s, val_loss: 0.913
Epoch   35/50, time: 174.04 s, training_loss: 0.911
Epoch   35/50, time: 30.69 s, val_loss: 0.937
Epoch   36/50, time: 176.42 s, training_loss: 0.914
Epoch   36/50, time: 27.67 s, val_loss: 0.914
Epoch   37/50, time: 162.40 s, training_loss: 0.909
Epoch   37/50, time: 26.82 s, val_loss: 0.842
Epoch   38/50, time: 145.95 s, training_loss: 0.909
Epoch   38/50, time: 27.25 s, val_loss: 0.809
Epoch   39/50, time: 168.14 s, training_loss: 0.904
Epoch   39/50, time: 29.37 s, val_loss: 0.898
Epoch   40/50, time: 153.13 s, training_loss: 0.900
Epoch   40/50, time: 27.59 s, val_loss: 0.937
Epoch   41/50, time: 171.99 s, training_loss: 0.901
Epoch   41/50, time: 30.35 s, val_loss: 0.942
Training Metrics:
Accuracy: 0.2493
Precision: 0.5017
Recall: 0.5636
F1 Score: 0.2031
IoU: 0.0057
Dice Coefficient: 0.0114
Validation Metrics:
Accuracy: 0.1860
Precision: 0.5016
Recall: 0.5499
F1 Score: 0.1596
IoU: 0.0053
Dice Coefficient: 0.0106
Epoch   42/50, time: 176.37 s, training_loss: 0.896
Epoch   42/50, time: 30.55 s, val_loss: 0.865
Epoch   43/50, time: 171.84 s, training_loss: 0.890
Epoch   43/50, time: 29.32 s, val_loss: 0.857
Epoch   44/50, time: 195.47 s, training_loss: 0.888
Epoch   44/50, time: 30.47 s, val_loss: 0.887
Epoch   45/50, time: 162.46 s, training_loss: 0.882
Epoch   45/50, time: 31.05 s, val_loss: 0.913
Epoch   46/50, time: 176.28 s, training_loss: 0.883
Epoch   46/50, time: 31.35 s, val_loss: 0.852
Epoch   47/50, time: 171.46 s, training_loss: 0.878
Epoch   47/50, time: 31.76 s, val_loss: 0.836
Epoch   48/50, time: 168.66 s, training_loss: 0.875
Epoch   48/50, time: 30.26 s, val_loss: 0.873
Epoch   49/50, time: 187.82 s, training_loss: 0.868
Epoch   49/50, time: 30.90 s, val_loss: 0.804
Epoch   50/50, time: 169.64 s, training_loss: 0.867
Epoch   50/50, time: 31.70 s, val_loss: 0.828
Training Metrics:
Accuracy: 0.4262
Precision: 0.5025
Recall: 0.6230
F1 Score: 0.3046
IoU: 0.0070
Dice Coefficient: 0.0139
Validation Metrics:
Accuracy: 0.5598
Precision: 0.5030
Recall: 0.6567
F1 Score: 0.3662
IoU: 0.0081
Dice Coefficient: 0.0160
[I 2025-06-17 16:48:01,594] Trial 1 finished with value: 0.01599743391213118 and parameters: {'batch_size': 128, 'lr': 0.0001491122467609156, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.0738760437877655.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.5598
Precision: 0.5030
Recall: 0.6567
F1 Score: 0.3662
IoU: 0.0081
Dice Coefficient: 0.0160
[Trial 1] Finished with val_loss=inf
[Trial 1] Finished with dice_coeff=0.01599743391213118
[Trial 2] Trying batch_size=64, lr=0.0006105290932174468, loss_fn=dice_loss
Epoch    1/50, time: 132.51 s, training_loss: 0.981
Epoch    1/50, time: 25.40 s, val_loss: 0.988
Training Metrics:
Accuracy: 0.1164
Precision: 0.5001
Recall: 0.5026
F1 Score: 0.1061
IoU: 0.0049
Dice Coefficient: 0.0098
Validation Metrics:
Accuracy: 0.1426
Precision: 0.5007
Recall: 0.5180
F1 Score: 0.1269
IoU: 0.0049
Dice Coefficient: 0.0098
Epoch    2/50, time: 126.26 s, training_loss: 0.973
Epoch    2/50, time: 24.82 s, val_loss: 0.956
Epoch    3/50, time: 120.23 s, training_loss: 0.967
Epoch    3/50, time: 24.68 s, val_loss: 0.966
Epoch    4/50, time: 123.66 s, training_loss: 0.961
Epoch    4/50, time: 24.68 s, val_loss: 0.972
Epoch    5/50, time: 122.81 s, training_loss: 0.951
Epoch    5/50, time: 24.79 s, val_loss: 0.947
Epoch    6/50, time: 121.12 s, training_loss: 0.930
Epoch    6/50, time: 25.03 s, val_loss: 0.942
Epoch    7/50, time: 123.28 s, training_loss: 0.920
Epoch    7/50, time: 24.45 s, val_loss: 0.856
Epoch    8/50, time: 128.22 s, training_loss: 0.908
Epoch    8/50, time: 24.68 s, val_loss: 0.851
Epoch    9/50, time: 125.56 s, training_loss: 0.891
Epoch    9/50, time: 24.87 s, val_loss: 0.880
Epoch   10/50, time: 112.87 s, training_loss: 0.880
Epoch   10/50, time: 26.62 s, val_loss: 0.857
Epoch   11/50, time: 117.23 s, training_loss: 0.868
Epoch   11/50, time: 26.49 s, val_loss: 0.924
Training Metrics:
Accuracy: 0.4988
Precision: 0.5016
Recall: 0.5806
F1 Score: 0.3385
IoU: 0.0065
Dice Coefficient: 0.0128
Validation Metrics:
Accuracy: 0.3830
Precision: 0.5019
Recall: 0.5962
F1 Score: 0.2818
IoU: 0.0062
Dice Coefficient: 0.0123
Epoch   12/50, time: 136.92 s, training_loss: 0.855
Epoch   12/50, time: 24.88 s, val_loss: 0.852
Epoch   13/50, time: 127.81 s, training_loss: 0.842
Epoch   13/50, time: 25.27 s, val_loss: 0.857
Epoch   14/50, time: 115.00 s, training_loss: 0.835
Epoch   14/50, time: 24.84 s, val_loss: 0.854
Epoch   15/50, time: 124.89 s, training_loss: 0.821
Epoch   15/50, time: 26.34 s, val_loss: 0.810
Epoch   16/50, time: 114.19 s, training_loss: 0.809
Epoch   16/50, time: 26.92 s, val_loss: 0.806
Epoch   17/50, time: 117.57 s, training_loss: 0.817
Epoch   17/50, time: 25.79 s, val_loss: 0.883
Epoch   18/50, time: 110.79 s, training_loss: 0.800
Epoch   18/50, time: 26.70 s, val_loss: 0.789
Epoch   19/50, time: 119.60 s, training_loss: 0.783
Epoch   19/50, time: 25.82 s, val_loss: 0.762
Epoch   20/50, time: 118.01 s, training_loss: 0.765
Epoch   20/50, time: 27.06 s, val_loss: 0.763
Epoch   21/50, time: 124.87 s, training_loss: 0.762
Epoch   21/50, time: 25.29 s, val_loss: 0.753
Training Metrics:
Accuracy: 0.8389
Precision: 0.5075
Recall: 0.7070
F1 Score: 0.4730
IoU: 0.0172
Dice Coefficient: 0.0338
Validation Metrics:
Accuracy: 0.8410
Precision: 0.5072
Recall: 0.7040
F1 Score: 0.4730
IoU: 0.0166
Dice Coefficient: 0.0326
Epoch   22/50, time: 136.04 s, training_loss: 0.747
Epoch   22/50, time: 25.19 s, val_loss: 0.743
Epoch   23/50, time: 121.85 s, training_loss: 0.739
Epoch   23/50, time: 23.14 s, val_loss: 0.738
Epoch   24/50, time: 117.29 s, training_loss: 0.734
Epoch   24/50, time: 24.84 s, val_loss: 0.755
Epoch   25/50, time: 127.06 s, training_loss: 0.724
Epoch   25/50, time: 26.58 s, val_loss: 0.739
Epoch   26/50, time: 125.30 s, training_loss: 0.711
Epoch   26/50, time: 24.44 s, val_loss: 0.704
Epoch   27/50, time: 126.13 s, training_loss: 0.700
Epoch   27/50, time: 24.97 s, val_loss: 0.745
Epoch   28/50, time: 117.94 s, training_loss: 0.697
Epoch   28/50, time: 24.44 s, val_loss: 0.713
Epoch   29/50, time: 114.06 s, training_loss: 0.684
Epoch   29/50, time: 25.13 s, val_loss: 0.698
Epoch   30/50, time: 109.72 s, training_loss: 0.681
Epoch   30/50, time: 22.34 s, val_loss: 0.724
Epoch   31/50, time: 117.57 s, training_loss: 0.683
Epoch   31/50, time: 23.08 s, val_loss: 0.683
Training Metrics:
Accuracy: 0.9373
Precision: 0.5164
Recall: 0.6954
F1 Score: 0.5168
IoU: 0.0341
Dice Coefficient: 0.0659
Validation Metrics:
Accuracy: 0.9270
Precision: 0.5134
Recall: 0.6909
F1 Score: 0.5088
IoU: 0.0285
Dice Coefficient: 0.0555
Epoch   32/50, time: 135.32 s, training_loss: 0.661
Epoch   32/50, time: 26.49 s, val_loss: 0.672
Epoch   33/50, time: 127.04 s, training_loss: 0.648
Epoch   33/50, time: 24.66 s, val_loss: 0.651
Epoch   34/50, time: 130.03 s, training_loss: 0.702
Epoch   34/50, time: 24.52 s, val_loss: 0.701
Epoch   35/50, time: 124.38 s, training_loss: 0.679
Epoch   35/50, time: 25.45 s, val_loss: 0.654
Epoch   36/50, time: 126.76 s, training_loss: 0.686
Epoch   36/50, time: 25.05 s, val_loss: 0.700
Epoch   37/50, time: 126.40 s, training_loss: 0.667
Epoch   37/50, time: 24.75 s, val_loss: 0.670
Epoch   38/50, time: 122.61 s, training_loss: 0.653
Epoch   38/50, time: 24.25 s, val_loss: 0.642
Epoch   39/50, time: 117.01 s, training_loss: 0.643
Epoch   39/50, time: 24.66 s, val_loss: 0.646
Epoch   40/50, time: 118.91 s, training_loss: 0.630
Epoch   40/50, time: 24.51 s, val_loss: 0.628
Epoch   41/50, time: 123.68 s, training_loss: 0.646
Epoch   41/50, time: 24.89 s, val_loss: 0.636
Training Metrics:
Accuracy: 0.9409
Precision: 0.5198
Recall: 0.7261
F1 Score: 0.5237
IoU: 0.0406
Dice Coefficient: 0.0780
Validation Metrics:
Accuracy: 0.9488
Precision: 0.5219
Recall: 0.7258
F1 Score: 0.5293
IoU: 0.0443
Dice Coefficient: 0.0849
Epoch   42/50, time: 131.40 s, training_loss: 0.620
Epoch   42/50, time: 26.75 s, val_loss: 0.613
Epoch   43/50, time: 133.27 s, training_loss: 0.609
Epoch   43/50, time: 24.86 s, val_loss: 0.602
Epoch   44/50, time: 117.75 s, training_loss: 0.596
Epoch   44/50, time: 24.75 s, val_loss: 0.592
Epoch   45/50, time: 126.47 s, training_loss: 0.589
Epoch   45/50, time: 24.86 s, val_loss: 0.628
Epoch   46/50, time: 129.26 s, training_loss: 0.576
Epoch   46/50, time: 24.79 s, val_loss: 0.553
Epoch   47/50, time: 128.79 s, training_loss: 0.569
Epoch   47/50, time: 25.01 s, val_loss: 0.597
Epoch   48/50, time: 117.60 s, training_loss: 0.565
Epoch   48/50, time: 25.33 s, val_loss: 0.599
Epoch   49/50, time: 126.48 s, training_loss: 0.577
Epoch   49/50, time: 24.91 s, val_loss: 0.572
Epoch   50/50, time: 126.40 s, training_loss: 0.558
Epoch   50/50, time: 24.81 s, val_loss: 0.545
Training Metrics:
Accuracy: 0.9728
Precision: 0.5423
Recall: 0.7276
F1 Score: 0.5669
IoU: 0.0797
Dice Coefficient: 0.1476
Validation Metrics:
Accuracy: 0.9613
Precision: 0.5293
Recall: 0.7313
F1 Score: 0.5445
IoU: 0.0576
Dice Coefficient: 0.1089
[I 2025-06-17 21:15:04,128] Trial 2 finished with value: 0.10887259942286644 and parameters: {'batch_size': 64, 'lr': 0.0006105290932174468, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.10887259942286644.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9613
Precision: 0.5293
Recall: 0.7313
F1 Score: 0.5445
IoU: 0.0576
Dice Coefficient: 0.1089
[Trial 2] Finished with val_loss=inf
[Trial 2] Finished with dice_coeff=0.10887259942286644
[Trial 3] Trying batch_size=64, lr=0.0005844966138440777, loss_fn=dice_loss
Epoch    1/50, time: 131.80 s, training_loss: 0.978
Epoch    1/50, time: 24.46 s, val_loss: 0.989
Training Metrics:
Accuracy: 0.1200
Precision: 0.5027
Recall: 0.5557
F1 Score: 0.1092
IoU: 0.0055
Dice Coefficient: 0.0110
Validation Metrics:
Accuracy: 0.1475
Precision: 0.5027
Recall: 0.5707
F1 Score: 0.1310
IoU: 0.0055
Dice Coefficient: 0.0110
Epoch    2/50, time: 118.79 s, training_loss: 0.965
Epoch    2/50, time: 26.86 s, val_loss: 0.932
Epoch    3/50, time: 130.52 s, training_loss: 0.952
Epoch    3/50, time: 26.31 s, val_loss: 0.942
Epoch    4/50, time: 119.33 s, training_loss: 0.938
Epoch    4/50, time: 24.43 s, val_loss: 0.931
Epoch    5/50, time: 122.25 s, training_loss: 0.926
Epoch    5/50, time: 23.66 s, val_loss: 0.954
Epoch    6/50, time: 124.21 s, training_loss: 0.910
Epoch    6/50, time: 26.68 s, val_loss: 0.896
Epoch    7/50, time: 116.92 s, training_loss: 0.896
Epoch    7/50, time: 26.87 s, val_loss: 0.886
Epoch    8/50, time: 116.15 s, training_loss: 0.883
Epoch    8/50, time: 26.21 s, val_loss: 0.909
Epoch    9/50, time: 113.44 s, training_loss: 0.875
Epoch    9/50, time: 25.95 s, val_loss: 0.907
Epoch   10/50, time: 123.84 s, training_loss: 0.857
Epoch   10/50, time: 26.84 s, val_loss: 0.981
Epoch   11/50, time: 121.18 s, training_loss: 0.855
Epoch   11/50, time: 25.43 s, val_loss: 0.923
Training Metrics:
Accuracy: 0.5169
Precision: 0.5025
Recall: 0.6273
F1 Score: 0.3474
IoU: 0.0074
Dice Coefficient: 0.0148
Validation Metrics:
Accuracy: 0.3155
Precision: 0.5020
Recall: 0.5890
F1 Score: 0.2441
IoU: 0.0060
Dice Coefficient: 0.0118
Epoch   12/50, time: 138.42 s, training_loss: 0.837
Epoch   12/50, time: 26.35 s, val_loss: 0.786
Epoch   13/50, time: 121.87 s, training_loss: 0.823
Epoch   13/50, time: 25.00 s, val_loss: 0.795
Epoch   14/50, time: 123.67 s, training_loss: 0.812
Epoch   14/50, time: 25.16 s, val_loss: 0.834
Epoch   15/50, time: 115.35 s, training_loss: 0.795
Epoch   15/50, time: 24.85 s, val_loss: 0.803
Epoch   16/50, time: 122.54 s, training_loss: 0.799
Epoch   16/50, time: 24.89 s, val_loss: 0.841
Epoch   17/50, time: 126.93 s, training_loss: 0.784
Epoch   17/50, time: 24.84 s, val_loss: 0.786
Epoch   18/50, time: 115.17 s, training_loss: 0.768
Epoch   18/50, time: 25.26 s, val_loss: 0.770
Epoch   19/50, time: 121.20 s, training_loss: 0.756
Epoch   19/50, time: 25.00 s, val_loss: 0.760
Epoch   20/50, time: 126.85 s, training_loss: 0.749
Epoch   20/50, time: 24.77 s, val_loss: 0.745
Epoch   21/50, time: 124.08 s, training_loss: 0.739
Epoch   21/50, time: 22.61 s, val_loss: 0.722
Training Metrics:
Accuracy: 0.7867
Precision: 0.5046
Recall: 0.6574
F1 Score: 0.4520
IoU: 0.0120
Dice Coefficient: 0.0237
Validation Metrics:
Accuracy: 0.7755
Precision: 0.5043
Recall: 0.6582
F1 Score: 0.4478
IoU: 0.0113
Dice Coefficient: 0.0223
Epoch   22/50, time: 136.57 s, training_loss: 0.730
Epoch   22/50, time: 24.78 s, val_loss: 0.710
Epoch   23/50, time: 127.56 s, training_loss: 0.727
Epoch   23/50, time: 23.97 s, val_loss: 0.726
Epoch   24/50, time: 126.98 s, training_loss: 0.713
Epoch   24/50, time: 26.73 s, val_loss: 0.682
Epoch   25/50, time: 108.63 s, training_loss: 0.698
Epoch   25/50, time: 26.49 s, val_loss: 0.703
Epoch   26/50, time: 125.80 s, training_loss: 0.706
Epoch   26/50, time: 27.01 s, val_loss: 0.701
Epoch   27/50, time: 115.80 s, training_loss: 0.683
Epoch   27/50, time: 26.98 s, val_loss: 0.676
Epoch   28/50, time: 122.02 s, training_loss: 0.662
Epoch   28/50, time: 23.92 s, val_loss: 0.649
Epoch   29/50, time: 114.58 s, training_loss: 0.653
Epoch   29/50, time: 25.99 s, val_loss: 0.649
Epoch   30/50, time: 114.37 s, training_loss: 0.636
Epoch   30/50, time: 27.09 s, val_loss: 0.650
Epoch   31/50, time: 117.43 s, training_loss: 0.632
Epoch   31/50, time: 25.95 s, val_loss: 0.639
Training Metrics:
Accuracy: 0.8957
Precision: 0.5119
Recall: 0.7288
F1 Score: 0.4974
IoU: 0.0257
Dice Coefficient: 0.0501
Validation Metrics:
Accuracy: 0.8895
Precision: 0.5112
Recall: 0.7355
F1 Score: 0.4944
IoU: 0.0243
Dice Coefficient: 0.0474
Epoch   32/50, time: 131.88 s, training_loss: 0.615
Epoch   32/50, time: 23.06 s, val_loss: 0.612
Epoch   33/50, time: 134.08 s, training_loss: 0.599
Epoch   33/50, time: 25.19 s, val_loss: 0.582
Epoch   34/50, time: 128.49 s, training_loss: 0.587
Epoch   34/50, time: 26.58 s, val_loss: 0.604
Epoch   35/50, time: 117.14 s, training_loss: 0.580
Epoch   35/50, time: 24.65 s, val_loss: 0.617
Epoch   36/50, time: 122.36 s, training_loss: 0.584
Epoch   36/50, time: 25.19 s, val_loss: 0.587
Epoch   37/50, time: 114.21 s, training_loss: 0.569
Epoch   37/50, time: 24.70 s, val_loss: 0.543
Epoch   38/50, time: 122.37 s, training_loss: 0.558
Epoch   38/50, time: 23.53 s, val_loss: 0.553
Epoch   39/50, time: 124.60 s, training_loss: 0.548
Epoch   39/50, time: 24.33 s, val_loss: 0.552
Epoch   40/50, time: 123.03 s, training_loss: 0.544
Epoch   40/50, time: 26.82 s, val_loss: 0.626
Epoch   41/50, time: 122.06 s, training_loss: 0.658
Epoch   41/50, time: 24.06 s, val_loss: 0.906
Training Metrics:
Accuracy: 0.7523
Precision: 0.5047
Recall: 0.6784
F1 Score: 0.4408
IoU: 0.0118
Dice Coefficient: 0.0234
Validation Metrics:
Accuracy: 0.6603
Precision: 0.5034
Recall: 0.6601
F1 Score: 0.4064
IoU: 0.0091
Dice Coefficient: 0.0181
Epoch   42/50, time: 135.54 s, training_loss: 0.627
Epoch   42/50, time: 26.45 s, val_loss: 0.634
Epoch   43/50, time: 124.78 s, training_loss: 0.606
Epoch   43/50, time: 25.33 s, val_loss: 0.579
Epoch   44/50, time: 125.56 s, training_loss: 0.570
Epoch   44/50, time: 24.94 s, val_loss: 0.544
Epoch   45/50, time: 121.75 s, training_loss: 0.557
Epoch   45/50, time: 25.93 s, val_loss: 0.522
Epoch   46/50, time: 121.18 s, training_loss: 0.521
Epoch   46/50, time: 26.66 s, val_loss: 0.527
Epoch   47/50, time: 119.48 s, training_loss: 0.515
Epoch   47/50, time: 24.76 s, val_loss: 0.505
Epoch   48/50, time: 123.82 s, training_loss: 0.511
Epoch   48/50, time: 25.76 s, val_loss: 0.520
Epoch   49/50, time: 127.24 s, training_loss: 0.493
Epoch   49/50, time: 24.09 s, val_loss: 0.480
Epoch   50/50, time: 128.87 s, training_loss: 0.487
Epoch   50/50, time: 24.71 s, val_loss: 0.486
Training Metrics:
Accuracy: 0.9773
Precision: 0.5584
Recall: 0.7731
F1 Score: 0.5926
IoU: 0.1091
Dice Coefficient: 0.1967
Validation Metrics:
Accuracy: 0.9632
Precision: 0.5351
Recall: 0.7683
F1 Score: 0.5549
IoU: 0.0687
Dice Coefficient: 0.1285
[I 2025-06-17 23:57:14,823] Trial 3 finished with value: 0.12851787816053872 and parameters: {'batch_size': 64, 'lr': 0.0005844966138440777, 'loss_fn': 'dice_loss'}. Best is trial 3 with value: 0.12851787816053872.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9632
Precision: 0.5351
Recall: 0.7683
F1 Score: 0.5549
IoU: 0.0687
Dice Coefficient: 0.1285
[Trial 3] Finished with val_loss=inf
[Trial 3] Finished with dice_coeff=0.12851787816053872
[Trial 4] Trying batch_size=32, lr=0.00047138941833688744, loss_fn=dice_loss
Epoch    1/50, time: 123.88 s, training_loss: 0.982
Epoch    1/50, time: 26.30 s, val_loss: 0.985
Training Metrics:
Accuracy: 0.2444
Precision: 0.5032
Recall: 0.6201
F1 Score: 0.2004
IoU: 0.0064
Dice Coefficient: 0.0128
Validation Metrics:
Accuracy: 0.3437
Precision: 0.5036
Recall: 0.6697
F1 Score: 0.2612
IoU: 0.0072
Dice Coefficient: 0.0142
Epoch    2/50, time: 109.36 s, training_loss: 0.974
Epoch    2/50, time: 26.53 s, val_loss: 0.948
Epoch    3/50, time: 112.07 s, training_loss: 0.964
Epoch    3/50, time: 24.90 s, val_loss: 0.971
Epoch    4/50, time: 106.73 s, training_loss: 0.947
Epoch    4/50, time: 24.62 s, val_loss: 0.926
Epoch    5/50, time: 111.48 s, training_loss: 0.928
Epoch    5/50, time: 24.82 s, val_loss: 0.923
Epoch    6/50, time: 106.70 s, training_loss: 0.912
Epoch    6/50, time: 22.63 s, val_loss: 0.876
Epoch    7/50, time: 102.64 s, training_loss: 0.896
Epoch    7/50, time: 26.72 s, val_loss: 0.848
Epoch    8/50, time: 110.71 s, training_loss: 0.877
Epoch    8/50, time: 27.30 s, val_loss: 0.889
Epoch    9/50, time: 107.15 s, training_loss: 0.860
Epoch    9/50, time: 26.79 s, val_loss: 0.853
Epoch   10/50, time: 108.87 s, training_loss: 0.843
Epoch   10/50, time: 24.73 s, val_loss: 0.874
Epoch   11/50, time: 110.64 s, training_loss: 0.828
Epoch   11/50, time: 26.04 s, val_loss: 0.835
Training Metrics:
Accuracy: 0.6613
Precision: 0.5027
Recall: 0.6218
F1 Score: 0.4060
IoU: 0.0084
Dice Coefficient: 0.0166
Validation Metrics:
Accuracy: 0.6904
Precision: 0.5025
Recall: 0.6132
F1 Score: 0.4162
IoU: 0.0081
Dice Coefficient: 0.0161
Epoch   12/50, time: 115.49 s, training_loss: 0.824
Epoch   12/50, time: 24.70 s, val_loss: 0.820
Epoch   13/50, time: 106.13 s, training_loss: 0.808
Epoch   13/50, time: 26.58 s, val_loss: 0.801
Epoch   14/50, time: 110.31 s, training_loss: 0.800
Epoch   14/50, time: 27.33 s, val_loss: 0.788
Epoch   15/50, time: 112.02 s, training_loss: 0.779
Epoch   15/50, time: 22.85 s, val_loss: 0.778
Epoch   16/50, time: 102.38 s, training_loss: 0.767
Epoch   16/50, time: 26.29 s, val_loss: 0.761
Epoch   17/50, time: 109.03 s, training_loss: 0.751
Epoch   17/50, time: 26.96 s, val_loss: 0.749
Epoch   18/50, time: 102.34 s, training_loss: 0.746
Epoch   18/50, time: 26.73 s, val_loss: 0.738
Epoch   19/50, time: 111.99 s, training_loss: 0.732
Epoch   19/50, time: 26.78 s, val_loss: 0.741
Epoch   20/50, time: 104.55 s, training_loss: 0.719
Epoch   20/50, time: 25.26 s, val_loss: 0.706
Epoch   21/50, time: 109.13 s, training_loss: 0.709
Epoch   21/50, time: 25.08 s, val_loss: 0.706
Training Metrics:
Accuracy: 0.8829
Precision: 0.5079
Recall: 0.6658
F1 Score: 0.4869
IoU: 0.0184
Dice Coefficient: 0.0361
Validation Metrics:
Accuracy: 0.9105
Precision: 0.5099
Recall: 0.6701
F1 Score: 0.4982
IoU: 0.0221
Dice Coefficient: 0.0433
Epoch   22/50, time: 120.63 s, training_loss: 0.707
Epoch   22/50, time: 24.86 s, val_loss: 0.688
Epoch   23/50, time: 110.35 s, training_loss: 0.691
Epoch   23/50, time: 23.27 s, val_loss: 0.702
Epoch   24/50, time: 105.59 s, training_loss: 0.682
Epoch   24/50, time: 24.92 s, val_loss: 0.665
Epoch   25/50, time: 112.53 s, training_loss: 0.663
Epoch   25/50, time: 27.14 s, val_loss: 0.637
Epoch   26/50, time: 108.85 s, training_loss: 0.654
Epoch   26/50, time: 26.41 s, val_loss: 0.665
Epoch   27/50, time: 105.20 s, training_loss: 0.655
Epoch   27/50, time: 22.78 s, val_loss: 0.634
Epoch   28/50, time: 111.06 s, training_loss: 0.626
Epoch   28/50, time: 24.27 s, val_loss: 0.637
Epoch   29/50, time: 108.22 s, training_loss: 0.610
Epoch   29/50, time: 23.38 s, val_loss: 0.591
Epoch   30/50, time: 109.52 s, training_loss: 0.583
Epoch   30/50, time: 24.77 s, val_loss: 0.619
Epoch   31/50, time: 111.64 s, training_loss: 0.593
Epoch   31/50, time: 24.23 s, val_loss: 0.666
Training Metrics:
Accuracy: 0.9403
Precision: 0.5128
Recall: 0.6439
F1 Score: 0.5114
IoU: 0.0275
Dice Coefficient: 0.0536
Validation Metrics:
Accuracy: 0.9415
Precision: 0.5118
Recall: 0.6346
F1 Score: 0.5099
IoU: 0.0256
Dice Coefficient: 0.0500
Epoch   32/50, time: 122.45 s, training_loss: 0.573
Epoch   32/50, time: 22.65 s, val_loss: 0.564
Epoch   33/50, time: 103.50 s, training_loss: 0.554
Epoch   33/50, time: 26.72 s, val_loss: 0.548
Epoch   34/50, time: 109.24 s, training_loss: 0.540
Epoch   34/50, time: 24.93 s, val_loss: 0.531
Epoch   35/50, time: 102.32 s, training_loss: 0.556
Epoch   35/50, time: 26.04 s, val_loss: 0.556
Epoch   36/50, time: 109.00 s, training_loss: 0.546
Epoch   36/50, time: 26.80 s, val_loss: 0.543
Epoch   37/50, time: 112.65 s, training_loss: 0.521
Epoch   37/50, time: 25.03 s, val_loss: 0.535
Epoch   38/50, time: 105.49 s, training_loss: 0.517
Epoch   38/50, time: 25.33 s, val_loss: 0.510
Epoch   39/50, time: 111.42 s, training_loss: 0.508
Epoch   39/50, time: 24.92 s, val_loss: 0.548
Epoch   40/50, time: 111.15 s, training_loss: 0.510
Epoch   40/50, time: 25.95 s, val_loss: 0.498
Epoch   41/50, time: 98.25 s, training_loss: 0.497
Epoch   41/50, time: 26.90 s, val_loss: 0.543
Training Metrics:
Accuracy: 0.9780
Precision: 0.5511
Recall: 0.7209
F1 Score: 0.5799
IoU: 0.0934
Dice Coefficient: 0.1709
Validation Metrics:
Accuracy: 0.9700
Precision: 0.5355
Recall: 0.7158
F1 Score: 0.5558
IoU: 0.0677
Dice Coefficient: 0.1269
Epoch   42/50, time: 111.77 s, training_loss: 0.492
Epoch   42/50, time: 25.17 s, val_loss: 0.498
Epoch   43/50, time: 105.74 s, training_loss: 0.481
Epoch   43/50, time: 24.36 s, val_loss: 0.496
Epoch   44/50, time: 106.25 s, training_loss: 0.470
Epoch   44/50, time: 25.37 s, val_loss: 0.467
Epoch   45/50, time: 105.21 s, training_loss: 0.467
Epoch   45/50, time: 24.65 s, val_loss: 0.482
Epoch   46/50, time: 115.12 s, training_loss: 0.490
Epoch   46/50, time: 26.11 s, val_loss: 0.514
Epoch   47/50, time: 115.72 s, training_loss: 0.474
Epoch   47/50, time: 25.09 s, val_loss: 0.496
Epoch   48/50, time: 109.66 s, training_loss: 0.463
Epoch   48/50, time: 26.28 s, val_loss: 0.482
Epoch   49/50, time: 107.90 s, training_loss: 0.467
Epoch   49/50, time: 25.60 s, val_loss: 0.509
Epoch   50/50, time: 118.46 s, training_loss: 0.508
Epoch   50/50, time: 25.74 s, val_loss: 0.510
Training Metrics:
Accuracy: 0.9870
Precision: 0.5916
Recall: 0.7391
F1 Score: 0.6313
IoU: 0.1555
Dice Coefficient: 0.2692
Validation Metrics:
Accuracy: 0.9890
Precision: 0.6031
Recall: 0.7313
F1 Score: 0.6418
IoU: 0.1691
Dice Coefficient: 0.2892
[I 2025-06-18 02:17:28,346] Trial 4 finished with value: 0.28922766211118983 and parameters: {'batch_size': 32, 'lr': 0.00047138941833688744, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.28922766211118983.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9890
Precision: 0.6031
Recall: 0.7313
F1 Score: 0.6418
IoU: 0.1691
Dice Coefficient: 0.2892
[Trial 4] Finished with val_loss=inf
[Trial 4] Finished with dice_coeff=0.28922766211118983
[Trial 5] Trying batch_size=16, lr=0.00019753013746600366, loss_fn=dice_loss
Epoch    1/50, time: 104.37 s, training_loss: 0.976
Epoch    1/50, time: 24.77 s, val_loss: 0.941
Training Metrics:
Accuracy: 0.6000
Precision: 0.5051
Recall: 0.7504
F1 Score: 0.3851
IoU: 0.0109
Dice Coefficient: 0.0217
Validation Metrics:
Accuracy: 0.8112
Precision: 0.5094
Recall: 0.8094
F1 Score: 0.4671
IoU: 0.0199
Dice Coefficient: 0.0390
Epoch    2/50, time: 113.62 s, training_loss: 0.964
Epoch    2/50, time: 22.54 s, val_loss: 0.945
Epoch    3/50, time: 101.92 s, training_loss: 0.953
Epoch    3/50, time: 26.55 s, val_loss: 0.931
Epoch    4/50, time: 104.33 s, training_loss: 0.942
Epoch    4/50, time: 26.27 s, val_loss: 0.990
Epoch    5/50, time: 102.31 s, training_loss: 0.933
Epoch    5/50, time: 27.39 s, val_loss: 0.924
Epoch    6/50, time: 99.72 s, training_loss: 0.913
Epoch    6/50, time: 25.23 s, val_loss: 0.878
Epoch    7/50, time: 104.00 s, training_loss: 0.893
Epoch    7/50, time: 25.61 s, val_loss: 0.823
Epoch    8/50, time: 105.21 s, training_loss: 0.867
Epoch    8/50, time: 25.87 s, val_loss: 0.849
Epoch    9/50, time: 105.00 s, training_loss: 0.850
Epoch    9/50, time: 27.12 s, val_loss: 0.824
Epoch   10/50, time: 103.26 s, training_loss: 0.826
Epoch   10/50, time: 23.94 s, val_loss: 0.764
Epoch   11/50, time: 101.65 s, training_loss: 0.803
Epoch   11/50, time: 27.40 s, val_loss: 0.761
Training Metrics:
Accuracy: 0.7605
Precision: 0.5043
Recall: 0.6594
F1 Score: 0.4429
IoU: 0.0113
Dice Coefficient: 0.0223
Validation Metrics:
Accuracy: 0.8856
Precision: 0.5083
Recall: 0.6788
F1 Score: 0.4884
IoU: 0.0191
Dice Coefficient: 0.0375
Epoch   12/50, time: 110.61 s, training_loss: 0.780
Epoch   12/50, time: 23.76 s, val_loss: 0.729
Epoch   13/50, time: 102.41 s, training_loss: 0.765
Epoch   13/50, time: 25.51 s, val_loss: 0.725
Epoch   14/50, time: 100.44 s, training_loss: 0.746
Epoch   14/50, time: 22.91 s, val_loss: 0.713
Epoch   15/50, time: 101.36 s, training_loss: 0.721
Epoch   15/50, time: 26.67 s, val_loss: 0.733
Epoch   16/50, time: 102.95 s, training_loss: 0.707
Epoch   16/50, time: 25.38 s, val_loss: 0.688
Epoch   17/50, time: 105.82 s, training_loss: 0.686
Epoch   17/50, time: 27.64 s, val_loss: 0.662
Epoch   18/50, time: 101.30 s, training_loss: 0.674
Epoch   18/50, time: 27.24 s, val_loss: 0.628
Epoch   19/50, time: 102.92 s, training_loss: 0.640
Epoch   19/50, time: 27.46 s, val_loss: 0.605
Epoch   20/50, time: 100.73 s, training_loss: 0.643
Epoch   20/50, time: 27.56 s, val_loss: 0.619
Epoch   21/50, time: 105.53 s, training_loss: 0.620
Epoch   21/50, time: 27.37 s, val_loss: 0.600
Training Metrics:
Accuracy: 0.9277
Precision: 0.5148
Recall: 0.7024
F1 Score: 0.5115
IoU: 0.0312
Dice Coefficient: 0.0605
Validation Metrics:
Accuracy: 0.9181
Precision: 0.5126
Recall: 0.6996
F1 Score: 0.5049
IoU: 0.0270
Dice Coefficient: 0.0526
Epoch   22/50, time: 109.87 s, training_loss: 0.595
Epoch   22/50, time: 27.61 s, val_loss: 0.563
Epoch   23/50, time: 101.77 s, training_loss: 0.582
Epoch   23/50, time: 24.76 s, val_loss: 0.563
Epoch   24/50, time: 106.81 s, training_loss: 0.593
Epoch   24/50, time: 25.01 s, val_loss: 0.585
Epoch   25/50, time: 107.97 s, training_loss: 0.573
Epoch   25/50, time: 22.74 s, val_loss: 0.567
Epoch   26/50, time: 104.04 s, training_loss: 0.546
Epoch   26/50, time: 25.70 s, val_loss: 0.528
Epoch   27/50, time: 109.00 s, training_loss: 0.547
Epoch   27/50, time: 23.56 s, val_loss: 0.534
Epoch   28/50, time: 103.18 s, training_loss: 0.531
Epoch   28/50, time: 26.92 s, val_loss: 0.504
Epoch   29/50, time: 100.18 s, training_loss: 0.523
Epoch   29/50, time: 22.95 s, val_loss: 0.503
Epoch   30/50, time: 102.90 s, training_loss: 0.515
Epoch   30/50, time: 26.13 s, val_loss: 0.505
Epoch   31/50, time: 100.58 s, training_loss: 0.513
Epoch   31/50, time: 25.00 s, val_loss: 0.515
Training Metrics:
Accuracy: 0.9565
Precision: 0.5272
Recall: 0.7318
F1 Score: 0.5400
IoU: 0.0539
Dice Coefficient: 0.1022
Validation Metrics:
Accuracy: 0.9439
Precision: 0.5200
Recall: 0.7241
F1 Score: 0.5246
IoU: 0.0407
Dice Coefficient: 0.0782
Epoch   32/50, time: 125.15 s, training_loss: 0.506
Epoch   32/50, time: 24.44 s, val_loss: 0.485
Epoch   33/50, time: 104.75 s, training_loss: 0.492
Epoch   33/50, time: 27.51 s, val_loss: 0.478
Epoch   34/50, time: 102.34 s, training_loss: 0.484
Epoch   34/50, time: 24.64 s, val_loss: 0.481
Epoch   35/50, time: 107.26 s, training_loss: 0.515
Epoch   35/50, time: 22.92 s, val_loss: 0.481
Epoch   36/50, time: 101.31 s, training_loss: 0.499
Epoch   36/50, time: 27.39 s, val_loss: 0.498
Epoch   37/50, time: 107.94 s, training_loss: 0.491
Epoch   37/50, time: 27.38 s, val_loss: 0.487
Epoch   38/50, time: 100.19 s, training_loss: 0.475
Epoch   38/50, time: 25.98 s, val_loss: 0.463
Epoch   39/50, time: 103.46 s, training_loss: 0.474
Epoch   39/50, time: 22.69 s, val_loss: 0.484
Epoch   40/50, time: 102.04 s, training_loss: 0.479
Epoch   40/50, time: 24.84 s, val_loss: 0.464
Epoch   41/50, time: 104.78 s, training_loss: 0.481
Epoch   41/50, time: 27.35 s, val_loss: 0.472
Training Metrics:
Accuracy: 0.9381
Precision: 0.5214
Recall: 0.7576
F1 Score: 0.5257
IoU: 0.0436
Dice Coefficient: 0.0835
Validation Metrics:
Accuracy: 0.9201
Precision: 0.5161
Recall: 0.7529
F1 Score: 0.5116
IoU: 0.0335
Dice Coefficient: 0.0648
Epoch   42/50, time: 107.04 s, training_loss: 0.469
Epoch   42/50, time: 25.61 s, val_loss: 0.486
Epoch   43/50, time: 107.59 s, training_loss: 0.455
Epoch   43/50, time: 24.89 s, val_loss: 0.450
Epoch   44/50, time: 101.71 s, training_loss: 0.460
Epoch   44/50, time: 26.21 s, val_loss: 0.470
Epoch   45/50, time: 104.15 s, training_loss: 0.461
Epoch   45/50, time: 24.87 s, val_loss: 0.467
Epoch   46/50, time: 102.26 s, training_loss: 0.462
Epoch   46/50, time: 24.96 s, val_loss: 0.443
Epoch   47/50, time: 105.13 s, training_loss: 0.452
Epoch   47/50, time: 24.57 s, val_loss: 0.445
Epoch   48/50, time: 109.70 s, training_loss: 0.451
Epoch   48/50, time: 24.78 s, val_loss: 0.469
Epoch   49/50, time: 108.47 s, training_loss: 0.469
Epoch   49/50, time: 24.30 s, val_loss: 0.471
Epoch   50/50, time: 99.95 s, training_loss: 0.429
Epoch   50/50, time: 23.52 s, val_loss: 0.444
Training Metrics:
Accuracy: 0.9919
Precision: 0.6549
Recall: 0.7634
F1 Score: 0.6948
IoU: 0.2450
Dice Coefficient: 0.3936
Validation Metrics:
Accuracy: 0.9894
Precision: 0.6133
Recall: 0.7559
F1 Score: 0.6563
IoU: 0.1890
Dice Coefficient: 0.3179
[I 2025-06-18 04:34:59,044] Trial 5 finished with value: 0.3178793177728782 and parameters: {'batch_size': 16, 'lr': 0.00019753013746600366, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.3178793177728782.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9894
Precision: 0.6133
Recall: 0.7559
F1 Score: 0.6563
IoU: 0.1890
Dice Coefficient: 0.3179
[Trial 5] Finished with val_loss=inf
[Trial 5] Finished with dice_coeff=0.3178793177728782
[Trial 6] Trying batch_size=32, lr=0.0008350099856947063, loss_fn=dice_loss
Epoch    1/50, time: 106.85 s, training_loss: 0.974
Epoch    1/50, time: 24.53 s, val_loss: 0.891
Training Metrics:
Accuracy: 0.6287
Precision: 0.5018
Recall: 0.5839
F1 Score: 0.3927
IoU: 0.0071
Dice Coefficient: 0.0140
Validation Metrics:
Accuracy: 0.8090
Precision: 0.5026
Recall: 0.5831
F1 Score: 0.4558
IoU: 0.0087
Dice Coefficient: 0.0173
Epoch    2/50, time: 114.04 s, training_loss: 0.947
Epoch    2/50, time: 26.00 s, val_loss: 0.929
Epoch    3/50, time: 103.88 s, training_loss: 0.914
Epoch    3/50, time: 23.86 s, val_loss: 0.859
Epoch    4/50, time: 108.95 s, training_loss: 0.891
Epoch    4/50, time: 25.57 s, val_loss: 0.855
Epoch    5/50, time: 107.60 s, training_loss: 0.866
Epoch    5/50, time: 22.42 s, val_loss: 0.826
Epoch    6/50, time: 106.05 s, training_loss: 0.846
Epoch    6/50, time: 25.45 s, val_loss: 0.826
Epoch    7/50, time: 106.25 s, training_loss: 0.821
Epoch    7/50, time: 25.76 s, val_loss: 0.781
Epoch    8/50, time: 106.42 s, training_loss: 0.806
Epoch    8/50, time: 27.75 s, val_loss: 0.789
Epoch    9/50, time: 101.41 s, training_loss: 0.792
Epoch    9/50, time: 28.59 s, val_loss: 0.781
Epoch   10/50, time: 103.27 s, training_loss: 0.779
Epoch   10/50, time: 25.70 s, val_loss: 0.777
Epoch   11/50, time: 107.40 s, training_loss: 0.774
Epoch   11/50, time: 27.50 s, val_loss: 0.775
Training Metrics:
Accuracy: 0.9295
Precision: 0.5079
Recall: 0.6031
F1 Score: 0.5000
IoU: 0.0187
Dice Coefficient: 0.0367
Validation Metrics:
Accuracy: 0.9046
Precision: 0.5080
Recall: 0.6446
F1 Score: 0.4932
IoU: 0.0186
Dice Coefficient: 0.0366
Epoch   12/50, time: 96.66 s, training_loss: 0.759
Epoch   12/50, time: 26.31 s, val_loss: 0.747
Epoch   13/50, time: 103.45 s, training_loss: 0.746
Epoch   13/50, time: 26.16 s, val_loss: 0.775
Epoch   14/50, time: 105.70 s, training_loss: 0.757
Epoch   14/50, time: 24.00 s, val_loss: 0.743
Epoch   15/50, time: 105.52 s, training_loss: 0.734
Epoch   15/50, time: 25.31 s, val_loss: 0.727
Epoch   16/50, time: 103.09 s, training_loss: 0.722
Epoch   16/50, time: 26.98 s, val_loss: 0.715
Epoch   17/50, time: 105.35 s, training_loss: 0.714
Epoch   17/50, time: 27.53 s, val_loss: 0.725
Epoch   18/50, time: 107.31 s, training_loss: 0.714
Epoch   18/50, time: 25.32 s, val_loss: 0.697
Epoch   19/50, time: 108.54 s, training_loss: 0.698
Epoch   19/50, time: 24.61 s, val_loss: 0.676
Epoch   20/50, time: 96.92 s, training_loss: 0.684
Epoch   20/50, time: 25.79 s, val_loss: 0.679
Epoch   21/50, time: 110.06 s, training_loss: 0.667
Epoch   21/50, time: 25.34 s, val_loss: 0.688
Training Metrics:
Accuracy: 0.9322
Precision: 0.5159
Recall: 0.7050
F1 Score: 0.5146
IoU: 0.0333
Dice Coefficient: 0.0644
Validation Metrics:
Accuracy: 0.8891
Precision: 0.5094
Recall: 0.6963
F1 Score: 0.4911
IoU: 0.0210
Dice Coefficient: 0.0411
Epoch   22/50, time: 120.38 s, training_loss: 0.710
Epoch   22/50, time: 25.32 s, val_loss: 0.706
Epoch   23/50, time: 103.51 s, training_loss: 0.674
Epoch   23/50, time: 25.22 s, val_loss: 0.677
Epoch   24/50, time: 102.58 s, training_loss: 0.650
Epoch   24/50, time: 23.52 s, val_loss: 0.678
Epoch   25/50, time: 104.09 s, training_loss: 0.643
Epoch   25/50, time: 25.67 s, val_loss: 0.614
Epoch   26/50, time: 107.92 s, training_loss: 0.609
Epoch   26/50, time: 25.92 s, val_loss: 0.591
Epoch   27/50, time: 105.44 s, training_loss: 0.586
Epoch   27/50, time: 24.89 s, val_loss: 0.594
Epoch   28/50, time: 110.65 s, training_loss: 0.571
Epoch   28/50, time: 25.64 s, val_loss: 0.550
Epoch   29/50, time: 106.96 s, training_loss: 0.554
Epoch   29/50, time: 24.51 s, val_loss: 0.579
Epoch   30/50, time: 103.64 s, training_loss: 0.547
Epoch   30/50, time: 26.01 s, val_loss: 0.525
Epoch   31/50, time: 109.03 s, training_loss: 0.535
Epoch   31/50, time: 23.02 s, val_loss: 0.556
Training Metrics:
Accuracy: 0.9944
Precision: 0.7176
Recall: 0.7456
F1 Score: 0.7307
IoU: 0.3023
Dice Coefficient: 0.4642
Validation Metrics:
Accuracy: 0.9950
Precision: 0.7361
Recall: 0.7437
F1 Score: 0.7398
IoU: 0.3177
Dice Coefficient: 0.4822
Epoch   32/50, time: 105.31 s, training_loss: 0.524
Epoch   32/50, time: 27.15 s, val_loss: 0.514
Epoch   33/50, time: 103.93 s, training_loss: 0.506
Epoch   33/50, time: 23.94 s, val_loss: 0.511
Epoch   34/50, time: 106.67 s, training_loss: 0.499
Epoch   34/50, time: 25.97 s, val_loss: 0.493
Epoch   35/50, time: 103.82 s, training_loss: 0.495
Epoch   35/50, time: 25.66 s, val_loss: 0.486
Epoch   36/50, time: 103.30 s, training_loss: 0.492
Epoch   36/50, time: 22.05 s, val_loss: 0.486
Epoch   37/50, time: 105.97 s, training_loss: 0.489
Epoch   37/50, time: 23.95 s, val_loss: 0.489
Epoch   38/50, time: 103.99 s, training_loss: 0.472
Epoch   38/50, time: 26.35 s, val_loss: 0.469
Epoch   39/50, time: 100.60 s, training_loss: 0.467
Epoch   39/50, time: 27.59 s, val_loss: 0.480
Epoch   40/50, time: 104.57 s, training_loss: 0.464
Epoch   40/50, time: 23.39 s, val_loss: 0.460
Epoch   41/50, time: 105.64 s, training_loss: 0.472
Epoch   41/50, time: 25.33 s, val_loss: 0.483
Training Metrics:
Accuracy: 0.9958
Precision: 0.7918
Recall: 0.7529
F1 Score: 0.7710
IoU: 0.3737
Dice Coefficient: 0.5441
Validation Metrics:
Accuracy: 0.9959
Precision: 0.7865
Recall: 0.7526
F1 Score: 0.7685
IoU: 0.3689
Dice Coefficient: 0.5390
Epoch   42/50, time: 125.36 s, training_loss: 0.459
Epoch   42/50, time: 27.65 s, val_loss: 0.451
Epoch   43/50, time: 105.88 s, training_loss: 0.444
Epoch   43/50, time: 26.40 s, val_loss: 0.440
Epoch   44/50, time: 101.06 s, training_loss: 0.444
Epoch   44/50, time: 25.89 s, val_loss: 0.441
Epoch   45/50, time: 101.63 s, training_loss: 0.437
Epoch   45/50, time: 24.55 s, val_loss: 0.422
Epoch   46/50, time: 107.50 s, training_loss: 0.437
Epoch   46/50, time: 25.87 s, val_loss: 0.449
Epoch   47/50, time: 102.18 s, training_loss: 0.431
Epoch   47/50, time: 24.74 s, val_loss: 0.435
Epoch   48/50, time: 105.83 s, training_loss: 0.425
Epoch   48/50, time: 23.42 s, val_loss: 0.436
Epoch   49/50, time: 107.29 s, training_loss: 0.423
Epoch   49/50, time: 26.65 s, val_loss: 0.425
Epoch   50/50, time: 108.91 s, training_loss: 0.426
Epoch   50/50, time: 26.31 s, val_loss: 0.437
Training Metrics:
Accuracy: 0.9963
Precision: 0.8270
Recall: 0.7667
F1 Score: 0.7937
IoU: 0.4178
Dice Coefficient: 0.5893
Validation Metrics:
Accuracy: 0.9964
Precision: 0.8242
Recall: 0.7592
F1 Score: 0.7880
IoU: 0.4064
Dice Coefficient: 0.5779
[I 2025-06-18 06:49:48,405] Trial 6 finished with value: 0.5778933392343438 and parameters: {'batch_size': 32, 'lr': 0.0008350099856947063, 'loss_fn': 'dice_loss'}. Best is trial 6 with value: 0.5778933392343438.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9964
Precision: 0.8242
Recall: 0.7592
F1 Score: 0.7880
IoU: 0.4064
Dice Coefficient: 0.5779
[Trial 6] Finished with val_loss=inf
[Trial 6] Finished with dice_coeff=0.5778933392343438
[Trial 7] Trying batch_size=16, lr=0.0002778197590641459, loss_fn=dice_loss
Epoch    1/50, time: 115.42 s, training_loss: 0.976
Epoch    1/50, time: 23.82 s, val_loss: 0.902
Training Metrics:
Accuracy: 0.4218
Precision: 0.5016
Recall: 0.5816
F1 Score: 0.3018
IoU: 0.0063
Dice Coefficient: 0.0125
Validation Metrics:
Accuracy: 0.7298
Precision: 0.5029
Recall: 0.6211
F1 Score: 0.4305
IoU: 0.0089
Dice Coefficient: 0.0176
Epoch    2/50, time: 97.84 s, training_loss: 0.953
Epoch    2/50, time: 23.58 s, val_loss: 0.887
Epoch    3/50, time: 97.87 s, training_loss: 0.931
Epoch    3/50, time: 23.94 s, val_loss: 0.885
Epoch    4/50, time: 92.58 s, training_loss: 0.909
Epoch    4/50, time: 24.91 s, val_loss: 0.877
Epoch    5/50, time: 99.02 s, training_loss: 0.902
Epoch    5/50, time: 25.10 s, val_loss: 0.828
Epoch    6/50, time: 99.42 s, training_loss: 0.878
Epoch    6/50, time: 25.42 s, val_loss: 0.916
Epoch    7/50, time: 95.78 s, training_loss: 0.874
Epoch    7/50, time: 23.60 s, val_loss: 0.847
Epoch    8/50, time: 96.67 s, training_loss: 0.846
Epoch    8/50, time: 24.90 s, val_loss: 0.858
Epoch    9/50, time: 97.70 s, training_loss: 0.828
Epoch    9/50, time: 25.14 s, val_loss: 0.822
Epoch   10/50, time: 96.11 s, training_loss: 0.825
Epoch   10/50, time: 25.31 s, val_loss: 0.783
Epoch   11/50, time: 93.19 s, training_loss: 0.800
Epoch   11/50, time: 26.36 s, val_loss: 0.777
Training Metrics:
Accuracy: 0.8499
Precision: 0.5068
Recall: 0.6769
F1 Score: 0.4752
IoU: 0.0162
Dice Coefficient: 0.0318
Validation Metrics:
Accuracy: 0.8934
Precision: 0.5093
Recall: 0.6878
F1 Score: 0.4923
IoU: 0.0209
Dice Coefficient: 0.0410
Epoch   12/50, time: 114.32 s, training_loss: 0.793
Epoch   12/50, time: 23.13 s, val_loss: 0.800
Epoch   13/50, time: 101.63 s, training_loss: 0.778
Epoch   13/50, time: 25.33 s, val_loss: 0.764
Epoch   14/50, time: 99.43 s, training_loss: 0.765
Epoch   14/50, time: 24.91 s, val_loss: 0.749
Epoch   15/50, time: 98.95 s, training_loss: 0.757
Epoch   15/50, time: 25.81 s, val_loss: 0.737
Epoch   16/50, time: 95.61 s, training_loss: 0.742
Epoch   16/50, time: 22.65 s, val_loss: 0.715
Epoch   17/50, time: 102.23 s, training_loss: 0.729
Epoch   17/50, time: 22.71 s, val_loss: 0.721
Epoch   18/50, time: 107.26 s, training_loss: 0.722
Epoch   18/50, time: 24.51 s, val_loss: 0.691
Epoch   19/50, time: 98.79 s, training_loss: 0.710
Epoch   19/50, time: 22.31 s, val_loss: 0.680
Epoch   20/50, time: 94.80 s, training_loss: 0.701
Epoch   20/50, time: 23.83 s, val_loss: 0.689
Epoch   21/50, time: 95.69 s, training_loss: 0.678
Epoch   21/50, time: 23.30 s, val_loss: 0.662
Training Metrics:
Accuracy: 0.9581
Precision: 0.5279
Recall: 0.7298
F1 Score: 0.5416
IoU: 0.0552
Dice Coefficient: 0.1046
Validation Metrics:
Accuracy: 0.9452
Precision: 0.5202
Recall: 0.7208
F1 Score: 0.5253
IoU: 0.0410
Dice Coefficient: 0.0789
Epoch   22/50, time: 116.60 s, training_loss: 0.663
Epoch   22/50, time: 24.65 s, val_loss: 0.624
Epoch   23/50, time: 93.20 s, training_loss: 0.646
Epoch   23/50, time: 22.98 s, val_loss: 0.606
Epoch   24/50, time: 101.66 s, training_loss: 0.639
Epoch   24/50, time: 21.99 s, val_loss: 0.634
Epoch   25/50, time: 96.78 s, training_loss: 0.622
Epoch   25/50, time: 21.50 s, val_loss: 0.600
Epoch   26/50, time: 98.97 s, training_loss: 0.601
Epoch   26/50, time: 25.28 s, val_loss: 0.581
Epoch   27/50, time: 99.51 s, training_loss: 0.600
Epoch   27/50, time: 25.06 s, val_loss: 0.615
Epoch   28/50, time: 95.34 s, training_loss: 0.615
Epoch   28/50, time: 22.76 s, val_loss: 0.614
Epoch   29/50, time: 103.29 s, training_loss: 0.580
Epoch   29/50, time: 25.28 s, val_loss: 0.538
Epoch   30/50, time: 102.37 s, training_loss: 0.568
Epoch   30/50, time: 25.29 s, val_loss: 0.527
Epoch   31/50, time: 93.02 s, training_loss: 0.553
Epoch   31/50, time: 24.35 s, val_loss: 0.559
Training Metrics:
Accuracy: 0.9556
Precision: 0.5285
Recall: 0.7498
F1 Score: 0.5420
IoU: 0.0565
Dice Coefficient: 0.1069
Validation Metrics:
Accuracy: 0.9477
Precision: 0.5235
Recall: 0.7483
F1 Score: 0.5317
IoU: 0.0473
Dice Coefficient: 0.0903
Epoch   32/50, time: 106.10 s, training_loss: 0.561
Epoch   32/50, time: 21.60 s, val_loss: 0.594
Epoch   33/50, time: 92.69 s, training_loss: 0.562
Epoch   33/50, time: 24.10 s, val_loss: 0.526
Epoch   34/50, time: 96.87 s, training_loss: 0.536
Epoch   34/50, time: 22.45 s, val_loss: 0.529
Epoch   35/50, time: 94.88 s, training_loss: 0.530
Epoch   35/50, time: 21.73 s, val_loss: 0.503
Epoch   36/50, time: 94.46 s, training_loss: 0.519
Epoch   36/50, time: 25.08 s, val_loss: 0.504
Epoch   37/50, time: 100.70 s, training_loss: 0.505
Epoch   37/50, time: 25.25 s, val_loss: 0.490
Epoch   38/50, time: 93.91 s, training_loss: 0.494
Epoch   38/50, time: 25.61 s, val_loss: 0.485
Epoch   39/50, time: 94.57 s, training_loss: 0.479
Epoch   39/50, time: 23.44 s, val_loss: 0.473
Epoch   40/50, time: 94.61 s, training_loss: 0.475
Epoch   40/50, time: 24.54 s, val_loss: 0.492
Epoch   41/50, time: 95.42 s, training_loss: 0.468
Epoch   41/50, time: 25.64 s, val_loss: 0.467
Training Metrics:
Accuracy: 0.9959
Precision: 0.7949
Recall: 0.7771
F1 Score: 0.7857
IoU: 0.4020
Dice Coefficient: 0.5734
Validation Metrics:
Accuracy: 0.9960
Precision: 0.7917
Recall: 0.7779
F1 Score: 0.7846
IoU: 0.3998
Dice Coefficient: 0.5713
Epoch   42/50, time: 96.36 s, training_loss: 0.461
Epoch   42/50, time: 25.43 s, val_loss: 0.458
Epoch   43/50, time: 93.65 s, training_loss: 0.455
Epoch   43/50, time: 21.21 s, val_loss: 0.456
Epoch   44/50, time: 96.76 s, training_loss: 0.451
Epoch   44/50, time: 25.29 s, val_loss: 0.443
Epoch   45/50, time: 95.64 s, training_loss: 0.445
Epoch   45/50, time: 24.95 s, val_loss: 0.459
Epoch   46/50, time: 95.71 s, training_loss: 0.437
Epoch   46/50, time: 23.55 s, val_loss: 0.456
Epoch   47/50, time: 95.73 s, training_loss: 0.435
Epoch   47/50, time: 23.46 s, val_loss: 0.452
Epoch   48/50, time: 105.28 s, training_loss: 0.431
Epoch   48/50, time: 24.55 s, val_loss: 0.466
Epoch   49/50, time: 100.71 s, training_loss: 0.431
Epoch   49/50, time: 24.87 s, val_loss: 0.427
Epoch   50/50, time: 95.47 s, training_loss: 0.418
Epoch   50/50, time: 24.98 s, val_loss: 0.438
Training Metrics:
Accuracy: 0.9964
Precision: 0.8261
Recall: 0.7838
F1 Score: 0.8035
IoU: 0.4376
Dice Coefficient: 0.6088
Validation Metrics:
Accuracy: 0.9965
Precision: 0.8267
Recall: 0.7789
F1 Score: 0.8009
IoU: 0.4322
Dice Coefficient: 0.6036
[I 2025-06-18 09:12:08,081] Trial 7 finished with value: 0.6035614709528434 and parameters: {'batch_size': 16, 'lr': 0.0002778197590641459, 'loss_fn': 'dice_loss'}. Best is trial 7 with value: 0.6035614709528434.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9965
Precision: 0.8267
Recall: 0.7789
F1 Score: 0.8009
IoU: 0.4322
Dice Coefficient: 0.6036
[Trial 7] Finished with val_loss=inf
[Trial 7] Finished with dice_coeff=0.6035614709528434
[Trial 8] Trying batch_size=16, lr=0.000690666996297961, loss_fn=dice_loss
Epoch    1/50, time: 108.24 s, training_loss: 0.969
Epoch    1/50, time: 25.20 s, val_loss: 0.946
Training Metrics:
Accuracy: 0.5217
Precision: 0.5020
Recall: 0.6000
F1 Score: 0.3490
IoU: 0.0069
Dice Coefficient: 0.0137
Validation Metrics:
Accuracy: 0.7601
Precision: 0.5038
Recall: 0.6455
F1 Score: 0.4419
IoU: 0.0104
Dice Coefficient: 0.0205
Epoch    2/50, time: 111.54 s, training_loss: 0.938
Epoch    2/50, time: 23.83 s, val_loss: 0.861
Epoch    3/50, time: 95.61 s, training_loss: 0.895
Epoch    3/50, time: 23.23 s, val_loss: 0.877
Epoch    4/50, time: 90.88 s, training_loss: 0.863
Epoch    4/50, time: 24.02 s, val_loss: 0.837
Epoch    5/50, time: 96.20 s, training_loss: 0.847
Epoch    5/50, time: 24.55 s, val_loss: 0.805
Epoch    6/50, time: 95.76 s, training_loss: 0.815
Epoch    6/50, time: 23.64 s, val_loss: 0.797
Epoch    7/50, time: 97.89 s, training_loss: 0.803
Epoch    7/50, time: 25.14 s, val_loss: 0.782
Epoch    8/50, time: 97.03 s, training_loss: 0.801
Epoch    8/50, time: 23.48 s, val_loss: 0.779
Epoch    9/50, time: 93.92 s, training_loss: 0.790
Epoch    9/50, time: 24.44 s, val_loss: 0.783
Epoch   10/50, time: 98.55 s, training_loss: 0.782
Epoch   10/50, time: 23.89 s, val_loss: 0.772
Epoch   11/50, time: 94.56 s, training_loss: 0.771
Epoch   11/50, time: 22.76 s, val_loss: 0.789
Training Metrics:
Accuracy: 0.9544
Precision: 0.5199
Recall: 0.6734
F1 Score: 0.5270
IoU: 0.0402
Dice Coefficient: 0.0774
Validation Metrics:
Accuracy: 0.9584
Precision: 0.5171
Recall: 0.6389
F1 Score: 0.5230
IoU: 0.0348
Dice Coefficient: 0.0672
Epoch   12/50, time: 115.78 s, training_loss: 0.777
Epoch   12/50, time: 23.52 s, val_loss: 0.766
Epoch   13/50, time: 103.89 s, training_loss: 0.772
Epoch   13/50, time: 26.77 s, val_loss: 0.781
Epoch   14/50, time: 102.97 s, training_loss: 0.766
Epoch   14/50, time: 27.45 s, val_loss: 0.769
Epoch   15/50, time: 99.95 s, training_loss: 0.761
Epoch   15/50, time: 25.40 s, val_loss: 0.771
Epoch   16/50, time: 99.24 s, training_loss: 0.759
Epoch   16/50, time: 27.14 s, val_loss: 0.730
Epoch   17/50, time: 97.46 s, training_loss: 0.748
Epoch   17/50, time: 23.91 s, val_loss: 0.750
Epoch   18/50, time: 109.13 s, training_loss: 0.744
Epoch   18/50, time: 27.87 s, val_loss: 0.727
Epoch   19/50, time: 101.50 s, training_loss: 0.723
Epoch   19/50, time: 25.50 s, val_loss: 0.715
Epoch   20/50, time: 100.76 s, training_loss: 0.708
Epoch   20/50, time: 26.61 s, val_loss: 0.708
Epoch   21/50, time: 97.92 s, training_loss: 0.701
Epoch   21/50, time: 26.57 s, val_loss: 0.694
Training Metrics:
Accuracy: 0.9898
Precision: 0.6146
Recall: 0.7278
F1 Score: 0.6520
IoU: 0.1828
Dice Coefficient: 0.3091
Validation Metrics:
Accuracy: 0.9900
Precision: 0.6173
Recall: 0.7479
F1 Score: 0.6586
IoU: 0.1921
Dice Coefficient: 0.3223
Epoch   22/50, time: 99.38 s, training_loss: 0.688
Epoch   22/50, time: 25.75 s, val_loss: 0.675
Epoch   23/50, time: 100.87 s, training_loss: 0.675
Epoch   23/50, time: 27.79 s, val_loss: 0.662
Epoch   24/50, time: 100.73 s, training_loss: 0.667
Epoch   24/50, time: 24.82 s, val_loss: 0.713
Epoch   25/50, time: 104.94 s, training_loss: 0.658
Epoch   25/50, time: 25.88 s, val_loss: 0.647
Epoch   26/50, time: 100.32 s, training_loss: 0.652
Epoch   26/50, time: 27.63 s, val_loss: 0.646
Epoch   27/50, time: 103.65 s, training_loss: 0.619
Epoch   27/50, time: 27.09 s, val_loss: 0.594
Epoch   28/50, time: 98.02 s, training_loss: 0.580
Epoch   28/50, time: 27.97 s, val_loss: 0.562
Epoch   29/50, time: 102.27 s, training_loss: 0.558
Epoch   29/50, time: 24.26 s, val_loss: 0.535
Epoch   30/50, time: 102.73 s, training_loss: 0.542
Epoch   30/50, time: 27.69 s, val_loss: 0.530
Epoch   31/50, time: 110.21 s, training_loss: 0.529
Epoch   31/50, time: 27.81 s, val_loss: 0.536
Training Metrics:
Accuracy: 0.9940
Precision: 0.7046
Recall: 0.7680
F1 Score: 0.7320
IoU: 0.3046
Dice Coefficient: 0.4670
Validation Metrics:
Accuracy: 0.9943
Precision: 0.7079
Recall: 0.7659
F1 Score: 0.7333
IoU: 0.3067
Dice Coefficient: 0.4694
Epoch   32/50, time: 116.13 s, training_loss: 0.515
Epoch   32/50, time: 26.70 s, val_loss: 0.516
Epoch   33/50, time: 96.23 s, training_loss: 0.511
Epoch   33/50, time: 25.09 s, val_loss: 0.498
Epoch   34/50, time: 91.56 s, training_loss: 0.489
Epoch   34/50, time: 24.86 s, val_loss: 0.507
Epoch   35/50, time: 102.18 s, training_loss: 0.486
Epoch   35/50, time: 25.30 s, val_loss: 0.480
Epoch   36/50, time: 101.99 s, training_loss: 0.472
Epoch   36/50, time: 25.21 s, val_loss: 0.459
Epoch   37/50, time: 103.16 s, training_loss: 0.461
Epoch   37/50, time: 26.43 s, val_loss: 0.463
Epoch   38/50, time: 100.17 s, training_loss: 0.457
Epoch   38/50, time: 25.49 s, val_loss: 0.479
Epoch   39/50, time: 104.41 s, training_loss: 0.450
Epoch   39/50, time: 25.11 s, val_loss: 0.442
Epoch   40/50, time: 104.04 s, training_loss: 0.443
Epoch   40/50, time: 24.91 s, val_loss: 0.463
Epoch   41/50, time: 100.59 s, training_loss: 0.440
Epoch   41/50, time: 23.22 s, val_loss: 0.464
Training Metrics:
Accuracy: 0.9957
Precision: 0.7789
Recall: 0.7756
F1 Score: 0.7773
IoU: 0.3857
Dice Coefficient: 0.5567
Validation Metrics:
Accuracy: 0.9958
Precision: 0.7763
Recall: 0.7705
F1 Score: 0.7734
IoU: 0.3782
Dice Coefficient: 0.5489
Epoch   42/50, time: 110.86 s, training_loss: 0.428
Epoch   42/50, time: 24.77 s, val_loss: 0.476
Epoch   43/50, time: 101.28 s, training_loss: 0.425
Epoch   43/50, time: 25.04 s, val_loss: 0.448
Epoch   44/50, time: 100.64 s, training_loss: 0.419
Epoch   44/50, time: 24.93 s, val_loss: 0.412
Epoch   45/50, time: 97.62 s, training_loss: 0.415
Epoch   45/50, time: 27.57 s, val_loss: 0.418
Epoch   46/50, time: 97.76 s, training_loss: 0.409
Epoch   46/50, time: 25.33 s, val_loss: 0.438
Epoch   47/50, time: 101.08 s, training_loss: 0.409
Epoch   47/50, time: 25.41 s, val_loss: 0.422
Epoch   48/50, time: 103.32 s, training_loss: 0.401
Epoch   48/50, time: 25.13 s, val_loss: 0.411
Epoch   49/50, time: 101.27 s, training_loss: 0.403
Epoch   49/50, time: 26.01 s, val_loss: 0.434
Epoch   50/50, time: 96.69 s, training_loss: 0.393
Epoch   50/50, time: 25.41 s, val_loss: 0.400
Training Metrics:
Accuracy: 0.9966
Precision: 0.8357
Recall: 0.8008
F1 Score: 0.8173
IoU: 0.4666
Dice Coefficient: 0.6363
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8354
Recall: 0.7925
F1 Score: 0.8125
IoU: 0.4562
Dice Coefficient: 0.6266
[I 2025-06-18 11:34:10,457] Trial 8 finished with value: 0.6265910195375796 and parameters: {'batch_size': 16, 'lr': 0.000690666996297961, 'loss_fn': 'dice_loss'}. Best is trial 8 with value: 0.6265910195375796.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9967
Precision: 0.8354
Recall: 0.7925
F1 Score: 0.8125
IoU: 0.4562
Dice Coefficient: 0.6266
[Trial 8] Finished with val_loss=inf
[Trial 8] Finished with dice_coeff=0.6265910195375796
[Trial 9] Trying batch_size=32, lr=0.00019686893358956834, loss_fn=dice_loss
Epoch    1/50, time: 119.08 s, training_loss: 0.980
Epoch    1/50, time: 25.77 s, val_loss: 0.986
Training Metrics:
Accuracy: 0.1011
Precision: 0.5013
Recall: 0.5240
F1 Score: 0.0934
IoU: 0.0052
Dice Coefficient: 0.0103
Validation Metrics:
Accuracy: 0.1620
Precision: 0.5014
Recall: 0.5385
F1 Score: 0.1418
IoU: 0.0052
Dice Coefficient: 0.0103
Epoch    2/50, time: 118.69 s, training_loss: 0.972
Epoch    2/50, time: 27.24 s, val_loss: 0.973
Epoch    3/50, time: 109.44 s, training_loss: 0.965
Epoch    3/50, time: 25.48 s, val_loss: 0.977
Epoch    4/50, time: 107.07 s, training_loss: 0.960
Epoch    4/50, time: 25.94 s, val_loss: 0.957
Epoch    5/50, time: 111.80 s, training_loss: 0.955
Epoch    5/50, time: 27.60 s, val_loss: 0.930
Epoch    6/50, time: 112.35 s, training_loss: 0.949
Epoch    6/50, time: 26.01 s, val_loss: 0.976
Epoch    7/50, time: 109.99 s, training_loss: 0.944
Epoch    7/50, time: 26.85 s, val_loss: 0.949
Epoch    8/50, time: 109.78 s, training_loss: 0.929
Epoch    8/50, time: 25.50 s, val_loss: 0.892
Epoch    9/50, time: 113.31 s, training_loss: 0.913
Epoch    9/50, time: 29.29 s, val_loss: 0.881
Epoch   10/50, time: 103.47 s, training_loss: 0.900
Epoch   10/50, time: 26.63 s, val_loss: 0.901
Epoch   11/50, time: 108.32 s, training_loss: 0.892
Epoch   11/50, time: 27.68 s, val_loss: 0.873
Training Metrics:
Accuracy: 0.5346
Precision: 0.5028
Recall: 0.6415
F1 Score: 0.3554
IoU: 0.0078
Dice Coefficient: 0.0156
Validation Metrics:
Accuracy: 0.5940
Precision: 0.5030
Recall: 0.6518
F1 Score: 0.3803
IoU: 0.0082
Dice Coefficient: 0.0163
Epoch   12/50, time: 119.29 s, training_loss: 0.877
Epoch   12/50, time: 25.46 s, val_loss: 0.871
Epoch   13/50, time: 113.29 s, training_loss: 0.867
Epoch   13/50, time: 26.06 s, val_loss: 0.873
Epoch   14/50, time: 104.25 s, training_loss: 0.861
Epoch   14/50, time: 26.86 s, val_loss: 0.917
Epoch   15/50, time: 113.35 s, training_loss: 0.851
Epoch   15/50, time: 29.09 s, val_loss: 0.902
Epoch   16/50, time: 117.50 s, training_loss: 0.835
Epoch   16/50, time: 26.11 s, val_loss: 0.845
Epoch   17/50, time: 120.53 s, training_loss: 0.823
Epoch   17/50, time: 26.74 s, val_loss: 0.761
Epoch   18/50, time: 109.60 s, training_loss: 0.802
Epoch   18/50, time: 26.54 s, val_loss: 0.786
Epoch   19/50, time: 106.36 s, training_loss: 0.787
Epoch   19/50, time: 29.50 s, val_loss: 0.755
Epoch   20/50, time: 114.32 s, training_loss: 0.768
Epoch   20/50, time: 27.06 s, val_loss: 0.712
Epoch   21/50, time: 106.45 s, training_loss: 0.761
Epoch   21/50, time: 26.01 s, val_loss: 0.737
Training Metrics:
Accuracy: 0.7622
Precision: 0.5046
Recall: 0.6722
F1 Score: 0.4440
IoU: 0.0119
Dice Coefficient: 0.0234
Validation Metrics:
Accuracy: 0.7754
Precision: 0.5047
Recall: 0.6736
F1 Score: 0.4483
IoU: 0.0119
Dice Coefficient: 0.0235
Epoch   22/50, time: 123.00 s, training_loss: 0.743
Epoch   22/50, time: 25.91 s, val_loss: 0.701
Epoch   23/50, time: 110.97 s, training_loss: 0.728
Epoch   23/50, time: 25.80 s, val_loss: 0.751
Epoch   24/50, time: 112.22 s, training_loss: 0.704
Epoch   24/50, time: 25.77 s, val_loss: 0.727
Epoch   25/50, time: 109.11 s, training_loss: 0.709
Epoch   25/50, time: 25.82 s, val_loss: 0.678
Epoch   26/50, time: 110.27 s, training_loss: 0.692
Epoch   26/50, time: 25.16 s, val_loss: 0.648
Epoch   27/50, time: 114.72 s, training_loss: 0.671
Epoch   27/50, time: 25.93 s, val_loss: 0.649
Epoch   28/50, time: 110.29 s, training_loss: 0.644
Epoch   28/50, time: 26.01 s, val_loss: 0.651
Epoch   29/50, time: 107.83 s, training_loss: 0.641
Epoch   29/50, time: 27.66 s, val_loss: 0.621
Epoch   30/50, time: 111.27 s, training_loss: 0.629
Epoch   30/50, time: 26.39 s, val_loss: 0.622
Epoch   31/50, time: 115.96 s, training_loss: 0.602
Epoch   31/50, time: 25.89 s, val_loss: 0.622
Training Metrics:
Accuracy: 0.8670
Precision: 0.5079
Recall: 0.6878
F1 Score: 0.4823
IoU: 0.0184
Dice Coefficient: 0.0360
Validation Metrics:
Accuracy: 0.8555
Precision: 0.5070
Recall: 0.6824
F1 Score: 0.4771
IoU: 0.0164
Dice Coefficient: 0.0322
Epoch   32/50, time: 126.00 s, training_loss: 0.592
Epoch   32/50, time: 26.73 s, val_loss: 0.549
Epoch   33/50, time: 110.41 s, training_loss: 0.575
Epoch   33/50, time: 25.97 s, val_loss: 0.591
Epoch   34/50, time: 110.51 s, training_loss: 0.570
Epoch   34/50, time: 25.75 s, val_loss: 0.573
Epoch   35/50, time: 107.27 s, training_loss: 0.558
Epoch   35/50, time: 26.47 s, val_loss: 0.569
Epoch   36/50, time: 115.92 s, training_loss: 0.548
Epoch   36/50, time: 25.66 s, val_loss: 0.555
Epoch   37/50, time: 111.18 s, training_loss: 0.543
Epoch   37/50, time: 25.67 s, val_loss: 0.532
Epoch   38/50, time: 113.24 s, training_loss: 0.530
Epoch   38/50, time: 24.24 s, val_loss: 0.546
Epoch   39/50, time: 111.41 s, training_loss: 0.532
Epoch   39/50, time: 28.84 s, val_loss: 0.673
Epoch   40/50, time: 109.23 s, training_loss: 0.566
Epoch   40/50, time: 25.79 s, val_loss: 0.558
Epoch   41/50, time: 112.40 s, training_loss: 0.524
Epoch   41/50, time: 25.60 s, val_loss: 0.519
Training Metrics:
Accuracy: 0.9228
Precision: 0.5166
Recall: 0.7445
F1 Score: 0.5133
IoU: 0.0346
Dice Coefficient: 0.0669
Validation Metrics:
Accuracy: 0.9096
Precision: 0.5135
Recall: 0.7361
F1 Score: 0.5041
IoU: 0.0286
Dice Coefficient: 0.0556
Epoch   42/50, time: 120.27 s, training_loss: 0.509
Epoch   42/50, time: 26.67 s, val_loss: 0.486
Epoch   43/50, time: 112.40 s, training_loss: 0.497
Epoch   43/50, time: 26.61 s, val_loss: 0.490
Epoch   44/50, time: 106.78 s, training_loss: 0.482
Epoch   44/50, time: 25.42 s, val_loss: 0.478
Epoch   45/50, time: 114.82 s, training_loss: 0.476
Epoch   45/50, time: 26.52 s, val_loss: 0.468
Epoch   46/50, time: 112.51 s, training_loss: 0.469
Epoch   46/50, time: 28.80 s, val_loss: 0.487
Epoch   47/50, time: 109.56 s, training_loss: 0.478
Epoch   47/50, time: 27.13 s, val_loss: 0.496
Epoch   48/50, time: 107.02 s, training_loss: 0.461
Epoch   48/50, time: 27.06 s, val_loss: 0.451
Epoch   49/50, time: 105.10 s, training_loss: 0.455
Epoch   49/50, time: 26.58 s, val_loss: 0.452
Epoch   50/50, time: 118.65 s, training_loss: 0.452
Epoch   50/50, time: 28.85 s, val_loss: 0.460
Training Metrics:
Accuracy: 0.9697
Precision: 0.5439
Recall: 0.7695
F1 Score: 0.5700
IoU: 0.0842
Dice Coefficient: 0.1553
Validation Metrics:
Accuracy: 0.9631
Precision: 0.5348
Recall: 0.7664
F1 Score: 0.5542
IoU: 0.0680
Dice Coefficient: 0.1273
[I 2025-06-18 17:17:23,730] Trial 9 finished with value: 0.12725340308589408 and parameters: {'batch_size': 32, 'lr': 0.00019686893358956834, 'loss_fn': 'dice_loss'}. Best is trial 8 with value: 0.6265910195375796.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9631
Precision: 0.5348
Recall: 0.7664
F1 Score: 0.5542
IoU: 0.0680
Dice Coefficient: 0.1273
[Trial 9] Finished with val_loss=inf
[Trial 9] Finished with dice_coeff=0.12725340308589408
[Trial 10] Trying batch_size=16, lr=0.0003657208259555114, loss_fn=dice_loss
Epoch    1/50, time: 128.90 s, training_loss: 0.975
Epoch    1/50, time: 24.99 s, val_loss: 0.924
Training Metrics:
Accuracy: 0.5040
Precision: 0.5034
Recall: 0.6737
F1 Score: 0.3424
IoU: 0.0083
Dice Coefficient: 0.0164
Validation Metrics:
Accuracy: 0.8569
Precision: 0.5110
Recall: 0.7895
F1 Score: 0.4841
IoU: 0.0233
Dice Coefficient: 0.0456
Epoch    2/50, time: 112.36 s, training_loss: 0.952
Epoch    2/50, time: 27.35 s, val_loss: 0.892
Epoch    3/50, time: 100.18 s, training_loss: 0.921
Epoch    3/50, time: 24.30 s, val_loss: 0.929
Epoch    4/50, time: 106.16 s, training_loss: 0.896
Epoch    4/50, time: 25.98 s, val_loss: 0.823
Epoch    5/50, time: 100.35 s, training_loss: 0.871
Epoch    5/50, time: 24.92 s, val_loss: 0.810
Epoch    6/50, time: 104.86 s, training_loss: 0.851
Epoch    6/50, time: 25.40 s, val_loss: 0.822
Epoch    7/50, time: 106.95 s, training_loss: 0.841
Epoch    7/50, time: 25.34 s, val_loss: 0.864
Epoch    8/50, time: 101.83 s, training_loss: 0.821
Epoch    8/50, time: 25.78 s, val_loss: 0.794
Epoch    9/50, time: 100.65 s, training_loss: 0.807
Epoch    9/50, time: 25.98 s, val_loss: 0.775
Epoch   10/50, time: 101.86 s, training_loss: 0.793
Epoch   10/50, time: 23.54 s, val_loss: 0.762
Epoch   11/50, time: 102.60 s, training_loss: 0.784
Epoch   11/50, time: 25.35 s, val_loss: 0.764
Training Metrics:
Accuracy: 0.8822
Precision: 0.5107
Recall: 0.7282
F1 Score: 0.4914
IoU: 0.0233
Dice Coefficient: 0.0455
Validation Metrics:
Accuracy: 0.8926
Precision: 0.5116
Recall: 0.7360
F1 Score: 0.4958
IoU: 0.0249
Dice Coefficient: 0.0486
Epoch   12/50, time: 112.84 s, training_loss: 0.777
Epoch   12/50, time: 26.45 s, val_loss: 0.750
Epoch   13/50, time: 101.99 s, training_loss: 0.761
Epoch   13/50, time: 24.96 s, val_loss: 0.761
Epoch   14/50, time: 100.39 s, training_loss: 0.752
Epoch   14/50, time: 23.95 s, val_loss: 0.757
Epoch   15/50, time: 97.31 s, training_loss: 0.751
Epoch   15/50, time: 27.39 s, val_loss: 0.719
Epoch   16/50, time: 103.53 s, training_loss: 0.743
Epoch   16/50, time: 25.19 s, val_loss: 0.748
Epoch   17/50, time: 104.05 s, training_loss: 0.741
Epoch   17/50, time: 25.71 s, val_loss: 0.719
Epoch   18/50, time: 104.53 s, training_loss: 0.729
Epoch   18/50, time: 25.13 s, val_loss: 0.710
Epoch   19/50, time: 109.52 s, training_loss: 0.715
Epoch   19/50, time: 23.79 s, val_loss: 0.702
Epoch   20/50, time: 100.07 s, training_loss: 0.710
Epoch   20/50, time: 25.49 s, val_loss: 0.684
Epoch   21/50, time: 98.58 s, training_loss: 0.702
Epoch   21/50, time: 25.29 s, val_loss: 0.688
Training Metrics:
Accuracy: 0.9508
Precision: 0.5156
Recall: 0.6446
F1 Score: 0.5188
IoU: 0.0324
Dice Coefficient: 0.0628
Validation Metrics:
Accuracy: 0.9221
Precision: 0.5094
Recall: 0.6407
F1 Score: 0.5005
IoU: 0.0212
Dice Coefficient: 0.0416
Epoch   22/50, time: 102.04 s, training_loss: 0.670
Epoch   22/50, time: 25.10 s, val_loss: 0.599
Epoch   23/50, time: 104.27 s, training_loss: 0.650
Epoch   23/50, time: 25.33 s, val_loss: 0.872
Epoch   24/50, time: 102.23 s, training_loss: 0.622
Epoch   24/50, time: 25.10 s, val_loss: 0.592
Epoch   25/50, time: 96.61 s, training_loss: 0.585
Epoch   25/50, time: 25.12 s, val_loss: 0.598
Epoch   26/50, time: 103.06 s, training_loss: 0.568
Epoch   26/50, time: 26.14 s, val_loss: 0.526
Epoch   27/50, time: 99.43 s, training_loss: 0.550
Epoch   27/50, time: 25.52 s, val_loss: 0.533
Epoch   28/50, time: 103.68 s, training_loss: 0.528
Epoch   28/50, time: 27.77 s, val_loss: 0.502
Epoch   29/50, time: 109.35 s, training_loss: 0.518
Epoch   29/50, time: 26.12 s, val_loss: 0.514
Epoch   30/50, time: 104.12 s, training_loss: 0.499
Epoch   30/50, time: 25.07 s, val_loss: 0.491
Epoch   31/50, time: 104.71 s, training_loss: 0.491
Epoch   31/50, time: 25.37 s, val_loss: 0.471
Training Metrics:
Accuracy: 0.9956
Precision: 0.7745
Recall: 0.7738
F1 Score: 0.7741
IoU: 0.3798
Dice Coefficient: 0.5505
Validation Metrics:
Accuracy: 0.9957
Precision: 0.7742
Recall: 0.7750
F1 Score: 0.7746
IoU: 0.3806
Dice Coefficient: 0.5513
Epoch   32/50, time: 114.16 s, training_loss: 0.480
Epoch   32/50, time: 25.90 s, val_loss: 0.465
Epoch   33/50, time: 100.95 s, training_loss: 0.475
Epoch   33/50, time: 25.37 s, val_loss: 0.466
Epoch   34/50, time: 100.45 s, training_loss: 0.465
Epoch   34/50, time: 25.94 s, val_loss: 0.479
Epoch   35/50, time: 103.13 s, training_loss: 0.456
Epoch   35/50, time: 25.95 s, val_loss: 0.453
Epoch   36/50, time: 99.68 s, training_loss: 0.450
Epoch   36/50, time: 25.38 s, val_loss: 0.455
Epoch   37/50, time: 99.51 s, training_loss: 0.444
Epoch   37/50, time: 24.81 s, val_loss: 0.476
Epoch   38/50, time: 98.27 s, training_loss: 0.435
Epoch   38/50, time: 25.59 s, val_loss: 0.428
Epoch   39/50, time: 100.27 s, training_loss: 0.431
Epoch   39/50, time: 26.67 s, val_loss: 0.410
Epoch   40/50, time: 105.76 s, training_loss: 0.435
Epoch   40/50, time: 25.40 s, val_loss: 0.449
Epoch   41/50, time: 100.77 s, training_loss: 0.418
Epoch   41/50, time: 25.10 s, val_loss: 0.431
Training Metrics:
Accuracy: 0.9964
Precision: 0.8217
Recall: 0.7914
F1 Score: 0.8058
IoU: 0.4424
Dice Coefficient: 0.6134
Validation Metrics:
Accuracy: 0.9966
Precision: 0.8287
Recall: 0.7860
F1 Score: 0.8059
IoU: 0.4424
Dice Coefficient: 0.6134
Epoch   42/50, time: 115.05 s, training_loss: 0.413
Epoch   42/50, time: 26.78 s, val_loss: 0.406
Epoch   43/50, time: 101.33 s, training_loss: 0.414
Epoch   43/50, time: 25.29 s, val_loss: 0.449
Epoch   44/50, time: 96.66 s, training_loss: 0.417
Epoch   44/50, time: 23.91 s, val_loss: 0.397
Epoch   45/50, time: 102.83 s, training_loss: 0.406
Epoch   45/50, time: 24.00 s, val_loss: 0.425
Epoch   46/50, time: 104.12 s, training_loss: 0.403
Epoch   46/50, time: 25.33 s, val_loss: 0.423
Epoch   47/50, time: 107.79 s, training_loss: 0.397
Epoch   47/50, time: 25.28 s, val_loss: 0.404
Epoch   48/50, time: 101.26 s, training_loss: 0.397
Epoch   48/50, time: 25.44 s, val_loss: 0.424
Epoch   49/50, time: 113.98 s, training_loss: 0.391
Epoch   49/50, time: 25.34 s, val_loss: 0.381
Epoch   50/50, time: 103.10 s, training_loss: 0.394
Epoch   50/50, time: 25.69 s, val_loss: 0.389
Training Metrics:
Accuracy: 0.9966
Precision: 0.8360
Recall: 0.7927
F1 Score: 0.8129
IoU: 0.4571
Dice Coefficient: 0.6274
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8416
Recall: 0.7860
F1 Score: 0.8113
IoU: 0.4538
Dice Coefficient: 0.6243
[I 2025-06-18 20:14:25,415] Trial 10 finished with value: 0.6242577945680722 and parameters: {'batch_size': 16, 'lr': 0.0003657208259555114, 'loss_fn': 'dice_loss'}. Best is trial 8 with value: 0.6265910195375796.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9967
Precision: 0.8416
Recall: 0.7860
F1 Score: 0.8113
IoU: 0.4538
Dice Coefficient: 0.6243
[Trial 10] Finished with val_loss=inf
[Trial 10] Finished with dice_coeff=0.6242577945680722
[Trial 11] Trying batch_size=16, lr=0.0004101976011846278, loss_fn=dice_loss
Epoch    1/50, time: 112.07 s, training_loss: 0.970
Epoch    1/50, time: 26.98 s, val_loss: 0.983
Training Metrics:
Accuracy: 0.0853
Precision: 0.5018
Recall: 0.5270
F1 Score: 0.0800
IoU: 0.0052
Dice Coefficient: 0.0103
Validation Metrics:
Accuracy: 0.1153
Precision: 0.5017
Recall: 0.5348
F1 Score: 0.1052
IoU: 0.0051
Dice Coefficient: 0.0102
Epoch    2/50, time: 125.09 s, training_loss: 0.943
Epoch    2/50, time: 26.42 s, val_loss: 0.887
Epoch    3/50, time: 105.38 s, training_loss: 0.918
Epoch    3/50, time: 25.57 s, val_loss: 0.877
Epoch    4/50, time: 105.75 s, training_loss: 0.896
Epoch    4/50, time: 25.85 s, val_loss: 0.850
Epoch    5/50, time: 106.14 s, training_loss: 0.874
Epoch    5/50, time: 25.97 s, val_loss: 0.815
Epoch    6/50, time: 106.09 s, training_loss: 0.854
Epoch    6/50, time: 25.91 s, val_loss: 0.818
Epoch    7/50, time: 105.73 s, training_loss: 0.842
Epoch    7/50, time: 25.61 s, val_loss: 0.821
Epoch    8/50, time: 103.44 s, training_loss: 0.829
Epoch    8/50, time: 25.46 s, val_loss: 0.807
Epoch    9/50, time: 112.44 s, training_loss: 0.813
Epoch    9/50, time: 24.62 s, val_loss: 0.784
Epoch   10/50, time: 111.16 s, training_loss: 0.802
Epoch   10/50, time: 25.79 s, val_loss: 0.783
Epoch   11/50, time: 102.78 s, training_loss: 0.783
Epoch   11/50, time: 24.95 s, val_loss: 0.770
Training Metrics:
Accuracy: 0.9046
Precision: 0.5139
Recall: 0.7476
F1 Score: 0.5034
IoU: 0.0294
Dice Coefficient: 0.0571
Validation Metrics:
Accuracy: 0.9162
Precision: 0.5152
Recall: 0.7500
F1 Score: 0.5090
IoU: 0.0319
Dice Coefficient: 0.0618
Epoch   12/50, time: 116.58 s, training_loss: 0.791
Epoch   12/50, time: 24.05 s, val_loss: 0.757
Epoch   13/50, time: 110.10 s, training_loss: 0.769
Epoch   13/50, time: 25.65 s, val_loss: 0.738
Epoch   14/50, time: 99.44 s, training_loss: 0.761
Epoch   14/50, time: 25.10 s, val_loss: 0.755
Epoch   15/50, time: 101.98 s, training_loss: 0.763
Epoch   15/50, time: 25.16 s, val_loss: 0.748
Epoch   16/50, time: 103.28 s, training_loss: 0.752
Epoch   16/50, time: 26.48 s, val_loss: 0.731
Epoch   17/50, time: 99.40 s, training_loss: 0.741
Epoch   17/50, time: 24.91 s, val_loss: 0.719
Epoch   18/50, time: 106.13 s, training_loss: 0.733
Epoch   18/50, time: 24.45 s, val_loss: 0.708
Epoch   19/50, time: 103.09 s, training_loss: 0.722
Epoch   19/50, time: 26.07 s, val_loss: 0.697
Epoch   20/50, time: 100.26 s, training_loss: 0.714
Epoch   20/50, time: 25.29 s, val_loss: 0.697
Epoch   21/50, time: 102.35 s, training_loss: 0.720
Epoch   21/50, time: 26.04 s, val_loss: 0.686
Training Metrics:
Accuracy: 0.9499
Precision: 0.5237
Recall: 0.7312
F1 Score: 0.5326
IoU: 0.0476
Dice Coefficient: 0.0909
Validation Metrics:
Accuracy: 0.9428
Precision: 0.5213
Recall: 0.7455
F1 Score: 0.5268
IoU: 0.0434
Dice Coefficient: 0.0831
Epoch   22/50, time: 121.92 s, training_loss: 0.709
Epoch   22/50, time: 25.36 s, val_loss: 0.681
Epoch   23/50, time: 108.19 s, training_loss: 0.701
Epoch   23/50, time: 23.56 s, val_loss: 0.693
Epoch   24/50, time: 113.29 s, training_loss: 0.700
Epoch   24/50, time: 25.34 s, val_loss: 0.695
Epoch   25/50, time: 105.25 s, training_loss: 0.691
Epoch   25/50, time: 26.54 s, val_loss: 0.666
Epoch   26/50, time: 106.14 s, training_loss: 0.688
Epoch   26/50, time: 25.58 s, val_loss: 0.659
Epoch   27/50, time: 101.08 s, training_loss: 0.654
Epoch   27/50, time: 24.84 s, val_loss: 0.629
Epoch   28/50, time: 101.85 s, training_loss: 0.622
Epoch   28/50, time: 25.21 s, val_loss: 0.566
Epoch   29/50, time: 107.07 s, training_loss: 0.601
Epoch   29/50, time: 27.73 s, val_loss: 0.604
Epoch   30/50, time: 101.06 s, training_loss: 0.582
Epoch   30/50, time: 25.77 s, val_loss: 0.554
Epoch   31/50, time: 103.06 s, training_loss: 0.566
Epoch   31/50, time: 25.59 s, val_loss: 0.554
Training Metrics:
Accuracy: 0.9695
Precision: 0.5323
Recall: 0.6895
F1 Score: 0.5502
IoU: 0.0615
Dice Coefficient: 0.1158
Validation Metrics:
Accuracy: 0.9608
Precision: 0.5251
Recall: 0.6969
F1 Score: 0.5371
IoU: 0.0495
Dice Coefficient: 0.0942
Epoch   32/50, time: 120.47 s, training_loss: 0.593
Epoch   32/50, time: 24.68 s, val_loss: 0.609
Epoch   33/50, time: 106.24 s, training_loss: 0.576
Epoch   33/50, time: 26.02 s, val_loss: 0.541
Epoch   34/50, time: 102.32 s, training_loss: 0.544
Epoch   34/50, time: 27.16 s, val_loss: 0.515
Epoch   35/50, time: 104.39 s, training_loss: 0.529
Epoch   35/50, time: 26.87 s, val_loss: 0.519
Epoch   36/50, time: 96.09 s, training_loss: 0.509
Epoch   36/50, time: 27.09 s, val_loss: 0.504
Epoch   37/50, time: 103.23 s, training_loss: 0.495
Epoch   37/50, time: 27.70 s, val_loss: 0.475
Epoch   38/50, time: 103.38 s, training_loss: 0.489
Epoch   38/50, time: 25.85 s, val_loss: 0.516
Epoch   39/50, time: 102.27 s, training_loss: 0.484
Epoch   39/50, time: 25.92 s, val_loss: 0.479
Epoch   40/50, time: 105.75 s, training_loss: 0.472
Epoch   40/50, time: 24.88 s, val_loss: 0.473
Epoch   41/50, time: 101.70 s, training_loss: 0.475
Epoch   41/50, time: 25.67 s, val_loss: 0.461
Training Metrics:
Accuracy: 0.9956
Precision: 0.7748
Recall: 0.7891
F1 Score: 0.7817
IoU: 0.3944
Dice Coefficient: 0.5657
Validation Metrics:
Accuracy: 0.9958
Precision: 0.7751
Recall: 0.7805
F1 Score: 0.7777
IoU: 0.3866
Dice Coefficient: 0.5576
Epoch   42/50, time: 118.30 s, training_loss: 0.458
Epoch   42/50, time: 25.53 s, val_loss: 0.469
Epoch   43/50, time: 103.00 s, training_loss: 0.451
Epoch   43/50, time: 25.88 s, val_loss: 0.443
Epoch   44/50, time: 102.46 s, training_loss: 0.440
Epoch   44/50, time: 27.20 s, val_loss: 0.452
Epoch   45/50, time: 109.58 s, training_loss: 0.441
Epoch   45/50, time: 26.76 s, val_loss: 0.434
Epoch   46/50, time: 106.66 s, training_loss: 0.438
Epoch   46/50, time: 25.30 s, val_loss: 0.436
Epoch   47/50, time: 107.56 s, training_loss: 0.429
Epoch   47/50, time: 25.93 s, val_loss: 0.443
Epoch   48/50, time: 102.42 s, training_loss: 0.420
Epoch   48/50, time: 25.97 s, val_loss: 0.436
Epoch   49/50, time: 107.97 s, training_loss: 0.420
Epoch   49/50, time: 25.17 s, val_loss: 0.419
Epoch   50/50, time: 114.44 s, training_loss: 0.420
Epoch   50/50, time: 26.07 s, val_loss: 0.420
Training Metrics:
Accuracy: 0.9961
Precision: 0.7997
Recall: 0.8046
F1 Score: 0.8021
IoU: 0.4349
Dice Coefficient: 0.6062
Validation Metrics:
Accuracy: 0.9961
Precision: 0.7911
Recall: 0.7983
F1 Score: 0.7947
IoU: 0.4197
Dice Coefficient: 0.5913
[I 2025-06-18 22:38:58,717] Trial 11 finished with value: 0.591277663414128 and parameters: {'batch_size': 16, 'lr': 0.0004101976011846278, 'loss_fn': 'dice_loss'}. Best is trial 8 with value: 0.6265910195375796.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9961
Precision: 0.7911
Recall: 0.7983
F1 Score: 0.7947
IoU: 0.4197
Dice Coefficient: 0.5913
[Trial 11] Finished with val_loss=inf
[Trial 11] Finished with dice_coeff=0.591277663414128
[Trial 12] Trying batch_size=16, lr=0.00031762562326883756, loss_fn=dice_loss
Epoch    1/50, time: 117.37 s, training_loss: 0.972
Epoch    1/50, time: 25.08 s, val_loss: 0.937
Training Metrics:
Accuracy: 0.4188
Precision: 0.5031
Recall: 0.6519
F1 Score: 0.3013
IoU: 0.0074
Dice Coefficient: 0.0148
Validation Metrics:
Accuracy: 0.8323
Precision: 0.5100
Recall: 0.7999
F1 Score: 0.4749
IoU: 0.0212
Dice Coefficient: 0.0416
Epoch    2/50, time: 122.04 s, training_loss: 0.952
Epoch    2/50, time: 24.96 s, val_loss: 0.896
Epoch    3/50, time: 104.27 s, training_loss: 0.922
Epoch    3/50, time: 26.26 s, val_loss: 0.881
Epoch    4/50, time: 107.54 s, training_loss: 0.903
Epoch    4/50, time: 25.87 s, val_loss: 0.990
Epoch    5/50, time: 101.24 s, training_loss: 0.896
Epoch    5/50, time: 25.45 s, val_loss: 0.819
Epoch    6/50, time: 100.69 s, training_loss: 0.868
Epoch    6/50, time: 25.19 s, val_loss: 0.812
Epoch    7/50, time: 100.55 s, training_loss: 0.850
Epoch    7/50, time: 26.24 s, val_loss: 0.805
Epoch    8/50, time: 98.88 s, training_loss: 0.840
Epoch    8/50, time: 24.97 s, val_loss: 0.811
Epoch    9/50, time: 107.06 s, training_loss: 0.824
Epoch    9/50, time: 28.25 s, val_loss: 0.821
Epoch   10/50, time: 105.60 s, training_loss: 0.809
Epoch   10/50, time: 28.32 s, val_loss: 0.781
Epoch   11/50, time: 101.78 s, training_loss: 0.797
Epoch   11/50, time: 25.58 s, val_loss: 0.777
Training Metrics:
Accuracy: 0.8460
Precision: 0.5062
Recall: 0.6650
F1 Score: 0.4731
IoU: 0.0151
Dice Coefficient: 0.0298
Validation Metrics:
Accuracy: 0.9188
Precision: 0.5125
Recall: 0.6975
F1 Score: 0.5050
IoU: 0.0269
Dice Coefficient: 0.0525
Epoch   12/50, time: 118.87 s, training_loss: 0.796
Epoch   12/50, time: 24.55 s, val_loss: 0.802
Epoch   13/50, time: 103.64 s, training_loss: 0.789
Epoch   13/50, time: 25.88 s, val_loss: 0.773
Epoch   14/50, time: 109.58 s, training_loss: 0.783
Epoch   14/50, time: 25.21 s, val_loss: 0.762
Epoch   15/50, time: 105.74 s, training_loss: 0.776
Epoch   15/50, time: 27.98 s, val_loss: 0.748
Epoch   16/50, time: 102.75 s, training_loss: 0.763
Epoch   16/50, time: 24.55 s, val_loss: 0.759
Epoch   17/50, time: 103.56 s, training_loss: 0.761
Epoch   17/50, time: 26.75 s, val_loss: 0.743
Epoch   18/50, time: 104.61 s, training_loss: 0.761
Epoch   18/50, time: 28.46 s, val_loss: 0.754
Epoch   19/50, time: 104.15 s, training_loss: 0.753
Epoch   19/50, time: 26.65 s, val_loss: 0.752
Epoch   20/50, time: 106.50 s, training_loss: 0.739
Epoch   20/50, time: 25.41 s, val_loss: 0.728
Epoch   21/50, time: 101.38 s, training_loss: 0.740
Epoch   21/50, time: 26.99 s, val_loss: 0.756
Training Metrics:
Accuracy: 0.9108
Precision: 0.5147
Recall: 0.7473
F1 Score: 0.5067
IoU: 0.0310
Dice Coefficient: 0.0602
Validation Metrics:
Accuracy: 0.8577
Precision: 0.5093
Recall: 0.7411
F1 Score: 0.4815
IoU: 0.0204
Dice Coefficient: 0.0399
Epoch   22/50, time: 130.86 s, training_loss: 0.727
Epoch   22/50, time: 25.26 s, val_loss: 0.708
Epoch   23/50, time: 105.13 s, training_loss: 0.718
Epoch   23/50, time: 25.06 s, val_loss: 0.722
Epoch   24/50, time: 109.37 s, training_loss: 0.704
Epoch   24/50, time: 28.00 s, val_loss: 0.669
Epoch   25/50, time: 103.57 s, training_loss: 0.679
Epoch   25/50, time: 26.90 s, val_loss: 0.670
Epoch   26/50, time: 107.11 s, training_loss: 0.674
Epoch   26/50, time: 27.07 s, val_loss: 0.648
Epoch   27/50, time: 107.17 s, training_loss: 0.670
Epoch   27/50, time: 24.84 s, val_loss: 0.655
Epoch   28/50, time: 108.27 s, training_loss: 0.650
Epoch   28/50, time: 25.39 s, val_loss: 0.631
Epoch   29/50, time: 103.74 s, training_loss: 0.625
Epoch   29/50, time: 25.48 s, val_loss: 0.610
Epoch   30/50, time: 104.82 s, training_loss: 0.614
Epoch   30/50, time: 25.23 s, val_loss: 0.617
Epoch   31/50, time: 102.89 s, training_loss: 0.598
Epoch   31/50, time: 27.78 s, val_loss: 0.595
Training Metrics:
Accuracy: 0.9930
Precision: 0.6710
Recall: 0.7390
F1 Score: 0.6992
IoU: 0.2516
Dice Coefficient: 0.4020
Validation Metrics:
Accuracy: 0.9933
Precision: 0.6758
Recall: 0.7457
F1 Score: 0.7048
IoU: 0.2602
Dice Coefficient: 0.4130
Epoch   32/50, time: 126.45 s, training_loss: 0.582
Epoch   32/50, time: 25.75 s, val_loss: 0.566
Epoch   33/50, time: 103.22 s, training_loss: 0.578
Epoch   33/50, time: 25.54 s, val_loss: 0.572
Epoch   34/50, time: 105.50 s, training_loss: 0.560
Epoch   34/50, time: 26.56 s, val_loss: 0.548
Epoch   35/50, time: 102.60 s, training_loss: 0.550
Epoch   35/50, time: 25.78 s, val_loss: 0.536
Epoch   36/50, time: 106.77 s, training_loss: 0.538
Epoch   36/50, time: 26.90 s, val_loss: 0.532
Epoch   37/50, time: 109.30 s, training_loss: 0.521
Epoch   37/50, time: 25.76 s, val_loss: 0.520
Epoch   38/50, time: 102.84 s, training_loss: 0.509
Epoch   38/50, time: 25.78 s, val_loss: 0.517
Epoch   39/50, time: 101.87 s, training_loss: 0.500
Epoch   39/50, time: 25.03 s, val_loss: 0.488
Epoch   40/50, time: 104.67 s, training_loss: 0.481
Epoch   40/50, time: 25.46 s, val_loss: 0.470
Epoch   41/50, time: 107.11 s, training_loss: 0.476
Epoch   41/50, time: 25.72 s, val_loss: 0.458
Training Metrics:
Accuracy: 0.9957
Precision: 0.7796
Recall: 0.7646
F1 Score: 0.7719
IoU: 0.3755
Dice Coefficient: 0.5460
Validation Metrics:
Accuracy: 0.9958
Precision: 0.7797
Recall: 0.7699
F1 Score: 0.7747
IoU: 0.3808
Dice Coefficient: 0.5515
Epoch   42/50, time: 123.95 s, training_loss: 0.472
Epoch   42/50, time: 26.17 s, val_loss: 0.477
Epoch   43/50, time: 104.92 s, training_loss: 0.466
Epoch   43/50, time: 25.88 s, val_loss: 0.460
Epoch   44/50, time: 104.92 s, training_loss: 0.459
Epoch   44/50, time: 26.33 s, val_loss: 0.449
Epoch   45/50, time: 106.81 s, training_loss: 0.450
Epoch   45/50, time: 25.56 s, val_loss: 0.452
Epoch   46/50, time: 103.00 s, training_loss: 0.447
Epoch   46/50, time: 25.46 s, val_loss: 0.454
Epoch   47/50, time: 104.06 s, training_loss: 0.446
Epoch   47/50, time: 25.95 s, val_loss: 0.434
Epoch   48/50, time: 106.06 s, training_loss: 0.438
Epoch   48/50, time: 26.33 s, val_loss: 0.439
Epoch   49/50, time: 104.00 s, training_loss: 0.432
Epoch   49/50, time: 24.71 s, val_loss: 0.438
Epoch   50/50, time: 100.92 s, training_loss: 0.422
Epoch   50/50, time: 27.86 s, val_loss: 0.442
Training Metrics:
Accuracy: 0.9962
Precision: 0.8127
Recall: 0.7861
F1 Score: 0.7988
IoU: 0.4281
Dice Coefficient: 0.5995
Validation Metrics:
Accuracy: 0.9963
Precision: 0.8115
Recall: 0.7846
F1 Score: 0.7974
IoU: 0.4252
Dice Coefficient: 0.5966
[I 2025-06-19 01:01:40,156] Trial 12 finished with value: 0.5966465110566885 and parameters: {'batch_size': 16, 'lr': 0.00031762562326883756, 'loss_fn': 'dice_loss'}. Best is trial 8 with value: 0.6265910195375796.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9963
Precision: 0.8115
Recall: 0.7846
F1 Score: 0.7974
IoU: 0.4252
Dice Coefficient: 0.5966
[Trial 12] Finished with val_loss=inf
[Trial 12] Finished with dice_coeff=0.5966465110566885
[Trial 13] Trying batch_size=16, lr=0.0008385520967028442, loss_fn=dice_loss
Epoch    1/50, time: 117.71 s, training_loss: 0.969
Epoch    1/50, time: 26.83 s, val_loss: 0.922
Training Metrics:
Accuracy: 0.7138
Precision: 0.5050
Recall: 0.7090
F1 Score: 0.4280
IoU: 0.0119
Dice Coefficient: 0.0236
Validation Metrics:
Accuracy: 0.8946
Precision: 0.5102
Recall: 0.7043
F1 Score: 0.4941
IoU: 0.0225
Dice Coefficient: 0.0440
Epoch    2/50, time: 119.10 s, training_loss: 0.923
Epoch    2/50, time: 25.01 s, val_loss: 0.893
Epoch    3/50, time: 102.73 s, training_loss: 0.879
Epoch    3/50, time: 25.63 s, val_loss: 0.851
Epoch    4/50, time: 107.45 s, training_loss: 0.848
Epoch    4/50, time: 24.25 s, val_loss: 0.808
Epoch    5/50, time: 108.03 s, training_loss: 0.819
Epoch    5/50, time: 27.22 s, val_loss: 0.845
Epoch    6/50, time: 114.28 s, training_loss: 0.807
Epoch    6/50, time: 26.46 s, val_loss: 0.787
Epoch    7/50, time: 107.81 s, training_loss: 0.794
Epoch    7/50, time: 25.56 s, val_loss: 0.875
Epoch    8/50, time: 102.58 s, training_loss: 0.790
Epoch    8/50, time: 27.80 s, val_loss: 0.784
Epoch    9/50, time: 103.18 s, training_loss: 0.778
Epoch    9/50, time: 26.25 s, val_loss: 0.769
Epoch   10/50, time: 100.78 s, training_loss: 0.774
Epoch   10/50, time: 25.68 s, val_loss: 0.761
Epoch   11/50, time: 100.67 s, training_loss: 0.772
Epoch   11/50, time: 23.15 s, val_loss: 0.758
Training Metrics:
Accuracy: 0.9477
Precision: 0.5227
Recall: 0.7310
F1 Score: 0.5304
IoU: 0.0458
Dice Coefficient: 0.0877
Validation Metrics:
Accuracy: 0.9457
Precision: 0.5214
Recall: 0.7341
F1 Score: 0.5277
IoU: 0.0435
Dice Coefficient: 0.0833
Epoch   12/50, time: 114.54 s, training_loss: 0.771
Epoch   12/50, time: 25.35 s, val_loss: 0.758
Epoch   13/50, time: 99.42 s, training_loss: 0.775
Epoch   13/50, time: 23.25 s, val_loss: 0.739
Epoch   14/50, time: 96.14 s, training_loss: 0.753
Epoch   14/50, time: 22.98 s, val_loss: 0.736
Epoch   15/50, time: 100.04 s, training_loss: 0.741
Epoch   15/50, time: 23.99 s, val_loss: 0.727
Epoch   16/50, time: 103.33 s, training_loss: 0.725
Epoch   16/50, time: 22.32 s, val_loss: 0.708
Epoch   17/50, time: 92.52 s, training_loss: 0.719
Epoch   17/50, time: 22.23 s, val_loss: 0.701
Epoch   18/50, time: 95.82 s, training_loss: 0.694
Epoch   18/50, time: 23.45 s, val_loss: 0.678
Epoch   19/50, time: 97.25 s, training_loss: 0.671
Epoch   19/50, time: 24.87 s, val_loss: 0.641
Epoch   20/50, time: 100.51 s, training_loss: 0.648
Epoch   20/50, time: 24.77 s, val_loss: 0.682
Epoch   21/50, time: 98.97 s, training_loss: 0.634
Epoch   21/50, time: 24.02 s, val_loss: 0.603
Training Metrics:
Accuracy: 0.9917
Precision: 0.6492
Recall: 0.7610
F1 Score: 0.6895
IoU: 0.2371
Dice Coefficient: 0.3833
Validation Metrics:
Accuracy: 0.9926
Precision: 0.6603
Recall: 0.7514
F1 Score: 0.6956
IoU: 0.2460
Dice Coefficient: 0.3948
Epoch   22/50, time: 97.92 s, training_loss: 0.612
Epoch   22/50, time: 25.20 s, val_loss: 0.582
Epoch   23/50, time: 97.69 s, training_loss: 0.588
Epoch   23/50, time: 22.22 s, val_loss: 0.585
Epoch   24/50, time: 95.55 s, training_loss: 0.579
Epoch   24/50, time: 20.81 s, val_loss: 0.551
Epoch   25/50, time: 102.82 s, training_loss: 0.562
Epoch   25/50, time: 24.59 s, val_loss: 0.539
Epoch   26/50, time: 95.11 s, training_loss: 0.545
Epoch   26/50, time: 24.70 s, val_loss: 0.551
Epoch   27/50, time: 96.40 s, training_loss: 0.531
Epoch   27/50, time: 24.77 s, val_loss: 0.498
Epoch   28/50, time: 93.72 s, training_loss: 0.511
Epoch   28/50, time: 22.73 s, val_loss: 0.497
Epoch   29/50, time: 95.32 s, training_loss: 0.504
Epoch   29/50, time: 22.75 s, val_loss: 0.483
Epoch   30/50, time: 97.14 s, training_loss: 0.486
Epoch   30/50, time: 25.45 s, val_loss: 0.470
Epoch   31/50, time: 95.61 s, training_loss: 0.479
Epoch   31/50, time: 25.19 s, val_loss: 0.472
Training Metrics:
Accuracy: 0.9955
Precision: 0.7687
Recall: 0.7529
F1 Score: 0.7606
IoU: 0.3544
Dice Coefficient: 0.5234
Validation Metrics:
Accuracy: 0.9958
Precision: 0.7804
Recall: 0.7614
F1 Score: 0.7706
IoU: 0.3729
Dice Coefficient: 0.5432
Epoch   32/50, time: 110.21 s, training_loss: 0.473
Epoch   32/50, time: 24.57 s, val_loss: 0.443
Epoch   33/50, time: 102.30 s, training_loss: 0.458
Epoch   33/50, time: 25.51 s, val_loss: 0.445
Epoch   34/50, time: 106.84 s, training_loss: 0.456
Epoch   34/50, time: 25.35 s, val_loss: 0.459
Epoch   35/50, time: 96.61 s, training_loss: 0.447
Epoch   35/50, time: 24.84 s, val_loss: 0.457
Epoch   36/50, time: 90.19 s, training_loss: 0.438
Epoch   36/50, time: 25.94 s, val_loss: 0.464
Epoch   37/50, time: 101.36 s, training_loss: 0.437
Epoch   37/50, time: 21.25 s, val_loss: 0.441
Epoch   38/50, time: 92.49 s, training_loss: 0.434
Epoch   38/50, time: 24.24 s, val_loss: 0.439
Epoch   39/50, time: 101.10 s, training_loss: 0.427
Epoch   39/50, time: 25.30 s, val_loss: 0.425
Epoch   40/50, time: 104.83 s, training_loss: 0.423
Epoch   40/50, time: 24.83 s, val_loss: 0.425
Epoch   41/50, time: 105.88 s, training_loss: 0.418
Epoch   41/50, time: 23.76 s, val_loss: 0.410
Training Metrics:
Accuracy: 0.9964
Precision: 0.8242
Recall: 0.7907
F1 Score: 0.8065
IoU: 0.4439
Dice Coefficient: 0.6149
Validation Metrics:
Accuracy: 0.9965
Precision: 0.8215
Recall: 0.7847
F1 Score: 0.8020
IoU: 0.4345
Dice Coefficient: 0.6057
Epoch   42/50, time: 108.54 s, training_loss: 0.412
Epoch   42/50, time: 22.48 s, val_loss: 0.422
Epoch   43/50, time: 102.11 s, training_loss: 0.406
Epoch   43/50, time: 25.25 s, val_loss: 0.395
Epoch   44/50, time: 93.34 s, training_loss: 0.404
Epoch   44/50, time: 24.32 s, val_loss: 0.433
Epoch   45/50, time: 100.46 s, training_loss: 0.401
Epoch   45/50, time: 25.71 s, val_loss: 0.394
Epoch   46/50, time: 103.10 s, training_loss: 0.399
Epoch   46/50, time: 25.41 s, val_loss: 0.409
Epoch   47/50, time: 97.95 s, training_loss: 0.395
Epoch   47/50, time: 23.24 s, val_loss: 0.406
Epoch   48/50, time: 92.57 s, training_loss: 0.395
Epoch   48/50, time: 25.87 s, val_loss: 0.396
Epoch   49/50, time: 96.10 s, training_loss: 0.394
Epoch   49/50, time: 22.80 s, val_loss: 0.394
Epoch   50/50, time: 96.96 s, training_loss: 0.389
Epoch   50/50, time: 24.47 s, val_loss: 0.383
Training Metrics:
Accuracy: 0.9965
Precision: 0.8259
Recall: 0.8076
F1 Score: 0.8164
IoU: 0.4648
Dice Coefficient: 0.6346
Validation Metrics:
Accuracy: 0.9966
Precision: 0.8290
Recall: 0.7996
F1 Score: 0.8136
IoU: 0.4587
Dice Coefficient: 0.6289
[I 2025-06-19 03:08:52,557] Trial 13 finished with value: 0.6288735135823516 and parameters: {'batch_size': 16, 'lr': 0.0008385520967028442, 'loss_fn': 'dice_loss'}. Best is trial 13 with value: 0.6288735135823516.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9966
Precision: 0.8290
Recall: 0.7996
F1 Score: 0.8136
IoU: 0.4587
Dice Coefficient: 0.6289
[Trial 13] Finished with val_loss=inf
[Trial 13] Finished with dice_coeff=0.6288735135823516
[Trial 14] Trying batch_size=16, lr=0.000996698180015414, loss_fn=dice_loss
Epoch    1/50, time: 112.10 s, training_loss: 0.962
Epoch    1/50, time: 24.80 s, val_loss: 0.931
Training Metrics:
Accuracy: 0.7227
Precision: 0.5010
Recall: 0.5390
F1 Score: 0.4255
IoU: 0.0062
Dice Coefficient: 0.0124
Validation Metrics:
Accuracy: 0.9227
Precision: 0.5016
Recall: 0.5234
F1 Score: 0.4871
IoU: 0.0073
Dice Coefficient: 0.0145
Epoch    2/50, time: 94.37 s, training_loss: 0.913
Epoch    2/50, time: 24.34 s, val_loss: 0.835
Epoch    3/50, time: 100.99 s, training_loss: 0.872
Epoch    3/50, time: 25.40 s, val_loss: 0.832
Epoch    4/50, time: 93.36 s, training_loss: 0.839
Epoch    4/50, time: 21.71 s, val_loss: 0.790
Epoch    5/50, time: 104.54 s, training_loss: 0.820
Epoch    5/50, time: 22.06 s, val_loss: 0.803
Epoch    6/50, time: 94.09 s, training_loss: 0.802
Epoch    6/50, time: 21.51 s, val_loss: 0.788
Epoch    7/50, time: 91.77 s, training_loss: 0.792
Epoch    7/50, time: 25.00 s, val_loss: 0.756
Epoch    8/50, time: 94.00 s, training_loss: 0.784
Epoch    8/50, time: 23.77 s, val_loss: 0.759
Epoch    9/50, time: 96.96 s, training_loss: 0.782
Epoch    9/50, time: 23.97 s, val_loss: 0.776
Epoch   10/50, time: 96.73 s, training_loss: 0.774
Epoch   10/50, time: 21.31 s, val_loss: 0.747
Epoch   11/50, time: 108.34 s, training_loss: 0.762
Epoch   11/50, time: 26.45 s, val_loss: 0.763
Training Metrics:
Accuracy: 0.9494
Precision: 0.5239
Recall: 0.7358
F1 Score: 0.5328
IoU: 0.0480
Dice Coefficient: 0.0917
Validation Metrics:
Accuracy: 0.9546
Precision: 0.5266
Recall: 0.7456
F1 Score: 0.5386
IoU: 0.0529
Dice Coefficient: 0.1005
Epoch   12/50, time: 103.66 s, training_loss: 0.761
Epoch   12/50, time: 25.73 s, val_loss: 0.746
Epoch   13/50, time: 96.95 s, training_loss: 0.769
Epoch   13/50, time: 26.35 s, val_loss: 0.750
Epoch   14/50, time: 97.68 s, training_loss: 0.744
Epoch   14/50, time: 24.87 s, val_loss: 0.735
Epoch   15/50, time: 95.51 s, training_loss: 0.733
Epoch   15/50, time: 24.09 s, val_loss: 0.719
Epoch   16/50, time: 93.54 s, training_loss: 0.725
Epoch   16/50, time: 20.85 s, val_loss: 0.714
Epoch   17/50, time: 95.15 s, training_loss: 0.712
Epoch   17/50, time: 22.40 s, val_loss: 0.713
Epoch   18/50, time: 103.13 s, training_loss: 0.685
Epoch   18/50, time: 25.15 s, val_loss: 0.672
Epoch   19/50, time: 97.06 s, training_loss: 0.666
Epoch   19/50, time: 25.41 s, val_loss: 0.633
Epoch   20/50, time: 92.22 s, training_loss: 0.645
Epoch   20/50, time: 22.59 s, val_loss: 0.651
Epoch   21/50, time: 95.63 s, training_loss: 0.633
Epoch   21/50, time: 22.65 s, val_loss: 0.610
Training Metrics:
Accuracy: 0.9941
Precision: 0.6963
Recall: 0.6937
F1 Score: 0.6950
IoU: 0.2445
Dice Coefficient: 0.3930
Validation Metrics:
Accuracy: 0.9941
Precision: 0.6942
Recall: 0.7166
F1 Score: 0.7048
IoU: 0.2599
Dice Coefficient: 0.4126
Epoch   22/50, time: 97.69 s, training_loss: 0.611
Epoch   22/50, time: 25.66 s, val_loss: 0.597
Epoch   23/50, time: 99.09 s, training_loss: 0.594
Epoch   23/50, time: 25.79 s, val_loss: 0.611
Epoch   24/50, time: 98.27 s, training_loss: 0.576
Epoch   24/50, time: 22.58 s, val_loss: 0.566
Epoch   25/50, time: 99.86 s, training_loss: 0.572
Epoch   25/50, time: 24.69 s, val_loss: 0.527
Epoch   26/50, time: 102.64 s, training_loss: 0.549
Epoch   26/50, time: 24.89 s, val_loss: 0.565
Epoch   27/50, time: 96.70 s, training_loss: 0.533
Epoch   27/50, time: 27.07 s, val_loss: 0.520
Epoch   28/50, time: 103.35 s, training_loss: 0.530
Epoch   28/50, time: 26.84 s, val_loss: 0.511
Epoch   29/50, time: 93.97 s, training_loss: 0.510
Epoch   29/50, time: 25.87 s, val_loss: 0.521
Epoch   30/50, time: 94.16 s, training_loss: 0.506
Epoch   30/50, time: 26.44 s, val_loss: 0.530
Epoch   31/50, time: 106.20 s, training_loss: 0.496
Epoch   31/50, time: 26.47 s, val_loss: 0.517
Training Metrics:
Accuracy: 0.9955
Precision: 0.7714
Recall: 0.7415
F1 Score: 0.7556
IoU: 0.3453
Dice Coefficient: 0.5134
Validation Metrics:
Accuracy: 0.9955
Precision: 0.7643
Recall: 0.7400
F1 Score: 0.7516
IoU: 0.3382
Dice Coefficient: 0.5054
Epoch   32/50, time: 112.63 s, training_loss: 0.493
Epoch   32/50, time: 25.83 s, val_loss: 0.557
Epoch   33/50, time: 95.95 s, training_loss: 0.476
Epoch   33/50, time: 26.14 s, val_loss: 0.470
Epoch   34/50, time: 93.79 s, training_loss: 0.470
Epoch   34/50, time: 26.40 s, val_loss: 0.462
Epoch   35/50, time: 96.05 s, training_loss: 0.455
Epoch   35/50, time: 25.35 s, val_loss: 0.450
Epoch   36/50, time: 99.00 s, training_loss: 0.447
Epoch   36/50, time: 25.69 s, val_loss: 0.451
Epoch   37/50, time: 99.71 s, training_loss: 0.440
Epoch   37/50, time: 22.08 s, val_loss: 0.440
Epoch   38/50, time: 97.02 s, training_loss: 0.438
Epoch   38/50, time: 24.35 s, val_loss: 0.471
Epoch   39/50, time: 92.61 s, training_loss: 0.435
Epoch   39/50, time: 23.84 s, val_loss: 0.428
Epoch   40/50, time: 95.20 s, training_loss: 0.422
Epoch   40/50, time: 23.06 s, val_loss: 0.437
Epoch   41/50, time: 107.99 s, training_loss: 0.427
Epoch   41/50, time: 23.79 s, val_loss: 0.421
Training Metrics:
Accuracy: 0.9964
Precision: 0.8237
Recall: 0.7813
F1 Score: 0.8010
IoU: 0.4326
Dice Coefficient: 0.6039
Validation Metrics:
Accuracy: 0.9964
Precision: 0.8185
Recall: 0.7779
F1 Score: 0.7968
IoU: 0.4239
Dice Coefficient: 0.5954
Epoch   42/50, time: 95.07 s, training_loss: 0.421
Epoch   42/50, time: 25.71 s, val_loss: 0.429
Epoch   43/50, time: 100.36 s, training_loss: 0.410
Epoch   43/50, time: 25.25 s, val_loss: 0.411
Epoch   44/50, time: 101.16 s, training_loss: 0.407
Epoch   44/50, time: 23.24 s, val_loss: 0.421
Epoch   45/50, time: 95.18 s, training_loss: 0.406
Epoch   45/50, time: 25.43 s, val_loss: 0.413
Epoch   46/50, time: 101.25 s, training_loss: 0.405
Epoch   46/50, time: 21.81 s, val_loss: 0.408
Epoch   47/50, time: 96.66 s, training_loss: 0.395
Epoch   47/50, time: 24.41 s, val_loss: 0.397
Epoch   48/50, time: 92.41 s, training_loss: 0.393
Epoch   48/50, time: 24.54 s, val_loss: 0.383
Epoch   49/50, time: 98.72 s, training_loss: 0.393
Epoch   49/50, time: 25.73 s, val_loss: 0.395
Epoch   50/50, time: 97.19 s, training_loss: 0.391
Epoch   50/50, time: 25.94 s, val_loss: 0.390
Training Metrics:
Accuracy: 0.9965
Precision: 0.8256
Recall: 0.8103
F1 Score: 0.8177
IoU: 0.4676
Dice Coefficient: 0.6372
Validation Metrics:
Accuracy: 0.9966
Precision: 0.8221
Recall: 0.8049
F1 Score: 0.8132
IoU: 0.4579
Dice Coefficient: 0.6282
[I 2025-06-19 05:16:30,948] Trial 14 finished with value: 0.6281856621589568 and parameters: {'batch_size': 16, 'lr': 0.000996698180015414, 'loss_fn': 'dice_loss'}. Best is trial 13 with value: 0.6288735135823516.
Test Metrics:
Accuracy: 0.9966
Precision: 0.8221
Recall: 0.8049
F1 Score: 0.8132
IoU: 0.4579
Dice Coefficient: 0.6282
[Trial 14] Finished with val_loss=inf
[Trial 14] Finished with dice_coeff=0.6281856621589568
Best params: {'batch_size': 16, 'lr': 0.0008385520967028442, 'loss_fn': 'dice_loss'}
Best val loss: 0.6288735135823516
