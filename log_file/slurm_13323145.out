/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Eval train rms=0.05:   0%|          | 0/46 [00:00<?, ?it/s]Eval train rms=0.05:   2%|▏         | 1/46 [00:04<03:05,  4.12s/it]Eval train rms=0.05:   4%|▍         | 2/46 [00:07<02:43,  3.71s/it]Eval train rms=0.05:   7%|▋         | 3/46 [00:11<02:36,  3.64s/it]Eval train rms=0.05:   9%|▊         | 4/46 [00:14<02:31,  3.60s/it]Eval train rms=0.05:  11%|█         | 5/46 [00:17<02:23,  3.49s/it]Eval train rms=0.05:  13%|█▎        | 6/46 [00:20<02:12,  3.31s/it]Eval train rms=0.05:  15%|█▌        | 7/46 [00:24<02:14,  3.44s/it]Eval train rms=0.05:  17%|█▋        | 8/46 [00:28<02:16,  3.59s/it]Eval train rms=0.05:  20%|█▉        | 9/46 [00:32<02:15,  3.67s/it]Eval train rms=0.05:  22%|██▏       | 10/46 [00:35<02:02,  3.40s/it]Eval train rms=0.05:  24%|██▍       | 11/46 [00:37<01:52,  3.22s/it]Eval train rms=0.05:  26%|██▌       | 12/46 [00:40<01:47,  3.15s/it]Eval train rms=0.05:  28%|██▊       | 13/46 [00:43<01:40,  3.05s/it]Eval train rms=0.05:  30%|███       | 14/46 [00:47<01:42,  3.21s/it]Eval train rms=0.05:  33%|███▎      | 15/46 [00:51<01:46,  3.44s/it]Eval train rms=0.05:  35%|███▍      | 16/46 [00:55<01:49,  3.65s/it]Eval train rms=0.05:  37%|███▋      | 17/46 [00:59<01:45,  3.65s/it]Eval train rms=0.05:  39%|███▉      | 18/46 [01:02<01:44,  3.72s/it]Eval train rms=0.05:  41%|████▏     | 19/46 [01:07<01:43,  3.82s/it]Eval train rms=0.05:  43%|████▎     | 20/46 [01:10<01:39,  3.83s/it]Eval train rms=0.05:  46%|████▌     | 21/46 [01:14<01:33,  3.72s/it]Eval train rms=0.05:  48%|████▊     | 22/46 [01:17<01:26,  3.62s/it]Eval train rms=0.05:  50%|█████     | 23/46 [01:21<01:24,  3.68s/it]Eval train rms=0.05:  52%|█████▏    | 24/46 [01:25<01:19,  3.61s/it]Eval train rms=0.05:  54%|█████▍    | 25/46 [01:28<01:13,  3.50s/it]Eval train rms=0.05:  57%|█████▋    | 26/46 [01:31<01:08,  3.43s/it]Eval train rms=0.05:  59%|█████▊    | 27/46 [01:34<01:04,  3.41s/it]Eval train rms=0.05:  61%|██████    | 28/46 [01:38<01:02,  3.46s/it]Eval train rms=0.05:  63%|██████▎   | 29/46 [01:41<00:56,  3.33s/it]Eval train rms=0.05:  65%|██████▌   | 30/46 [01:44<00:52,  3.25s/it]Eval train rms=0.05:  67%|██████▋   | 31/46 [01:47<00:49,  3.28s/it]Eval train rms=0.05:  70%|██████▉   | 32/46 [01:51<00:45,  3.29s/it]Eval train rms=0.05:  72%|███████▏  | 33/46 [01:54<00:42,  3.26s/it]Eval train rms=0.05:  74%|███████▍  | 34/46 [01:57<00:38,  3.20s/it]Eval train rms=0.05:  76%|███████▌  | 35/46 [02:00<00:34,  3.13s/it]Eval train rms=0.05:  78%|███████▊  | 36/46 [02:03<00:31,  3.15s/it]Eval train rms=0.05:  80%|████████  | 37/46 [02:06<00:28,  3.12s/it]Eval train rms=0.05:  83%|████████▎ | 38/46 [02:09<00:24,  3.12s/it]Eval train rms=0.05:  85%|████████▍ | 39/46 [02:12<00:21,  3.10s/it]Eval train rms=0.05:  87%|████████▋ | 40/46 [02:15<00:18,  3.10s/it]Eval train rms=0.05:  89%|████████▉ | 41/46 [02:18<00:15,  3.06s/it]Eval train rms=0.05:  91%|█████████▏| 42/46 [02:21<00:12,  3.01s/it]Eval train rms=0.05:  93%|█████████▎| 43/46 [02:25<00:09,  3.08s/it]Eval train rms=0.05:  96%|█████████▌| 44/46 [02:28<00:06,  3.09s/it]Eval train rms=0.05:  98%|█████████▊| 45/46 [02:31<00:03,  3.00s/it]Eval train rms=0.05: 100%|██████████| 46/46 [02:34<00:00,  3.06s/it]Eval train rms=0.05: 100%|██████████| 46/46 [02:34<00:00,  3.35s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 148 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.05/best_worst/bottom_10_percent'
Saved 148 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.05/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.05/tables/metrics_train_rms0.05.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.05/violin/dice_vs_planarity_train_rms0.05.png
Eval train rms=0.1:   0%|          | 0/53 [00:00<?, ?it/s]Eval train rms=0.1:   2%|▏         | 1/53 [00:03<02:52,  3.31s/it]Eval train rms=0.1:   4%|▍         | 2/53 [00:06<02:42,  3.19s/it]Eval train rms=0.1:   6%|▌         | 3/53 [00:09<02:39,  3.19s/it]Eval train rms=0.1:   8%|▊         | 4/53 [00:12<02:37,  3.22s/it]Eval train rms=0.1:   9%|▉         | 5/53 [00:16<02:34,  3.22s/it]Eval train rms=0.1:  11%|█▏        | 6/53 [00:19<02:30,  3.20s/it]Eval train rms=0.1:  13%|█▎        | 7/53 [00:21<02:19,  3.03s/it]Eval train rms=0.1:  15%|█▌        | 8/53 [00:25<02:19,  3.10s/it]Eval train rms=0.1:  17%|█▋        | 9/53 [00:28<02:22,  3.23s/it]Eval train rms=0.1:  19%|█▉        | 10/53 [00:32<02:20,  3.28s/it]Eval train rms=0.1:  21%|██        | 11/53 [00:35<02:20,  3.34s/it]Eval train rms=0.1:  23%|██▎       | 12/53 [00:38<02:12,  3.23s/it]Eval train rms=0.1:  25%|██▍       | 13/53 [00:41<02:05,  3.14s/it]Eval train rms=0.1:  26%|██▋       | 14/53 [00:44<01:59,  3.06s/it]Eval train rms=0.1:  28%|██▊       | 15/53 [00:47<01:52,  2.97s/it]Eval train rms=0.1:  30%|███       | 16/53 [00:50<01:53,  3.06s/it]Eval train rms=0.1:  32%|███▏      | 17/53 [00:54<01:57,  3.26s/it]Eval train rms=0.1:  34%|███▍      | 18/53 [00:57<02:00,  3.44s/it]Eval train rms=0.1:  36%|███▌      | 19/53 [01:01<01:59,  3.53s/it]Eval train rms=0.1:  38%|███▊      | 20/53 [01:05<01:56,  3.52s/it]Eval train rms=0.1:  40%|███▉      | 21/53 [01:08<01:54,  3.56s/it]Eval train rms=0.1:  42%|████▏     | 22/53 [01:12<01:50,  3.58s/it]Eval train rms=0.1:  43%|████▎     | 23/53 [01:16<01:47,  3.58s/it]Eval train rms=0.1:  45%|████▌     | 24/53 [01:19<01:42,  3.54s/it]Eval train rms=0.1:  47%|████▋     | 25/53 [01:22<01:36,  3.46s/it]Eval train rms=0.1:  49%|████▉     | 26/53 [01:25<01:31,  3.38s/it]Eval train rms=0.1:  51%|█████     | 27/53 [01:29<01:28,  3.39s/it]Eval train rms=0.1:  53%|█████▎    | 28/53 [01:32<01:22,  3.29s/it]Eval train rms=0.1:  55%|█████▍    | 29/53 [01:35<01:18,  3.25s/it]Eval train rms=0.1:  57%|█████▋    | 30/53 [01:38<01:14,  3.26s/it]Eval train rms=0.1:  58%|█████▊    | 31/53 [01:41<01:10,  3.20s/it]Eval train rms=0.1:  60%|██████    | 32/53 [01:45<01:07,  3.24s/it]Eval train rms=0.1:  62%|██████▏   | 33/53 [01:48<01:05,  3.28s/it]Eval train rms=0.1:  64%|██████▍   | 34/53 [01:51<01:01,  3.22s/it]Eval train rms=0.1:  66%|██████▌   | 35/53 [01:54<00:57,  3.20s/it]Eval train rms=0.1:  68%|██████▊   | 36/53 [01:58<00:54,  3.22s/it]Eval train rms=0.1:  70%|██████▉   | 37/53 [02:01<00:51,  3.20s/it]Eval train rms=0.1:  72%|███████▏  | 38/53 [02:04<00:48,  3.23s/it]Eval train rms=0.1:  74%|███████▎  | 39/53 [02:07<00:43,  3.14s/it]Eval train rms=0.1:  75%|███████▌  | 40/53 [02:10<00:39,  3.06s/it]Eval train rms=0.1:  77%|███████▋  | 41/53 [02:13<00:36,  3.05s/it]Eval train rms=0.1:  79%|███████▉  | 42/53 [02:16<00:34,  3.10s/it]Eval train rms=0.1:  81%|████████  | 43/53 [02:19<00:31,  3.13s/it]Eval train rms=0.1:  83%|████████▎ | 44/53 [02:22<00:28,  3.11s/it]Eval train rms=0.1:  85%|████████▍ | 45/53 [02:26<00:24,  3.10s/it]Eval train rms=0.1:  87%|████████▋ | 46/53 [02:29<00:21,  3.09s/it]Eval train rms=0.1:  89%|████████▊ | 47/53 [02:31<00:18,  3.04s/it]Eval train rms=0.1:  91%|█████████ | 48/53 [02:34<00:15,  3.01s/it]Eval train rms=0.1:  92%|█████████▏| 49/53 [02:38<00:12,  3.05s/it]Eval train rms=0.1:  94%|█████████▍| 50/53 [02:41<00:09,  3.08s/it]Eval train rms=0.1:  96%|█████████▌| 51/53 [02:44<00:06,  3.01s/it]Eval train rms=0.1:  98%|█████████▊| 52/53 [02:47<00:03,  3.06s/it]Eval train rms=0.1: 100%|██████████| 53/53 [02:48<00:00,  2.63s/it]Eval train rms=0.1: 100%|██████████| 53/53 [02:48<00:00,  3.19s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 169 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.1/best_worst/bottom_10_percent'
Saved 169 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.1/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.1/tables/metrics_train_rms0.1.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.1/violin/dice_vs_planarity_train_rms0.1.png
Eval train rms=0.5:   0%|          | 0/196 [00:00<?, ?it/s]Eval train rms=0.5:   1%|          | 1/196 [00:04<13:36,  4.19s/it]Eval train rms=0.5:   1%|          | 2/196 [00:08<13:15,  4.10s/it]Eval train rms=0.5:   2%|▏         | 3/196 [00:12<13:07,  4.08s/it]Eval train rms=0.5:   2%|▏         | 4/196 [00:16<12:52,  4.02s/it]Eval train rms=0.5:   3%|▎         | 5/196 [00:19<12:16,  3.86s/it]Eval train rms=0.5:   3%|▎         | 6/196 [00:23<12:03,  3.81s/it]Eval train rms=0.5:   4%|▎         | 7/196 [00:27<12:01,  3.82s/it]Eval train rms=0.5:   4%|▍         | 8/196 [00:31<12:02,  3.84s/it]Eval train rms=0.5:   5%|▍         | 9/196 [00:35<12:14,  3.93s/it]Eval train rms=0.5:   5%|▌         | 10/196 [00:39<12:05,  3.90s/it]Eval train rms=0.5:   6%|▌         | 11/196 [00:43<12:05,  3.92s/it]Eval train rms=0.5:   6%|▌         | 12/196 [00:46<11:56,  3.89s/it]Eval train rms=0.5:   7%|▋         | 13/196 [00:50<11:52,  3.90s/it]Eval train rms=0.5:   7%|▋         | 14/196 [00:54<12:00,  3.96s/it]Eval train rms=0.5:   8%|▊         | 15/196 [00:59<12:02,  3.99s/it]Eval train rms=0.5:   8%|▊         | 16/196 [01:02<11:51,  3.95s/it]Eval train rms=0.5:   9%|▊         | 17/196 [01:06<11:29,  3.85s/it]Eval train rms=0.5:   9%|▉         | 18/196 [01:09<10:49,  3.65s/it]Eval train rms=0.5:  10%|▉         | 19/196 [01:13<10:40,  3.62s/it]Eval train rms=0.5:  10%|█         | 20/196 [01:16<10:29,  3.58s/it]Eval train rms=0.5:  11%|█         | 21/196 [01:20<10:26,  3.58s/it]Eval train rms=0.5:  11%|█         | 22/196 [01:24<10:30,  3.63s/it]Eval train rms=0.5:  12%|█▏        | 23/196 [01:27<10:36,  3.68s/it]Eval train rms=0.5:  12%|█▏        | 24/196 [01:31<10:43,  3.74s/it]Eval train rms=0.5:  13%|█▎        | 25/196 [01:35<10:41,  3.75s/it]Eval train rms=0.5:  13%|█▎        | 26/196 [01:38<10:22,  3.66s/it]Eval train rms=0.5:  14%|█▍        | 27/196 [01:42<10:02,  3.57s/it]Eval train rms=0.5:  14%|█▍        | 28/196 [01:45<09:32,  3.41s/it]Eval train rms=0.5:  15%|█▍        | 29/196 [01:48<09:08,  3.29s/it]Eval train rms=0.5:  15%|█▌        | 30/196 [01:52<09:26,  3.41s/it]Eval train rms=0.5:  16%|█▌        | 31/196 [01:55<09:47,  3.56s/it]Eval train rms=0.5:  16%|█▋        | 32/196 [02:00<10:12,  3.73s/it]Eval train rms=0.5:  17%|█▋        | 33/196 [02:03<10:14,  3.77s/it]Eval train rms=0.5:  17%|█▋        | 34/196 [02:07<09:53,  3.66s/it]Eval train rms=0.5:  18%|█▊        | 35/196 [02:11<10:18,  3.84s/it]Eval train rms=0.5:  18%|█▊        | 36/196 [02:15<10:32,  3.95s/it]Eval train rms=0.5:  19%|█▉        | 37/196 [02:20<10:38,  4.02s/it]Eval train rms=0.5:  19%|█▉        | 38/196 [02:23<10:29,  3.99s/it]Eval train rms=0.5:  20%|█▉        | 39/196 [02:27<10:13,  3.91s/it]Eval train rms=0.5:  20%|██        | 40/196 [02:31<10:23,  4.00s/it]Eval train rms=0.5:  21%|██        | 41/196 [02:36<10:40,  4.14s/it]Eval train rms=0.5:  21%|██▏       | 42/196 [02:40<10:39,  4.15s/it]Eval train rms=0.5:  22%|██▏       | 43/196 [02:44<10:09,  3.98s/it]Eval train rms=0.5:  22%|██▏       | 44/196 [02:47<09:50,  3.88s/it]Eval train rms=0.5:  23%|██▎       | 45/196 [02:51<09:19,  3.71s/it]Eval train rms=0.5:  23%|██▎       | 46/196 [02:54<09:20,  3.74s/it]Eval train rms=0.5:  24%|██▍       | 47/196 [02:58<09:15,  3.73s/it]Eval train rms=0.5:  24%|██▍       | 48/196 [03:02<09:14,  3.75s/it]Eval train rms=0.5:  25%|██▌       | 49/196 [03:05<08:55,  3.64s/it]Eval train rms=0.5:  26%|██▌       | 50/196 [03:09<08:49,  3.62s/it]Eval train rms=0.5:  26%|██▌       | 51/196 [03:13<08:53,  3.68s/it]Eval train rms=0.5:  27%|██▋       | 52/196 [03:17<08:58,  3.74s/it]Eval train rms=0.5:  27%|██▋       | 53/196 [03:20<08:48,  3.70s/it]Eval train rms=0.5:  28%|██▊       | 54/196 [03:24<08:31,  3.60s/it]Eval train rms=0.5:  28%|██▊       | 55/196 [03:27<08:28,  3.61s/it]Eval train rms=0.5:  29%|██▊       | 56/196 [03:30<08:11,  3.51s/it]Eval train rms=0.5:  29%|██▉       | 57/196 [03:34<08:06,  3.50s/it]Eval train rms=0.5:  30%|██▉       | 58/196 [03:38<08:10,  3.56s/it]Eval train rms=0.5:  30%|███       | 59/196 [03:41<08:03,  3.53s/it]Eval train rms=0.5:  31%|███       | 60/196 [03:45<08:08,  3.59s/it]Eval train rms=0.5:  31%|███       | 61/196 [03:49<08:19,  3.70s/it]Eval train rms=0.5:  32%|███▏      | 62/196 [03:53<08:24,  3.76s/it]Eval train rms=0.5:  32%|███▏      | 63/196 [03:57<08:32,  3.86s/it]Eval train rms=0.5:  33%|███▎      | 64/196 [04:01<08:36,  3.91s/it]Eval train rms=0.5:  33%|███▎      | 65/196 [04:05<08:48,  4.03s/it]Eval train rms=0.5:  34%|███▎      | 66/196 [04:10<09:12,  4.25s/it]Eval train rms=0.5:  34%|███▍      | 67/196 [04:15<09:29,  4.42s/it]Eval train rms=0.5:  35%|███▍      | 68/196 [04:19<09:33,  4.48s/it]Eval train rms=0.5:  35%|███▌      | 69/196 [04:24<09:40,  4.57s/it]Eval train rms=0.5:  36%|███▌      | 70/196 [04:29<09:43,  4.63s/it]Eval train rms=0.5:  36%|███▌      | 71/196 [04:33<09:26,  4.53s/it]Eval train rms=0.5:  37%|███▋      | 72/196 [04:37<09:15,  4.48s/it]Eval train rms=0.5:  37%|███▋      | 73/196 [04:42<09:12,  4.49s/it]Eval train rms=0.5:  38%|███▊      | 74/196 [04:46<08:59,  4.42s/it]Eval train rms=0.5:  38%|███▊      | 75/196 [04:50<08:49,  4.37s/it]Eval train rms=0.5:  39%|███▉      | 76/196 [04:55<08:48,  4.41s/it]Eval train rms=0.5:  39%|███▉      | 77/196 [04:59<08:34,  4.32s/it]Eval train rms=0.5:  40%|███▉      | 78/196 [05:03<08:09,  4.14s/it]Eval train rms=0.5:  40%|████      | 79/196 [05:07<08:03,  4.13s/it]Eval train rms=0.5:  41%|████      | 80/196 [05:11<08:09,  4.22s/it]Eval train rms=0.5:  41%|████▏     | 81/196 [05:15<08:00,  4.17s/it]Eval train rms=0.5:  42%|████▏     | 82/196 [05:20<08:03,  4.24s/it]Eval train rms=0.5:  42%|████▏     | 83/196 [05:24<08:02,  4.27s/it]Eval train rms=0.5:  43%|████▎     | 84/196 [05:29<08:03,  4.32s/it]Eval train rms=0.5:  43%|████▎     | 85/196 [05:33<08:07,  4.39s/it]Eval train rms=0.5:  44%|████▍     | 86/196 [05:38<08:02,  4.39s/it]Eval train rms=0.5:  44%|████▍     | 87/196 [05:42<08:01,  4.42s/it]Eval train rms=0.5:  45%|████▍     | 88/196 [05:46<07:47,  4.33s/it]Eval train rms=0.5:  45%|████▌     | 89/196 [05:50<07:34,  4.25s/it]Eval train rms=0.5:  46%|████▌     | 90/196 [05:54<07:26,  4.21s/it]Eval train rms=0.5:  46%|████▋     | 91/196 [05:58<07:20,  4.19s/it]Eval train rms=0.5:  47%|████▋     | 92/196 [06:03<07:21,  4.25s/it]Eval train rms=0.5:  47%|████▋     | 93/196 [06:07<07:20,  4.27s/it]Eval train rms=0.5:  48%|████▊     | 94/196 [06:11<07:15,  4.27s/it]Eval train rms=0.5:  48%|████▊     | 95/196 [06:16<07:25,  4.41s/it]Eval train rms=0.5:  49%|████▉     | 96/196 [06:23<08:19,  4.99s/it]Eval train rms=0.5:  49%|████▉     | 97/196 [06:29<08:55,  5.41s/it]Eval train rms=0.5:  50%|█████     | 98/196 [06:35<09:16,  5.68s/it]Eval train rms=0.5:  51%|█████     | 99/196 [06:41<09:27,  5.85s/it]Eval train rms=0.5:  51%|█████     | 100/196 [06:48<09:26,  5.90s/it]Eval train rms=0.5:  52%|█████▏    | 101/196 [06:53<09:16,  5.85s/it]Eval train rms=0.5:  52%|█████▏    | 102/196 [06:59<08:59,  5.74s/it]Eval train rms=0.5:  53%|█████▎    | 103/196 [07:04<08:52,  5.73s/it]Eval train rms=0.5:  53%|█████▎    | 104/196 [07:10<08:43,  5.69s/it]Eval train rms=0.5:  54%|█████▎    | 105/196 [07:16<08:54,  5.88s/it]Eval train rms=0.5:  54%|█████▍    | 106/196 [07:22<08:49,  5.88s/it]Eval train rms=0.5:  55%|█████▍    | 107/196 [07:28<08:36,  5.80s/it]Eval train rms=0.5:  55%|█████▌    | 108/196 [07:34<08:37,  5.88s/it]Eval train rms=0.5:  56%|█████▌    | 109/196 [07:40<08:28,  5.84s/it]Eval train rms=0.5:  56%|█████▌    | 110/196 [07:45<08:14,  5.75s/it]Eval train rms=0.5:  57%|█████▋    | 111/196 [07:51<08:07,  5.73s/it]Eval train rms=0.5:  57%|█████▋    | 112/196 [07:56<07:57,  5.69s/it]Eval train rms=0.5:  58%|█████▊    | 113/196 [08:02<07:49,  5.66s/it]Eval train rms=0.5:  58%|█████▊    | 114/196 [08:08<07:45,  5.67s/it]Eval train rms=0.5:  59%|█████▊    | 115/196 [08:13<07:34,  5.61s/it]Eval train rms=0.5:  59%|█████▉    | 116/196 [08:19<07:31,  5.65s/it]Eval train rms=0.5:  60%|█████▉    | 117/196 [08:25<07:38,  5.80s/it]Eval train rms=0.5:  60%|██████    | 118/196 [08:33<08:11,  6.30s/it]Eval train rms=0.5:  61%|██████    | 119/196 [08:39<07:56,  6.19s/it]Eval train rms=0.5:  61%|██████    | 120/196 [08:49<09:34,  7.55s/it]Eval train rms=0.5:  62%|██████▏   | 121/196 [08:55<08:49,  7.06s/it]Eval train rms=0.5:  62%|██████▏   | 122/196 [09:01<08:10,  6.62s/it]Eval train rms=0.5:  63%|██████▎   | 123/196 [09:07<07:44,  6.37s/it]Eval train rms=0.5:  63%|██████▎   | 124/196 [09:12<07:24,  6.17s/it]Eval train rms=0.5:  64%|██████▍   | 125/196 [09:18<07:09,  6.05s/it]Eval train rms=0.5:  64%|██████▍   | 126/196 [09:24<06:58,  5.97s/it]Eval train rms=0.5:  65%|██████▍   | 127/196 [09:30<06:48,  5.92s/it]Eval train rms=0.5:  65%|██████▌   | 128/196 [09:36<06:43,  5.93s/it]Eval train rms=0.5:  66%|██████▌   | 129/196 [09:42<06:48,  6.10s/it]Eval train rms=0.5:  66%|██████▋   | 130/196 [09:48<06:38,  6.04s/it]Eval train rms=0.5:  67%|██████▋   | 131/196 [09:54<06:32,  6.04s/it]Eval train rms=0.5:  67%|██████▋   | 132/196 [10:00<06:24,  6.01s/it]Eval train rms=0.5:  68%|██████▊   | 133/196 [10:06<06:16,  5.98s/it]Eval train rms=0.5:  68%|██████▊   | 134/196 [10:11<06:03,  5.86s/it]Eval train rms=0.5:  69%|██████▉   | 135/196 [10:17<05:58,  5.88s/it]Eval train rms=0.5:  69%|██████▉   | 136/196 [10:23<05:41,  5.69s/it]Eval train rms=0.5:  70%|██████▉   | 137/196 [10:29<05:40,  5.76s/it]Eval train rms=0.5:  70%|███████   | 138/196 [10:34<05:35,  5.78s/it]Eval train rms=0.5:  71%|███████   | 139/196 [10:40<05:30,  5.79s/it]Eval train rms=0.5:  71%|███████▏  | 140/196 [10:46<05:18,  5.69s/it]Eval train rms=0.5:  72%|███████▏  | 141/196 [10:51<05:08,  5.60s/it]Eval train rms=0.5:  72%|███████▏  | 142/196 [10:56<04:59,  5.55s/it]Eval train rms=0.5:  73%|███████▎  | 143/196 [11:03<05:03,  5.73s/it]Eval train rms=0.5:  73%|███████▎  | 144/196 [11:09<05:01,  5.81s/it]Eval train rms=0.5:  74%|███████▍  | 145/196 [11:14<04:55,  5.80s/it]Eval train rms=0.5:  74%|███████▍  | 146/196 [11:20<04:46,  5.73s/it]Eval train rms=0.5:  75%|███████▌  | 147/196 [11:26<04:41,  5.75s/it]Eval train rms=0.5:  76%|███████▌  | 148/196 [11:32<04:36,  5.76s/it]Eval train rms=0.5:  76%|███████▌  | 149/196 [11:38<04:37,  5.90s/it]Eval train rms=0.5:  77%|███████▋  | 150/196 [11:43<04:25,  5.77s/it]Eval train rms=0.5:  77%|███████▋  | 151/196 [11:48<04:12,  5.60s/it]Eval train rms=0.5:  78%|███████▊  | 152/196 [11:54<04:02,  5.52s/it]Eval train rms=0.5:  78%|███████▊  | 153/196 [11:59<03:52,  5.40s/it]Eval train rms=0.5:  79%|███████▊  | 154/196 [12:05<03:51,  5.52s/it]Eval train rms=0.5:  79%|███████▉  | 155/196 [12:10<03:44,  5.47s/it]Eval train rms=0.5:  80%|███████▉  | 156/196 [12:15<03:37,  5.43s/it]Eval train rms=0.5:  80%|████████  | 157/196 [12:21<03:32,  5.44s/it]Eval train rms=0.5:  81%|████████  | 158/196 [12:27<03:29,  5.52s/it]Eval train rms=0.5:  81%|████████  | 159/196 [12:32<03:21,  5.45s/it]Eval train rms=0.5:  82%|████████▏ | 160/196 [12:38<03:18,  5.53s/it]Eval train rms=0.5:  82%|████████▏ | 161/196 [12:43<03:14,  5.56s/it]Eval train rms=0.5:  83%|████████▎ | 162/196 [12:49<03:09,  5.59s/it]Eval train rms=0.5:  83%|████████▎ | 163/196 [12:55<03:08,  5.70s/it]Eval train rms=0.5:  84%|████████▎ | 164/196 [13:01<03:03,  5.72s/it]Eval train rms=0.5:  84%|████████▍ | 165/196 [13:07<03:06,  6.02s/it]Eval train rms=0.5:  85%|████████▍ | 166/196 [13:13<02:59,  5.98s/it]Eval train rms=0.5:  85%|████████▌ | 167/196 [13:19<02:51,  5.90s/it]Eval train rms=0.5:  86%|████████▌ | 168/196 [13:25<02:44,  5.89s/it]Eval train rms=0.5:  86%|████████▌ | 169/196 [13:30<02:37,  5.83s/it]Eval train rms=0.5:  87%|████████▋ | 170/196 [13:36<02:31,  5.83s/it]Eval train rms=0.5:  87%|████████▋ | 171/196 [13:42<02:24,  5.80s/it]Eval train rms=0.5:  88%|████████▊ | 172/196 [13:48<02:19,  5.80s/it]Eval train rms=0.5:  88%|████████▊ | 173/196 [13:53<02:12,  5.74s/it]Eval train rms=0.5:  89%|████████▉ | 174/196 [13:59<02:05,  5.72s/it]Eval train rms=0.5:  89%|████████▉ | 175/196 [14:05<02:01,  5.77s/it]Eval train rms=0.5:  90%|████████▉ | 176/196 [14:16<02:28,  7.44s/it]Eval train rms=0.5:  90%|█████████ | 177/196 [14:22<02:09,  6.84s/it]Eval train rms=0.5:  91%|█████████ | 178/196 [14:27<01:56,  6.50s/it]Eval train rms=0.5:  91%|█████████▏| 179/196 [14:34<01:48,  6.39s/it]Eval train rms=0.5:  92%|█████████▏| 180/196 [14:39<01:38,  6.16s/it]Eval train rms=0.5:  92%|█████████▏| 181/196 [14:45<01:31,  6.12s/it]Eval train rms=0.5:  93%|█████████▎| 182/196 [14:51<01:24,  6.05s/it]Eval train rms=0.5:  93%|█████████▎| 183/196 [14:57<01:18,  6.07s/it]Eval train rms=0.5:  94%|█████████▍| 184/196 [15:03<01:11,  5.95s/it]Eval train rms=0.5:  94%|█████████▍| 185/196 [15:09<01:04,  5.86s/it]Eval train rms=0.5:  95%|█████████▍| 186/196 [15:14<00:58,  5.84s/it]Eval train rms=0.5:  95%|█████████▌| 187/196 [15:22<00:57,  6.44s/it]Eval train rms=0.5:  96%|█████████▌| 188/196 [15:28<00:50,  6.27s/it]Eval train rms=0.5:  96%|█████████▋| 189/196 [15:34<00:43,  6.26s/it]Eval train rms=0.5:  97%|█████████▋| 190/196 [15:40<00:36,  6.03s/it]Eval train rms=0.5:  97%|█████████▋| 191/196 [15:45<00:29,  5.90s/it]Eval train rms=0.5:  98%|█████████▊| 192/196 [15:51<00:23,  5.90s/it]Eval train rms=0.5:  98%|█████████▊| 193/196 [15:57<00:17,  5.74s/it]Eval train rms=0.5:  99%|█████████▉| 194/196 [16:02<00:11,  5.69s/it]Eval train rms=0.5:  99%|█████████▉| 195/196 [16:08<00:05,  5.71s/it]Eval train rms=0.5: 100%|██████████| 196/196 [16:11<00:00,  4.76s/it]Eval train rms=0.5: 100%|██████████| 196/196 [16:11<00:00,  4.95s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 626 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.5/best_worst/bottom_10_percent'
Saved 626 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.5/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.5/tables/metrics_train_rms0.5.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_0.5/violin/dice_vs_planarity_train_rms0.5.png
Eval train rms=1.0:   0%|          | 0/210 [00:00<?, ?it/s]Eval train rms=1.0:   0%|          | 1/210 [00:06<22:00,  6.32s/it]Eval train rms=1.0:   1%|          | 2/210 [00:12<22:00,  6.35s/it]Eval train rms=1.0:   1%|▏         | 3/210 [00:18<21:10,  6.14s/it]Eval train rms=1.0:   2%|▏         | 4/210 [00:24<21:06,  6.15s/it]Eval train rms=1.0:   2%|▏         | 5/210 [00:31<22:12,  6.50s/it]Eval train rms=1.0:   3%|▎         | 6/210 [00:38<21:59,  6.47s/it]Eval train rms=1.0:   3%|▎         | 7/210 [00:43<21:00,  6.21s/it]Eval train rms=1.0:   4%|▍         | 8/210 [00:50<21:05,  6.26s/it]Eval train rms=1.0:   4%|▍         | 9/210 [00:56<20:56,  6.25s/it]Eval train rms=1.0:   5%|▍         | 10/210 [01:03<21:38,  6.49s/it]Eval train rms=1.0:   5%|▌         | 11/210 [01:09<21:12,  6.40s/it]Eval train rms=1.0:   6%|▌         | 12/210 [01:16<20:57,  6.35s/it]Eval train rms=1.0:   6%|▌         | 13/210 [01:22<20:46,  6.33s/it]Eval train rms=1.0:   7%|▋         | 14/210 [01:28<20:39,  6.32s/it]Eval train rms=1.0:   7%|▋         | 15/210 [01:34<20:36,  6.34s/it]Eval train rms=1.0:   8%|▊         | 16/210 [01:42<21:20,  6.60s/it]Eval train rms=1.0:   8%|▊         | 17/210 [01:48<20:45,  6.45s/it]Eval train rms=1.0:   9%|▊         | 18/210 [01:55<21:02,  6.58s/it]Eval train rms=1.0:   9%|▉         | 19/210 [02:01<21:08,  6.64s/it]Eval train rms=1.0:  10%|▉         | 20/210 [02:07<20:02,  6.33s/it]Eval train rms=1.0:  10%|█         | 21/210 [02:13<19:33,  6.21s/it]Eval train rms=1.0:  10%|█         | 22/210 [02:19<19:30,  6.23s/it]Eval train rms=1.0:  11%|█         | 23/210 [02:25<19:25,  6.23s/it]Eval train rms=1.0:  11%|█▏        | 24/210 [02:41<28:22,  9.15s/it]Eval train rms=1.0:  12%|█▏        | 25/210 [02:47<25:12,  8.17s/it]Eval train rms=1.0:  12%|█▏        | 26/210 [02:54<23:15,  7.58s/it]Eval train rms=1.0:  13%|█▎        | 27/210 [03:00<21:55,  7.19s/it]Eval train rms=1.0:  13%|█▎        | 28/210 [03:06<21:07,  6.97s/it]Eval train rms=1.0:  14%|█▍        | 29/210 [03:12<20:02,  6.64s/it]Eval train rms=1.0:  14%|█▍        | 30/210 [03:18<18:56,  6.31s/it]Eval train rms=1.0:  15%|█▍        | 31/210 [03:22<17:15,  5.79s/it]Eval train rms=1.0:  15%|█▌        | 32/210 [03:29<17:40,  5.96s/it]Eval train rms=1.0:  16%|█▌        | 33/210 [03:35<18:17,  6.20s/it]Eval train rms=1.0:  16%|█▌        | 34/210 [03:43<19:10,  6.54s/it]Eval train rms=1.0:  17%|█▋        | 35/210 [03:49<18:47,  6.44s/it]Eval train rms=1.0:  17%|█▋        | 36/210 [03:55<18:11,  6.27s/it]Eval train rms=1.0:  18%|█▊        | 37/210 [04:02<18:34,  6.44s/it]Eval train rms=1.0:  18%|█▊        | 38/210 [04:08<18:24,  6.42s/it]Eval train rms=1.0:  19%|█▊        | 39/210 [04:15<18:53,  6.63s/it]Eval train rms=1.0:  19%|█▉        | 40/210 [04:22<18:52,  6.66s/it]Eval train rms=1.0:  20%|█▉        | 41/210 [04:29<19:14,  6.83s/it]Eval train rms=1.0:  20%|██        | 42/210 [04:37<19:59,  7.14s/it]Eval train rms=1.0:  20%|██        | 43/210 [04:43<19:12,  6.90s/it]Eval train rms=1.0:  21%|██        | 44/210 [04:50<19:11,  6.94s/it]Eval train rms=1.0:  21%|██▏       | 45/210 [04:57<18:35,  6.76s/it]Eval train rms=1.0:  22%|██▏       | 46/210 [05:02<17:26,  6.38s/it]Eval train rms=1.0:  22%|██▏       | 47/210 [05:08<16:44,  6.16s/it]Eval train rms=1.0:  23%|██▎       | 48/210 [05:13<15:59,  5.92s/it]Eval train rms=1.0:  23%|██▎       | 49/210 [05:19<15:39,  5.84s/it]Eval train rms=1.0:  24%|██▍       | 50/210 [05:25<15:54,  5.97s/it]Eval train rms=1.0:  24%|██▍       | 51/210 [05:30<15:20,  5.79s/it]Eval train rms=1.0:  25%|██▍       | 52/210 [05:36<15:10,  5.76s/it]Eval train rms=1.0:  25%|██▌       | 53/210 [05:41<14:21,  5.49s/it]Eval train rms=1.0:  26%|██▌       | 54/210 [05:47<14:28,  5.57s/it]Eval train rms=1.0:  26%|██▌       | 55/210 [05:52<14:29,  5.61s/it]Eval train rms=1.0:  27%|██▋       | 56/210 [05:58<14:24,  5.61s/it]Eval train rms=1.0:  27%|██▋       | 57/210 [06:03<13:53,  5.45s/it]Eval train rms=1.0:  28%|██▊       | 58/210 [06:09<14:01,  5.54s/it]Eval train rms=1.0:  28%|██▊       | 59/210 [06:14<13:55,  5.53s/it]Eval train rms=1.0:  29%|██▊       | 60/210 [06:20<13:54,  5.56s/it]Eval train rms=1.0:  29%|██▉       | 61/210 [06:26<14:23,  5.79s/it]Eval train rms=1.0:  30%|██▉       | 62/210 [06:32<14:31,  5.89s/it]Eval train rms=1.0:  30%|███       | 63/210 [06:38<14:27,  5.90s/it]Eval train rms=1.0:  30%|███       | 64/210 [06:44<14:05,  5.79s/it]Eval train rms=1.0:  31%|███       | 65/210 [06:49<13:44,  5.68s/it]Eval train rms=1.0:  31%|███▏      | 66/210 [06:55<13:56,  5.81s/it]Eval train rms=1.0:  32%|███▏      | 67/210 [07:01<13:56,  5.85s/it]Eval train rms=1.0:  32%|███▏      | 68/210 [07:07<13:36,  5.75s/it]Eval train rms=1.0:  33%|███▎      | 69/210 [07:14<14:11,  6.04s/it]Eval train rms=1.0:  33%|███▎      | 70/210 [07:21<14:38,  6.28s/it]Eval train rms=1.0:  34%|███▍      | 71/210 [07:28<15:05,  6.51s/it]Eval train rms=1.0:  34%|███▍      | 72/210 [07:36<15:57,  6.94s/it]Eval train rms=1.0:  35%|███▍      | 73/210 [07:43<16:17,  7.13s/it]Eval train rms=1.0:  35%|███▌      | 74/210 [08:01<23:36, 10.41s/it]Eval train rms=1.0:  36%|███▌      | 75/210 [08:09<21:38,  9.62s/it]Eval train rms=1.0:  36%|███▌      | 76/210 [08:16<19:57,  8.94s/it]Eval train rms=1.0:  37%|███▋      | 77/210 [08:24<18:51,  8.50s/it]Eval train rms=1.0:  37%|███▋      | 78/210 [08:32<18:50,  8.56s/it]Eval train rms=1.0:  38%|███▊      | 79/210 [08:41<18:39,  8.54s/it]Eval train rms=1.0:  38%|███▊      | 80/210 [08:48<17:47,  8.21s/it]Eval train rms=1.0:  39%|███▊      | 81/210 [08:56<17:05,  7.95s/it]Eval train rms=1.0:  39%|███▉      | 82/210 [09:03<16:34,  7.77s/it]Eval train rms=1.0:  40%|███▉      | 83/210 [09:11<16:15,  7.68s/it]Eval train rms=1.0:  40%|████      | 84/210 [09:17<15:21,  7.31s/it]Eval train rms=1.0:  40%|████      | 85/210 [09:23<14:34,  6.99s/it]Eval train rms=1.0:  41%|████      | 86/210 [09:31<15:02,  7.28s/it]Eval train rms=1.0:  41%|████▏     | 87/210 [09:38<14:22,  7.02s/it]Eval train rms=1.0:  42%|████▏     | 88/210 [09:45<14:19,  7.04s/it]Eval train rms=1.0:  42%|████▏     | 89/210 [09:51<13:55,  6.90s/it]Eval train rms=1.0:  43%|████▎     | 90/210 [09:59<14:09,  7.08s/it]Eval train rms=1.0:  43%|████▎     | 91/210 [10:06<14:19,  7.22s/it]Eval train rms=1.0:  44%|████▍     | 92/210 [10:14<14:12,  7.22s/it]Eval train rms=1.0:  44%|████▍     | 93/210 [10:21<14:08,  7.26s/it]Eval train rms=1.0:  45%|████▍     | 94/210 [10:28<13:59,  7.24s/it]Eval train rms=1.0:  45%|████▌     | 95/210 [10:35<13:37,  7.10s/it]Eval train rms=1.0:  46%|████▌     | 96/210 [10:42<13:23,  7.05s/it]Eval train rms=1.0:  46%|████▌     | 97/210 [10:49<13:26,  7.13s/it]Eval train rms=1.0:  47%|████▋     | 98/210 [10:57<13:29,  7.23s/it]Eval train rms=1.0:  47%|████▋     | 99/210 [11:05<13:47,  7.46s/it]Eval train rms=1.0:  48%|████▊     | 100/210 [11:11<13:17,  7.25s/it]Eval train rms=1.0:  48%|████▊     | 101/210 [11:17<12:23,  6.83s/it]Eval train rms=1.0:  49%|████▊     | 102/210 [11:24<12:08,  6.75s/it]Eval train rms=1.0:  49%|████▉     | 103/210 [11:30<11:57,  6.70s/it]Eval train rms=1.0:  50%|████▉     | 104/210 [11:36<11:32,  6.53s/it]Eval train rms=1.0:  50%|█████     | 105/210 [11:43<11:15,  6.43s/it]Eval train rms=1.0:  50%|█████     | 106/210 [11:48<10:49,  6.25s/it]Eval train rms=1.0:  51%|█████     | 107/210 [11:55<11:03,  6.44s/it]Eval train rms=1.0:  51%|█████▏    | 108/210 [12:01<10:44,  6.32s/it]Eval train rms=1.0:  52%|█████▏    | 109/210 [12:07<10:24,  6.18s/it]Eval train rms=1.0:  52%|█████▏    | 110/210 [12:14<10:27,  6.28s/it]Eval train rms=1.0:  53%|█████▎    | 111/210 [12:20<10:11,  6.18s/it]Eval train rms=1.0:  53%|█████▎    | 112/210 [12:26<09:54,  6.06s/it]Eval train rms=1.0:  54%|█████▍    | 113/210 [12:31<09:40,  5.99s/it]Eval train rms=1.0:  54%|█████▍    | 114/210 [12:37<09:31,  5.95s/it]Eval train rms=1.0:  55%|█████▍    | 115/210 [12:43<09:14,  5.84s/it]Eval train rms=1.0:  55%|█████▌    | 116/210 [12:49<09:12,  5.88s/it]Eval train rms=1.0:  56%|█████▌    | 117/210 [12:54<08:51,  5.72s/it]Eval train rms=1.0:  56%|█████▌    | 118/210 [13:00<08:41,  5.67s/it]Eval train rms=1.0:  57%|█████▋    | 119/210 [13:05<08:31,  5.62s/it]Eval train rms=1.0:  57%|█████▋    | 120/210 [13:11<08:32,  5.69s/it]Eval train rms=1.0:  58%|█████▊    | 121/210 [13:17<08:25,  5.68s/it]Eval train rms=1.0:  58%|█████▊    | 122/210 [13:22<08:18,  5.66s/it]Eval train rms=1.0:  59%|█████▊    | 123/210 [13:30<08:58,  6.19s/it]Eval train rms=1.0:  59%|█████▉    | 124/210 [13:36<08:48,  6.14s/it]Eval train rms=1.0:  60%|█████▉    | 125/210 [13:42<08:35,  6.07s/it]Eval train rms=1.0:  60%|██████    | 126/210 [13:48<08:47,  6.28s/it]Eval train rms=1.0:  60%|██████    | 127/210 [13:54<08:34,  6.20s/it]Eval train rms=1.0:  61%|██████    | 128/210 [14:01<08:39,  6.34s/it]Eval train rms=1.0:  61%|██████▏   | 129/210 [14:07<08:35,  6.36s/it]Eval train rms=1.0:  62%|██████▏   | 130/210 [14:13<08:09,  6.12s/it]Eval train rms=1.0:  62%|██████▏   | 131/210 [14:20<08:20,  6.34s/it]Eval train rms=1.0:  63%|██████▎   | 132/210 [14:26<08:04,  6.21s/it]Eval train rms=1.0:  63%|██████▎   | 133/210 [14:32<07:50,  6.11s/it]Eval train rms=1.0:  64%|██████▍   | 134/210 [14:39<08:00,  6.32s/it]Eval train rms=1.0:  64%|██████▍   | 135/210 [14:44<07:39,  6.13s/it]Eval train rms=1.0:  65%|██████▍   | 136/210 [14:51<07:41,  6.24s/it]Eval train rms=1.0:  65%|██████▌   | 137/210 [14:57<07:27,  6.13s/it]Eval train rms=1.0:  66%|██████▌   | 138/210 [15:02<07:16,  6.06s/it]Eval train rms=1.0:  66%|██████▌   | 139/210 [15:08<07:06,  6.00s/it]Eval train rms=1.0:  67%|██████▋   | 140/210 [15:14<06:54,  5.92s/it]Eval train rms=1.0:  67%|██████▋   | 141/210 [15:20<06:44,  5.86s/it]Eval train rms=1.0:  68%|██████▊   | 142/210 [15:26<06:40,  5.89s/it]Eval train rms=1.0:  68%|██████▊   | 143/210 [15:32<06:50,  6.12s/it]Eval train rms=1.0:  69%|██████▊   | 144/210 [15:38<06:33,  5.96s/it]Eval train rms=1.0:  69%|██████▉   | 145/210 [15:44<06:27,  5.96s/it]Eval train rms=1.0:  70%|██████▉   | 146/210 [15:50<06:20,  5.95s/it]Eval train rms=1.0:  70%|███████   | 147/210 [15:55<06:08,  5.84s/it]Eval train rms=1.0:  70%|███████   | 148/210 [16:02<06:11,  5.99s/it]Eval train rms=1.0:  71%|███████   | 149/210 [16:08<06:10,  6.08s/it]Eval train rms=1.0:  71%|███████▏  | 150/210 [16:14<05:54,  5.91s/it]Eval train rms=1.0:  72%|███████▏  | 151/210 [16:19<05:37,  5.72s/it]Eval train rms=1.0:  72%|███████▏  | 152/210 [16:24<05:28,  5.67s/it]Eval train rms=1.0:  73%|███████▎  | 153/210 [16:30<05:21,  5.63s/it]Eval train rms=1.0:  73%|███████▎  | 154/210 [16:36<05:20,  5.73s/it]Eval train rms=1.0:  74%|███████▍  | 155/210 [16:42<05:16,  5.75s/it]Eval train rms=1.0:  74%|███████▍  | 156/210 [16:48<05:19,  5.92s/it]Eval train rms=1.0:  75%|███████▍  | 157/210 [16:54<05:09,  5.83s/it]Eval train rms=1.0:  75%|███████▌  | 158/210 [17:00<05:06,  5.89s/it]Eval train rms=1.0:  76%|███████▌  | 159/210 [17:06<05:11,  6.11s/it]Eval train rms=1.0:  76%|███████▌  | 160/210 [17:13<05:15,  6.31s/it]Eval train rms=1.0:  77%|███████▋  | 161/210 [17:19<05:09,  6.32s/it]Eval train rms=1.0:  77%|███████▋  | 162/210 [17:25<04:51,  6.07s/it]Eval train rms=1.0:  78%|███████▊  | 163/210 [17:30<04:33,  5.81s/it]Eval train rms=1.0:  78%|███████▊  | 164/210 [17:36<04:27,  5.82s/it]Eval train rms=1.0:  79%|███████▊  | 165/210 [17:42<04:21,  5.80s/it]Eval train rms=1.0:  79%|███████▉  | 166/210 [17:48<04:19,  5.90s/it]Eval train rms=1.0:  80%|███████▉  | 167/210 [17:54<04:10,  5.83s/it]Eval train rms=1.0:  80%|████████  | 168/210 [17:59<04:02,  5.77s/it]Eval train rms=1.0:  80%|████████  | 169/210 [18:05<03:59,  5.84s/it]Eval train rms=1.0:  81%|████████  | 170/210 [18:11<03:54,  5.86s/it]Eval train rms=1.0:  81%|████████▏ | 171/210 [18:17<03:47,  5.83s/it]Eval train rms=1.0:  82%|████████▏ | 172/210 [18:23<03:41,  5.84s/it]Eval train rms=1.0:  82%|████████▏ | 173/210 [18:28<03:31,  5.73s/it]Eval train rms=1.0:  83%|████████▎ | 174/210 [18:34<03:25,  5.71s/it]Eval train rms=1.0:  83%|████████▎ | 175/210 [18:40<03:22,  5.79s/it]Eval train rms=1.0:  84%|████████▍ | 176/210 [18:52<04:16,  7.55s/it]Eval train rms=1.0:  84%|████████▍ | 177/210 [18:57<03:49,  6.96s/it]Eval train rms=1.0:  85%|████████▍ | 178/210 [19:03<03:27,  6.50s/it]Eval train rms=1.0:  85%|████████▌ | 179/210 [19:08<03:12,  6.22s/it]Eval train rms=1.0:  86%|████████▌ | 180/210 [19:13<02:57,  5.93s/it]Eval train rms=1.0:  86%|████████▌ | 181/210 [19:19<02:48,  5.82s/it]Eval train rms=1.0:  87%|████████▋ | 182/210 [19:24<02:40,  5.72s/it]Eval train rms=1.0:  87%|████████▋ | 183/210 [19:30<02:29,  5.55s/it]Eval train rms=1.0:  88%|████████▊ | 184/210 [19:36<02:32,  5.86s/it]Eval train rms=1.0:  88%|████████▊ | 185/210 [19:41<02:22,  5.68s/it]Eval train rms=1.0:  89%|████████▊ | 186/210 [19:47<02:14,  5.60s/it]Eval train rms=1.0:  89%|████████▉ | 187/210 [19:52<02:08,  5.60s/it]Eval train rms=1.0:  90%|████████▉ | 188/210 [19:58<02:04,  5.67s/it]Eval train rms=1.0:  90%|█████████ | 189/210 [20:04<01:57,  5.58s/it]Eval train rms=1.0:  90%|█████████ | 190/210 [20:09<01:50,  5.50s/it]Eval train rms=1.0:  91%|█████████ | 191/210 [20:14<01:43,  5.42s/it]Eval train rms=1.0:  91%|█████████▏| 192/210 [20:20<01:40,  5.59s/it]Eval train rms=1.0:  92%|█████████▏| 193/210 [20:26<01:35,  5.64s/it]Eval train rms=1.0:  92%|█████████▏| 194/210 [20:32<01:30,  5.67s/it]Eval train rms=1.0:  93%|█████████▎| 195/210 [20:38<01:26,  5.74s/it]Eval train rms=1.0:  93%|█████████▎| 196/210 [20:43<01:21,  5.80s/it]Eval train rms=1.0:  94%|█████████▍| 197/210 [20:49<01:14,  5.74s/it]Eval train rms=1.0:  94%|█████████▍| 198/210 [20:55<01:08,  5.71s/it]Eval train rms=1.0:  95%|█████████▍| 199/210 [21:01<01:04,  5.85s/it]Eval train rms=1.0:  95%|█████████▌| 200/210 [21:06<00:57,  5.73s/it]Eval train rms=1.0:  96%|█████████▌| 201/210 [21:12<00:50,  5.65s/it]Eval train rms=1.0:  96%|█████████▌| 202/210 [21:18<00:45,  5.74s/it]Eval train rms=1.0:  97%|█████████▋| 203/210 [21:24<00:40,  5.78s/it]Eval train rms=1.0:  97%|█████████▋| 204/210 [21:29<00:33,  5.67s/it]Eval train rms=1.0:  98%|█████████▊| 205/210 [21:34<00:27,  5.52s/it]Eval train rms=1.0:  98%|█████████▊| 206/210 [21:40<00:22,  5.62s/it]Eval train rms=1.0:  99%|█████████▊| 207/210 [21:46<00:16,  5.60s/it]Eval train rms=1.0:  99%|█████████▉| 208/210 [21:51<00:11,  5.54s/it]Eval train rms=1.0: 100%|█████████▉| 209/210 [21:57<00:05,  5.57s/it]Eval train rms=1.0: 100%|██████████| 210/210 [21:58<00:00,  4.37s/it]Eval train rms=1.0: 100%|██████████| 210/210 [21:58<00:00,  6.28s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 670 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_1.0/best_worst/bottom_10_percent'
Saved 670 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_1.0/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_1.0/tables/metrics_train_rms1.0.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/train/rms_1.0/violin/dice_vs_planarity_train_rms1.0.png
Eval val rms=0.05:   0%|          | 0/6 [00:00<?, ?it/s]Eval val rms=0.05:  17%|█▋        | 1/6 [00:08<00:42,  8.57s/it]Eval val rms=0.05:  33%|███▎      | 2/6 [00:16<00:31,  7.99s/it]Eval val rms=0.05:  50%|█████     | 3/6 [00:22<00:22,  7.42s/it]Eval val rms=0.05:  67%|██████▋   | 4/6 [00:28<00:13,  6.87s/it]Eval val rms=0.05:  83%|████████▎ | 5/6 [00:34<00:06,  6.42s/it]Eval val rms=0.05: 100%|██████████| 6/6 [00:38<00:00,  5.59s/it]Eval val rms=0.05: 100%|██████████| 6/6 [00:38<00:00,  6.42s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 19 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.05/best_worst/bottom_10_percent'
Saved 19 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.05/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.05/tables/metrics_val_rms0.05.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.05/violin/dice_vs_planarity_val_rms0.05.png
Eval val rms=0.1:   0%|          | 0/7 [00:00<?, ?it/s]Eval val rms=0.1:  14%|█▍        | 1/7 [00:05<00:34,  5.77s/it]Eval val rms=0.1:  29%|██▊       | 2/7 [00:13<00:35,  7.12s/it]Eval val rms=0.1:  43%|████▎     | 3/7 [00:20<00:27,  6.95s/it]Eval val rms=0.1:  57%|█████▋    | 4/7 [00:26<00:19,  6.63s/it]Eval val rms=0.1:  71%|███████▏  | 5/7 [00:32<00:12,  6.20s/it]Eval val rms=0.1:  86%|████████▌ | 6/7 [00:37<00:05,  5.86s/it]Eval val rms=0.1: 100%|██████████| 7/7 [00:40<00:00,  4.85s/it]Eval val rms=0.1: 100%|██████████| 7/7 [00:40<00:00,  5.73s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 21 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.1/best_worst/bottom_10_percent'
Saved 21 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.1/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.1/tables/metrics_val_rms0.1.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.1/violin/dice_vs_planarity_val_rms0.1.png
Eval val rms=0.5:   0%|          | 0/25 [00:00<?, ?it/s]Eval val rms=0.5:   4%|▍         | 1/25 [00:06<02:24,  6.01s/it]Eval val rms=0.5:   8%|▊         | 2/25 [00:15<03:11,  8.31s/it]Eval val rms=0.5:  12%|█▏        | 3/25 [00:22<02:46,  7.57s/it]Eval val rms=0.5:  16%|█▌        | 4/25 [00:28<02:20,  6.71s/it]Eval val rms=0.5:  20%|██        | 5/25 [00:34<02:09,  6.49s/it]Eval val rms=0.5:  24%|██▍       | 6/25 [00:39<01:59,  6.28s/it]Eval val rms=0.5:  28%|██▊       | 7/25 [00:45<01:48,  6.05s/it]Eval val rms=0.5:  32%|███▏      | 8/25 [00:51<01:41,  5.97s/it]Eval val rms=0.5:  36%|███▌      | 9/25 [00:58<01:42,  6.41s/it]Eval val rms=0.5:  40%|████      | 10/25 [01:05<01:37,  6.49s/it]Eval val rms=0.5:  44%|████▍     | 11/25 [01:12<01:34,  6.76s/it]Eval val rms=0.5:  48%|████▊     | 12/25 [01:19<01:28,  6.80s/it]Eval val rms=0.5:  52%|█████▏    | 13/25 [01:25<01:18,  6.54s/it]Eval val rms=0.5:  56%|█████▌    | 14/25 [01:31<01:09,  6.32s/it]Eval val rms=0.5:  60%|██████    | 15/25 [01:37<01:02,  6.25s/it]Eval val rms=0.5:  64%|██████▍   | 16/25 [01:44<00:57,  6.42s/it]Eval val rms=0.5:  68%|██████▊   | 17/25 [01:51<00:52,  6.53s/it]Eval val rms=0.5:  72%|███████▏  | 18/25 [01:56<00:44,  6.31s/it]Eval val rms=0.5:  76%|███████▌  | 19/25 [02:02<00:36,  6.13s/it]Eval val rms=0.5:  80%|████████  | 20/25 [02:08<00:29,  5.95s/it]Eval val rms=0.5:  84%|████████▍ | 21/25 [02:13<00:23,  5.89s/it]Eval val rms=0.5:  88%|████████▊ | 22/25 [02:19<00:17,  5.77s/it]Eval val rms=0.5:  92%|█████████▏| 23/25 [02:24<00:11,  5.58s/it]Eval val rms=0.5:  96%|█████████▌| 24/25 [02:29<00:05,  5.43s/it]Eval val rms=0.5: 100%|██████████| 25/25 [02:31<00:00,  4.47s/it]Eval val rms=0.5: 100%|██████████| 25/25 [02:31<00:00,  6.07s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 79 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.5/best_worst/bottom_10_percent'
Saved 79 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.5/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.5/tables/metrics_val_rms0.5.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_0.5/violin/dice_vs_planarity_val_rms0.5.png
Eval val rms=1.0:   0%|          | 0/27 [00:00<?, ?it/s]Eval val rms=1.0:   4%|▎         | 1/27 [00:06<02:45,  6.38s/it]Eval val rms=1.0:   7%|▋         | 2/27 [00:16<03:27,  8.30s/it]Eval val rms=1.0:  11%|█         | 3/27 [00:22<03:01,  7.56s/it]Eval val rms=1.0:  15%|█▍        | 4/27 [00:28<02:39,  6.95s/it]Eval val rms=1.0:  19%|█▊        | 5/27 [00:35<02:35,  7.07s/it]Eval val rms=1.0:  22%|██▏       | 6/27 [00:41<02:19,  6.66s/it]Eval val rms=1.0:  26%|██▌       | 7/27 [00:47<02:06,  6.30s/it]Eval val rms=1.0:  30%|██▉       | 8/27 [00:53<01:55,  6.10s/it]Eval val rms=1.0:  33%|███▎      | 9/27 [01:00<01:56,  6.47s/it]Eval val rms=1.0:  37%|███▋      | 10/27 [01:07<01:54,  6.76s/it]Eval val rms=1.0:  41%|████      | 11/27 [01:15<01:54,  7.14s/it]Eval val rms=1.0:  44%|████▍     | 12/27 [01:23<01:48,  7.22s/it]Eval val rms=1.0:  48%|████▊     | 13/27 [01:30<01:40,  7.17s/it]Eval val rms=1.0:  52%|█████▏    | 14/27 [01:35<01:27,  6.73s/it]Eval val rms=1.0:  56%|█████▌    | 15/27 [01:42<01:18,  6.53s/it]Eval val rms=1.0:  59%|█████▉    | 16/27 [01:48<01:12,  6.57s/it]Eval val rms=1.0:  63%|██████▎   | 17/27 [01:54<01:04,  6.47s/it]Eval val rms=1.0:  67%|██████▋   | 18/27 [02:00<00:56,  6.33s/it]Eval val rms=1.0:  70%|███████   | 19/27 [02:06<00:48,  6.07s/it]Eval val rms=1.0:  74%|███████▍  | 20/27 [02:12<00:42,  6.01s/it]Eval val rms=1.0:  78%|███████▊  | 21/27 [02:17<00:34,  5.82s/it]Eval val rms=1.0:  81%|████████▏ | 22/27 [02:23<00:28,  5.77s/it]Eval val rms=1.0:  85%|████████▌ | 23/27 [02:29<00:23,  5.79s/it]Eval val rms=1.0:  89%|████████▉ | 24/27 [02:35<00:17,  5.97s/it]Eval val rms=1.0:  93%|█████████▎| 25/27 [02:41<00:11,  5.89s/it]Eval val rms=1.0:  96%|█████████▋| 26/27 [02:46<00:05,  5.77s/it]Eval val rms=1.0: 100%|██████████| 27/27 [02:47<00:00,  4.33s/it]Eval val rms=1.0: 100%|██████████| 27/27 [02:47<00:00,  6.21s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 84 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_1.0/best_worst/bottom_10_percent'
Saved 84 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_1.0/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_1.0/tables/metrics_val_rms1.0.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/val/rms_1.0/violin/dice_vs_planarity_val_rms1.0.png
Eval test rms=0.05:   0%|          | 0/6 [00:00<?, ?it/s]Eval test rms=0.05:  17%|█▋        | 1/6 [00:05<00:29,  5.85s/it]Eval test rms=0.05:  33%|███▎      | 2/6 [00:14<00:30,  7.52s/it]Eval test rms=0.05:  50%|█████     | 3/6 [00:20<00:20,  6.74s/it]Eval test rms=0.05:  67%|██████▋   | 4/6 [00:25<00:12,  6.28s/it]Eval test rms=0.05:  83%|████████▎ | 5/6 [00:31<00:05,  5.85s/it]Eval test rms=0.05: 100%|██████████| 6/6 [00:34<00:00,  5.12s/it]Eval test rms=0.05: 100%|██████████| 6/6 [00:34<00:00,  5.79s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 19 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.05/best_worst/bottom_10_percent'
Saved 19 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.05/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.05/tables/metrics_test_rms0.05.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.05/violin/dice_vs_planarity_test_rms0.05.png
Eval test rms=0.1:   0%|          | 0/7 [00:00<?, ?it/s]Eval test rms=0.1:  14%|█▍        | 1/7 [00:05<00:34,  5.78s/it]Eval test rms=0.1:  29%|██▊       | 2/7 [00:14<00:36,  7.32s/it]Eval test rms=0.1:  43%|████▎     | 3/7 [00:19<00:26,  6.64s/it]Eval test rms=0.1:  57%|█████▋    | 4/7 [00:25<00:19,  6.36s/it]Eval test rms=0.1:  71%|███████▏  | 5/7 [00:30<00:11,  5.89s/it]Eval test rms=0.1:  86%|████████▌ | 6/7 [00:36<00:05,  5.60s/it]Eval test rms=0.1: 100%|██████████| 7/7 [00:39<00:00,  4.80s/it]Eval test rms=0.1: 100%|██████████| 7/7 [00:39<00:00,  5.60s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 22 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.1/best_worst/bottom_10_percent'
Saved 22 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.1/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.1/tables/metrics_test_rms0.1.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.1/violin/dice_vs_planarity_test_rms0.1.png
Eval test rms=0.5:   0%|          | 0/25 [00:00<?, ?it/s]Eval test rms=0.5:   4%|▍         | 1/25 [00:06<02:32,  6.35s/it]Eval test rms=0.5:   8%|▊         | 2/25 [00:16<03:24,  8.88s/it]Eval test rms=0.5:  12%|█▏        | 3/25 [00:23<02:52,  7.85s/it]Eval test rms=0.5:  16%|█▌        | 4/25 [00:29<02:30,  7.16s/it]Eval test rms=0.5:  20%|██        | 5/25 [00:37<02:25,  7.27s/it]Eval test rms=0.5:  24%|██▍       | 6/25 [00:43<02:10,  6.86s/it]Eval test rms=0.5:  28%|██▊       | 7/25 [00:49<01:59,  6.67s/it]Eval test rms=0.5:  32%|███▏      | 8/25 [00:55<01:50,  6.50s/it]Eval test rms=0.5:  36%|███▌      | 9/25 [01:03<01:50,  6.91s/it]Eval test rms=0.5:  40%|████      | 10/25 [01:11<01:48,  7.22s/it]Eval test rms=0.5:  44%|████▍     | 11/25 [01:18<01:42,  7.33s/it]Eval test rms=0.5:  48%|████▊     | 12/25 [01:25<01:31,  7.07s/it]Eval test rms=0.5:  52%|█████▏    | 13/25 [01:31<01:20,  6.75s/it]Eval test rms=0.5:  56%|█████▌    | 14/25 [01:37<01:10,  6.40s/it]Eval test rms=0.5:  60%|██████    | 15/25 [01:42<01:02,  6.22s/it]Eval test rms=0.5:  64%|██████▍   | 16/25 [01:49<00:55,  6.22s/it]Eval test rms=0.5:  68%|██████▊   | 17/25 [01:55<00:49,  6.18s/it]Eval test rms=0.5:  72%|███████▏  | 18/25 [02:01<00:42,  6.10s/it]Eval test rms=0.5:  76%|███████▌  | 19/25 [02:07<00:36,  6.13s/it]Eval test rms=0.5:  80%|████████  | 20/25 [02:13<00:30,  6.19s/it]Eval test rms=0.5:  84%|████████▍ | 21/25 [02:19<00:24,  6.03s/it]Eval test rms=0.5:  88%|████████▊ | 22/25 [02:24<00:17,  5.89s/it]Eval test rms=0.5:  92%|█████████▏| 23/25 [02:29<00:11,  5.68s/it]Eval test rms=0.5:  96%|█████████▌| 24/25 [02:35<00:05,  5.59s/it]Eval test rms=0.5: 100%|██████████| 25/25 [02:37<00:00,  4.66s/it]Eval test rms=0.5: 100%|██████████| 25/25 [02:37<00:00,  6.31s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:70: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model = torch.load(str(model_path), map_location=device)
Saved 79 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.5/best_worst/bottom_10_percent'
Saved 79 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.5/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.5/tables/metrics_test_rms0.5.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_0.5/violin/dice_vs_planarity_test_rms0.5.png
Eval test rms=1.0:   0%|          | 0/27 [00:00<?, ?it/s]Eval test rms=1.0:   4%|▎         | 1/27 [00:05<02:32,  5.88s/it]Eval test rms=1.0:   7%|▋         | 2/27 [00:15<03:18,  7.94s/it]Eval test rms=1.0:  11%|█         | 3/27 [00:22<02:59,  7.48s/it]Eval test rms=1.0:  15%|█▍        | 4/27 [00:28<02:43,  7.09s/it]Eval test rms=1.0:  19%|█▊        | 5/27 [00:34<02:28,  6.75s/it]Eval test rms=1.0:  22%|██▏       | 6/27 [00:42<02:25,  6.95s/it]Eval test rms=1.0:  26%|██▌       | 7/27 [00:47<02:10,  6.53s/it]Eval test rms=1.0:  30%|██▉       | 8/27 [00:53<01:59,  6.29s/it]Eval test rms=1.0:  33%|███▎      | 9/27 [01:00<01:55,  6.42s/it]Eval test rms=1.0:  37%|███▋      | 10/27 [01:08<01:56,  6.83s/it]Eval test rms=1.0:  41%|████      | 11/27 [01:15<01:51,  6.94s/it]Eval test rms=1.0:  44%|████▍     | 12/27 [01:23<01:49,  7.32s/it]Eval test rms=1.0:  48%|████▊     | 13/27 [01:31<01:45,  7.53s/it]Eval test rms=1.0:  52%|█████▏    | 14/27 [01:38<01:34,  7.24s/it]Eval test rms=1.0:  56%|█████▌    | 15/27 [01:44<01:22,  6.91s/it]Eval test rms=1.0:  59%|█████▉    | 16/27 [01:49<01:11,  6.52s/it]Eval test rms=1.0:  63%|██████▎   | 17/27 [01:55<01:03,  6.33s/it]Eval test rms=1.0:  67%|██████▋   | 18/27 [02:02<00:57,  6.37s/it]Eval test rms=1.0:  70%|███████   | 19/27 [02:07<00:49,  6.16s/it]Eval test rms=1.0:  74%|███████▍  | 20/27 [02:13<00:42,  6.01s/it]Eval test rms=1.0:  78%|███████▊  | 21/27 [02:19<00:35,  5.88s/it]Eval test rms=1.0:  81%|████████▏ | 22/27 [02:28<00:34,  6.82s/it]Eval test rms=1.0:  85%|████████▌ | 23/27 [02:33<00:25,  6.39s/it]Eval test rms=1.0:  89%|████████▉ | 24/27 [02:38<00:18,  6.09s/it]Eval test rms=1.0:  93%|█████████▎| 25/27 [02:44<00:12,  6.00s/it]Eval test rms=1.0:  96%|█████████▋| 26/27 [02:49<00:05,  5.77s/it]Eval test rms=1.0: 100%|██████████| 27/27 [02:51<00:00,  4.38s/it]Eval test rms=1.0: 100%|██████████| 27/27 [02:51<00:00,  6.33s/it]
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:335: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_clean, x='planarity_bin', y='dice', color='black', markers='o', linestyles='-', ci=None)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:384: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_s, x='rms_str', y='dice', order=order, color='black', markers='o', linestyles='-', ci=None, ax=ax)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:384: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_s, x='rms_str', y='dice', order=order, color='black', markers='o', linestyles='-', ci=None, ax=ax)
/home/sethih1/masque_new/ters_gen/compare_accuracy.py:384: FutureWarning: 

The `ci` parameter is deprecated. Use `errorbar=None` for the same effect.

  sns.pointplot(data=df_s, x='rms_str', y='dice', order=order, color='black', markers='o', linestyles='-', ci=None, ax=ax)
Saved 84 bottom_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_1.0/best_worst/bottom_10_percent'
Saved 84 top_10_percent samples in '/scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_1.0/best_worst/top_10_percent'
Saved metrics table to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_1.0/tables/metrics_test_rms1.0.csv
Saved violin: /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/test/rms_1.0/violin/dice_vs_planarity_test_rms1.0.png
Saved aggregated scores to /scratch/phys/sin/sethih1/Extended_TERS_data/run_planar_again/planar_comparison_viz/all_scores.csv
Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/compare_accuracy.py", line 455, in <module>
    results, all_df = run_all_experiments()
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/compare_accuracy.py", line 445, in run_all_experiments
    save_comparison_plots(all_df, out_root)
  File "/home/sethih1/masque_new/ters_gen/compare_accuracy.py", line 393, in save_comparison_plots
    order_comb = df.groupby(['suffix','rms_numeric'])['rms_numeric'].first().reset_index().sort_values(['suffix','rms_numeric'])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/pandas/core/series.py", line 1770, in reset_index
    return df.reset_index(
           ^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/pandas/core/frame.py", line 6472, in reset_index
    new_obj.insert(
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/pandas/core/frame.py", line 5158, in insert
    raise ValueError(f"cannot insert {column}, already exists")
ValueError: cannot insert rms_numeric, already exists
