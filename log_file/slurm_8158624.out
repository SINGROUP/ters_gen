[I 2025-06-14 20:35:41,222] A new study created in memory with name: no-name-1e94495e-00a1-4f60-86a2-691e59688a45
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
[Trial 0] Trying batch_size=16, lr=0.00014898179226687525, loss_fn=dice_loss
Epoch    1/50, time: 53.69 s, training_loss: 0.981
Epoch    1/50, time: 14.06 s, val_loss: 0.987
Training Metrics:
Accuracy: 0.0226
Precision: 0.2527
Recall: 0.3169
F1 Score: 0.0172
IoU: 0.0133
Dice Coefficient: 0.0119
Validation Metrics:
Accuracy: 0.0220
Precision: 0.2532
Recall: 0.3248
F1 Score: 0.0176
IoU: 0.0128
Dice Coefficient: 0.0108
Epoch    2/50, time: 40.16 s, training_loss: 0.973
Epoch    2/50, time: 10.67 s, val_loss: 0.987
Epoch    3/50, time: 39.87 s, training_loss: 0.963
Epoch    3/50, time: 11.63 s, val_loss: 0.988
Epoch    4/50, time: 39.76 s, training_loss: 0.953
Epoch    4/50, time: 12.09 s, val_loss: 0.914
Epoch    5/50, time: 41.45 s, training_loss: 0.939
Epoch    5/50, time: 11.98 s, val_loss: 0.989
Epoch    6/50, time: 40.34 s, training_loss: 0.927
Epoch    6/50, time: 10.36 s, val_loss: 0.902
Epoch    7/50, time: 40.44 s, training_loss: 0.912
Epoch    7/50, time: 12.23 s, val_loss: 0.912
Epoch    8/50, time: 41.25 s, training_loss: 0.895
Epoch    8/50, time: 11.95 s, val_loss: 0.864
Epoch    9/50, time: 40.95 s, training_loss: 0.881
Epoch    9/50, time: 9.86 s, val_loss: 0.814
Epoch   10/50, time: 40.54 s, training_loss: 0.865
Epoch   10/50, time: 11.90 s, val_loss: 0.808
Epoch   11/50, time: 39.44 s, training_loss: 0.849
Epoch   11/50, time: 11.50 s, val_loss: 0.728
Training Metrics:
Accuracy: 0.0324
Precision: 0.2528
Recall: 0.3545
F1 Score: 0.0273
IoU: 0.0130
Dice Coefficient: 0.0116
Validation Metrics:
Accuracy: 0.0440
Precision: 0.2515
Recall: 0.3998
F1 Score: 0.0308
IoU: 0.0123
Dice Coefficient: 0.0130
Epoch   12/50, time: 40.77 s, training_loss: 0.830
Epoch   12/50, time: 11.94 s, val_loss: 0.773
Epoch   13/50, time: 42.41 s, training_loss: 0.812
Epoch   13/50, time: 10.21 s, val_loss: 0.817
Epoch   14/50, time: 42.09 s, training_loss: 0.789
Epoch   14/50, time: 10.37 s, val_loss: 0.757
Epoch   15/50, time: 40.52 s, training_loss: 0.771
Epoch   15/50, time: 10.06 s, val_loss: 0.725
Epoch   16/50, time: 40.69 s, training_loss: 0.745
Epoch   16/50, time: 10.43 s, val_loss: 0.790
Epoch   17/50, time: 40.44 s, training_loss: 0.719
Epoch   17/50, time: 10.66 s, val_loss: 0.736
Epoch   18/50, time: 40.39 s, training_loss: 0.707
Epoch   18/50, time: 12.05 s, val_loss: 0.681
Epoch   19/50, time: 42.43 s, training_loss: 0.678
Epoch   19/50, time: 9.88 s, val_loss: 0.676
Epoch   20/50, time: 41.42 s, training_loss: 0.651
Epoch   20/50, time: 11.83 s, val_loss: 0.659
Epoch   21/50, time: 40.39 s, training_loss: 0.643
Epoch   21/50, time: 11.97 s, val_loss: 0.608
Training Metrics:
Accuracy: 0.0313
Precision: 0.2514
Recall: 0.3954
F1 Score: 0.0210
IoU: 0.0131
Dice Coefficient: 0.0147
Validation Metrics:
Accuracy: 0.0302
Precision: 0.2512
Recall: 0.4023
F1 Score: 0.0204
IoU: 0.0126
Dice Coefficient: 0.0143
Epoch   22/50, time: 42.77 s, training_loss: 0.617
Epoch   22/50, time: 12.07 s, val_loss: 0.643
Epoch   23/50, time: 41.08 s, training_loss: 0.603
Epoch   23/50, time: 12.28 s, val_loss: 0.575
Epoch   24/50, time: 40.37 s, training_loss: 0.577
Epoch   24/50, time: 11.78 s, val_loss: 0.564
Epoch   25/50, time: 40.67 s, training_loss: 0.563
Epoch   25/50, time: 10.28 s, val_loss: 0.538
Epoch   26/50, time: 40.77 s, training_loss: 0.560
Epoch   26/50, time: 10.48 s, val_loss: 0.559
Epoch   27/50, time: 42.44 s, training_loss: 0.547
Epoch   27/50, time: 12.04 s, val_loss: 0.538
Epoch   28/50, time: 39.99 s, training_loss: 0.533
Epoch   28/50, time: 11.86 s, val_loss: 0.520
Epoch   29/50, time: 40.31 s, training_loss: 0.537
Epoch   29/50, time: 11.66 s, val_loss: 0.508
Epoch   30/50, time: 41.75 s, training_loss: 0.527
Epoch   30/50, time: 12.14 s, val_loss: 0.491
Epoch   31/50, time: 40.47 s, training_loss: 0.509
Epoch   31/50, time: 10.25 s, val_loss: 0.530
Training Metrics:
Accuracy: 0.0556
Precision: 0.2553
Recall: 0.3812
F1 Score: 0.0368
IoU: 0.0134
Dice Coefficient: 0.0136
Validation Metrics:
Accuracy: 0.0599
Precision: 0.2560
Recall: 0.3841
F1 Score: 0.0392
IoU: 0.0130
Dice Coefficient: 0.0128
Epoch   32/50, time: 42.11 s, training_loss: 0.542
Epoch   32/50, time: 10.30 s, val_loss: 0.545
Epoch   33/50, time: 40.86 s, training_loss: 0.516
Epoch   33/50, time: 12.45 s, val_loss: 0.468
Epoch   34/50, time: 41.13 s, training_loss: 0.497
Epoch   34/50, time: 10.64 s, val_loss: 0.445
Epoch   35/50, time: 41.25 s, training_loss: 0.492
Epoch   35/50, time: 11.86 s, val_loss: 0.476
Epoch   36/50, time: 40.89 s, training_loss: 0.498
Epoch   36/50, time: 12.28 s, val_loss: 0.510
Epoch   37/50, time: 42.88 s, training_loss: 0.518
Epoch   37/50, time: 11.04 s, val_loss: 0.463
Epoch   38/50, time: 42.44 s, training_loss: 0.485
Epoch   38/50, time: 10.76 s, val_loss: 0.463
Epoch   39/50, time: 42.30 s, training_loss: 0.474
Epoch   39/50, time: 10.74 s, val_loss: 0.450
Epoch   40/50, time: 40.92 s, training_loss: 0.459
Epoch   40/50, time: 12.23 s, val_loss: 0.438
Epoch   41/50, time: 42.25 s, training_loss: 0.457
Epoch   41/50, time: 12.00 s, val_loss: 0.461
Training Metrics:
Accuracy: 0.0306
Precision: 0.2539
Recall: 0.3578
F1 Score: 0.0219
IoU: 0.0133
Dice Coefficient: 0.0144
Validation Metrics:
Accuracy: 0.0307
Precision: 0.2539
Recall: 0.3568
F1 Score: 0.0221
IoU: 0.0128
Dice Coefficient: 0.0136
Epoch   42/50, time: 41.97 s, training_loss: 0.459
Epoch   42/50, time: 10.79 s, val_loss: 0.466
Epoch   43/50, time: 42.19 s, training_loss: 0.471
Epoch   43/50, time: 12.51 s, val_loss: 0.466
Epoch   44/50, time: 42.56 s, training_loss: 0.461
Epoch   44/50, time: 10.88 s, val_loss: 0.436
Epoch   45/50, time: 40.75 s, training_loss: 0.457
Epoch   45/50, time: 10.83 s, val_loss: 0.447
Epoch   46/50, time: 40.84 s, training_loss: 0.461
Epoch   46/50, time: 10.39 s, val_loss: 0.437
Epoch   47/50, time: 44.03 s, training_loss: 0.453
Epoch   47/50, time: 11.10 s, val_loss: 0.449
Epoch   48/50, time: 41.40 s, training_loss: 0.454
Epoch   48/50, time: 10.85 s, val_loss: 0.461
Epoch   49/50, time: 41.02 s, training_loss: 0.444
Epoch   49/50, time: 12.57 s, val_loss: 0.411
Epoch   50/50, time: 41.94 s, training_loss: 0.454
Epoch   50/50, time: 10.93 s, val_loss: 0.468
Training Metrics:
Accuracy: 0.0392
Precision: 0.2530
Recall: 0.2873
F1 Score: 0.0267
IoU: 0.0132
Dice Coefficient: 0.0135
Validation Metrics:
Accuracy: 0.0411
Precision: 0.2545
Recall: 0.2900
F1 Score: 0.0286
IoU: 0.0128
Dice Coefficient: 0.0126
[I 2025-06-14 21:26:45,079] Trial 0 finished with value: 0.012592875685107049 and parameters: {'batch_size': 16, 'lr': 0.00014898179226687525, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.012592875685107049.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.0411
Precision: 0.2545
Recall: 0.2900
F1 Score: 0.0286
IoU: 0.0128
Dice Coefficient: 0.0126
[Trial 0] Finished with val_loss=inf
[Trial 0] Finished with dice_coeff=0.012592875685107049
[Trial 1] Trying batch_size=128, lr=0.00032921481882958116, loss_fn=dice_loss
Epoch    1/50, time: 61.74 s, training_loss: 0.982
Epoch    1/50, time: 12.49 s, val_loss: 0.989
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.0087
Precision: 0.2026
Recall: 0.2500
F1 Score: 0.0043
IoU: 0.0132
Dice Coefficient: 0.0258
Validation Metrics:
Accuracy: 0.0083
Precision: 0.2521
Recall: 0.2500
F1 Score: 0.0041
IoU: 0.0127
Dice Coefficient: 0.0248
Epoch    2/50, time: 51.37 s, training_loss: 0.976
Epoch    2/50, time: 11.12 s, val_loss: 0.985
Epoch    3/50, time: 53.34 s, training_loss: 0.972
Epoch    3/50, time: 11.08 s, val_loss: 0.973
Epoch    4/50, time: 63.48 s, training_loss: 0.968
Epoch    4/50, time: 12.32 s, val_loss: 0.945
Epoch    5/50, time: 62.88 s, training_loss: 0.964
Epoch    5/50, time: 11.27 s, val_loss: 0.948
Epoch    6/50, time: 53.21 s, training_loss: 0.962
Epoch    6/50, time: 10.90 s, val_loss: 0.944
Epoch    7/50, time: 53.16 s, training_loss: 0.958
Epoch    7/50, time: 10.41 s, val_loss: 0.957
Epoch    8/50, time: 61.62 s, training_loss: 0.953
Epoch    8/50, time: 12.49 s, val_loss: 0.946
Epoch    9/50, time: 62.25 s, training_loss: 0.950
Epoch    9/50, time: 12.39 s, val_loss: 0.963
Epoch   10/50, time: 53.32 s, training_loss: 0.947
Epoch   10/50, time: 10.92 s, val_loss: 0.940
Epoch   11/50, time: 53.24 s, training_loss: 0.942
Epoch   11/50, time: 10.86 s, val_loss: 0.962
Training Metrics:
Accuracy: 0.0656
Precision: 0.2773
Recall: 0.3057
F1 Score: 0.0392
IoU: 0.0133
Dice Coefficient: 0.0159
Validation Metrics:
Accuracy: 0.0668
Precision: 0.2697
Recall: 0.2984
F1 Score: 0.0440
IoU: 0.0127
Dice Coefficient: 0.0158
Epoch   12/50, time: 66.92 s, training_loss: 0.933
Epoch   12/50, time: 10.81 s, val_loss: 0.874
Epoch   13/50, time: 63.68 s, training_loss: 0.928
Epoch   13/50, time: 12.90 s, val_loss: 0.892
Epoch   14/50, time: 53.97 s, training_loss: 0.918
Epoch   14/50, time: 12.18 s, val_loss: 0.897
Epoch   15/50, time: 60.45 s, training_loss: 0.917
Epoch   15/50, time: 11.13 s, val_loss: 0.916
Epoch   16/50, time: 65.12 s, training_loss: 0.910
Epoch   16/50, time: 11.13 s, val_loss: 0.868
Epoch   17/50, time: 54.45 s, training_loss: 0.901
Epoch   17/50, time: 10.66 s, val_loss: 0.880
Epoch   18/50, time: 61.52 s, training_loss: 0.897
Epoch   18/50, time: 10.86 s, val_loss: 0.911
Epoch   19/50, time: 57.38 s, training_loss: 0.893
Epoch   19/50, time: 12.69 s, val_loss: 0.944
Epoch   20/50, time: 52.59 s, training_loss: 0.883
Epoch   20/50, time: 12.48 s, val_loss: 0.855
Epoch   21/50, time: 64.12 s, training_loss: 0.879
Epoch   21/50, time: 10.59 s, val_loss: 0.859
Training Metrics:
Accuracy: 0.0460
Precision: 0.2506
Recall: 0.3288
F1 Score: 0.0270
IoU: 0.0131
Dice Coefficient: 0.0132
Validation Metrics:
Accuracy: 0.0505
Precision: 0.2507
Recall: 0.3340
F1 Score: 0.0295
IoU: 0.0125
Dice Coefficient: 0.0122
Epoch   22/50, time: 63.90 s, training_loss: 0.873
Epoch   22/50, time: 11.08 s, val_loss: 0.865
Epoch   23/50, time: 60.11 s, training_loss: 0.874
Epoch   23/50, time: 12.53 s, val_loss: 0.905
Epoch   24/50, time: 50.65 s, training_loss: 0.866
Epoch   24/50, time: 12.69 s, val_loss: 0.807
Epoch   25/50, time: 55.37 s, training_loss: 0.857
Epoch   25/50, time: 12.58 s, val_loss: 0.798
Epoch   26/50, time: 53.33 s, training_loss: 0.855
Epoch   26/50, time: 10.56 s, val_loss: 0.833
Epoch   27/50, time: 55.84 s, training_loss: 0.845
Epoch   27/50, time: 12.40 s, val_loss: 0.859
Epoch   28/50, time: 54.76 s, training_loss: 0.837
Epoch   28/50, time: 10.58 s, val_loss: 0.820
Epoch   29/50, time: 64.77 s, training_loss: 0.827
Epoch   29/50, time: 12.08 s, val_loss: 0.795
Epoch   30/50, time: 52.28 s, training_loss: 0.825
Epoch   30/50, time: 12.75 s, val_loss: 0.808
Epoch   31/50, time: 63.55 s, training_loss: 0.837
Epoch   31/50, time: 10.73 s, val_loss: 0.846
Training Metrics:
Accuracy: 0.0347
Precision: 0.2541
Recall: 0.3731
F1 Score: 0.0222
IoU: 0.0134
Dice Coefficient: 0.0129
Validation Metrics:
Accuracy: 0.0428
Precision: 0.2545
Recall: 0.3817
F1 Score: 0.0275
IoU: 0.0130
Dice Coefficient: 0.0114
Epoch   32/50, time: 62.29 s, training_loss: 0.818
Epoch   32/50, time: 11.02 s, val_loss: 0.767
Epoch   33/50, time: 53.71 s, training_loss: 0.799
Epoch   33/50, time: 10.81 s, val_loss: 0.821
Epoch   34/50, time: 52.49 s, training_loss: 0.788
Epoch   34/50, time: 12.65 s, val_loss: 0.840
Epoch   35/50, time: 63.67 s, training_loss: 0.784
Epoch   35/50, time: 12.85 s, val_loss: 0.787
Epoch   36/50, time: 60.81 s, training_loss: 0.778
Epoch   36/50, time: 13.01 s, val_loss: 0.809
Epoch   37/50, time: 62.26 s, training_loss: 0.760
Epoch   37/50, time: 12.78 s, val_loss: 0.759
Epoch   38/50, time: 53.68 s, training_loss: 0.754
Epoch   38/50, time: 12.31 s, val_loss: 0.766
Epoch   39/50, time: 61.83 s, training_loss: 0.747
Epoch   39/50, time: 10.97 s, val_loss: 0.750
Epoch   40/50, time: 55.45 s, training_loss: 0.743
Epoch   40/50, time: 12.35 s, val_loss: 0.797
Epoch   41/50, time: 52.60 s, training_loss: 0.778
Epoch   41/50, time: 10.93 s, val_loss: 0.738
Training Metrics:
Accuracy: 0.0542
Precision: 0.2453
Recall: 0.3142
F1 Score: 0.0316
IoU: 0.0119
Dice Coefficient: 0.0107
Validation Metrics:
Accuracy: 0.0632
Precision: 0.2508
Recall: 0.3497
F1 Score: 0.0417
IoU: 0.0117
Dice Coefficient: 0.0090
Epoch   42/50, time: 61.83 s, training_loss: 0.760
Epoch   42/50, time: 10.43 s, val_loss: 0.657
Epoch   43/50, time: 51.50 s, training_loss: 0.735
Epoch   43/50, time: 11.12 s, val_loss: 0.698
Epoch   44/50, time: 52.98 s, training_loss: 0.706
Epoch   44/50, time: 12.34 s, val_loss: 0.763
Epoch   45/50, time: 63.32 s, training_loss: 0.709
Epoch   45/50, time: 10.76 s, val_loss: 0.748
Epoch   46/50, time: 54.15 s, training_loss: 0.690
Epoch   46/50, time: 12.17 s, val_loss: 0.650
Epoch   47/50, time: 61.32 s, training_loss: 0.683
Epoch   47/50, time: 12.57 s, val_loss: 0.738
Epoch   48/50, time: 62.45 s, training_loss: 0.665
Epoch   48/50, time: 10.69 s, val_loss: 0.645
Epoch   49/50, time: 52.09 s, training_loss: 0.671
Epoch   49/50, time: 12.33 s, val_loss: 0.656
Epoch   50/50, time: 63.62 s, training_loss: 0.654
Epoch   50/50, time: 12.58 s, val_loss: 0.679
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.0365
Precision: 0.2527
Recall: 0.4059
F1 Score: 0.0269
IoU: 0.0130
Dice Coefficient: 0.0111
Validation Metrics:
Accuracy: 0.0407
Precision: 0.2537
Recall: 0.4182
F1 Score: 0.0302
IoU: 0.0126
Dice Coefficient: 0.0103
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[I 2025-06-14 22:33:52,083] Trial 1 finished with value: 0.010297631075781953 and parameters: {'batch_size': 128, 'lr': 0.00032921481882958116, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.012592875685107049.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.0407
Precision: 0.2537
Recall: 0.4182
F1 Score: 0.0302
IoU: 0.0126
Dice Coefficient: 0.0103
[Trial 1] Finished with val_loss=inf
[Trial 1] Finished with dice_coeff=0.010297631075781953
[Trial 2] Trying batch_size=64, lr=0.000736807765353683, loss_fn=dice_loss
Epoch    1/50, time: 44.67 s, training_loss: 0.981
Epoch    1/50, time: 12.16 s, val_loss: 0.986
Training Metrics:
Accuracy: 0.0023
Precision: 0.2507
Recall: 0.2541
F1 Score: 0.0025
IoU: 0.0132
Dice Coefficient: 0.0118
Validation Metrics:
Accuracy: 0.0024
Precision: 0.2513
Recall: 0.2624
F1 Score: 0.0029
IoU: 0.0127
Dice Coefficient: 0.0107
Epoch    2/50, time: 48.96 s, training_loss: 0.975
Epoch    2/50, time: 12.46 s, val_loss: 0.965
Epoch    3/50, time: 50.78 s, training_loss: 0.968
Epoch    3/50, time: 10.70 s, val_loss: 0.933
Epoch    4/50, time: 43.78 s, training_loss: 0.956
Epoch    4/50, time: 10.51 s, val_loss: 0.904
Epoch    5/50, time: 43.23 s, training_loss: 0.942
Epoch    5/50, time: 10.94 s, val_loss: 0.889
Epoch    6/50, time: 50.97 s, training_loss: 0.921
Epoch    6/50, time: 10.97 s, val_loss: 0.908
Epoch    7/50, time: 44.27 s, training_loss: 0.902
Epoch    7/50, time: 12.53 s, val_loss: 0.819
Epoch    8/50, time: 42.45 s, training_loss: 0.887
Epoch    8/50, time: 10.94 s, val_loss: 0.773
Epoch    9/50, time: 51.02 s, training_loss: 0.876
Epoch    9/50, time: 10.36 s, val_loss: 0.768
Epoch   10/50, time: 51.02 s, training_loss: 0.869
Epoch   10/50, time: 10.62 s, val_loss: 0.775
Epoch   11/50, time: 52.83 s, training_loss: 0.864
Epoch   11/50, time: 12.36 s, val_loss: 0.776
Training Metrics:
Accuracy: 0.0223
Precision: 0.2773
Recall: 0.4135
F1 Score: 0.0580
IoU: 0.0132
Dice Coefficient: 0.0091
Validation Metrics:
Accuracy: 0.0251
Precision: 0.2809
Recall: 0.4452
F1 Score: 0.0672
IoU: 0.0127
Dice Coefficient: 0.0087
Epoch   12/50, time: 51.70 s, training_loss: 0.842
Epoch   12/50, time: 12.71 s, val_loss: 0.751
Epoch   13/50, time: 52.15 s, training_loss: 0.826
Epoch   13/50, time: 12.35 s, val_loss: 0.712
Epoch   14/50, time: 48.81 s, training_loss: 0.807
Epoch   14/50, time: 10.83 s, val_loss: 0.715
Epoch   15/50, time: 48.84 s, training_loss: 0.799
Epoch   15/50, time: 10.76 s, val_loss: 0.689
Epoch   16/50, time: 51.24 s, training_loss: 0.784
Epoch   16/50, time: 12.50 s, val_loss: 0.724
Epoch   17/50, time: 43.31 s, training_loss: 0.773
Epoch   17/50, time: 10.78 s, val_loss: 0.698
Epoch   18/50, time: 52.28 s, training_loss: 0.753
Epoch   18/50, time: 12.90 s, val_loss: 0.684
Epoch   19/50, time: 50.08 s, training_loss: 0.749
Epoch   19/50, time: 12.64 s, val_loss: 0.674
Epoch   20/50, time: 52.10 s, training_loss: 0.734
Epoch   20/50, time: 12.19 s, val_loss: 0.674
Epoch   21/50, time: 50.71 s, training_loss: 0.724
Epoch   21/50, time: 10.72 s, val_loss: 0.689
Training Metrics:
Accuracy: 0.0288
Precision: 0.2756
Recall: 0.3859
F1 Score: 0.0597
IoU: 0.0131
Dice Coefficient: 0.0090
Validation Metrics:
Accuracy: 0.0290
Precision: 0.2997
Recall: 0.4000
F1 Score: 0.0917
IoU: 0.0126
Dice Coefficient: 0.0085
Epoch   22/50, time: 50.86 s, training_loss: 0.707
Epoch   22/50, time: 12.54 s, val_loss: 0.636
Epoch   23/50, time: 51.44 s, training_loss: 0.694
Epoch   23/50, time: 12.30 s, val_loss: 0.624
Epoch   24/50, time: 50.94 s, training_loss: 0.688
Epoch   24/50, time: 10.70 s, val_loss: 0.929
Epoch   25/50, time: 51.76 s, training_loss: 0.694
Epoch   25/50, time: 12.23 s, val_loss: 0.629
Epoch   26/50, time: 43.99 s, training_loss: 0.666
Epoch   26/50, time: 10.83 s, val_loss: 0.618
Epoch   27/50, time: 44.57 s, training_loss: 0.641
Epoch   27/50, time: 12.34 s, val_loss: 0.582
Epoch   28/50, time: 51.83 s, training_loss: 0.636
Epoch   28/50, time: 10.79 s, val_loss: 0.611
Epoch   29/50, time: 45.37 s, training_loss: 0.632
Epoch   29/50, time: 12.67 s, val_loss: 0.591
Epoch   30/50, time: 50.42 s, training_loss: 0.612
Epoch   30/50, time: 12.31 s, val_loss: 0.547
Epoch   31/50, time: 44.20 s, training_loss: 0.595
Epoch   31/50, time: 10.43 s, val_loss: 0.620
Training Metrics:
Accuracy: 0.0315
Precision: 0.2861
Recall: 0.4046
F1 Score: 0.0849
IoU: 0.0125
Dice Coefficient: 0.0085
Validation Metrics:
Accuracy: 0.0301
Precision: 0.2989
Recall: 0.4126
F1 Score: 0.1007
IoU: 0.0120
Dice Coefficient: 0.0081
Epoch   32/50, time: 48.98 s, training_loss: 0.579
Epoch   32/50, time: 12.27 s, val_loss: 0.560
Epoch   33/50, time: 43.76 s, training_loss: 0.580
Epoch   33/50, time: 12.24 s, val_loss: 0.530
Epoch   34/50, time: 52.10 s, training_loss: 0.570
Epoch   34/50, time: 12.20 s, val_loss: 0.613
Epoch   35/50, time: 42.56 s, training_loss: 0.549
Epoch   35/50, time: 10.55 s, val_loss: 0.533
Epoch   36/50, time: 50.75 s, training_loss: 0.540
Epoch   36/50, time: 10.69 s, val_loss: 0.519
Epoch   37/50, time: 50.53 s, training_loss: 0.526
Epoch   37/50, time: 10.73 s, val_loss: 0.539
Epoch   38/50, time: 51.31 s, training_loss: 0.514
Epoch   38/50, time: 10.75 s, val_loss: 0.524
Epoch   39/50, time: 51.94 s, training_loss: 0.522
Epoch   39/50, time: 10.85 s, val_loss: 0.516
Epoch   40/50, time: 50.80 s, training_loss: 0.507
Epoch   40/50, time: 12.66 s, val_loss: 0.483
Epoch   41/50, time: 52.95 s, training_loss: 0.523
Epoch   41/50, time: 12.44 s, val_loss: 0.582
Training Metrics:
Accuracy: 0.1369
Precision: 0.2889
Recall: 0.3060
F1 Score: 0.1320
IoU: 0.0115
Dice Coefficient: 0.0079
Validation Metrics:
Accuracy: 0.1426
Precision: 0.2892
Recall: 0.3165
F1 Score: 0.1341
IoU: 0.0112
Dice Coefficient: 0.0077
Epoch   42/50, time: 49.33 s, training_loss: 0.510
Epoch   42/50, time: 12.36 s, val_loss: 0.562
Epoch   43/50, time: 51.06 s, training_loss: 0.500
Epoch   43/50, time: 12.39 s, val_loss: 0.559
Epoch   44/50, time: 44.13 s, training_loss: 0.560
Epoch   44/50, time: 11.03 s, val_loss: 0.552
Epoch   45/50, time: 51.08 s, training_loss: 0.523
Epoch   45/50, time: 12.31 s, val_loss: 0.475
Epoch   46/50, time: 50.52 s, training_loss: 0.505
Epoch   46/50, time: 12.41 s, val_loss: 0.469
Epoch   47/50, time: 52.19 s, training_loss: 0.487
Epoch   47/50, time: 10.82 s, val_loss: 0.464
Epoch   48/50, time: 52.49 s, training_loss: 0.477
Epoch   48/50, time: 12.48 s, val_loss: 0.474
Epoch   49/50, time: 50.81 s, training_loss: 0.470
Epoch   49/50, time: 12.18 s, val_loss: 0.468
Epoch   50/50, time: 42.52 s, training_loss: 0.466
Epoch   50/50, time: 12.49 s, val_loss: 0.460
Training Metrics:
Accuracy: 0.0334
Precision: 0.2933
Recall: 0.4408
F1 Score: 0.0880
IoU: 0.0132
Dice Coefficient: 0.0092
Validation Metrics:
Accuracy: 0.0327
Precision: 0.2910
Recall: 0.4412
F1 Score: 0.0836
IoU: 0.0128
Dice Coefficient: 0.0090
[I 2025-06-14 23:32:39,208] Trial 2 finished with value: 0.00895956518987349 and parameters: {'batch_size': 64, 'lr': 0.000736807765353683, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.012592875685107049.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.0328
Precision: 0.2910
Recall: 0.4411
F1 Score: 0.0836
IoU: 0.0128
Dice Coefficient: 0.0090
[Trial 2] Finished with val_loss=inf
[Trial 2] Finished with dice_coeff=0.00895956518987349
[Trial 3] Trying batch_size=16, lr=0.0004454076166456256, loss_fn=dice_loss
Epoch    1/50, time: 41.69 s, training_loss: 0.968
Epoch    1/50, time: 12.33 s, val_loss: 0.880
Training Metrics:
Accuracy: 0.0953
Precision: 0.2498
Recall: 0.2955
F1 Score: 0.0483
IoU: 0.0128
Dice Coefficient: 0.0161
Validation Metrics:
Accuracy: 0.0742
Precision: 0.2698
Recall: 0.2528
F1 Score: 0.0361
IoU: 0.0110
Dice Coefficient: 0.0217
Epoch    2/50, time: 40.22 s, training_loss: 0.933
Epoch    2/50, time: 10.88 s, val_loss: 0.801
Epoch    3/50, time: 41.53 s, training_loss: 0.902
Epoch    3/50, time: 10.94 s, val_loss: 0.786
Epoch    4/50, time: 42.66 s, training_loss: 0.872
Epoch    4/50, time: 11.05 s, val_loss: 0.763
Epoch    5/50, time: 40.53 s, training_loss: 0.843
Epoch    5/50, time: 12.24 s, val_loss: 0.763
Epoch    6/50, time: 42.55 s, training_loss: 0.821
Epoch    6/50, time: 13.02 s, val_loss: 0.749
Epoch    7/50, time: 42.17 s, training_loss: 0.795
Epoch    7/50, time: 10.67 s, val_loss: 0.717
Epoch    8/50, time: 41.79 s, training_loss: 0.774
Epoch    8/50, time: 10.92 s, val_loss: 0.723
Epoch    9/50, time: 43.04 s, training_loss: 0.777
Epoch    9/50, time: 12.45 s, val_loss: 0.706
Epoch   10/50, time: 41.44 s, training_loss: 0.750
Epoch   10/50, time: 12.18 s, val_loss: 0.698
Epoch   11/50, time: 40.04 s, training_loss: 0.733
Epoch   11/50, time: 10.99 s, val_loss: 0.683
Training Metrics:
Accuracy: 0.1857
Precision: 0.2490
Recall: 0.2535
F1 Score: 0.0820
IoU: 0.0121
Dice Coefficient: 0.0236
Validation Metrics:
Accuracy: 0.0896
Precision: 0.2498
Recall: 0.2566
F1 Score: 0.0443
IoU: 0.0115
Dice Coefficient: 0.0226
Epoch   12/50, time: 40.74 s, training_loss: 0.719
Epoch   12/50, time: 12.92 s, val_loss: 0.672
Epoch   13/50, time: 41.14 s, training_loss: 0.702
Epoch   13/50, time: 10.55 s, val_loss: 0.651
Epoch   14/50, time: 43.08 s, training_loss: 0.686
Epoch   14/50, time: 10.45 s, val_loss: 0.652
Epoch   15/50, time: 40.79 s, training_loss: 0.658
Epoch   15/50, time: 10.68 s, val_loss: 0.599
Epoch   16/50, time: 41.65 s, training_loss: 0.643
Epoch   16/50, time: 10.76 s, val_loss: 0.586
Epoch   17/50, time: 42.36 s, training_loss: 0.585
Epoch   17/50, time: 10.75 s, val_loss: 0.561
Epoch   18/50, time: 42.65 s, training_loss: 0.560
Epoch   18/50, time: 10.66 s, val_loss: 0.548
Epoch   19/50, time: 40.93 s, training_loss: 0.537
Epoch   19/50, time: 10.65 s, val_loss: 0.531
Epoch   20/50, time: 43.13 s, training_loss: 0.527
Epoch   20/50, time: 10.69 s, val_loss: 0.538
Epoch   21/50, time: 40.62 s, training_loss: 0.516
Epoch   21/50, time: 12.54 s, val_loss: 0.489
Training Metrics:
Accuracy: 0.2042
Precision: 0.2563
Recall: 0.3030
F1 Score: 0.0937
IoU: 0.0156
Dice Coefficient: 0.0301
Validation Metrics:
Accuracy: 0.1989
Precision: 0.2566
Recall: 0.3050
F1 Score: 0.0930
IoU: 0.0149
Dice Coefficient: 0.0285
Epoch   22/50, time: 43.36 s, training_loss: 0.495
Epoch   22/50, time: 12.74 s, val_loss: 0.470
Epoch   23/50, time: 41.34 s, training_loss: 0.484
Epoch   23/50, time: 10.72 s, val_loss: 0.476
Epoch   24/50, time: 41.23 s, training_loss: 0.474
Epoch   24/50, time: 10.44 s, val_loss: 0.478
Epoch   25/50, time: 42.67 s, training_loss: 0.480
Epoch   25/50, time: 12.30 s, val_loss: 0.474
Epoch   26/50, time: 40.23 s, training_loss: 0.460
Epoch   26/50, time: 12.33 s, val_loss: 0.460
Epoch   27/50, time: 41.64 s, training_loss: 0.454
Epoch   27/50, time: 12.45 s, val_loss: 0.452
Epoch   28/50, time: 41.34 s, training_loss: 0.451
Epoch   28/50, time: 10.96 s, val_loss: 0.461
Epoch   29/50, time: 41.03 s, training_loss: 0.446
Epoch   29/50, time: 12.56 s, val_loss: 0.433
Epoch   30/50, time: 41.15 s, training_loss: 0.433
Epoch   30/50, time: 10.36 s, val_loss: 0.425
Epoch   31/50, time: 40.99 s, training_loss: 0.429
Epoch   31/50, time: 11.01 s, val_loss: 0.419
Training Metrics:
Accuracy: 0.1515
Precision: 0.2519
Recall: 0.2849
F1 Score: 0.0693
IoU: 0.0145
Dice Coefficient: 0.0274
Validation Metrics:
Accuracy: 0.1595
Precision: 0.2526
Recall: 0.2876
F1 Score: 0.0730
IoU: 0.0141
Dice Coefficient: 0.0267
Epoch   32/50, time: 41.23 s, training_loss: 0.426
Epoch   32/50, time: 10.22 s, val_loss: 0.427
Epoch   33/50, time: 43.66 s, training_loss: 0.428
Epoch   33/50, time: 12.57 s, val_loss: 0.431
Epoch   34/50, time: 41.18 s, training_loss: 0.418
Epoch   34/50, time: 10.58 s, val_loss: 0.413
Epoch   35/50, time: 41.78 s, training_loss: 0.423
Epoch   35/50, time: 10.67 s, val_loss: 0.404
Epoch   36/50, time: 43.54 s, training_loss: 0.407
Epoch   36/50, time: 12.00 s, val_loss: 0.407
Epoch   37/50, time: 40.43 s, training_loss: 0.407
Epoch   37/50, time: 10.88 s, val_loss: 0.393
Epoch   38/50, time: 41.73 s, training_loss: 0.403
Epoch   38/50, time: 12.29 s, val_loss: 0.404
Epoch   39/50, time: 40.46 s, training_loss: 0.401
Epoch   39/50, time: 12.73 s, val_loss: 0.382
Epoch   40/50, time: 43.82 s, training_loss: 0.393
Epoch   40/50, time: 10.43 s, val_loss: 0.375
Epoch   41/50, time: 41.21 s, training_loss: 0.399
Epoch   41/50, time: 10.81 s, val_loss: 0.426
Training Metrics:
Accuracy: 0.1045
Precision: 0.2518
Recall: 0.2696
F1 Score: 0.0499
IoU: 0.0140
Dice Coefficient: 0.0266
Validation Metrics:
Accuracy: 0.0998
Precision: 0.2515
Recall: 0.2655
F1 Score: 0.0482
IoU: 0.0133
Dice Coefficient: 0.0252
Epoch   42/50, time: 41.19 s, training_loss: 0.398
Epoch   42/50, time: 10.35 s, val_loss: 0.397
Epoch   43/50, time: 41.84 s, training_loss: 0.389
Epoch   43/50, time: 12.43 s, val_loss: 0.379
Epoch   44/50, time: 41.12 s, training_loss: 0.386
Epoch   44/50, time: 12.58 s, val_loss: 0.385
Epoch   45/50, time: 41.32 s, training_loss: 0.383
Epoch   45/50, time: 11.23 s, val_loss: 0.379
Epoch   46/50, time: 42.48 s, training_loss: 0.379
Epoch   46/50, time: 12.43 s, val_loss: 0.372
Epoch   47/50, time: 41.83 s, training_loss: 0.375
Epoch   47/50, time: 10.66 s, val_loss: 0.380
Epoch   48/50, time: 44.14 s, training_loss: 0.379
Epoch   48/50, time: 12.14 s, val_loss: 0.378
Epoch   49/50, time: 42.25 s, training_loss: 0.371
Epoch   49/50, time: 10.78 s, val_loss: 0.377
Epoch   50/50, time: 41.59 s, training_loss: 0.376
Epoch   50/50, time: 12.89 s, val_loss: 0.369
Training Metrics:
Accuracy: 0.2510
Precision: 0.2529
Recall: 0.3092
F1 Score: 0.1048
IoU: 0.0170
Dice Coefficient: 0.0321
Validation Metrics:
Accuracy: 0.2579
Precision: 0.2534
Recall: 0.3106
F1 Score: 0.1078
IoU: 0.0165
Dice Coefficient: 0.0310
[I 2025-06-15 00:24:03,950] Trial 3 finished with value: 0.031033711675426207 and parameters: {'batch_size': 16, 'lr': 0.0004454076166456256, 'loss_fn': 'dice_loss'}. Best is trial 3 with value: 0.031033711675426207.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.2579
Precision: 0.2534
Recall: 0.3106
F1 Score: 0.1078
IoU: 0.0165
Dice Coefficient: 0.0310
[Trial 3] Finished with val_loss=inf
[Trial 3] Finished with dice_coeff=0.031033711675426207
[Trial 4] Trying batch_size=64, lr=0.0005808911996267963, loss_fn=dice_loss
Epoch    1/50, time: 44.43 s, training_loss: 0.981
Epoch    1/50, time: 10.80 s, val_loss: 0.984
Training Metrics:
Accuracy: 0.0171
Precision: 0.2559
Recall: 0.3303
F1 Score: 0.0170
IoU: 0.0133
Dice Coefficient: 0.0111
Validation Metrics:
Accuracy: 0.0242
Precision: 0.2547
Recall: 0.3017
F1 Score: 0.0184
IoU: 0.0128
Dice Coefficient: 0.0115
Epoch    2/50, time: 50.84 s, training_loss: 0.972
Epoch    2/50, time: 12.38 s, val_loss: 0.986
Epoch    3/50, time: 48.80 s, training_loss: 0.964
Epoch    3/50, time: 10.80 s, val_loss: 0.989
Epoch    4/50, time: 43.49 s, training_loss: 0.955
Epoch    4/50, time: 10.76 s, val_loss: 0.990
Epoch    5/50, time: 53.15 s, training_loss: 0.945
Epoch    5/50, time: 10.64 s, val_loss: 0.989
Epoch    6/50, time: 43.87 s, training_loss: 0.929
Epoch    6/50, time: 10.70 s, val_loss: 0.989
Epoch    7/50, time: 50.69 s, training_loss: 0.914
Epoch    7/50, time: 12.39 s, val_loss: 0.990
Epoch    8/50, time: 51.16 s, training_loss: 0.902
Epoch    8/50, time: 11.40 s, val_loss: 0.990
Epoch    9/50, time: 51.51 s, training_loss: 0.899
Epoch    9/50, time: 12.53 s, val_loss: 0.990
Epoch   10/50, time: 51.46 s, training_loss: 0.886
Epoch   10/50, time: 10.93 s, val_loss: 0.990
Epoch   11/50, time: 51.49 s, training_loss: 0.881
Epoch   11/50, time: 10.70 s, val_loss: 0.988
Training Metrics:
Accuracy: 0.5186
Precision: 0.2570
Recall: 0.4290
F1 Score: 0.1822
IoU: 0.0253
Dice Coefficient: 0.0263
Validation Metrics:
Accuracy: 0.1026
Precision: 0.2515
Recall: 0.2713
F1 Score: 0.0489
IoU: 0.0141
Dice Coefficient: 0.0145
Epoch   12/50, time: 43.44 s, training_loss: 0.877
Epoch   12/50, time: 10.98 s, val_loss: 0.990
Epoch   13/50, time: 51.67 s, training_loss: 0.874
Epoch   13/50, time: 12.52 s, val_loss: 0.988
Epoch   14/50, time: 51.40 s, training_loss: 0.866
Epoch   14/50, time: 10.36 s, val_loss: 0.978
Epoch   15/50, time: 49.96 s, training_loss: 0.853
Epoch   15/50, time: 11.03 s, val_loss: 0.901
Epoch   16/50, time: 44.11 s, training_loss: 0.840
Epoch   16/50, time: 12.30 s, val_loss: 0.946
Epoch   17/50, time: 51.14 s, training_loss: 0.815
Epoch   17/50, time: 12.74 s, val_loss: 0.861
Epoch   18/50, time: 44.55 s, training_loss: 0.801
Epoch   18/50, time: 12.51 s, val_loss: 0.928
Epoch   19/50, time: 49.14 s, training_loss: 0.785
Epoch   19/50, time: 10.96 s, val_loss: 0.892
Epoch   20/50, time: 41.78 s, training_loss: 0.775
Epoch   20/50, time: 12.60 s, val_loss: 0.791
Epoch   21/50, time: 52.10 s, training_loss: 0.773
Epoch   21/50, time: 11.99 s, val_loss: 0.913
Training Metrics:
Accuracy: 0.6180
Precision: 0.2873
Recall: 0.4351
F1 Score: 0.2496
IoU: 0.0271
Dice Coefficient: 0.0193
Validation Metrics:
Accuracy: 0.4045
Precision: 0.2909
Recall: 0.4003
F1 Score: 0.2007
IoU: 0.0186
Dice Coefficient: 0.0127
Epoch   22/50, time: 51.13 s, training_loss: 0.759
Epoch   22/50, time: 11.07 s, val_loss: 0.812
Epoch   23/50, time: 51.02 s, training_loss: 0.750
Epoch   23/50, time: 12.29 s, val_loss: 0.795
Epoch   24/50, time: 51.30 s, training_loss: 0.737
Epoch   24/50, time: 10.89 s, val_loss: 0.749
Epoch   25/50, time: 51.96 s, training_loss: 0.723
Epoch   25/50, time: 10.87 s, val_loss: 0.730
Epoch   26/50, time: 49.33 s, training_loss: 0.720
Epoch   26/50, time: 10.52 s, val_loss: 0.740
Epoch   27/50, time: 50.70 s, training_loss: 0.714
Epoch   27/50, time: 12.44 s, val_loss: 0.743
Epoch   28/50, time: 51.17 s, training_loss: 0.694
Epoch   28/50, time: 10.56 s, val_loss: 0.691
Epoch   29/50, time: 48.56 s, training_loss: 0.660
Epoch   29/50, time: 10.45 s, val_loss: 0.690
Epoch   30/50, time: 53.23 s, training_loss: 0.646
Epoch   30/50, time: 10.84 s, val_loss: 0.658
Epoch   31/50, time: 53.43 s, training_loss: 0.629
Epoch   31/50, time: 10.85 s, val_loss: 0.705
Training Metrics:
Accuracy: 0.6756
Precision: 0.3052
Recall: 0.5464
F1 Score: 0.2867
IoU: 0.0367
Dice Coefficient: 0.0256
Validation Metrics:
Accuracy: 0.6144
Precision: 0.3083
Recall: 0.5204
F1 Score: 0.2775
IoU: 0.0297
Dice Coefficient: 0.0205
Epoch   32/50, time: 50.62 s, training_loss: 0.617
Epoch   32/50, time: 10.51 s, val_loss: 0.646
Epoch   33/50, time: 44.34 s, training_loss: 0.638
Epoch   33/50, time: 10.96 s, val_loss: 0.675
Epoch   34/50, time: 53.03 s, training_loss: 0.606
Epoch   34/50, time: 10.79 s, val_loss: 0.610
Epoch   35/50, time: 43.52 s, training_loss: 0.590
Epoch   35/50, time: 12.18 s, val_loss: 0.607
Epoch   36/50, time: 53.00 s, training_loss: 0.621
Epoch   36/50, time: 10.61 s, val_loss: 0.663
Epoch   37/50, time: 51.62 s, training_loss: 0.604
Epoch   37/50, time: 12.43 s, val_loss: 0.624
Epoch   38/50, time: 50.44 s, training_loss: 0.575
Epoch   38/50, time: 10.62 s, val_loss: 0.594
Epoch   39/50, time: 52.89 s, training_loss: 0.554
Epoch   39/50, time: 12.26 s, val_loss: 0.572
Epoch   40/50, time: 43.59 s, training_loss: 0.550
Epoch   40/50, time: 12.73 s, val_loss: 0.598
Epoch   41/50, time: 44.50 s, training_loss: 0.542
Epoch   41/50, time: 10.42 s, val_loss: 0.524
Training Metrics:
Accuracy: 0.6762
Precision: 0.2691
Recall: 0.5474
F1 Score: 0.2383
IoU: 0.0337
Dice Coefficient: 0.0282
Validation Metrics:
Accuracy: 0.7002
Precision: 0.2711
Recall: 0.5177
F1 Score: 0.2461
IoU: 0.0325
Dice Coefficient: 0.0264
Epoch   42/50, time: 52.14 s, training_loss: 0.538
Epoch   42/50, time: 12.61 s, val_loss: 0.535
Epoch   43/50, time: 52.44 s, training_loss: 0.508
Epoch   43/50, time: 12.49 s, val_loss: 0.528
Epoch   44/50, time: 49.75 s, training_loss: 0.506
Epoch   44/50, time: 10.81 s, val_loss: 0.520
Epoch   45/50, time: 43.37 s, training_loss: 0.502
Epoch   45/50, time: 11.10 s, val_loss: 0.501
Epoch   46/50, time: 51.99 s, training_loss: 0.486
Epoch   46/50, time: 10.72 s, val_loss: 0.529
Epoch   47/50, time: 44.66 s, training_loss: 0.481
Epoch   47/50, time: 12.48 s, val_loss: 0.479
Epoch   48/50, time: 50.35 s, training_loss: 0.474
Epoch   48/50, time: 12.33 s, val_loss: 0.526
Epoch   49/50, time: 51.44 s, training_loss: 0.491
Epoch   49/50, time: 12.64 s, val_loss: 0.528
Epoch   50/50, time: 46.50 s, training_loss: 0.489
Epoch   50/50, time: 12.45 s, val_loss: 0.533
Training Metrics:
Accuracy: 0.7023
Precision: 0.2891
Recall: 0.5789
F1 Score: 0.2739
IoU: 0.0385
Dice Coefficient: 0.0285
Validation Metrics:
Accuracy: 0.6982
Precision: 0.2928
Recall: 0.5592
F1 Score: 0.2781
IoU: 0.0363
Dice Coefficient: 0.0263
[I 2025-06-15 01:22:28,904] Trial 4 finished with value: 0.02628304369554486 and parameters: {'batch_size': 64, 'lr': 0.0005808911996267963, 'loss_fn': 'dice_loss'}. Best is trial 3 with value: 0.031033711675426207.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.6982
Precision: 0.2928
Recall: 0.5592
F1 Score: 0.2781
IoU: 0.0363
Dice Coefficient: 0.0263
[Trial 4] Finished with val_loss=inf
[Trial 4] Finished with dice_coeff=0.02628304369554486
[Trial 5] Trying batch_size=32, lr=0.0002709829673680805, loss_fn=dice_loss
Epoch    1/50, time: 46.58 s, training_loss: 0.976
Epoch    1/50, time: 12.76 s, val_loss: 0.958
Training Metrics:
Accuracy: 0.1835
Precision: 0.2489
Recall: 0.1718
F1 Score: 0.0927
IoU: 0.0070
Dice Coefficient: 0.0055
Validation Metrics:
Accuracy: 0.2390
Precision: 0.2473
Recall: 0.1224
F1 Score: 0.1085
IoU: 0.0027
Dice Coefficient: 0.0019
Epoch    2/50, time: 45.14 s, training_loss: 0.965
Epoch    2/50, time: 10.90 s, val_loss: 0.952
Epoch    3/50, time: 43.59 s, training_loss: 0.954
Epoch    3/50, time: 12.53 s, val_loss: 0.976
Epoch    4/50, time: 42.67 s, training_loss: 0.939
Epoch    4/50, time: 10.62 s, val_loss: 0.907
Epoch    5/50, time: 46.86 s, training_loss: 0.921
Epoch    5/50, time: 12.19 s, val_loss: 0.848
Epoch    6/50, time: 43.28 s, training_loss: 0.906
Epoch    6/50, time: 10.87 s, val_loss: 0.927
Epoch    7/50, time: 45.09 s, training_loss: 0.887
Epoch    7/50, time: 10.85 s, val_loss: 0.863
Epoch    8/50, time: 44.58 s, training_loss: 0.867
Epoch    8/50, time: 12.41 s, val_loss: 0.895
Epoch    9/50, time: 45.10 s, training_loss: 0.853
Epoch    9/50, time: 11.41 s, val_loss: 0.810
Epoch   10/50, time: 45.94 s, training_loss: 0.832
Epoch   10/50, time: 10.48 s, val_loss: 0.794
Epoch   11/50, time: 42.08 s, training_loss: 0.811
Epoch   11/50, time: 12.38 s, val_loss: 0.820
Training Metrics:
Accuracy: 0.5901
Precision: 0.3016
Recall: 0.4772
F1 Score: 0.2691
IoU: 0.0247
Dice Coefficient: 0.0174
Validation Metrics:
Accuracy: 0.6569
Precision: 0.3047
Recall: 0.5175
F1 Score: 0.2876
IoU: 0.0292
Dice Coefficient: 0.0209
Epoch   12/50, time: 42.60 s, training_loss: 0.795
Epoch   12/50, time: 10.96 s, val_loss: 0.734
Epoch   13/50, time: 43.90 s, training_loss: 0.778
Epoch   13/50, time: 10.87 s, val_loss: 0.788
Epoch   14/50, time: 44.05 s, training_loss: 0.758
Epoch   14/50, time: 12.22 s, val_loss: 0.743
Epoch   15/50, time: 44.34 s, training_loss: 0.727
Epoch   15/50, time: 12.60 s, val_loss: 0.696
Epoch   16/50, time: 46.00 s, training_loss: 0.703
Epoch   16/50, time: 12.69 s, val_loss: 0.695
Epoch   17/50, time: 46.54 s, training_loss: 0.689
Epoch   17/50, time: 10.76 s, val_loss: 0.611
Epoch   18/50, time: 44.99 s, training_loss: 0.650
Epoch   18/50, time: 10.88 s, val_loss: 0.614
Epoch   19/50, time: 41.82 s, training_loss: 0.632
Epoch   19/50, time: 12.42 s, val_loss: 0.635
Epoch   20/50, time: 43.23 s, training_loss: 0.596
Epoch   20/50, time: 12.90 s, val_loss: 0.568
Epoch   21/50, time: 43.16 s, training_loss: 0.577
Epoch   21/50, time: 12.65 s, val_loss: 0.579
Training Metrics:
Accuracy: 0.7597
Precision: 0.3043
Recall: 0.6140
F1 Score: 0.3058
IoU: 0.0452
Dice Coefficient: 0.0383
Validation Metrics:
Accuracy: 0.7532
Precision: 0.3018
Recall: 0.6154
F1 Score: 0.3016
IoU: 0.0430
Dice Coefficient: 0.0366
Epoch   22/50, time: 43.37 s, training_loss: 0.555
Epoch   22/50, time: 12.52 s, val_loss: 0.592
Epoch   23/50, time: 46.73 s, training_loss: 0.562
Epoch   23/50, time: 12.54 s, val_loss: 0.548
Epoch   24/50, time: 43.97 s, training_loss: 0.530
Epoch   24/50, time: 10.84 s, val_loss: 0.510
Epoch   25/50, time: 43.41 s, training_loss: 0.509
Epoch   25/50, time: 12.61 s, val_loss: 0.453
Epoch   26/50, time: 45.09 s, training_loss: 0.497
Epoch   26/50, time: 11.06 s, val_loss: 0.500
Epoch   27/50, time: 43.25 s, training_loss: 0.491
Epoch   27/50, time: 10.92 s, val_loss: 0.466
Epoch   28/50, time: 45.93 s, training_loss: 0.481
Epoch   28/50, time: 12.60 s, val_loss: 0.499
Epoch   29/50, time: 43.23 s, training_loss: 0.488
Epoch   29/50, time: 10.38 s, val_loss: 0.469
Epoch   30/50, time: 45.49 s, training_loss: 0.451
Epoch   30/50, time: 10.83 s, val_loss: 0.490
Epoch   31/50, time: 45.26 s, training_loss: 0.434
Epoch   31/50, time: 12.56 s, val_loss: 0.468
Training Metrics:
Accuracy: 0.6355
Precision: 0.3028
Recall: 0.6490
F1 Score: 0.2836
IoU: 0.0337
Dice Coefficient: 0.0312
Validation Metrics:
Accuracy: 0.6382
Precision: 0.3010
Recall: 0.6345
F1 Score: 0.2813
IoU: 0.0324
Dice Coefficient: 0.0296
Epoch   32/50, time: 45.90 s, training_loss: 0.423
Epoch   32/50, time: 12.08 s, val_loss: 0.421
Epoch   33/50, time: 43.29 s, training_loss: 0.426
Epoch   33/50, time: 10.90 s, val_loss: 0.449
Epoch   34/50, time: 46.22 s, training_loss: 0.407
Epoch   34/50, time: 12.38 s, val_loss: 0.398
Epoch   35/50, time: 45.85 s, training_loss: 0.400
Epoch   35/50, time: 10.83 s, val_loss: 0.437
Epoch   36/50, time: 46.56 s, training_loss: 0.395
Epoch   36/50, time: 12.51 s, val_loss: 0.390
Epoch   37/50, time: 44.07 s, training_loss: 0.392
Epoch   37/50, time: 10.72 s, val_loss: 0.418
Epoch   38/50, time: 45.25 s, training_loss: 0.387
Epoch   38/50, time: 12.65 s, val_loss: 0.381
Epoch   39/50, time: 44.70 s, training_loss: 0.384
Epoch   39/50, time: 10.79 s, val_loss: 0.421
Epoch   40/50, time: 41.56 s, training_loss: 0.381
Epoch   40/50, time: 12.59 s, val_loss: 0.375
Epoch   41/50, time: 42.92 s, training_loss: 0.366
Epoch   41/50, time: 10.98 s, val_loss: 0.359
Training Metrics:
Accuracy: 0.6804
Precision: 0.3194
Recall: 0.6579
F1 Score: 0.3133
IoU: 0.0381
Dice Coefficient: 0.0345
Validation Metrics:
Accuracy: 0.6767
Precision: 0.3109
Recall: 0.6439
F1 Score: 0.3014
IoU: 0.0361
Dice Coefficient: 0.0326
Epoch   42/50, time: 43.08 s, training_loss: 0.364
Epoch   42/50, time: 12.59 s, val_loss: 0.388
Epoch   43/50, time: 42.36 s, training_loss: 0.357
Epoch   43/50, time: 10.68 s, val_loss: 0.369
Epoch   44/50, time: 47.13 s, training_loss: 0.363
Epoch   44/50, time: 12.40 s, val_loss: 0.367
Epoch   45/50, time: 45.05 s, training_loss: 0.362
Epoch   45/50, time: 10.93 s, val_loss: 0.379
Epoch   46/50, time: 44.34 s, training_loss: 0.353
Epoch   46/50, time: 10.83 s, val_loss: 0.395
Epoch   47/50, time: 42.32 s, training_loss: 0.345
Epoch   47/50, time: 11.12 s, val_loss: 0.360
Epoch   48/50, time: 43.43 s, training_loss: 0.348
Epoch   48/50, time: 12.52 s, val_loss: 0.347
Epoch   49/50, time: 45.18 s, training_loss: 0.344
Epoch   49/50, time: 10.37 s, val_loss: 0.377
Epoch   50/50, time: 42.06 s, training_loss: 0.346
Epoch   50/50, time: 12.86 s, val_loss: 0.339
Training Metrics:
Accuracy: 0.6878
Precision: 0.3354
Recall: 0.6660
F1 Score: 0.3338
IoU: 0.0389
Dice Coefficient: 0.0344
Validation Metrics:
Accuracy: 0.6898
Precision: 0.3278
Recall: 0.6451
F1 Score: 0.3252
IoU: 0.0373
Dice Coefficient: 0.0331
[I 2025-06-15 02:16:45,932] Trial 5 finished with value: 0.033077967337771755 and parameters: {'batch_size': 32, 'lr': 0.0002709829673680805, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.6898
Precision: 0.3278
Recall: 0.6451
F1 Score: 0.3252
IoU: 0.0373
Dice Coefficient: 0.0331
[Trial 5] Finished with val_loss=inf
[Trial 5] Finished with dice_coeff=0.033077967337771755
[Trial 6] Trying batch_size=32, lr=0.0005970703569219447, loss_fn=dice_loss
Epoch    1/50, time: 44.03 s, training_loss: 0.967
Epoch    1/50, time: 12.42 s, val_loss: 0.860
Training Metrics:
Accuracy: 0.0812
Precision: 0.2493
Recall: 0.2589
F1 Score: 0.0449
IoU: 0.0119
Dice Coefficient: 0.0170
Validation Metrics:
Accuracy: 0.0218
Precision: 0.2478
Recall: 0.2598
F1 Score: 0.0159
IoU: 0.0124
Dice Coefficient: 0.0237
Epoch    2/50, time: 45.62 s, training_loss: 0.938
Epoch    2/50, time: 12.72 s, val_loss: 0.876
Epoch    3/50, time: 45.29 s, training_loss: 0.913
Epoch    3/50, time: 10.74 s, val_loss: 0.806
Epoch    4/50, time: 46.87 s, training_loss: 0.895
Epoch    4/50, time: 12.48 s, val_loss: 0.792
Epoch    5/50, time: 43.10 s, training_loss: 0.882
Epoch    5/50, time: 12.50 s, val_loss: 0.788
Epoch    6/50, time: 43.17 s, training_loss: 0.858
Epoch    6/50, time: 10.44 s, val_loss: 0.765
Epoch    7/50, time: 47.01 s, training_loss: 0.845
Epoch    7/50, time: 12.42 s, val_loss: 0.787
Epoch    8/50, time: 45.38 s, training_loss: 0.826
Epoch    8/50, time: 10.59 s, val_loss: 0.748
Epoch    9/50, time: 45.10 s, training_loss: 0.818
Epoch    9/50, time: 12.78 s, val_loss: 0.738
Epoch   10/50, time: 44.55 s, training_loss: 0.795
Epoch   10/50, time: 11.95 s, val_loss: 0.718
Epoch   11/50, time: 44.40 s, training_loss: 0.778
Epoch   11/50, time: 11.33 s, val_loss: 0.708
Training Metrics:
Accuracy: 0.0527
Precision: 0.2534
Recall: 0.3231
F1 Score: 0.0368
IoU: 0.0128
Dice Coefficient: 0.0197
Validation Metrics:
Accuracy: 0.0371
Precision: 0.2526
Recall: 0.3440
F1 Score: 0.0295
IoU: 0.0124
Dice Coefficient: 0.0219
Epoch   12/50, time: 44.25 s, training_loss: 0.782
Epoch   12/50, time: 12.48 s, val_loss: 0.715
Epoch   13/50, time: 45.19 s, training_loss: 0.763
Epoch   13/50, time: 12.67 s, val_loss: 0.714
Epoch   14/50, time: 44.70 s, training_loss: 0.752
Epoch   14/50, time: 12.86 s, val_loss: 0.711
Epoch   15/50, time: 45.93 s, training_loss: 0.743
Epoch   15/50, time: 10.94 s, val_loss: 0.802
Epoch   16/50, time: 47.28 s, training_loss: 0.765
Epoch   16/50, time: 10.82 s, val_loss: 0.724
Epoch   17/50, time: 44.82 s, training_loss: 0.734
Epoch   17/50, time: 12.38 s, val_loss: 0.735
Epoch   18/50, time: 43.65 s, training_loss: 0.738
Epoch   18/50, time: 12.41 s, val_loss: 0.834
Epoch   19/50, time: 47.81 s, training_loss: 0.711
Epoch   19/50, time: 12.33 s, val_loss: 0.669
Epoch   20/50, time: 43.60 s, training_loss: 0.668
Epoch   20/50, time: 12.45 s, val_loss: 0.613
Epoch   21/50, time: 43.19 s, training_loss: 0.644
Epoch   21/50, time: 10.90 s, val_loss: 0.595
Training Metrics:
Accuracy: 0.0605
Precision: 0.2514
Recall: 0.3309
F1 Score: 0.0345
IoU: 0.0132
Dice Coefficient: 0.0179
Validation Metrics:
Accuracy: 0.0480
Precision: 0.2518
Recall: 0.3409
F1 Score: 0.0296
IoU: 0.0126
Dice Coefficient: 0.0178
Epoch   22/50, time: 42.97 s, training_loss: 0.612
Epoch   22/50, time: 12.41 s, val_loss: 0.570
Epoch   23/50, time: 43.47 s, training_loss: 0.585
Epoch   23/50, time: 12.71 s, val_loss: 0.540
Epoch   24/50, time: 44.72 s, training_loss: 0.560
Epoch   24/50, time: 12.60 s, val_loss: 0.572
Epoch   25/50, time: 43.74 s, training_loss: 0.548
Epoch   25/50, time: 12.63 s, val_loss: 0.624
Epoch   26/50, time: 45.07 s, training_loss: 0.547
Epoch   26/50, time: 12.78 s, val_loss: 0.500
Epoch   27/50, time: 45.02 s, training_loss: 0.526
Epoch   27/50, time: 12.42 s, val_loss: 0.495
Epoch   28/50, time: 44.96 s, training_loss: 0.512
Epoch   28/50, time: 10.95 s, val_loss: 0.464
Epoch   29/50, time: 44.94 s, training_loss: 0.512
Epoch   29/50, time: 11.54 s, val_loss: 0.479
Epoch   30/50, time: 44.42 s, training_loss: 0.490
Epoch   30/50, time: 12.48 s, val_loss: 0.490
Epoch   31/50, time: 46.64 s, training_loss: 0.493
Epoch   31/50, time: 12.49 s, val_loss: 0.452
Training Metrics:
Accuracy: 0.0557
Precision: 0.2526
Recall: 0.3408
F1 Score: 0.0312
IoU: 0.0135
Dice Coefficient: 0.0169
Validation Metrics:
Accuracy: 0.0522
Precision: 0.2528
Recall: 0.3521
F1 Score: 0.0294
IoU: 0.0130
Dice Coefficient: 0.0172
Epoch   32/50, time: 44.56 s, training_loss: 0.472
Epoch   32/50, time: 10.95 s, val_loss: 0.474
Epoch   33/50, time: 45.88 s, training_loss: 0.468
Epoch   33/50, time: 10.86 s, val_loss: 0.474
Epoch   34/50, time: 47.38 s, training_loss: 0.473
Epoch   34/50, time: 12.31 s, val_loss: 0.493
Epoch   35/50, time: 46.41 s, training_loss: 0.471
Epoch   35/50, time: 12.77 s, val_loss: 0.460
Epoch   36/50, time: 46.45 s, training_loss: 0.460
Epoch   36/50, time: 10.96 s, val_loss: 0.448
Epoch   37/50, time: 45.01 s, training_loss: 0.449
Epoch   37/50, time: 12.44 s, val_loss: 0.463
Epoch   38/50, time: 45.06 s, training_loss: 0.446
Epoch   38/50, time: 11.16 s, val_loss: 0.441
Epoch   39/50, time: 46.14 s, training_loss: 0.438
Epoch   39/50, time: 10.71 s, val_loss: 0.422
Epoch   40/50, time: 42.16 s, training_loss: 0.431
Epoch   40/50, time: 12.52 s, val_loss: 0.464
Epoch   41/50, time: 43.79 s, training_loss: 0.435
Epoch   41/50, time: 10.84 s, val_loss: 0.438
Training Metrics:
Accuracy: 0.0705
Precision: 0.2536
Recall: 0.3142
F1 Score: 0.0375
IoU: 0.0139
Dice Coefficient: 0.0199
Validation Metrics:
Accuracy: 0.0598
Precision: 0.2533
Recall: 0.3162
F1 Score: 0.0323
IoU: 0.0132
Dice Coefficient: 0.0196
Epoch   42/50, time: 43.42 s, training_loss: 0.430
Epoch   42/50, time: 10.71 s, val_loss: 0.421
Epoch   43/50, time: 45.46 s, training_loss: 0.424
Epoch   43/50, time: 10.85 s, val_loss: 0.400
Epoch   44/50, time: 44.22 s, training_loss: 0.414
Epoch   44/50, time: 13.20 s, val_loss: 0.423
Epoch   45/50, time: 42.95 s, training_loss: 0.410
Epoch   45/50, time: 10.63 s, val_loss: 0.415
Epoch   46/50, time: 46.15 s, training_loss: 0.416
Epoch   46/50, time: 12.87 s, val_loss: 0.399
Epoch   47/50, time: 44.44 s, training_loss: 0.402
Epoch   47/50, time: 12.56 s, val_loss: 0.422
Epoch   48/50, time: 44.53 s, training_loss: 0.404
Epoch   48/50, time: 11.08 s, val_loss: 0.402
Epoch   49/50, time: 41.45 s, training_loss: 0.403
Epoch   49/50, time: 10.74 s, val_loss: 0.432
Epoch   50/50, time: 43.95 s, training_loss: 0.395
Epoch   50/50, time: 10.71 s, val_loss: 0.418
Training Metrics:
Accuracy: 0.0672
Precision: 0.2543
Recall: 0.3475
F1 Score: 0.0370
IoU: 0.0139
Dice Coefficient: 0.0176
Validation Metrics:
Accuracy: 0.0723
Precision: 0.2543
Recall: 0.3634
F1 Score: 0.0394
IoU: 0.0134
Dice Coefficient: 0.0176
[I 2025-06-15 03:11:22,864] Trial 6 finished with value: 0.01764971478870391 and parameters: {'batch_size': 32, 'lr': 0.0005970703569219447, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.0723
Precision: 0.2543
Recall: 0.3634
F1 Score: 0.0394
IoU: 0.0134
Dice Coefficient: 0.0176
[Trial 6] Finished with val_loss=inf
[Trial 6] Finished with dice_coeff=0.01764971478870391
[Trial 7] Trying batch_size=128, lr=0.00010338555803139292, loss_fn=dice_loss
Epoch    1/50, time: 54.31 s, training_loss: 0.985
Epoch    1/50, time: 10.81 s, val_loss: 0.990
/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Training Metrics:
Accuracy: 0.0032
Precision: 0.2820
Recall: 0.2665
F1 Score: 0.0362
IoU: 0.0132
Dice Coefficient: 0.0131
Validation Metrics:
Accuracy: 0.0041
Precision: 0.0330
Recall: 0.2769
F1 Score: 0.0470
IoU: 0.0127
Dice Coefficient: 0.0126
Epoch    2/50, time: 59.01 s, training_loss: 0.981
Epoch    2/50, time: 12.43 s, val_loss: 0.986
Epoch    3/50, time: 61.17 s, training_loss: 0.979
Epoch    3/50, time: 12.83 s, val_loss: 0.983
Epoch    4/50, time: 53.99 s, training_loss: 0.978
Epoch    4/50, time: 10.59 s, val_loss: 0.985
Epoch    5/50, time: 53.17 s, training_loss: 0.977
Epoch    5/50, time: 10.86 s, val_loss: 0.979
Epoch    6/50, time: 52.23 s, training_loss: 0.976
Epoch    6/50, time: 10.65 s, val_loss: 0.978
Epoch    7/50, time: 52.10 s, training_loss: 0.974
Epoch    7/50, time: 12.70 s, val_loss: 0.982
Epoch    8/50, time: 52.89 s, training_loss: 0.971
Epoch    8/50, time: 11.60 s, val_loss: 0.978
Epoch    9/50, time: 54.81 s, training_loss: 0.969
Epoch    9/50, time: 12.87 s, val_loss: 0.980
Epoch   10/50, time: 53.39 s, training_loss: 0.968
Epoch   10/50, time: 10.89 s, val_loss: 0.944
Epoch   11/50, time: 52.41 s, training_loss: 0.965
Epoch   11/50, time: 12.65 s, val_loss: 0.982
Training Metrics:
Accuracy: 0.0846
Precision: 0.2563
Recall: 0.2801
F1 Score: 0.0491
IoU: 0.0140
Dice Coefficient: 0.0159
Validation Metrics:
Accuracy: 0.0842
Precision: 0.2555
Recall: 0.2806
F1 Score: 0.0468
IoU: 0.0136
Dice Coefficient: 0.0158
Epoch   12/50, time: 54.73 s, training_loss: 0.963
Epoch   12/50, time: 11.07 s, val_loss: 0.966
Epoch   13/50, time: 55.36 s, training_loss: 0.962
Epoch   13/50, time: 10.79 s, val_loss: 0.966
Epoch   14/50, time: 52.75 s, training_loss: 0.960
Epoch   14/50, time: 12.61 s, val_loss: 0.955
Epoch   15/50, time: 62.59 s, training_loss: 0.959
Epoch   15/50, time: 10.58 s, val_loss: 0.973
Epoch   16/50, time: 52.64 s, training_loss: 0.957
Epoch   16/50, time: 10.74 s, val_loss: 0.967
Epoch   17/50, time: 53.07 s, training_loss: 0.956
Epoch   17/50, time: 10.93 s, val_loss: 0.963
Epoch   18/50, time: 53.32 s, training_loss: 0.954
Epoch   18/50, time: 10.67 s, val_loss: 0.970
Epoch   19/50, time: 61.97 s, training_loss: 0.953
Epoch   19/50, time: 12.48 s, val_loss: 0.958
Epoch   20/50, time: 64.44 s, training_loss: 0.951
Epoch   20/50, time: 10.74 s, val_loss: 0.936
Epoch   21/50, time: 62.86 s, training_loss: 0.949
Epoch   21/50, time: 12.83 s, val_loss: 0.958
Training Metrics:
Accuracy: 0.0551
Precision: 0.2582
Recall: 0.2758
F1 Score: 0.0413
IoU: 0.0135
Dice Coefficient: 0.0151
Validation Metrics:
Accuracy: 0.0643
Precision: 0.2573
Recall: 0.2764
F1 Score: 0.0440
IoU: 0.0130
Dice Coefficient: 0.0146
Epoch   22/50, time: 59.18 s, training_loss: 0.948
Epoch   22/50, time: 11.00 s, val_loss: 0.929
Epoch   23/50, time: 63.69 s, training_loss: 0.947
Epoch   23/50, time: 11.19 s, val_loss: 0.940
Epoch   24/50, time: 61.24 s, training_loss: 0.946
Epoch   24/50, time: 12.32 s, val_loss: 0.937
Epoch   25/50, time: 62.18 s, training_loss: 0.944
Epoch   25/50, time: 11.14 s, val_loss: 0.962
Epoch   26/50, time: 62.60 s, training_loss: 0.942
Epoch   26/50, time: 10.67 s, val_loss: 0.939
Epoch   27/50, time: 62.57 s, training_loss: 0.941
Epoch   27/50, time: 12.69 s, val_loss: 0.927
Epoch   28/50, time: 62.17 s, training_loss: 0.939
Epoch   28/50, time: 12.60 s, val_loss: 0.951
Epoch   29/50, time: 60.26 s, training_loss: 0.939
Epoch   29/50, time: 12.79 s, val_loss: 0.938
Epoch   30/50, time: 52.76 s, training_loss: 0.940
Epoch   30/50, time: 10.74 s, val_loss: 0.942
Epoch   31/50, time: 52.51 s, training_loss: 0.940
Epoch   31/50, time: 11.24 s, val_loss: 0.903
Training Metrics:
Accuracy: 0.0549
Precision: 0.2530
Recall: 0.2940
F1 Score: 0.0371
IoU: 0.0129
Dice Coefficient: 0.0145
Validation Metrics:
Accuracy: 0.0565
Precision: 0.2521
Recall: 0.2938
F1 Score: 0.0376
IoU: 0.0122
Dice Coefficient: 0.0137
Epoch   32/50, time: 61.84 s, training_loss: 0.936
Epoch   32/50, time: 10.88 s, val_loss: 0.938
Epoch   33/50, time: 53.31 s, training_loss: 0.933
Epoch   33/50, time: 12.46 s, val_loss: 0.934
Epoch   34/50, time: 58.69 s, training_loss: 0.933
Epoch   34/50, time: 11.00 s, val_loss: 0.916
Epoch   35/50, time: 61.07 s, training_loss: 0.929
Epoch   35/50, time: 12.89 s, val_loss: 0.945
Epoch   36/50, time: 62.35 s, training_loss: 0.929
Epoch   36/50, time: 12.82 s, val_loss: 0.930
Epoch   37/50, time: 54.75 s, training_loss: 0.929
Epoch   37/50, time: 12.62 s, val_loss: 0.902
Epoch   38/50, time: 60.64 s, training_loss: 0.929
Epoch   38/50, time: 10.87 s, val_loss: 0.913
Epoch   39/50, time: 54.00 s, training_loss: 0.924
Epoch   39/50, time: 12.64 s, val_loss: 0.920
Epoch   40/50, time: 55.20 s, training_loss: 0.925
Epoch   40/50, time: 10.97 s, val_loss: 0.894
Epoch   41/50, time: 62.60 s, training_loss: 0.922
Epoch   41/50, time: 12.80 s, val_loss: 0.888
Training Metrics:
Accuracy: 0.0401
Precision: 0.2533
Recall: 0.2978
F1 Score: 0.0304
IoU: 0.0130
Dice Coefficient: 0.0148
Validation Metrics:
Accuracy: 0.0445
Precision: 0.2547
Recall: 0.3087
F1 Score: 0.0365
IoU: 0.0124
Dice Coefficient: 0.0135
Epoch   42/50, time: 63.74 s, training_loss: 0.921
Epoch   42/50, time: 11.29 s, val_loss: 0.882
Epoch   43/50, time: 61.01 s, training_loss: 0.916
Epoch   43/50, time: 11.24 s, val_loss: 0.896
Epoch   44/50, time: 54.59 s, training_loss: 0.914
Epoch   44/50, time: 10.80 s, val_loss: 0.961
Epoch   45/50, time: 62.85 s, training_loss: 0.914
Epoch   45/50, time: 13.10 s, val_loss: 0.897
Epoch   46/50, time: 55.19 s, training_loss: 0.911
Epoch   46/50, time: 10.44 s, val_loss: 0.919
Epoch   47/50, time: 61.13 s, training_loss: 0.911
Epoch   47/50, time: 12.62 s, val_loss: 0.925
Epoch   48/50, time: 55.14 s, training_loss: 0.908
Epoch   48/50, time: 12.71 s, val_loss: 0.905
Epoch   49/50, time: 63.61 s, training_loss: 0.909
Epoch   49/50, time: 10.87 s, val_loss: 0.851
Epoch   50/50, time: 62.44 s, training_loss: 0.906
Epoch   50/50, time: 11.10 s, val_loss: 0.825
Training Metrics:
Accuracy: 0.0367
Precision: 0.2508
Recall: 0.3162
F1 Score: 0.0287
IoU: 0.0127
Dice Coefficient: 0.0144
Validation Metrics:
Accuracy: 0.0426
Precision: 0.2548
Recall: 0.3398
F1 Score: 0.0398
IoU: 0.0120
Dice Coefficient: 0.0128
[I 2025-06-15 04:18:02,160] Trial 7 finished with value: 0.01282513530459009 and parameters: {'batch_size': 128, 'lr': 0.00010338555803139292, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.0426
Precision: 0.2548
Recall: 0.3398
F1 Score: 0.0398
IoU: 0.0120
Dice Coefficient: 0.0128
[Trial 7] Finished with val_loss=inf
[Trial 7] Finished with dice_coeff=0.01282513530459009
[Trial 8] Trying batch_size=128, lr=0.00017904575222251644, loss_fn=dice_loss
Epoch    1/50, time: 60.09 s, training_loss: 0.985
Epoch    1/50, time: 12.75 s, val_loss: 0.990
Training Metrics:
Accuracy: 0.0087
Precision: 0.2120
Recall: 0.2498
F1 Score: 0.0044
IoU: 0.0132
Dice Coefficient: 0.0258
Validation Metrics:
Accuracy: 0.0083
Precision: 0.2122
Recall: 0.2497
F1 Score: 0.0047
IoU: 0.0127
Dice Coefficient: 0.0248
Epoch    2/50, time: 54.27 s, training_loss: 0.982
Epoch    2/50, time: 12.55 s, val_loss: 0.986
Epoch    3/50, time: 62.09 s, training_loss: 0.981
Epoch    3/50, time: 10.79 s, val_loss: 0.985
Epoch    4/50, time: 52.28 s, training_loss: 0.980
Epoch    4/50, time: 12.20 s, val_loss: 0.985
Epoch    5/50, time: 61.26 s, training_loss: 0.979
Epoch    5/50, time: 12.99 s, val_loss: 0.983
Epoch    6/50, time: 52.83 s, training_loss: 0.979
Epoch    6/50, time: 12.83 s, val_loss: 0.978
Epoch    7/50, time: 60.87 s, training_loss: 0.977
Epoch    7/50, time: 12.39 s, val_loss: 0.978
Epoch    8/50, time: 55.46 s, training_loss: 0.977
Epoch    8/50, time: 12.52 s, val_loss: 0.977
Epoch    9/50, time: 61.75 s, training_loss: 0.975
Epoch    9/50, time: 11.05 s, val_loss: 0.981
Epoch   10/50, time: 61.87 s, training_loss: 0.974
Epoch   10/50, time: 12.86 s, val_loss: 0.979
Epoch   11/50, time: 59.99 s, training_loss: 0.973
Epoch   11/50, time: 12.57 s, val_loss: 0.956
Training Metrics:
Accuracy: 0.0883
Precision: 0.2541
Recall: 0.4543
F1 Score: 0.0466
IoU: 0.0140
Dice Coefficient: 0.0174
Validation Metrics:
Accuracy: 0.0977
Precision: 0.2537
Recall: 0.4583
F1 Score: 0.0506
IoU: 0.0134
Dice Coefficient: 0.0157
Epoch   12/50, time: 62.45 s, training_loss: 0.971
Epoch   12/50, time: 12.94 s, val_loss: 0.966
Epoch   13/50, time: 60.68 s, training_loss: 0.970
Epoch   13/50, time: 11.00 s, val_loss: 0.958
Epoch   14/50, time: 59.36 s, training_loss: 0.967
Epoch   14/50, time: 10.70 s, val_loss: 0.958
Epoch   15/50, time: 63.87 s, training_loss: 0.966
Epoch   15/50, time: 11.05 s, val_loss: 0.971
Epoch   16/50, time: 61.92 s, training_loss: 0.965
Epoch   16/50, time: 10.68 s, val_loss: 0.965
Epoch   17/50, time: 55.91 s, training_loss: 0.961
Epoch   17/50, time: 12.51 s, val_loss: 0.967
Epoch   18/50, time: 52.68 s, training_loss: 0.959
Epoch   18/50, time: 10.88 s, val_loss: 0.971
Epoch   19/50, time: 61.50 s, training_loss: 0.958
Epoch   19/50, time: 12.96 s, val_loss: 0.971
Epoch   20/50, time: 60.66 s, training_loss: 0.957
Epoch   20/50, time: 12.75 s, val_loss: 0.968
Epoch   21/50, time: 52.52 s, training_loss: 0.956
Epoch   21/50, time: 11.09 s, val_loss: 0.913
Training Metrics:
Accuracy: 0.0826
Precision: 0.2561
Recall: 0.4311
F1 Score: 0.0529
IoU: 0.0131
Dice Coefficient: 0.0217
Validation Metrics:
Accuracy: 0.0895
Precision: 0.2549
Recall: 0.4213
F1 Score: 0.0553
IoU: 0.0123
Dice Coefficient: 0.0204
Epoch   22/50, time: 62.66 s, training_loss: 0.953
Epoch   22/50, time: 12.07 s, val_loss: 0.978
Epoch   23/50, time: 60.91 s, training_loss: 0.950
Epoch   23/50, time: 11.08 s, val_loss: 0.939
Epoch   24/50, time: 60.63 s, training_loss: 0.949
Epoch   24/50, time: 13.02 s, val_loss: 0.918
Epoch   25/50, time: 52.63 s, training_loss: 0.947
Epoch   25/50, time: 12.59 s, val_loss: 0.934
Epoch   26/50, time: 60.40 s, training_loss: 0.943
Epoch   26/50, time: 11.01 s, val_loss: 0.976
Epoch   27/50, time: 53.33 s, training_loss: 0.941
Epoch   27/50, time: 12.59 s, val_loss: 0.931
Epoch   28/50, time: 63.69 s, training_loss: 0.940
Epoch   28/50, time: 10.76 s, val_loss: 0.927
Epoch   29/50, time: 52.64 s, training_loss: 0.936
Epoch   29/50, time: 12.48 s, val_loss: 0.946
Epoch   30/50, time: 52.65 s, training_loss: 0.933
Epoch   30/50, time: 12.92 s, val_loss: 0.930
Epoch   31/50, time: 62.79 s, training_loss: 0.930
Epoch   31/50, time: 12.63 s, val_loss: 0.904
Training Metrics:
Accuracy: 0.0688
Precision: 0.2548
Recall: 0.4595
F1 Score: 0.0395
IoU: 0.0137
Dice Coefficient: 0.0179
Validation Metrics:
Accuracy: 0.0643
Precision: 0.2550
Recall: 0.4675
F1 Score: 0.0384
IoU: 0.0131
Dice Coefficient: 0.0173
Epoch   32/50, time: 53.04 s, training_loss: 0.926
Epoch   32/50, time: 10.73 s, val_loss: 0.911
Epoch   33/50, time: 54.67 s, training_loss: 0.922
Epoch   33/50, time: 12.69 s, val_loss: 0.937
Epoch   34/50, time: 54.92 s, training_loss: 0.921
Epoch   34/50, time: 11.03 s, val_loss: 0.894
Epoch   35/50, time: 55.46 s, training_loss: 0.920
Epoch   35/50, time: 12.41 s, val_loss: 0.901
Epoch   36/50, time: 56.89 s, training_loss: 0.919
Epoch   36/50, time: 10.92 s, val_loss: 0.874
Epoch   37/50, time: 55.51 s, training_loss: 0.911
Epoch   37/50, time: 11.57 s, val_loss: 0.911
Epoch   38/50, time: 61.55 s, training_loss: 0.907
Epoch   38/50, time: 12.67 s, val_loss: 0.863
Epoch   39/50, time: 63.96 s, training_loss: 0.903
Epoch   39/50, time: 12.57 s, val_loss: 0.895
Epoch   40/50, time: 64.70 s, training_loss: 0.901
Epoch   40/50, time: 12.80 s, val_loss: 0.879
Epoch   41/50, time: 54.50 s, training_loss: 0.899
Epoch   41/50, time: 10.98 s, val_loss: 0.933
Training Metrics:
Accuracy: 0.0773
Precision: 0.2571
Recall: 0.3476
F1 Score: 0.0461
IoU: 0.0140
Dice Coefficient: 0.0143
Validation Metrics:
Accuracy: 0.0871
Precision: 0.2570
Recall: 0.3554
F1 Score: 0.0504
IoU: 0.0136
Dice Coefficient: 0.0135
Epoch   42/50, time: 59.58 s, training_loss: 0.895
Epoch   42/50, time: 12.55 s, val_loss: 0.860
Epoch   43/50, time: 62.02 s, training_loss: 0.890
Epoch   43/50, time: 12.95 s, val_loss: 0.900
Epoch   44/50, time: 59.55 s, training_loss: 0.889
Epoch   44/50, time: 10.89 s, val_loss: 0.921
Epoch   45/50, time: 53.03 s, training_loss: 0.883
Epoch   45/50, time: 10.79 s, val_loss: 0.875
Epoch   46/50, time: 64.34 s, training_loss: 0.876
Epoch   46/50, time: 10.95 s, val_loss: 0.867
Epoch   47/50, time: 62.25 s, training_loss: 0.879
Epoch   47/50, time: 11.08 s, val_loss: 0.903
Epoch   48/50, time: 61.97 s, training_loss: 0.874
Epoch   48/50, time: 10.30 s, val_loss: 0.884
Epoch   49/50, time: 59.27 s, training_loss: 0.866
Epoch   49/50, time: 11.17 s, val_loss: 0.903
Epoch   50/50, time: 54.29 s, training_loss: 0.875
Epoch   50/50, time: 11.13 s, val_loss: 0.863
Training Metrics:
Accuracy: 0.2086
Precision: 0.2565
Recall: 0.4023
F1 Score: 0.0975
IoU: 0.0160
Dice Coefficient: 0.0243
Validation Metrics:
Accuracy: 0.1919
Precision: 0.2564
Recall: 0.4113
F1 Score: 0.0914
IoU: 0.0152
Dice Coefficient: 0.0226
[I 2025-06-15 05:25:36,483] Trial 8 finished with value: 0.022617004689334856 and parameters: {'batch_size': 128, 'lr': 0.00017904575222251644, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.1919
Precision: 0.2564
Recall: 0.4113
F1 Score: 0.0914
IoU: 0.0152
Dice Coefficient: 0.0226
[Trial 8] Finished with val_loss=inf
[Trial 8] Finished with dice_coeff=0.022617004689334856
[Trial 9] Trying batch_size=128, lr=0.00010510368670679463, loss_fn=dice_loss
Epoch    1/50, time: 62.16 s, training_loss: 0.985
Epoch    1/50, time: 10.94 s, val_loss: 0.991
Training Metrics:
Accuracy: 0.0248
Precision: 0.2308
Recall: 0.2361
F1 Score: 0.0171
IoU: 0.0104
Dice Coefficient: 0.0070
Validation Metrics:
Accuracy: 0.0430
Precision: 0.2240
Recall: 0.2244
F1 Score: 0.0257
IoU: 0.0076
Dice Coefficient: 0.0051
Epoch    2/50, time: 55.45 s, training_loss: 0.981
Epoch    2/50, time: 10.77 s, val_loss: 0.985
Epoch    3/50, time: 53.83 s, training_loss: 0.979
Epoch    3/50, time: 10.80 s, val_loss: 0.982
Epoch    4/50, time: 62.77 s, training_loss: 0.977
Epoch    4/50, time: 12.47 s, val_loss: 0.978
Epoch    5/50, time: 52.65 s, training_loss: 0.976
Epoch    5/50, time: 12.75 s, val_loss: 0.975
Epoch    6/50, time: 55.19 s, training_loss: 0.973
Epoch    6/50, time: 12.50 s, val_loss: 0.972
Epoch    7/50, time: 51.98 s, training_loss: 0.972
Epoch    7/50, time: 11.16 s, val_loss: 0.973
Epoch    8/50, time: 61.11 s, training_loss: 0.970
Epoch    8/50, time: 10.78 s, val_loss: 0.967
Epoch    9/50, time: 54.20 s, training_loss: 0.967
Epoch    9/50, time: 12.47 s, val_loss: 0.955
Epoch   10/50, time: 53.70 s, training_loss: 0.966
Epoch   10/50, time: 12.74 s, val_loss: 0.959
Epoch   11/50, time: 53.11 s, training_loss: 0.964
Epoch   11/50, time: 10.52 s, val_loss: 0.953
Training Metrics:
Accuracy: 0.2071
Precision: 0.2813
Recall: 0.3304
F1 Score: 0.1443
IoU: 0.0085
Dice Coefficient: 0.0081
Validation Metrics:
Accuracy: 0.2168
Precision: 0.2864
Recall: 0.4394
F1 Score: 0.1539
IoU: 0.0125
Dice Coefficient: 0.0119
Epoch   12/50, time: 61.07 s, training_loss: 0.961
Epoch   12/50, time: 12.53 s, val_loss: 0.962
Epoch   13/50, time: 62.54 s, training_loss: 0.961
Epoch   13/50, time: 10.89 s, val_loss: 0.945
Epoch   14/50, time: 50.21 s, training_loss: 0.957
Epoch   14/50, time: 12.81 s, val_loss: 0.909
Epoch   15/50, time: 51.75 s, training_loss: 0.955
Epoch   15/50, time: 12.58 s, val_loss: 0.936
Epoch   16/50, time: 55.16 s, training_loss: 0.953
Epoch   16/50, time: 11.08 s, val_loss: 0.913
Epoch   17/50, time: 55.92 s, training_loss: 0.949
Epoch   17/50, time: 12.44 s, val_loss: 0.911
Epoch   18/50, time: 61.06 s, training_loss: 0.948
Epoch   18/50, time: 10.97 s, val_loss: 0.911
Epoch   19/50, time: 62.55 s, training_loss: 0.945
Epoch   19/50, time: 12.16 s, val_loss: 0.928
Epoch   20/50, time: 52.90 s, training_loss: 0.944
Epoch   20/50, time: 10.85 s, val_loss: 0.890
Epoch   21/50, time: 63.36 s, training_loss: 0.939
Epoch   21/50, time: 10.99 s, val_loss: 0.902
Training Metrics:
Accuracy: 0.2669
Precision: 0.2859
Recall: 0.2707
F1 Score: 0.1638
IoU: 0.0065
Dice Coefficient: 0.0058
Validation Metrics:
Accuracy: 0.2678
Precision: 0.2897
Recall: 0.4180
F1 Score: 0.1745
IoU: 0.0114
Dice Coefficient: 0.0095
Epoch   22/50, time: 54.39 s, training_loss: 0.938
Epoch   22/50, time: 12.80 s, val_loss: 0.896
Epoch   23/50, time: 52.16 s, training_loss: 0.936
Epoch   23/50, time: 11.09 s, val_loss: 0.882
Epoch   24/50, time: 53.65 s, training_loss: 0.933
Epoch   24/50, time: 12.71 s, val_loss: 0.874
Epoch   25/50, time: 59.06 s, training_loss: 0.930
Epoch   25/50, time: 12.61 s, val_loss: 0.864
Epoch   26/50, time: 53.17 s, training_loss: 0.927
Epoch   26/50, time: 12.58 s, val_loss: 0.885
Epoch   27/50, time: 62.08 s, training_loss: 0.926
Epoch   27/50, time: 12.70 s, val_loss: 0.890
Epoch   28/50, time: 62.42 s, training_loss: 0.923
Epoch   28/50, time: 10.82 s, val_loss: 0.869
Epoch   29/50, time: 54.04 s, training_loss: 0.920
Epoch   29/50, time: 10.90 s, val_loss: 0.841
Epoch   30/50, time: 61.28 s, training_loss: 0.916
Epoch   30/50, time: 12.65 s, val_loss: 0.855
Epoch   31/50, time: 54.04 s, training_loss: 0.912
Epoch   31/50, time: 11.02 s, val_loss: 0.817
Training Metrics:
Accuracy: 0.2988
Precision: 0.2899
Recall: 0.3426
F1 Score: 0.1785
IoU: 0.0082
Dice Coefficient: 0.0072
Validation Metrics:
Accuracy: 0.3450
Precision: 0.2946
Recall: 0.5332
F1 Score: 0.2031
IoU: 0.0154
Dice Coefficient: 0.0121
Epoch   32/50, time: 63.02 s, training_loss: 0.910
Epoch   32/50, time: 10.73 s, val_loss: 0.843
Epoch   33/50, time: 53.97 s, training_loss: 0.911
Epoch   33/50, time: 10.93 s, val_loss: 0.827
Epoch   34/50, time: 61.35 s, training_loss: 0.905
Epoch   34/50, time: 10.91 s, val_loss: 0.863
Epoch   35/50, time: 53.82 s, training_loss: 0.903
Epoch   35/50, time: 12.73 s, val_loss: 0.844
Epoch   36/50, time: 62.76 s, training_loss: 0.903
Epoch   36/50, time: 12.68 s, val_loss: 0.785
Epoch   37/50, time: 56.40 s, training_loss: 0.898
Epoch   37/50, time: 10.90 s, val_loss: 0.871
Epoch   38/50, time: 55.46 s, training_loss: 0.896
Epoch   38/50, time: 10.96 s, val_loss: 0.797
Epoch   39/50, time: 62.53 s, training_loss: 0.899
Epoch   39/50, time: 10.90 s, val_loss: 0.837
Epoch   40/50, time: 55.70 s, training_loss: 0.894
Epoch   40/50, time: 11.03 s, val_loss: 0.814
Epoch   41/50, time: 53.19 s, training_loss: 0.889
Epoch   41/50, time: 12.54 s, val_loss: 0.804
Training Metrics:
Accuracy: 0.4038
Precision: 0.2925
Recall: 0.3320
F1 Score: 0.2085
IoU: 0.0088
Dice Coefficient: 0.0077
Validation Metrics:
Accuracy: 0.4264
Precision: 0.2967
Recall: 0.5446
F1 Score: 0.2274
IoU: 0.0170
Dice Coefficient: 0.0132
Epoch   42/50, time: 53.85 s, training_loss: 0.881
Epoch   42/50, time: 10.99 s, val_loss: 0.793
Epoch   43/50, time: 56.41 s, training_loss: 0.880
Epoch   43/50, time: 10.72 s, val_loss: 0.799
Epoch   44/50, time: 53.96 s, training_loss: 0.880
Epoch   44/50, time: 12.62 s, val_loss: 0.831
Epoch   45/50, time: 62.78 s, training_loss: 0.882
Epoch   45/50, time: 12.68 s, val_loss: 0.775
Epoch   46/50, time: 53.19 s, training_loss: 0.873
Epoch   46/50, time: 12.54 s, val_loss: 0.788
Epoch   47/50, time: 53.66 s, training_loss: 0.872
Epoch   47/50, time: 12.64 s, val_loss: 0.765
Epoch   48/50, time: 60.71 s, training_loss: 0.876
Epoch   48/50, time: 12.94 s, val_loss: 0.832
Epoch   49/50, time: 52.82 s, training_loss: 0.872
Epoch   49/50, time: 13.22 s, val_loss: 0.771
Epoch   50/50, time: 62.18 s, training_loss: 0.866
Epoch   50/50, time: 11.51 s, val_loss: 0.731
Training Metrics:
Accuracy: 0.2721
Precision: 0.3015
Recall: 0.3522
F1 Score: 0.1797
IoU: 0.0081
Dice Coefficient: 0.0067
Validation Metrics:
Accuracy: 0.2061
Precision: 0.3070
Recall: 0.5677
F1 Score: 0.1756
IoU: 0.0139
Dice Coefficient: 0.0101
[I 2025-06-15 06:31:54,227] Trial 9 finished with value: 0.010100888032401707 and parameters: {'batch_size': 128, 'lr': 0.00010510368670679463, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.2061
Precision: 0.3070
Recall: 0.5677
F1 Score: 0.1756
IoU: 0.0139
Dice Coefficient: 0.0101
[Trial 9] Finished with val_loss=inf
[Trial 9] Finished with dice_coeff=0.010100888032401707
[Trial 10] Trying batch_size=32, lr=0.00023746608671136016, loss_fn=dice_loss
Epoch    1/50, time: 44.33 s, training_loss: 0.982
Epoch    1/50, time: 12.56 s, val_loss: 0.983
Training Metrics:
Accuracy: 0.0623
Precision: 0.2625
Recall: 0.3163
F1 Score: 0.0526
IoU: 0.0135
Dice Coefficient: 0.0146
Validation Metrics:
Accuracy: 0.0866
Precision: 0.2672
Recall: 0.3656
F1 Score: 0.0735
IoU: 0.0129
Dice Coefficient: 0.0135
Epoch    2/50, time: 47.25 s, training_loss: 0.976
Epoch    2/50, time: 10.56 s, val_loss: 0.980
Epoch    3/50, time: 46.71 s, training_loss: 0.968
Epoch    3/50, time: 12.59 s, val_loss: 0.937
Epoch    4/50, time: 42.81 s, training_loss: 0.959
Epoch    4/50, time: 10.68 s, val_loss: 0.964
Epoch    5/50, time: 43.98 s, training_loss: 0.948
Epoch    5/50, time: 11.32 s, val_loss: 0.932
Epoch    6/50, time: 45.53 s, training_loss: 0.935
Epoch    6/50, time: 12.70 s, val_loss: 0.899
Epoch    7/50, time: 44.19 s, training_loss: 0.920
Epoch    7/50, time: 12.66 s, val_loss: 0.902
Epoch    8/50, time: 46.11 s, training_loss: 0.908
Epoch    8/50, time: 12.75 s, val_loss: 0.896
Epoch    9/50, time: 43.94 s, training_loss: 0.892
Epoch    9/50, time: 10.78 s, val_loss: 0.925
Epoch   10/50, time: 42.99 s, training_loss: 0.878
Epoch   10/50, time: 13.00 s, val_loss: 0.834
Epoch   11/50, time: 43.93 s, training_loss: 0.866
Epoch   11/50, time: 12.31 s, val_loss: 0.894
Training Metrics:
Accuracy: 0.5394
Precision: 0.3172
Recall: 0.5298
F1 Score: 0.2832
IoU: 0.0265
Dice Coefficient: 0.0270
Validation Metrics:
Accuracy: 0.5402
Precision: 0.3167
Recall: 0.5337
F1 Score: 0.2833
IoU: 0.0254
Dice Coefficient: 0.0258
Epoch   12/50, time: 42.80 s, training_loss: 0.847
Epoch   12/50, time: 12.54 s, val_loss: 0.911
Epoch   13/50, time: 43.88 s, training_loss: 0.831
Epoch   13/50, time: 12.47 s, val_loss: 0.815
Epoch   14/50, time: 45.21 s, training_loss: 0.815
Epoch   14/50, time: 10.86 s, val_loss: 0.787
Epoch   15/50, time: 43.90 s, training_loss: 0.789
Epoch   15/50, time: 10.64 s, val_loss: 0.844
Epoch   16/50, time: 45.93 s, training_loss: 0.771
Epoch   16/50, time: 11.32 s, val_loss: 0.736
Epoch   17/50, time: 45.53 s, training_loss: 0.759
Epoch   17/50, time: 12.43 s, val_loss: 0.794
Epoch   18/50, time: 40.85 s, training_loss: 0.737
Epoch   18/50, time: 10.91 s, val_loss: 0.730
Epoch   19/50, time: 41.68 s, training_loss: 0.723
Epoch   19/50, time: 12.86 s, val_loss: 0.732
Epoch   20/50, time: 46.85 s, training_loss: 0.690
Epoch   20/50, time: 12.19 s, val_loss: 0.673
Epoch   21/50, time: 45.79 s, training_loss: 0.670
Epoch   21/50, time: 11.02 s, val_loss: 0.650
Training Metrics:
Accuracy: 0.8184
Precision: 0.3295
Recall: 0.6088
F1 Score: 0.3533
IoU: 0.0582
Dice Coefficient: 0.0580
Validation Metrics:
Accuracy: 0.7947
Precision: 0.3259
Recall: 0.6056
F1 Score: 0.3458
IoU: 0.0506
Dice Coefficient: 0.0509
Epoch   22/50, time: 43.19 s, training_loss: 0.654
Epoch   22/50, time: 12.84 s, val_loss: 0.651
Epoch   23/50, time: 43.96 s, training_loss: 0.625
Epoch   23/50, time: 11.14 s, val_loss: 0.572
Epoch   24/50, time: 44.40 s, training_loss: 0.608
Epoch   24/50, time: 12.67 s, val_loss: 0.614
Epoch   25/50, time: 44.29 s, training_loss: 0.583
Epoch   25/50, time: 11.16 s, val_loss: 0.561
Epoch   26/50, time: 46.50 s, training_loss: 0.560
Epoch   26/50, time: 12.59 s, val_loss: 0.546
Epoch   27/50, time: 44.54 s, training_loss: 0.549
Epoch   27/50, time: 12.42 s, val_loss: 0.543
Epoch   28/50, time: 45.27 s, training_loss: 0.529
Epoch   28/50, time: 10.98 s, val_loss: 0.479
Epoch   29/50, time: 43.80 s, training_loss: 0.514
Epoch   29/50, time: 12.49 s, val_loss: 0.497
Epoch   30/50, time: 43.05 s, training_loss: 0.501
Epoch   30/50, time: 10.84 s, val_loss: 0.555
Epoch   31/50, time: 45.63 s, training_loss: 0.482
Epoch   31/50, time: 12.52 s, val_loss: 0.476
Training Metrics:
Accuracy: 0.8596
Precision: 0.3374
Recall: 0.6486
F1 Score: 0.3709
IoU: 0.0764
Dice Coefficient: 0.0847
Validation Metrics:
Accuracy: 0.8383
Precision: 0.3270
Recall: 0.6432
F1 Score: 0.3541
IoU: 0.0648
Dice Coefficient: 0.0719
Epoch   32/50, time: 45.93 s, training_loss: 0.480
Epoch   32/50, time: 12.65 s, val_loss: 0.487
Epoch   33/50, time: 46.34 s, training_loss: 0.471
Epoch   33/50, time: 10.65 s, val_loss: 0.482
Epoch   34/50, time: 44.30 s, training_loss: 0.459
Epoch   34/50, time: 12.66 s, val_loss: 0.423
Epoch   35/50, time: 42.93 s, training_loss: 0.449
Epoch   35/50, time: 12.66 s, val_loss: 0.479
Epoch   36/50, time: 42.83 s, training_loss: 0.449
Epoch   36/50, time: 11.11 s, val_loss: 0.466
Epoch   37/50, time: 46.50 s, training_loss: 0.428
Epoch   37/50, time: 10.79 s, val_loss: 0.423
Epoch   38/50, time: 45.49 s, training_loss: 0.431
Epoch   38/50, time: 12.35 s, val_loss: 0.430
Epoch   39/50, time: 44.80 s, training_loss: 0.463
Epoch   39/50, time: 12.73 s, val_loss: 0.441
Epoch   40/50, time: 47.73 s, training_loss: 0.434
Epoch   40/50, time: 12.71 s, val_loss: 0.416
Epoch   41/50, time: 45.72 s, training_loss: 0.468
Epoch   41/50, time: 12.60 s, val_loss: 0.449
Training Metrics:
Accuracy: 0.8878
Precision: 0.3185
Recall: 0.6110
F1 Score: 0.3516
IoU: 0.0858
Dice Coefficient: 0.0989
Validation Metrics:
Accuracy: 0.8573
Precision: 0.3111
Recall: 0.6116
F1 Score: 0.3369
IoU: 0.0668
Dice Coefficient: 0.0736
Epoch   42/50, time: 46.95 s, training_loss: 0.440
Epoch   42/50, time: 12.76 s, val_loss: 0.419
Epoch   43/50, time: 47.59 s, training_loss: 0.411
Epoch   43/50, time: 10.77 s, val_loss: 0.389
Epoch   44/50, time: 43.97 s, training_loss: 0.403
Epoch   44/50, time: 12.83 s, val_loss: 0.413
Epoch   45/50, time: 46.44 s, training_loss: 0.402
Epoch   45/50, time: 10.59 s, val_loss: 0.399
Epoch   46/50, time: 45.15 s, training_loss: 0.419
Epoch   46/50, time: 11.27 s, val_loss: 0.415
Epoch   47/50, time: 42.42 s, training_loss: 0.401
Epoch   47/50, time: 10.97 s, val_loss: 0.394
Epoch   48/50, time: 46.26 s, training_loss: 0.399
Epoch   48/50, time: 12.58 s, val_loss: 0.401
Epoch   49/50, time: 41.66 s, training_loss: 0.390
Epoch   49/50, time: 11.20 s, val_loss: 0.396
Epoch   50/50, time: 43.34 s, training_loss: 0.424
Epoch   50/50, time: 12.74 s, val_loss: 0.401
Training Metrics:
Accuracy: 0.6757
Precision: 0.3292
Recall: 0.5731
F1 Score: 0.3337
IoU: 0.0330
Dice Coefficient: 0.0335
Validation Metrics:
Accuracy: 0.6549
Precision: 0.3233
Recall: 0.5744
F1 Score: 0.3214
IoU: 0.0303
Dice Coefficient: 0.0306
[I 2025-06-15 07:26:34,120] Trial 10 finished with value: 0.030631959266342785 and parameters: {'batch_size': 32, 'lr': 0.00023746608671136016, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.6549
Precision: 0.3233
Recall: 0.5744
F1 Score: 0.3214
IoU: 0.0303
Dice Coefficient: 0.0306
[Trial 10] Finished with val_loss=inf
[Trial 10] Finished with dice_coeff=0.030631959266342785
[Trial 11] Trying batch_size=16, lr=0.000353796155897648, loss_fn=dice_loss
Epoch    1/50, time: 41.91 s, training_loss: 0.971
Epoch    1/50, time: 12.24 s, val_loss: 0.989
Training Metrics:
Accuracy: 0.4102
Precision: 0.2491
Recall: 0.1757
F1 Score: 0.1553
IoU: 0.0040
Dice Coefficient: 0.0033
Validation Metrics:
Accuracy: 0.6388
Precision: 0.2453
Recall: 0.1626
F1 Score: 0.1951
IoU: 0.0001
Dice Coefficient: 0.0001
Epoch    2/50, time: 43.39 s, training_loss: 0.951
Epoch    2/50, time: 13.03 s, val_loss: 0.989
Epoch    3/50, time: 43.33 s, training_loss: 0.940
Epoch    3/50, time: 12.44 s, val_loss: 0.990
Epoch    4/50, time: 41.27 s, training_loss: 0.916
Epoch    4/50, time: 12.83 s, val_loss: 0.989
Epoch    5/50, time: 41.35 s, training_loss: 0.894
Epoch    5/50, time: 10.88 s, val_loss: 0.945
Epoch    6/50, time: 41.72 s, training_loss: 0.868
Epoch    6/50, time: 12.84 s, val_loss: 0.886
Epoch    7/50, time: 40.67 s, training_loss: 0.842
Epoch    7/50, time: 11.87 s, val_loss: 0.823
Epoch    8/50, time: 43.66 s, training_loss: 0.820
Epoch    8/50, time: 10.45 s, val_loss: 0.773
Epoch    9/50, time: 40.62 s, training_loss: 0.789
Epoch    9/50, time: 12.02 s, val_loss: 0.747
Epoch   10/50, time: 41.05 s, training_loss: 0.777
Epoch   10/50, time: 10.31 s, val_loss: 0.745
Epoch   11/50, time: 40.06 s, training_loss: 0.752
Epoch   11/50, time: 10.20 s, val_loss: 0.736
Training Metrics:
Accuracy: 0.4414
Precision: 0.2563
Recall: 0.3956
F1 Score: 0.1652
IoU: 0.0212
Dice Coefficient: 0.0348
Validation Metrics:
Accuracy: 0.7336
Precision: 0.2638
Recall: 0.4848
F1 Score: 0.2381
IoU: 0.0420
Dice Coefficient: 0.0652
Epoch   12/50, time: 39.93 s, training_loss: 0.739
Epoch   12/50, time: 10.84 s, val_loss: 0.723
Epoch   13/50, time: 42.62 s, training_loss: 0.727
Epoch   13/50, time: 12.48 s, val_loss: 0.717
Epoch   14/50, time: 42.07 s, training_loss: 0.714
Epoch   14/50, time: 10.62 s, val_loss: 0.705
Epoch   15/50, time: 42.27 s, training_loss: 0.694
Epoch   15/50, time: 12.85 s, val_loss: 0.678
Epoch   16/50, time: 41.04 s, training_loss: 0.670
Epoch   16/50, time: 10.90 s, val_loss: 0.654
Epoch   17/50, time: 43.27 s, training_loss: 0.651
Epoch   17/50, time: 10.72 s, val_loss: 0.621
Epoch   18/50, time: 41.80 s, training_loss: 0.631
Epoch   18/50, time: 12.29 s, val_loss: 0.618
Epoch   19/50, time: 41.83 s, training_loss: 0.607
Epoch   19/50, time: 12.65 s, val_loss: 0.585
Epoch   20/50, time: 42.26 s, training_loss: 0.587
Epoch   20/50, time: 11.09 s, val_loss: 0.559
Epoch   21/50, time: 40.52 s, training_loss: 0.566
Epoch   21/50, time: 12.45 s, val_loss: 0.539
Training Metrics:
Accuracy: 0.2779
Precision: 0.2547
Recall: 0.3347
F1 Score: 0.1171
IoU: 0.0168
Dice Coefficient: 0.0277
Validation Metrics:
Accuracy: 0.2490
Precision: 0.2545
Recall: 0.3274
F1 Score: 0.1080
IoU: 0.0153
Dice Coefficient: 0.0250
Epoch   22/50, time: 41.33 s, training_loss: 0.549
Epoch   22/50, time: 10.40 s, val_loss: 0.538
Epoch   23/50, time: 41.40 s, training_loss: 0.533
Epoch   23/50, time: 12.72 s, val_loss: 0.512
Epoch   24/50, time: 41.14 s, training_loss: 0.519
Epoch   24/50, time: 12.34 s, val_loss: 0.508
Epoch   25/50, time: 41.65 s, training_loss: 0.504
Epoch   25/50, time: 12.37 s, val_loss: 0.507
Epoch   26/50, time: 41.82 s, training_loss: 0.502
Epoch   26/50, time: 12.53 s, val_loss: 0.494
Epoch   27/50, time: 41.91 s, training_loss: 0.481
Epoch   27/50, time: 13.03 s, val_loss: 0.481
Epoch   28/50, time: 40.51 s, training_loss: 0.474
Epoch   28/50, time: 10.65 s, val_loss: 0.495
Epoch   29/50, time: 43.26 s, training_loss: 0.471
Epoch   29/50, time: 10.89 s, val_loss: 0.450
Epoch   30/50, time: 40.72 s, training_loss: 0.451
Epoch   30/50, time: 12.40 s, val_loss: 0.465
Epoch   31/50, time: 41.55 s, training_loss: 0.447
Epoch   31/50, time: 10.66 s, val_loss: 0.455
Training Metrics:
Accuracy: 0.2470
Precision: 0.2543
Recall: 0.3530
F1 Score: 0.1077
IoU: 0.0158
Dice Coefficient: 0.0259
Validation Metrics:
Accuracy: 0.2558
Precision: 0.2547
Recall: 0.3572
F1 Score: 0.1116
IoU: 0.0151
Dice Coefficient: 0.0248
Epoch   32/50, time: 43.12 s, training_loss: 0.448
Epoch   32/50, time: 12.53 s, val_loss: 0.456
Epoch   33/50, time: 41.01 s, training_loss: 0.437
Epoch   33/50, time: 12.60 s, val_loss: 0.432
Epoch   34/50, time: 42.79 s, training_loss: 0.426
Epoch   34/50, time: 12.76 s, val_loss: 0.447
Epoch   35/50, time: 41.25 s, training_loss: 0.425
Epoch   35/50, time: 10.76 s, val_loss: 0.432
Epoch   36/50, time: 41.76 s, training_loss: 0.420
Epoch   36/50, time: 12.68 s, val_loss: 0.411
Epoch   37/50, time: 43.00 s, training_loss: 0.420
Epoch   37/50, time: 12.55 s, val_loss: 0.431
Epoch   38/50, time: 40.40 s, training_loss: 0.412
Epoch   38/50, time: 10.91 s, val_loss: 0.413
Epoch   39/50, time: 42.02 s, training_loss: 0.409
Epoch   39/50, time: 12.54 s, val_loss: 0.430
Epoch   40/50, time: 43.73 s, training_loss: 0.409
Epoch   40/50, time: 10.71 s, val_loss: 0.394
Epoch   41/50, time: 41.42 s, training_loss: 0.403
Epoch   41/50, time: 12.67 s, val_loss: 0.421
Training Metrics:
Accuracy: 0.3326
Precision: 0.2544
Recall: 0.3659
F1 Score: 0.1341
IoU: 0.0175
Dice Coefficient: 0.0272
Validation Metrics:
Accuracy: 0.3314
Precision: 0.2543
Recall: 0.3653
F1 Score: 0.1337
IoU: 0.0165
Dice Coefficient: 0.0258
Epoch   42/50, time: 43.02 s, training_loss: 0.394
Epoch   42/50, time: 10.57 s, val_loss: 0.403
Epoch   43/50, time: 42.02 s, training_loss: 0.395
Epoch   43/50, time: 12.51 s, val_loss: 0.414
Epoch   44/50, time: 42.49 s, training_loss: 0.393
Epoch   44/50, time: 10.77 s, val_loss: 0.377
Epoch   45/50, time: 43.53 s, training_loss: 0.390
Epoch   45/50, time: 12.37 s, val_loss: 0.377
Epoch   46/50, time: 40.61 s, training_loss: 0.381
Epoch   46/50, time: 11.28 s, val_loss: 0.393
Epoch   47/50, time: 40.63 s, training_loss: 0.383
Epoch   47/50, time: 10.46 s, val_loss: 0.397
Epoch   48/50, time: 41.11 s, training_loss: 0.380
Epoch   48/50, time: 11.01 s, val_loss: 0.400
Epoch   49/50, time: 41.60 s, training_loss: 0.380
Epoch   49/50, time: 11.26 s, val_loss: 0.414
Epoch   50/50, time: 41.46 s, training_loss: 0.376
Epoch   50/50, time: 10.71 s, val_loss: 0.377
Training Metrics:
Accuracy: 0.2067
Precision: 0.2534
Recall: 0.3457
F1 Score: 0.0920
IoU: 0.0154
Dice Coefficient: 0.0245
Validation Metrics:
Accuracy: 0.1967
Precision: 0.2530
Recall: 0.3404
F1 Score: 0.0880
IoU: 0.0145
Dice Coefficient: 0.0231
[I 2025-06-15 08:18:27,200] Trial 11 finished with value: 0.023068116727598443 and parameters: {'batch_size': 16, 'lr': 0.000353796155897648, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.1967
Precision: 0.2530
Recall: 0.3404
F1 Score: 0.0880
IoU: 0.0145
Dice Coefficient: 0.0231
[Trial 11] Finished with val_loss=inf
[Trial 11] Finished with dice_coeff=0.023068116727598443
[Trial 12] Trying batch_size=32, lr=0.0004303703543609529, loss_fn=dice_loss
Epoch    1/50, time: 44.33 s, training_loss: 0.978
Epoch    1/50, time: 12.59 s, val_loss: 0.949
Training Metrics:
Accuracy: 0.0560
Precision: 0.2486
Recall: 0.2762
F1 Score: 0.0308
IoU: 0.0127
Dice Coefficient: 0.0148
Validation Metrics:
Accuracy: 0.0924
Precision: 0.2481
Recall: 0.2977
F1 Score: 0.0460
IoU: 0.0118
Dice Coefficient: 0.0187
Epoch    2/50, time: 43.28 s, training_loss: 0.963
Epoch    2/50, time: 12.60 s, val_loss: 0.959
Epoch    3/50, time: 44.81 s, training_loss: 0.946
Epoch    3/50, time: 10.89 s, val_loss: 0.872
Epoch    4/50, time: 44.78 s, training_loss: 0.930
Epoch    4/50, time: 11.17 s, val_loss: 0.852
Epoch    5/50, time: 45.58 s, training_loss: 0.918
Epoch    5/50, time: 10.72 s, val_loss: 0.855
Epoch    6/50, time: 42.77 s, training_loss: 0.901
Epoch    6/50, time: 12.41 s, val_loss: 0.793
Epoch    7/50, time: 45.39 s, training_loss: 0.878
Epoch    7/50, time: 10.69 s, val_loss: 0.813
Epoch    8/50, time: 42.84 s, training_loss: 0.857
Epoch    8/50, time: 10.81 s, val_loss: 0.789
Epoch    9/50, time: 44.28 s, training_loss: 0.848
Epoch    9/50, time: 10.83 s, val_loss: 0.768
Epoch   10/50, time: 44.06 s, training_loss: 0.827
Epoch   10/50, time: 11.09 s, val_loss: 0.746
Epoch   11/50, time: 45.28 s, training_loss: 0.823
Epoch   11/50, time: 10.72 s, val_loss: 0.735
Training Metrics:
Accuracy: 0.1856
Precision: 0.2858
Recall: 0.4411
F1 Score: 0.1387
IoU: 0.0149
Dice Coefficient: 0.0103
Validation Metrics:
Accuracy: 0.2632
Precision: 0.2888
Recall: 0.4789
F1 Score: 0.1702
IoU: 0.0157
Dice Coefficient: 0.0109
Epoch   12/50, time: 44.54 s, training_loss: 0.802
Epoch   12/50, time: 10.85 s, val_loss: 0.745
Epoch   13/50, time: 45.37 s, training_loss: 0.789
Epoch   13/50, time: 10.69 s, val_loss: 0.733
Epoch   14/50, time: 45.42 s, training_loss: 0.773
Epoch   14/50, time: 12.60 s, val_loss: 0.709
Epoch   15/50, time: 42.57 s, training_loss: 0.764
Epoch   15/50, time: 11.29 s, val_loss: 0.680
Epoch   16/50, time: 46.24 s, training_loss: 0.737
Epoch   16/50, time: 10.91 s, val_loss: 0.717
Epoch   17/50, time: 47.09 s, training_loss: 0.715
Epoch   17/50, time: 11.12 s, val_loss: 0.681
Epoch   18/50, time: 42.71 s, training_loss: 0.694
Epoch   18/50, time: 12.54 s, val_loss: 0.675
Epoch   19/50, time: 46.82 s, training_loss: 0.690
Epoch   19/50, time: 10.84 s, val_loss: 0.646
Epoch   20/50, time: 44.26 s, training_loss: 0.649
Epoch   20/50, time: 12.65 s, val_loss: 0.640
Epoch   21/50, time: 44.17 s, training_loss: 0.637
Epoch   21/50, time: 12.75 s, val_loss: 0.846
Training Metrics:
Accuracy: 0.2428
Precision: 0.2642
Recall: 0.4284
F1 Score: 0.1251
IoU: 0.0154
Dice Coefficient: 0.0115
Validation Metrics:
Accuracy: 0.2729
Precision: 0.2635
Recall: 0.4286
F1 Score: 0.1331
IoU: 0.0156
Dice Coefficient: 0.0118
Epoch   22/50, time: 42.13 s, training_loss: 0.625
Epoch   22/50, time: 12.47 s, val_loss: 0.626
Epoch   23/50, time: 43.42 s, training_loss: 0.589
Epoch   23/50, time: 10.81 s, val_loss: 0.565
Epoch   24/50, time: 43.78 s, training_loss: 0.572
Epoch   24/50, time: 12.53 s, val_loss: 0.552
Epoch   25/50, time: 45.16 s, training_loss: 0.560
Epoch   25/50, time: 12.29 s, val_loss: 0.530
Epoch   26/50, time: 43.71 s, training_loss: 0.553
Epoch   26/50, time: 11.25 s, val_loss: 0.530
Epoch   27/50, time: 45.08 s, training_loss: 0.538
Epoch   27/50, time: 10.65 s, val_loss: 0.539
Epoch   28/50, time: 41.56 s, training_loss: 0.539
Epoch   28/50, time: 12.91 s, val_loss: 0.517
Epoch   29/50, time: 44.76 s, training_loss: 0.525
Epoch   29/50, time: 10.89 s, val_loss: 0.506
Epoch   30/50, time: 45.33 s, training_loss: 0.511
Epoch   30/50, time: 11.03 s, val_loss: 0.476
Epoch   31/50, time: 42.98 s, training_loss: 0.501
Epoch   31/50, time: 12.82 s, val_loss: 0.546
Training Metrics:
Accuracy: 0.1967
Precision: 0.2604
Recall: 0.4138
F1 Score: 0.1032
IoU: 0.0144
Dice Coefficient: 0.0123
Validation Metrics:
Accuracy: 0.2288
Precision: 0.2600
Recall: 0.4244
F1 Score: 0.1132
IoU: 0.0144
Dice Coefficient: 0.0126
Epoch   32/50, time: 44.70 s, training_loss: 0.506
Epoch   32/50, time: 10.64 s, val_loss: 0.505
Epoch   33/50, time: 44.16 s, training_loss: 0.500
Epoch   33/50, time: 10.80 s, val_loss: 0.478
Epoch   34/50, time: 42.49 s, training_loss: 0.483
Epoch   34/50, time: 11.05 s, val_loss: 0.480
Epoch   35/50, time: 43.20 s, training_loss: 0.483
Epoch   35/50, time: 11.38 s, val_loss: 0.476
Epoch   36/50, time: 44.21 s, training_loss: 0.470
Epoch   36/50, time: 10.96 s, val_loss: 0.452
Epoch   37/50, time: 46.16 s, training_loss: 0.468
Epoch   37/50, time: 11.18 s, val_loss: 0.462
Epoch   38/50, time: 45.62 s, training_loss: 0.464
Epoch   38/50, time: 11.30 s, val_loss: 0.474
Epoch   39/50, time: 45.10 s, training_loss: 0.461
Epoch   39/50, time: 12.38 s, val_loss: 0.445
Epoch   40/50, time: 44.76 s, training_loss: 0.455
Epoch   40/50, time: 10.95 s, val_loss: 0.464
Epoch   41/50, time: 46.16 s, training_loss: 0.447
Epoch   41/50, time: 10.66 s, val_loss: 0.431
Training Metrics:
Accuracy: 0.3552
Precision: 0.2618
Recall: 0.4631
F1 Score: 0.1543
IoU: 0.0177
Dice Coefficient: 0.0150
Validation Metrics:
Accuracy: 0.3719
Precision: 0.2612
Recall: 0.4563
F1 Score: 0.1578
IoU: 0.0173
Dice Coefficient: 0.0147
Epoch   42/50, time: 45.72 s, training_loss: 0.432
Epoch   42/50, time: 12.64 s, val_loss: 0.429
Epoch   43/50, time: 44.74 s, training_loss: 0.428
Epoch   43/50, time: 12.80 s, val_loss: 0.426
Epoch   44/50, time: 44.78 s, training_loss: 0.421
Epoch   44/50, time: 10.85 s, val_loss: 0.434
Epoch   45/50, time: 46.30 s, training_loss: 0.423
Epoch   45/50, time: 12.67 s, val_loss: 0.429
Epoch   46/50, time: 42.38 s, training_loss: 0.414
Epoch   46/50, time: 10.93 s, val_loss: 0.414
Epoch   47/50, time: 45.88 s, training_loss: 0.417
Epoch   47/50, time: 11.01 s, val_loss: 0.417
Epoch   48/50, time: 41.90 s, training_loss: 0.412
Epoch   48/50, time: 12.81 s, val_loss: 0.408
Epoch   49/50, time: 45.17 s, training_loss: 0.408
Epoch   49/50, time: 12.94 s, val_loss: 0.394
Epoch   50/50, time: 46.52 s, training_loss: 0.412
Epoch   50/50, time: 10.50 s, val_loss: 0.434
Training Metrics:
Accuracy: 0.5184
Precision: 0.2636
Recall: 0.4689
F1 Score: 0.1968
IoU: 0.0249
Dice Coefficient: 0.0233
Validation Metrics:
Accuracy: 0.5581
Precision: 0.2638
Recall: 0.4745
F1 Score: 0.2058
IoU: 0.0258
Dice Coefficient: 0.0242
[I 2025-06-15 09:12:39,469] Trial 12 finished with value: 0.02424105367814981 and parameters: {'batch_size': 32, 'lr': 0.0004303703543609529, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.5581
Precision: 0.2638
Recall: 0.4745
F1 Score: 0.2058
IoU: 0.0258
Dice Coefficient: 0.0242
[Trial 12] Finished with val_loss=inf
[Trial 12] Finished with dice_coeff=0.02424105367814981
[Trial 13] Trying batch_size=16, lr=0.00024588160694534884, loss_fn=dice_loss
Epoch    1/50, time: 42.30 s, training_loss: 0.978
Epoch    1/50, time: 12.28 s, val_loss: 0.980
Training Metrics:
Accuracy: 0.6986
Precision: 0.2852
Recall: 0.4504
F1 Score: 0.2682
IoU: 0.0313
Dice Coefficient: 0.0320
Validation Metrics:
Accuracy: 0.5968
Precision: 0.2896
Recall: 0.4876
F1 Score: 0.2553
IoU: 0.0267
Dice Coefficient: 0.0265
Epoch    2/50, time: 42.01 s, training_loss: 0.967
Epoch    2/50, time: 13.00 s, val_loss: 0.988
Epoch    3/50, time: 42.01 s, training_loss: 0.956
Epoch    3/50, time: 11.14 s, val_loss: 0.987
Epoch    4/50, time: 42.59 s, training_loss: 0.944
Epoch    4/50, time: 10.85 s, val_loss: 0.968
Epoch    5/50, time: 42.02 s, training_loss: 0.932
Epoch    5/50, time: 11.43 s, val_loss: 0.929
Epoch    6/50, time: 40.58 s, training_loss: 0.921
Epoch    6/50, time: 11.18 s, val_loss: 0.952
Epoch    7/50, time: 42.53 s, training_loss: 0.909
Epoch    7/50, time: 12.94 s, val_loss: 0.947
Epoch    8/50, time: 43.78 s, training_loss: 0.900
Epoch    8/50, time: 11.08 s, val_loss: 0.899
Epoch    9/50, time: 42.64 s, training_loss: 0.870
Epoch    9/50, time: 11.11 s, val_loss: 0.806
Epoch   10/50, time: 43.89 s, training_loss: 0.834
Epoch   10/50, time: 12.55 s, val_loss: 0.787
Epoch   11/50, time: 40.76 s, training_loss: 0.803
Epoch   11/50, time: 12.31 s, val_loss: 0.854
Training Metrics:
Accuracy: 0.9114
Precision: 0.3055
Recall: 0.6248
F1 Score: 0.3364
IoU: 0.1137
Dice Coefficient: 0.1248
Validation Metrics:
Accuracy: 0.9172
Precision: 0.3038
Recall: 0.5937
F1 Score: 0.3338
IoU: 0.1092
Dice Coefficient: 0.1195
Epoch   12/50, time: 40.09 s, training_loss: 0.783
Epoch   12/50, time: 11.29 s, val_loss: 0.768
Epoch   13/50, time: 41.59 s, training_loss: 0.754
Epoch   13/50, time: 12.60 s, val_loss: 0.725
Epoch   14/50, time: 42.16 s, training_loss: 0.730
Epoch   14/50, time: 10.62 s, val_loss: 0.693
Epoch   15/50, time: 43.56 s, training_loss: 0.702
Epoch   15/50, time: 10.64 s, val_loss: 0.651
Epoch   16/50, time: 40.92 s, training_loss: 0.679
Epoch   16/50, time: 10.82 s, val_loss: 0.696
Epoch   17/50, time: 41.39 s, training_loss: 0.657
Epoch   17/50, time: 12.34 s, val_loss: 0.661
Epoch   18/50, time: 41.38 s, training_loss: 0.627
Epoch   18/50, time: 12.41 s, val_loss: 0.600
Epoch   19/50, time: 42.34 s, training_loss: 0.613
Epoch   19/50, time: 11.03 s, val_loss: 0.594
Epoch   20/50, time: 42.78 s, training_loss: 0.595
Epoch   20/50, time: 10.72 s, val_loss: 0.551
Epoch   21/50, time: 42.50 s, training_loss: 0.578
Epoch   21/50, time: 12.59 s, val_loss: 0.546
Training Metrics:
Accuracy: 0.8183
Precision: 0.3161
Recall: 0.6856
F1 Score: 0.3302
IoU: 0.0665
Dice Coefficient: 0.0574
Validation Metrics:
Accuracy: 0.8151
Precision: 0.3133
Recall: 0.6961
F1 Score: 0.3269
IoU: 0.0628
Dice Coefficient: 0.0541
Epoch   22/50, time: 41.06 s, training_loss: 0.558
Epoch   22/50, time: 12.99 s, val_loss: 0.594
Epoch   23/50, time: 41.74 s, training_loss: 0.555
Epoch   23/50, time: 11.18 s, val_loss: 0.516
Epoch   24/50, time: 42.56 s, training_loss: 0.529
Epoch   24/50, time: 11.20 s, val_loss: 0.497
Epoch   25/50, time: 41.48 s, training_loss: 0.510
Epoch   25/50, time: 13.87 s, val_loss: 0.460
Epoch   26/50, time: 43.34 s, training_loss: 0.492
Epoch   26/50, time: 12.70 s, val_loss: 0.458
Epoch   27/50, time: 42.93 s, training_loss: 0.477
Epoch   27/50, time: 10.70 s, val_loss: 0.454
Epoch   28/50, time: 40.03 s, training_loss: 0.474
Epoch   28/50, time: 10.67 s, val_loss: 0.442
Epoch   29/50, time: 40.77 s, training_loss: 0.484
Epoch   29/50, time: 10.86 s, val_loss: 0.503
Epoch   30/50, time: 41.47 s, training_loss: 0.464
Epoch   30/50, time: 10.67 s, val_loss: 0.448
Epoch   31/50, time: 40.81 s, training_loss: 0.472
Epoch   31/50, time: 12.27 s, val_loss: 0.422
Training Metrics:
Accuracy: 0.7161
Precision: 0.3074
Recall: 0.6043
F1 Score: 0.3069
IoU: 0.0368
Dice Coefficient: 0.0362
Validation Metrics:
Accuracy: 0.7491
Precision: 0.3085
Recall: 0.6215
F1 Score: 0.3141
IoU: 0.0400
Dice Coefficient: 0.0393
Epoch   32/50, time: 40.74 s, training_loss: 0.433
Epoch   32/50, time: 12.68 s, val_loss: 0.420
Epoch   33/50, time: 42.20 s, training_loss: 0.429
Epoch   33/50, time: 12.53 s, val_loss: 0.451
Epoch   34/50, time: 41.56 s, training_loss: 0.414
Epoch   34/50, time: 12.42 s, val_loss: 0.413
Epoch   35/50, time: 41.96 s, training_loss: 0.406
Epoch   35/50, time: 10.94 s, val_loss: 0.382
Epoch   36/50, time: 41.95 s, training_loss: 0.396
Epoch   36/50, time: 10.66 s, val_loss: 0.380
Epoch   37/50, time: 40.71 s, training_loss: 0.384
Epoch   37/50, time: 11.05 s, val_loss: 0.388
Epoch   38/50, time: 41.88 s, training_loss: 0.387
Epoch   38/50, time: 12.97 s, val_loss: 0.406
Epoch   39/50, time: 41.17 s, training_loss: 0.388
Epoch   39/50, time: 12.70 s, val_loss: 0.389
Epoch   40/50, time: 40.46 s, training_loss: 0.382
Epoch   40/50, time: 11.00 s, val_loss: 0.359
Epoch   41/50, time: 40.60 s, training_loss: 0.371
Epoch   41/50, time: 11.07 s, val_loss: 0.365
Training Metrics:
Accuracy: 0.6163
Precision: 0.2933
Recall: 0.6620
F1 Score: 0.2661
IoU: 0.0327
Dice Coefficient: 0.0299
Validation Metrics:
Accuracy: 0.6409
Precision: 0.2930
Recall: 0.6706
F1 Score: 0.2703
IoU: 0.0334
Dice Coefficient: 0.0303
Epoch   42/50, time: 40.60 s, training_loss: 0.363
Epoch   42/50, time: 12.80 s, val_loss: 0.369
Epoch   43/50, time: 43.96 s, training_loss: 0.365
Epoch   43/50, time: 11.22 s, val_loss: 0.375
Epoch   44/50, time: 42.82 s, training_loss: 0.363
Epoch   44/50, time: 12.87 s, val_loss: 0.377
Epoch   45/50, time: 42.64 s, training_loss: 0.360
Epoch   45/50, time: 11.08 s, val_loss: 0.386
Epoch   46/50, time: 42.24 s, training_loss: 0.353
Epoch   46/50, time: 10.66 s, val_loss: 0.351
Epoch   47/50, time: 41.88 s, training_loss: 0.350
Epoch   47/50, time: 12.64 s, val_loss: 0.374
Epoch   48/50, time: 43.86 s, training_loss: 0.354
Epoch   48/50, time: 11.10 s, val_loss: 0.350
Epoch   49/50, time: 42.45 s, training_loss: 0.345
Epoch   49/50, time: 11.35 s, val_loss: 0.365
Epoch   50/50, time: 41.89 s, training_loss: 0.351
Epoch   50/50, time: 10.49 s, val_loss: 0.344
Training Metrics:
Accuracy: 0.5919
Precision: 0.2972
Recall: 0.6478
F1 Score: 0.2667
IoU: 0.0307
Dice Coefficient: 0.0273
Validation Metrics:
Accuracy: 0.6199
Precision: 0.3021
Recall: 0.6484
F1 Score: 0.2790
IoU: 0.0315
Dice Coefficient: 0.0275
[I 2025-06-15 10:04:37,227] Trial 13 finished with value: 0.02754746572540883 and parameters: {'batch_size': 16, 'lr': 0.00024588160694534884, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.6199
Precision: 0.3021
Recall: 0.6484
F1 Score: 0.2790
IoU: 0.0315
Dice Coefficient: 0.0275
[Trial 13] Finished with val_loss=inf
[Trial 13] Finished with dice_coeff=0.02754746572540883
[Trial 14] Trying batch_size=16, lr=0.0009062133987452809, loss_fn=dice_loss
Epoch    1/50, time: 42.37 s, training_loss: 0.973
Epoch    1/50, time: 10.96 s, val_loss: 0.987
Training Metrics:
Accuracy: 0.0660
Precision: 0.2425
Recall: 0.2139
F1 Score: 0.0461
IoU: 0.0093
Dice Coefficient: 0.0176
Validation Metrics:
Accuracy: 0.0113
Precision: 0.2544
Recall: 0.2689
F1 Score: 0.0149
IoU: 0.0127
Dice Coefficient: 0.0241
Epoch    2/50, time: 41.18 s, training_loss: 0.946
Epoch    2/50, time: 10.89 s, val_loss: 0.956
Epoch    3/50, time: 40.86 s, training_loss: 0.919
Epoch    3/50, time: 11.07 s, val_loss: 0.925
Epoch    4/50, time: 41.84 s, training_loss: 0.895
Epoch    4/50, time: 12.31 s, val_loss: 0.896
Epoch    5/50, time: 41.22 s, training_loss: 0.846
Epoch    5/50, time: 12.60 s, val_loss: 0.822
Epoch    6/50, time: 40.72 s, training_loss: 0.798
Epoch    6/50, time: 12.36 s, val_loss: 0.784
Epoch    7/50, time: 41.45 s, training_loss: 0.791
Epoch    7/50, time: 12.34 s, val_loss: 0.762
Epoch    8/50, time: 40.74 s, training_loss: 0.781
Epoch    8/50, time: 10.81 s, val_loss: 0.772
Epoch    9/50, time: 41.19 s, training_loss: 0.754
Epoch    9/50, time: 12.34 s, val_loss: 0.751
Epoch   10/50, time: 41.62 s, training_loss: 0.744
Epoch   10/50, time: 11.94 s, val_loss: 0.728
Epoch   11/50, time: 41.62 s, training_loss: 0.735
Epoch   11/50, time: 10.67 s, val_loss: 0.715
Training Metrics:
Accuracy: 0.2689
Precision: 0.2572
Recall: 0.4376
F1 Score: 0.1192
IoU: 0.0170
Dice Coefficient: 0.0261
Validation Metrics:
Accuracy: 0.3142
Precision: 0.2573
Recall: 0.4538
F1 Score: 0.1330
IoU: 0.0175
Dice Coefficient: 0.0260
Epoch   12/50, time: 42.18 s, training_loss: 0.724
Epoch   12/50, time: 10.99 s, val_loss: 0.712
Epoch   13/50, time: 42.53 s, training_loss: 0.718
Epoch   13/50, time: 11.01 s, val_loss: 0.702
Epoch   14/50, time: 42.85 s, training_loss: 0.709
Epoch   14/50, time: 12.39 s, val_loss: 0.709
Epoch   15/50, time: 41.06 s, training_loss: 0.705
Epoch   15/50, time: 10.91 s, val_loss: 0.696
Epoch   16/50, time: 41.10 s, training_loss: 0.695
Epoch   16/50, time: 12.45 s, val_loss: 0.678
Epoch   17/50, time: 40.80 s, training_loss: 0.677
Epoch   17/50, time: 12.55 s, val_loss: 0.725
Epoch   18/50, time: 40.21 s, training_loss: 0.652
Epoch   18/50, time: 11.24 s, val_loss: 0.664
Epoch   19/50, time: 43.25 s, training_loss: 0.631
Epoch   19/50, time: 12.38 s, val_loss: 0.670
Epoch   20/50, time: 40.83 s, training_loss: 0.622
Epoch   20/50, time: 10.74 s, val_loss: 0.620
Epoch   21/50, time: 40.73 s, training_loss: 0.594
Epoch   21/50, time: 10.86 s, val_loss: 0.578
Training Metrics:
Accuracy: 0.3502
Precision: 0.2558
Recall: 0.3833
F1 Score: 0.1400
IoU: 0.0197
Dice Coefficient: 0.0304
Validation Metrics:
Accuracy: 0.4602
Precision: 0.2566
Recall: 0.4146
F1 Score: 0.1700
IoU: 0.0227
Dice Coefficient: 0.0306
Epoch   22/50, time: 41.48 s, training_loss: 0.573
Epoch   22/50, time: 10.86 s, val_loss: 0.548
Epoch   23/50, time: 42.13 s, training_loss: 0.560
Epoch   23/50, time: 10.74 s, val_loss: 0.552
Epoch   24/50, time: 41.06 s, training_loss: 0.547
Epoch   24/50, time: 10.85 s, val_loss: 0.516
Epoch   25/50, time: 42.69 s, training_loss: 0.535
Epoch   25/50, time: 12.56 s, val_loss: 0.510
Epoch   26/50, time: 43.56 s, training_loss: 0.522
Epoch   26/50, time: 10.62 s, val_loss: 0.492
Epoch   27/50, time: 41.92 s, training_loss: 0.513
Epoch   27/50, time: 10.85 s, val_loss: 0.490
Epoch   28/50, time: 43.77 s, training_loss: 0.500
Epoch   28/50, time: 12.70 s, val_loss: 0.505
Epoch   29/50, time: 40.69 s, training_loss: 0.492
Epoch   29/50, time: 10.87 s, val_loss: 0.474
Epoch   30/50, time: 40.73 s, training_loss: 0.491
Epoch   30/50, time: 12.54 s, val_loss: 0.508
Epoch   31/50, time: 41.71 s, training_loss: 0.478
Epoch   31/50, time: 12.49 s, val_loss: 0.452
Training Metrics:
Accuracy: 0.2610
Precision: 0.2557
Recall: 0.3441
F1 Score: 0.1126
IoU: 0.0174
Dice Coefficient: 0.0308
Validation Metrics:
Accuracy: 0.3112
Precision: 0.2553
Recall: 0.3635
F1 Score: 0.1277
IoU: 0.0180
Dice Coefficient: 0.0302
Epoch   32/50, time: 41.48 s, training_loss: 0.468
Epoch   32/50, time: 12.51 s, val_loss: 0.450
Epoch   33/50, time: 41.71 s, training_loss: 0.460
Epoch   33/50, time: 12.60 s, val_loss: 0.445
Epoch   34/50, time: 39.81 s, training_loss: 0.457
Epoch   34/50, time: 12.52 s, val_loss: 0.436
Epoch   35/50, time: 40.30 s, training_loss: 0.447
Epoch   35/50, time: 12.71 s, val_loss: 0.447
Epoch   36/50, time: 42.87 s, training_loss: 0.445
Epoch   36/50, time: 10.87 s, val_loss: 0.444
Epoch   37/50, time: 43.04 s, training_loss: 0.438
Epoch   37/50, time: 12.67 s, val_loss: 0.435
Epoch   38/50, time: 41.08 s, training_loss: 0.443
Epoch   38/50, time: 12.33 s, val_loss: 0.421
Epoch   39/50, time: 43.05 s, training_loss: 0.439
Epoch   39/50, time: 12.50 s, val_loss: 0.444
Epoch   40/50, time: 41.90 s, training_loss: 0.425
Epoch   40/50, time: 12.32 s, val_loss: 0.434
Epoch   41/50, time: 40.87 s, training_loss: 0.424
Epoch   41/50, time: 11.45 s, val_loss: 0.417
Training Metrics:
Accuracy: 0.1302
Precision: 0.2570
Recall: 0.2969
F1 Score: 0.0670
IoU: 0.0149
Dice Coefficient: 0.0284
Validation Metrics:
Accuracy: 0.1558
Precision: 0.2574
Recall: 0.3096
F1 Score: 0.0782
IoU: 0.0148
Dice Coefficient: 0.0279
Epoch   42/50, time: 40.87 s, training_loss: 0.428
Epoch   42/50, time: 12.81 s, val_loss: 0.427
Epoch   43/50, time: 41.48 s, training_loss: 0.414
Epoch   43/50, time: 12.80 s, val_loss: 0.421
Epoch   44/50, time: 40.17 s, training_loss: 0.412
Epoch   44/50, time: 10.66 s, val_loss: 0.427
Epoch   45/50, time: 41.11 s, training_loss: 0.409
Epoch   45/50, time: 12.62 s, val_loss: 0.408
Epoch   46/50, time: 41.75 s, training_loss: 0.402
Epoch   46/50, time: 12.46 s, val_loss: 0.398
Epoch   47/50, time: 41.81 s, training_loss: 0.398
Epoch   47/50, time: 11.04 s, val_loss: 0.587
Epoch   48/50, time: 41.57 s, training_loss: 0.413
Epoch   48/50, time: 12.79 s, val_loss: 0.400
Epoch   49/50, time: 40.68 s, training_loss: 0.401
Epoch   49/50, time: 12.76 s, val_loss: 0.422
Epoch   50/50, time: 41.30 s, training_loss: 0.400
Epoch   50/50, time: 12.48 s, val_loss: 0.407
Training Metrics:
Accuracy: 0.1212
Precision: 0.2553
Recall: 0.2930
F1 Score: 0.0607
IoU: 0.0148
Dice Coefficient: 0.0270
Validation Metrics:
Accuracy: 0.1475
Precision: 0.2549
Recall: 0.3006
F1 Score: 0.0709
IoU: 0.0146
Dice Coefficient: 0.0264
[I 2025-06-15 10:56:20,643] Trial 14 finished with value: 0.026368801253795822 and parameters: {'batch_size': 16, 'lr': 0.0009062133987452809, 'loss_fn': 'dice_loss'}. Best is trial 5 with value: 0.033077967337771755.
Test Metrics:
Accuracy: 0.1475
Precision: 0.2549
Recall: 0.3006
F1 Score: 0.0709
IoU: 0.0146
Dice Coefficient: 0.0264
[Trial 14] Finished with val_loss=inf
[Trial 14] Finished with dice_coeff=0.026368801253795822
Best params: {'batch_size': 32, 'lr': 0.0002709829673680805, 'loss_fn': 'dice_loss'}
Best val loss: 0.033077967337771755
