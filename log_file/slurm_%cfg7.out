[I 2025-06-16 14:01:03,261] A new study created in memory with name: no-name-61634839-61db-4e31-a25d-185ac5a2f8a6
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
[Trial 0] Trying batch_size=32, lr=0.00023112613070152776, loss_fn=dice_loss
Epoch    1/50, time: 46.27 s, training_loss: 0.981
Epoch    1/50, time: 12.11 s, val_loss: 0.983
Training Metrics:
Accuracy: 0.4218
Precision: 0.5038
Recall: 0.6901
F1 Score: 0.3033
IoU: 0.0081
Dice Coefficient: 0.0161
Validation Metrics:
Accuracy: 0.4889
Precision: 0.5044
Recall: 0.7323
F1 Score: 0.3362
IoU: 0.0090
Dice Coefficient: 0.0178
Epoch    2/50, time: 30.99 s, training_loss: 0.976
Epoch    2/50, time: 8.70 s, val_loss: 0.969
Epoch    3/50, time: 33.25 s, training_loss: 0.970
Epoch    3/50, time: 8.62 s, val_loss: 0.961
Epoch    4/50, time: 31.48 s, training_loss: 0.963
Epoch    4/50, time: 8.18 s, val_loss: 0.970
Epoch    5/50, time: 32.55 s, training_loss: 0.955
Epoch    5/50, time: 8.48 s, val_loss: 0.917
Epoch    6/50, time: 32.14 s, training_loss: 0.946
Epoch    6/50, time: 8.46 s, val_loss: 0.874
Epoch    7/50, time: 32.14 s, training_loss: 0.937
Epoch    7/50, time: 8.10 s, val_loss: 0.899
Epoch    8/50, time: 31.68 s, training_loss: 0.925
Epoch    8/50, time: 8.41 s, val_loss: 0.865
Epoch    9/50, time: 32.18 s, training_loss: 0.916
Epoch    9/50, time: 8.38 s, val_loss: 0.881
Epoch   10/50, time: 33.66 s, training_loss: 0.902
Epoch   10/50, time: 8.38 s, val_loss: 0.871
Epoch   11/50, time: 31.31 s, training_loss: 0.891
Epoch   11/50, time: 8.45 s, val_loss: 0.848
Training Metrics:
Accuracy: 0.5424
Precision: 0.5021
Recall: 0.6050
F1 Score: 0.3581
IoU: 0.0071
Dice Coefficient: 0.0141
Validation Metrics:
Accuracy: 0.6903
Precision: 0.5029
Recall: 0.6315
F1 Score: 0.4167
IoU: 0.0087
Dice Coefficient: 0.0172
Epoch   12/50, time: 31.58 s, training_loss: 0.877
Epoch   12/50, time: 8.35 s, val_loss: 0.822
Epoch   13/50, time: 32.67 s, training_loss: 0.867
Epoch   13/50, time: 8.57 s, val_loss: 0.865
Epoch   14/50, time: 31.84 s, training_loss: 0.855
Epoch   14/50, time: 8.60 s, val_loss: 0.828
Epoch   15/50, time: 31.51 s, training_loss: 0.839
Epoch   15/50, time: 8.75 s, val_loss: 0.842
Epoch   16/50, time: 31.71 s, training_loss: 0.830
Epoch   16/50, time: 8.67 s, val_loss: 0.815
Epoch   17/50, time: 31.72 s, training_loss: 0.816
Epoch   17/50, time: 8.34 s, val_loss: 0.777
Epoch   18/50, time: 34.32 s, training_loss: 0.813
Epoch   18/50, time: 8.75 s, val_loss: 0.753
Epoch   19/50, time: 30.75 s, training_loss: 0.794
Epoch   19/50, time: 8.45 s, val_loss: 0.789
Epoch   20/50, time: 32.47 s, training_loss: 0.787
Epoch   20/50, time: 8.25 s, val_loss: 0.776
Epoch   21/50, time: 32.12 s, training_loss: 0.773
Epoch   21/50, time: 8.66 s, val_loss: 0.737
Training Metrics:
Accuracy: 0.6413
Precision: 0.5027
Recall: 0.6292
F1 Score: 0.3986
IoU: 0.0084
Dice Coefficient: 0.0166
Validation Metrics:
Accuracy: 0.7438
Precision: 0.5036
Recall: 0.6438
F1 Score: 0.4362
IoU: 0.0100
Dice Coefficient: 0.0197
Epoch   22/50, time: 32.28 s, training_loss: 0.763
Epoch   22/50, time: 8.54 s, val_loss: 0.723
Epoch   23/50, time: 32.23 s, training_loss: 0.747
Epoch   23/50, time: 8.42 s, val_loss: 0.799
Epoch   24/50, time: 31.95 s, training_loss: 0.729
Epoch   24/50, time: 8.53 s, val_loss: 0.724
Epoch   25/50, time: 31.88 s, training_loss: 0.710
Epoch   25/50, time: 8.78 s, val_loss: 0.663
Epoch   26/50, time: 31.95 s, training_loss: 0.699
Epoch   26/50, time: 8.41 s, val_loss: 0.677
Epoch   27/50, time: 31.36 s, training_loss: 0.673
Epoch   27/50, time: 8.46 s, val_loss: 0.613
Epoch   28/50, time: 32.40 s, training_loss: 0.642
Epoch   28/50, time: 8.71 s, val_loss: 0.617
Epoch   29/50, time: 31.45 s, training_loss: 0.626
Epoch   29/50, time: 8.60 s, val_loss: 0.739
Epoch   30/50, time: 32.59 s, training_loss: 0.634
Epoch   30/50, time: 8.36 s, val_loss: 0.646
Epoch   31/50, time: 33.08 s, training_loss: 0.611
Epoch   31/50, time: 8.43 s, val_loss: 0.586
Training Metrics:
Accuracy: 0.8139
Precision: 0.5070
Recall: 0.7171
F1 Score: 0.4644
IoU: 0.0161
Dice Coefficient: 0.0316
Validation Metrics:
Accuracy: 0.7981
Precision: 0.5062
Recall: 0.7131
F1 Score: 0.4580
IoU: 0.0145
Dice Coefficient: 0.0286
Epoch   32/50, time: 31.86 s, training_loss: 0.590
Epoch   32/50, time: 8.62 s, val_loss: 0.563
Epoch   33/50, time: 33.05 s, training_loss: 0.569
Epoch   33/50, time: 8.23 s, val_loss: 0.568
Epoch   34/50, time: 31.33 s, training_loss: 0.563
Epoch   34/50, time: 8.39 s, val_loss: 0.569
Epoch   35/50, time: 33.20 s, training_loss: 0.563
Epoch   35/50, time: 8.40 s, val_loss: 0.560
Epoch   36/50, time: 32.34 s, training_loss: 0.544
Epoch   36/50, time: 8.32 s, val_loss: 0.503
Epoch   37/50, time: 31.82 s, training_loss: 0.537
Epoch   37/50, time: 8.12 s, val_loss: 0.515
Epoch   38/50, time: 31.98 s, training_loss: 0.525
Epoch   38/50, time: 8.51 s, val_loss: 0.526
Epoch   39/50, time: 31.22 s, training_loss: 0.518
Epoch   39/50, time: 8.38 s, val_loss: 0.520
Epoch   40/50, time: 32.70 s, training_loss: 0.506
Epoch   40/50, time: 8.67 s, val_loss: 0.505
Epoch   41/50, time: 32.76 s, training_loss: 0.491
Epoch   41/50, time: 8.57 s, val_loss: 0.510
Training Metrics:
Accuracy: 0.8953
Precision: 0.5120
Recall: 0.7306
F1 Score: 0.4974
IoU: 0.0258
Dice Coefficient: 0.0502
Validation Metrics:
Accuracy: 0.8810
Precision: 0.5100
Recall: 0.7230
F1 Score: 0.4898
IoU: 0.0220
Dice Coefficient: 0.0430
Epoch   42/50, time: 31.55 s, training_loss: 0.503
Epoch   42/50, time: 8.36 s, val_loss: 0.501
Epoch   43/50, time: 32.01 s, training_loss: 0.510
Epoch   43/50, time: 8.34 s, val_loss: 0.499
Epoch   44/50, time: 36.65 s, training_loss: 0.493
Epoch   44/50, time: 20.68 s, val_loss: 0.446
Epoch   45/50, time: 36.33 s, training_loss: 0.476
Epoch   45/50, time: 8.48 s, val_loss: 0.498
Epoch   46/50, time: 32.32 s, training_loss: 0.473
Epoch   46/50, time: 8.36 s, val_loss: 0.462
Epoch   47/50, time: 37.88 s, training_loss: 0.465
Epoch   47/50, time: 12.63 s, val_loss: 0.474
Epoch   48/50, time: 44.85 s, training_loss: 0.455
Epoch   48/50, time: 12.40 s, val_loss: 0.441
Epoch   49/50, time: 39.54 s, training_loss: 0.457
Epoch   49/50, time: 8.42 s, val_loss: 0.476
Epoch   50/50, time: 32.30 s, training_loss: 0.457
Epoch   50/50, time: 8.36 s, val_loss: 0.456
Training Metrics:
Accuracy: 0.9301
Precision: 0.5205
Recall: 0.7777
F1 Score: 0.5221
IoU: 0.0419
Dice Coefficient: 0.0805
Validation Metrics:
Accuracy: 0.9260
Precision: 0.5186
Recall: 0.7737
F1 Score: 0.5175
IoU: 0.0382
Dice Coefficient: 0.0736
[I 2025-06-16 14:44:46,168] Trial 0 finished with value: 0.07361687046304834 and parameters: {'batch_size': 32, 'lr': 0.00023112613070152776, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.07361687046304834.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9260
Precision: 0.5186
Recall: 0.7737
F1 Score: 0.5175
IoU: 0.0382
Dice Coefficient: 0.0736
[Trial 0] Finished with val_loss=inf
[Trial 0] Finished with dice_coeff=0.07361687046304834
[Trial 1] Trying batch_size=64, lr=0.00011981777117467961, loss_fn=dice_loss
Epoch    1/50, time: 39.54 s, training_loss: 0.981
Epoch    1/50, time: 8.53 s, val_loss: 0.985
Training Metrics:
Accuracy: 0.5179
Precision: 0.5046
Recall: 0.7341
F1 Score: 0.3497
IoU: 0.0096
Dice Coefficient: 0.0190
Validation Metrics:
Accuracy: 0.6298
Precision: 0.5057
Recall: 0.7831
F1 Score: 0.3975
IoU: 0.0119
Dice Coefficient: 0.0235
Epoch    2/50, time: 38.03 s, training_loss: 0.975
Epoch    2/50, time: 8.48 s, val_loss: 0.976
Epoch    3/50, time: 36.62 s, training_loss: 0.971
Epoch    3/50, time: 8.50 s, val_loss: 0.976
Epoch    4/50, time: 36.47 s, training_loss: 0.967
Epoch    4/50, time: 8.66 s, val_loss: 0.981
Epoch    5/50, time: 39.70 s, training_loss: 0.965
Epoch    5/50, time: 14.60 s, val_loss: 0.929
Epoch    6/50, time: 56.88 s, training_loss: 0.962
Epoch    6/50, time: 14.92 s, val_loss: 0.980
Epoch    7/50, time: 51.67 s, training_loss: 0.958
Epoch    7/50, time: 13.25 s, val_loss: 0.980
Epoch    8/50, time: 52.37 s, training_loss: 0.957
Epoch    8/50, time: 13.12 s, val_loss: 0.958
Epoch    9/50, time: 43.41 s, training_loss: 0.950
Epoch    9/50, time: 8.82 s, val_loss: 0.968
Epoch   10/50, time: 37.02 s, training_loss: 0.943
Epoch   10/50, time: 8.05 s, val_loss: 0.871
Epoch   11/50, time: 37.03 s, training_loss: 0.939
Epoch   11/50, time: 8.77 s, val_loss: 0.904
Training Metrics:
Accuracy: 0.3740
Precision: 0.5024
Recall: 0.6164
F1 Score: 0.2774
IoU: 0.0067
Dice Coefficient: 0.0133
Validation Metrics:
Accuracy: 0.6123
Precision: 0.5038
Recall: 0.6900
F1 Score: 0.3884
IoU: 0.0093
Dice Coefficient: 0.0185
Epoch   12/50, time: 34.58 s, training_loss: 0.933
Epoch   12/50, time: 8.49 s, val_loss: 0.886
Epoch   13/50, time: 35.76 s, training_loss: 0.928
Epoch   13/50, time: 8.72 s, val_loss: 0.890
Epoch   14/50, time: 35.88 s, training_loss: 0.925
Epoch   14/50, time: 8.51 s, val_loss: 0.964
Epoch   15/50, time: 34.70 s, training_loss: 0.924
Epoch   15/50, time: 8.74 s, val_loss: 0.897
Epoch   16/50, time: 35.84 s, training_loss: 0.917
Epoch   16/50, time: 8.22 s, val_loss: 0.864
Epoch   17/50, time: 36.00 s, training_loss: 0.910
Epoch   17/50, time: 8.52 s, val_loss: 0.940
Epoch   18/50, time: 35.96 s, training_loss: 0.906
Epoch   18/50, time: 8.38 s, val_loss: 0.862
Epoch   19/50, time: 37.15 s, training_loss: 0.900
Epoch   19/50, time: 8.29 s, val_loss: 0.841
Epoch   20/50, time: 35.81 s, training_loss: 0.900
Epoch   20/50, time: 8.92 s, val_loss: 0.809
Epoch   21/50, time: 35.60 s, training_loss: 0.900
Epoch   21/50, time: 8.44 s, val_loss: 0.797
Training Metrics:
Accuracy: 0.4440
Precision: 0.5022
Recall: 0.6088
F1 Score: 0.3132
IoU: 0.0068
Dice Coefficient: 0.0135
Validation Metrics:
Accuracy: 0.8504
Precision: 0.5078
Recall: 0.7098
F1 Score: 0.4768
IoU: 0.0177
Dice Coefficient: 0.0347
Epoch   22/50, time: 36.85 s, training_loss: 0.894
Epoch   22/50, time: 8.69 s, val_loss: 0.816
Epoch   23/50, time: 36.75 s, training_loss: 0.883
Epoch   23/50, time: 8.37 s, val_loss: 0.831
Epoch   24/50, time: 36.38 s, training_loss: 0.877
Epoch   24/50, time: 8.43 s, val_loss: 0.798
Epoch   25/50, time: 34.85 s, training_loss: 0.867
Epoch   25/50, time: 8.80 s, val_loss: 0.781
Epoch   26/50, time: 36.31 s, training_loss: 0.864
Epoch   26/50, time: 8.32 s, val_loss: 0.882
Epoch   27/50, time: 37.08 s, training_loss: 0.852
Epoch   27/50, time: 8.12 s, val_loss: 0.841
Epoch   28/50, time: 35.28 s, training_loss: 0.844
Epoch   28/50, time: 8.69 s, val_loss: 0.791
Epoch   29/50, time: 37.03 s, training_loss: 0.843
Epoch   29/50, time: 8.38 s, val_loss: 0.909
Epoch   30/50, time: 36.59 s, training_loss: 0.834
Epoch   30/50, time: 8.64 s, val_loss: 0.777
Epoch   31/50, time: 35.33 s, training_loss: 0.834
Epoch   31/50, time: 8.43 s, val_loss: 0.786
Training Metrics:
Accuracy: 0.5519
Precision: 0.5024
Recall: 0.6207
F1 Score: 0.3625
IoU: 0.0075
Dice Coefficient: 0.0149
Validation Metrics:
Accuracy: 0.6842
Precision: 0.5032
Recall: 0.6453
F1 Score: 0.4149
IoU: 0.0090
Dice Coefficient: 0.0179
Epoch   32/50, time: 35.05 s, training_loss: 0.828
Epoch   32/50, time: 8.34 s, val_loss: 0.785
Epoch   33/50, time: 36.84 s, training_loss: 0.815
Epoch   33/50, time: 8.24 s, val_loss: 0.864
Epoch   34/50, time: 36.24 s, training_loss: 0.805
Epoch   34/50, time: 8.20 s, val_loss: 0.799
Epoch   35/50, time: 36.76 s, training_loss: 0.806
Epoch   35/50, time: 8.68 s, val_loss: 0.716
Epoch   36/50, time: 37.50 s, training_loss: 0.801
Epoch   36/50, time: 8.85 s, val_loss: 0.681
Epoch   37/50, time: 36.88 s, training_loss: 0.788
Epoch   37/50, time: 8.71 s, val_loss: 0.715
Epoch   38/50, time: 35.91 s, training_loss: 0.781
Epoch   38/50, time: 8.62 s, val_loss: 0.715
Epoch   39/50, time: 37.50 s, training_loss: 0.769
Epoch   39/50, time: 8.06 s, val_loss: 0.700
Epoch   40/50, time: 35.45 s, training_loss: 0.760
Epoch   40/50, time: 8.22 s, val_loss: 0.744
Epoch   41/50, time: 37.00 s, training_loss: 0.752
Epoch   41/50, time: 8.53 s, val_loss: 0.685
Training Metrics:
Accuracy: 0.6242
Precision: 0.5029
Recall: 0.6379
F1 Score: 0.3922
IoU: 0.0084
Dice Coefficient: 0.0167
Validation Metrics:
Accuracy: 0.7220
Precision: 0.5040
Recall: 0.6724
F1 Score: 0.4294
IoU: 0.0105
Dice Coefficient: 0.0208
Epoch   42/50, time: 36.61 s, training_loss: 0.747
Epoch   42/50, time: 8.36 s, val_loss: 0.740
Epoch   43/50, time: 37.51 s, training_loss: 0.742
Epoch   43/50, time: 8.73 s, val_loss: 0.657
Epoch   44/50, time: 34.41 s, training_loss: 0.736
Epoch   44/50, time: 8.53 s, val_loss: 0.724
Epoch   45/50, time: 35.97 s, training_loss: 0.719
Epoch   45/50, time: 8.72 s, val_loss: 0.719
Epoch   46/50, time: 36.27 s, training_loss: 0.713
Epoch   46/50, time: 8.55 s, val_loss: 0.739
Epoch   47/50, time: 36.72 s, training_loss: 0.716
Epoch   47/50, time: 8.49 s, val_loss: 0.660
Epoch   48/50, time: 36.50 s, training_loss: 0.704
Epoch   48/50, time: 8.41 s, val_loss: 0.711
Epoch   49/50, time: 37.11 s, training_loss: 0.699
Epoch   49/50, time: 8.65 s, val_loss: 0.652
Epoch   50/50, time: 35.40 s, training_loss: 0.690
Epoch   50/50, time: 8.39 s, val_loss: 0.687
Training Metrics:
Accuracy: 0.6901
Precision: 0.5042
Recall: 0.6830
F1 Score: 0.4184
IoU: 0.0106
Dice Coefficient: 0.0210
Validation Metrics:
Accuracy: 0.7076
Precision: 0.5043
Recall: 0.6878
F1 Score: 0.4247
IoU: 0.0107
Dice Coefficient: 0.0212
[I 2025-06-16 15:32:28,409] Trial 1 finished with value: 0.021203685075542364 and parameters: {'batch_size': 64, 'lr': 0.00011981777117467961, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.07361687046304834.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.7076
Precision: 0.5043
Recall: 0.6878
F1 Score: 0.4247
IoU: 0.0107
Dice Coefficient: 0.0212
[Trial 1] Finished with val_loss=inf
[Trial 1] Finished with dice_coeff=0.021203685075542364
[Trial 2] Trying batch_size=128, lr=0.0005372299037661056, loss_fn=dice_loss
Epoch    1/50, time: 44.17 s, training_loss: 0.983
Epoch    1/50, time: 8.20 s, val_loss: 0.988
Training Metrics:
Accuracy: 0.0420
Precision: 0.5025
Recall: 0.5186
F1 Score: 0.0410
IoU: 0.0051
Dice Coefficient: 0.0101
Validation Metrics:
Accuracy: 0.0567
Precision: 0.5025
Recall: 0.5261
F1 Score: 0.0546
IoU: 0.0050
Dice Coefficient: 0.0100
Epoch    2/50, time: 49.80 s, training_loss: 0.974
Epoch    2/50, time: 8.28 s, val_loss: 0.977
Epoch    3/50, time: 45.40 s, training_loss: 0.969
Epoch    3/50, time: 8.40 s, val_loss: 0.959
Epoch    4/50, time: 43.48 s, training_loss: 0.965
Epoch    4/50, time: 8.30 s, val_loss: 0.955
Epoch    5/50, time: 43.13 s, training_loss: 0.960
Epoch    5/50, time: 8.76 s, val_loss: 0.973
Epoch    6/50, time: 43.97 s, training_loss: 0.956
Epoch    6/50, time: 8.55 s, val_loss: 0.941
Epoch    7/50, time: 44.20 s, training_loss: 0.949
Epoch    7/50, time: 8.79 s, val_loss: 0.935
Epoch    8/50, time: 47.61 s, training_loss: 0.941
Epoch    8/50, time: 8.59 s, val_loss: 0.851
Epoch    9/50, time: 44.12 s, training_loss: 0.934
Epoch    9/50, time: 8.43 s, val_loss: 0.911
Epoch   10/50, time: 44.90 s, training_loss: 0.924
Epoch   10/50, time: 8.43 s, val_loss: 0.962
Epoch   11/50, time: 44.87 s, training_loss: 0.917
Epoch   11/50, time: 8.64 s, val_loss: 0.870
Training Metrics:
Accuracy: 0.5709
Precision: 0.5025
Recall: 0.6247
F1 Score: 0.3705
IoU: 0.0077
Dice Coefficient: 0.0153
Validation Metrics:
Accuracy: 0.7402
Precision: 0.5038
Recall: 0.6541
F1 Score: 0.4353
IoU: 0.0102
Dice Coefficient: 0.0203
Epoch   12/50, time: 61.26 s, training_loss: 0.908
Epoch   12/50, time: 8.47 s, val_loss: 0.891
Epoch   13/50, time: 44.75 s, training_loss: 0.898
Epoch   13/50, time: 8.16 s, val_loss: 0.893
Epoch   14/50, time: 45.05 s, training_loss: 0.888
Epoch   14/50, time: 8.41 s, val_loss: 0.920
Epoch   15/50, time: 44.33 s, training_loss: 0.881
Epoch   15/50, time: 8.34 s, val_loss: 0.843
Epoch   16/50, time: 44.53 s, training_loss: 0.876
Epoch   16/50, time: 8.32 s, val_loss: 0.971
Epoch   17/50, time: 45.74 s, training_loss: 0.868
Epoch   17/50, time: 8.19 s, val_loss: 0.948
Epoch   18/50, time: 46.79 s, training_loss: 0.861
Epoch   18/50, time: 8.65 s, val_loss: 0.814
Epoch   19/50, time: 46.40 s, training_loss: 0.858
Epoch   19/50, time: 8.16 s, val_loss: 0.875
Epoch   20/50, time: 45.25 s, training_loss: 0.852
Epoch   20/50, time: 8.25 s, val_loss: 0.860
Epoch   21/50, time: 41.74 s, training_loss: 0.849
Epoch   21/50, time: 8.47 s, val_loss: 0.822
Training Metrics:
Accuracy: 0.6771
Precision: 0.5042
Recall: 0.6867
F1 Score: 0.4137
IoU: 0.0105
Dice Coefficient: 0.0207
Validation Metrics:
Accuracy: 0.7667
Precision: 0.5054
Recall: 0.7051
F1 Score: 0.4465
IoU: 0.0129
Dice Coefficient: 0.0255
Epoch   22/50, time: 47.07 s, training_loss: 0.846
Epoch   22/50, time: 12.76 s, val_loss: 0.839
Epoch   23/50, time: 71.96 s, training_loss: 0.833
Epoch   23/50, time: 12.69 s, val_loss: 0.810
Epoch   24/50, time: 68.65 s, training_loss: 0.823
Epoch   24/50, time: 8.45 s, val_loss: 0.793
Epoch   25/50, time: 41.49 s, training_loss: 0.808
Epoch   25/50, time: 8.68 s, val_loss: 0.819
Epoch   26/50, time: 46.25 s, training_loss: 0.799
Epoch   26/50, time: 8.69 s, val_loss: 0.822
Epoch   27/50, time: 44.41 s, training_loss: 0.790
Epoch   27/50, time: 8.64 s, val_loss: 0.775
Epoch   28/50, time: 45.95 s, training_loss: 0.788
Epoch   28/50, time: 8.48 s, val_loss: 0.790
Epoch   29/50, time: 45.04 s, training_loss: 0.831
Epoch   29/50, time: 8.65 s, val_loss: 0.811
Epoch   30/50, time: 47.04 s, training_loss: 0.811
Epoch   30/50, time: 8.46 s, val_loss: 0.786
Epoch   31/50, time: 43.98 s, training_loss: 0.786
Epoch   31/50, time: 8.47 s, val_loss: 0.766
Training Metrics:
Accuracy: 0.7764
Precision: 0.5045
Recall: 0.6601
F1 Score: 0.4485
IoU: 0.0118
Dice Coefficient: 0.0233
Validation Metrics:
Accuracy: 0.8076
Precision: 0.5051
Recall: 0.6675
F1 Score: 0.4593
IoU: 0.0128
Dice Coefficient: 0.0253
Epoch   32/50, time: 61.44 s, training_loss: 0.773
Epoch   32/50, time: 8.45 s, val_loss: 0.749
Epoch   33/50, time: 44.81 s, training_loss: 0.761
Epoch   33/50, time: 8.29 s, val_loss: 0.777
Epoch   34/50, time: 43.73 s, training_loss: 0.754
Epoch   34/50, time: 8.37 s, val_loss: 0.792
Epoch   35/50, time: 42.52 s, training_loss: 0.746
Epoch   35/50, time: 8.42 s, val_loss: 0.734
Epoch   36/50, time: 45.90 s, training_loss: 0.738
Epoch   36/50, time: 8.34 s, val_loss: 0.753
Epoch   37/50, time: 44.89 s, training_loss: 0.731
Epoch   37/50, time: 8.23 s, val_loss: 0.812
Epoch   38/50, time: 47.63 s, training_loss: 0.729
Epoch   38/50, time: 8.12 s, val_loss: 0.701
Epoch   39/50, time: 43.67 s, training_loss: 0.729
Epoch   39/50, time: 8.90 s, val_loss: 0.699
Epoch   40/50, time: 43.05 s, training_loss: 0.715
Epoch   40/50, time: 8.05 s, val_loss: 0.688
Epoch   41/50, time: 43.49 s, training_loss: 0.712
Epoch   41/50, time: 8.58 s, val_loss: 0.703
Training Metrics:
Accuracy: 0.8237
Precision: 0.5070
Recall: 0.7077
F1 Score: 0.4674
IoU: 0.0162
Dice Coefficient: 0.0318
Validation Metrics:
Accuracy: 0.8434
Precision: 0.5080
Recall: 0.7242
F1 Score: 0.4750
IoU: 0.0180
Dice Coefficient: 0.0353
Epoch   42/50, time: 59.12 s, training_loss: 0.706
Epoch   42/50, time: 8.52 s, val_loss: 0.707
Epoch   43/50, time: 46.08 s, training_loss: 0.693
Epoch   43/50, time: 8.41 s, val_loss: 0.699
Epoch   44/50, time: 45.29 s, training_loss: 0.684
Epoch   44/50, time: 8.93 s, val_loss: 0.691
Epoch   45/50, time: 44.42 s, training_loss: 0.683
Epoch   45/50, time: 8.46 s, val_loss: 0.670
Epoch   46/50, time: 44.37 s, training_loss: 0.672
Epoch   46/50, time: 8.45 s, val_loss: 0.670
Epoch   47/50, time: 43.84 s, training_loss: 0.660
Epoch   47/50, time: 8.61 s, val_loss: 0.644
Epoch   48/50, time: 43.78 s, training_loss: 0.652
Epoch   48/50, time: 8.29 s, val_loss: 0.643
Epoch   49/50, time: 45.66 s, training_loss: 0.636
Epoch   49/50, time: 8.50 s, val_loss: 0.706
Epoch   50/50, time: 44.79 s, training_loss: 0.636
Epoch   50/50, time: 8.41 s, val_loss: 0.604
Training Metrics:
Accuracy: 0.8698
Precision: 0.5088
Recall: 0.7040
F1 Score: 0.4845
IoU: 0.0198
Dice Coefficient: 0.0389
Validation Metrics:
Accuracy: 0.8895
Precision: 0.5104
Recall: 0.7168
F1 Score: 0.4929
IoU: 0.0227
Dice Coefficient: 0.0445
[I 2025-06-16 16:29:32,428] Trial 2 finished with value: 0.04448037600476804 and parameters: {'batch_size': 128, 'lr': 0.0005372299037661056, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.07361687046304834.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.8895
Precision: 0.5104
Recall: 0.7168
F1 Score: 0.4929
IoU: 0.0227
Dice Coefficient: 0.0445
[Trial 2] Finished with val_loss=inf
[Trial 2] Finished with dice_coeff=0.04448037600476804
[Trial 3] Trying batch_size=16, lr=0.0003686047640658085, loss_fn=dice_loss
Epoch    1/50, time: 30.75 s, training_loss: 0.980
Epoch    1/50, time: 8.38 s, val_loss: 0.942
Training Metrics:
Accuracy: 0.5297
Precision: 0.5030
Recall: 0.6515
F1 Score: 0.3535
IoU: 0.0080
Dice Coefficient: 0.0159
Validation Metrics:
Accuracy: 0.6905
Precision: 0.5038
Recall: 0.6716
F1 Score: 0.4179
IoU: 0.0099
Dice Coefficient: 0.0196
Epoch    2/50, time: 31.10 s, training_loss: 0.966
Epoch    2/50, time: 9.38 s, val_loss: 0.898
Epoch    3/50, time: 30.17 s, training_loss: 0.945
Epoch    3/50, time: 8.66 s, val_loss: 0.829
Epoch    4/50, time: 30.92 s, training_loss: 0.923
Epoch    4/50, time: 8.51 s, val_loss: 0.851
Epoch    5/50, time: 30.68 s, training_loss: 0.900
Epoch    5/50, time: 8.05 s, val_loss: 0.880
Epoch    6/50, time: 30.23 s, training_loss: 0.887
Epoch    6/50, time: 8.57 s, val_loss: 0.819
Epoch    7/50, time: 29.67 s, training_loss: 0.866
Epoch    7/50, time: 8.46 s, val_loss: 0.828
Epoch    8/50, time: 30.73 s, training_loss: 0.835
Epoch    8/50, time: 8.51 s, val_loss: 0.763
Epoch    9/50, time: 31.12 s, training_loss: 0.814
Epoch    9/50, time: 8.50 s, val_loss: 0.749
Epoch   10/50, time: 31.66 s, training_loss: 0.792
Epoch   10/50, time: 8.46 s, val_loss: 0.782
Epoch   11/50, time: 29.92 s, training_loss: 0.779
Epoch   11/50, time: 8.51 s, val_loss: 0.735
Training Metrics:
Accuracy: 0.7884
Precision: 0.5045
Recall: 0.6542
F1 Score: 0.4524
IoU: 0.0119
Dice Coefficient: 0.0235
Validation Metrics:
Accuracy: 0.8514
Precision: 0.5061
Recall: 0.6645
F1 Score: 0.4745
IoU: 0.0150
Dice Coefficient: 0.0295
Epoch   12/50, time: 32.38 s, training_loss: 0.764
Epoch   12/50, time: 8.71 s, val_loss: 0.766
Epoch   13/50, time: 29.63 s, training_loss: 0.742
Epoch   13/50, time: 8.31 s, val_loss: 0.725
Epoch   14/50, time: 31.54 s, training_loss: 0.732
Epoch   14/50, time: 8.16 s, val_loss: 0.688
Epoch   15/50, time: 30.52 s, training_loss: 0.710
Epoch   15/50, time: 8.43 s, val_loss: 0.677
Epoch   16/50, time: 31.16 s, training_loss: 0.702
Epoch   16/50, time: 8.51 s, val_loss: 0.673
Epoch   17/50, time: 30.51 s, training_loss: 0.676
Epoch   17/50, time: 8.35 s, val_loss: 0.628
Epoch   18/50, time: 30.17 s, training_loss: 0.680
Epoch   18/50, time: 8.21 s, val_loss: 0.676
Epoch   19/50, time: 30.96 s, training_loss: 0.653
Epoch   19/50, time: 8.13 s, val_loss: 0.619
Epoch   20/50, time: 31.35 s, training_loss: 0.635
Epoch   20/50, time: 8.26 s, val_loss: 0.610
Epoch   21/50, time: 30.67 s, training_loss: 0.617
Epoch   21/50, time: 8.30 s, val_loss: 0.600
Training Metrics:
Accuracy: 0.9562
Precision: 0.5221
Recall: 0.6860
F1 Score: 0.5311
IoU: 0.0442
Dice Coefficient: 0.0847
Validation Metrics:
Accuracy: 0.9447
Precision: 0.5172
Recall: 0.6882
F1 Score: 0.5201
IoU: 0.0355
Dice Coefficient: 0.0686
Epoch   22/50, time: 31.99 s, training_loss: 0.602
Epoch   22/50, time: 8.75 s, val_loss: 0.581
Epoch   23/50, time: 30.77 s, training_loss: 0.608
Epoch   23/50, time: 8.37 s, val_loss: 0.651
Epoch   24/50, time: 30.23 s, training_loss: 0.609
Epoch   24/50, time: 8.13 s, val_loss: 0.565
Epoch   25/50, time: 30.46 s, training_loss: 0.584
Epoch   25/50, time: 8.27 s, val_loss: 0.624
Epoch   26/50, time: 30.35 s, training_loss: 0.581
Epoch   26/50, time: 8.25 s, val_loss: 0.541
Epoch   27/50, time: 30.89 s, training_loss: 0.554
Epoch   27/50, time: 9.07 s, val_loss: 0.554
Epoch   28/50, time: 31.01 s, training_loss: 0.533
Epoch   28/50, time: 9.01 s, val_loss: 0.541
Epoch   29/50, time: 31.27 s, training_loss: 0.520
Epoch   29/50, time: 8.15 s, val_loss: 0.520
Epoch   30/50, time: 35.91 s, training_loss: 0.513
Epoch   30/50, time: 9.27 s, val_loss: 0.475
Epoch   31/50, time: 29.65 s, training_loss: 0.509
Epoch   31/50, time: 10.49 s, val_loss: 0.466
Training Metrics:
Accuracy: 0.9535
Precision: 0.5283
Recall: 0.7603
F1 Score: 0.5414
IoU: 0.0563
Dice Coefficient: 0.1067
Validation Metrics:
Accuracy: 0.9557
Precision: 0.5288
Recall: 0.7616
F1 Score: 0.5427
IoU: 0.0571
Dice Coefficient: 0.1080
Epoch   32/50, time: 34.28 s, training_loss: 0.493
Epoch   32/50, time: 8.67 s, val_loss: 0.471
Epoch   33/50, time: 34.03 s, training_loss: 0.500
Epoch   33/50, time: 8.56 s, val_loss: 0.454
Epoch   34/50, time: 31.26 s, training_loss: 0.531
Epoch   34/50, time: 8.30 s, val_loss: 0.601
Epoch   35/50, time: 34.63 s, training_loss: 0.571
Epoch   35/50, time: 8.32 s, val_loss: 0.532
Epoch   36/50, time: 35.01 s, training_loss: 0.518
Epoch   36/50, time: 8.74 s, val_loss: 0.475
Epoch   37/50, time: 31.32 s, training_loss: 0.501
Epoch   37/50, time: 8.34 s, val_loss: 0.489
Epoch   38/50, time: 33.43 s, training_loss: 0.497
Epoch   38/50, time: 8.06 s, val_loss: 0.462
Epoch   39/50, time: 31.06 s, training_loss: 0.484
Epoch   39/50, time: 8.36 s, val_loss: 0.457
Epoch   40/50, time: 31.01 s, training_loss: 0.476
Epoch   40/50, time: 8.25 s, val_loss: 0.446
Epoch   41/50, time: 30.42 s, training_loss: 0.497
Epoch   41/50, time: 8.36 s, val_loss: 0.462
Training Metrics:
Accuracy: 0.9587
Precision: 0.5312
Recall: 0.7556
F1 Score: 0.5473
IoU: 0.0614
Dice Coefficient: 0.1157
Validation Metrics:
Accuracy: 0.9492
Precision: 0.5245
Recall: 0.7530
F1 Score: 0.5339
IoU: 0.0493
Dice Coefficient: 0.0940
Epoch   42/50, time: 33.59 s, training_loss: 0.486
Epoch   42/50, time: 8.24 s, val_loss: 0.444
Epoch   43/50, time: 33.12 s, training_loss: 0.467
Epoch   43/50, time: 8.61 s, val_loss: 0.446
Epoch   44/50, time: 34.20 s, training_loss: 0.453
Epoch   44/50, time: 8.49 s, val_loss: 0.448
Epoch   45/50, time: 33.19 s, training_loss: 0.456
Epoch   45/50, time: 8.40 s, val_loss: 0.438
Epoch   46/50, time: 34.09 s, training_loss: 0.445
Epoch   46/50, time: 8.02 s, val_loss: 0.429
Epoch   47/50, time: 29.97 s, training_loss: 0.461
Epoch   47/50, time: 8.72 s, val_loss: 0.451
Epoch   48/50, time: 31.01 s, training_loss: 0.447
Epoch   48/50, time: 8.57 s, val_loss: 0.449
Epoch   49/50, time: 33.40 s, training_loss: 0.445
Epoch   49/50, time: 8.98 s, val_loss: 0.430
Epoch   50/50, time: 33.67 s, training_loss: 0.444
Epoch   50/50, time: 9.77 s, val_loss: 0.422
Training Metrics:
Accuracy: 0.9643
Precision: 0.5391
Recall: 0.7832
F1 Score: 0.5617
IoU: 0.0762
Dice Coefficient: 0.1417
Validation Metrics:
Accuracy: 0.9524
Precision: 0.5287
Recall: 0.7820
F1 Score: 0.5419
IoU: 0.0573
Dice Coefficient: 0.1083
[I 2025-06-16 17:11:36,778] Trial 3 finished with value: 0.10831194629831471 and parameters: {'batch_size': 16, 'lr': 0.0003686047640658085, 'loss_fn': 'dice_loss'}. Best is trial 3 with value: 0.10831194629831471.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9524
Precision: 0.5287
Recall: 0.7820
F1 Score: 0.5419
IoU: 0.0573
Dice Coefficient: 0.1083
[Trial 3] Finished with val_loss=inf
[Trial 3] Finished with dice_coeff=0.10831194629831471
[Trial 4] Trying batch_size=16, lr=0.0008078921183289167, loss_fn=dice_loss
Epoch    1/50, time: 32.47 s, training_loss: 0.967
Epoch    1/50, time: 9.19 s, val_loss: 0.963
Training Metrics:
Accuracy: 0.7693
Precision: 0.5088
Recall: 0.8239
F1 Score: 0.4525
IoU: 0.0184
Dice Coefficient: 0.0360
Validation Metrics:
Accuracy: 0.5911
Precision: 0.5052
Recall: 0.7658
F1 Score: 0.3815
IoU: 0.0108
Dice Coefficient: 0.0214
Epoch    2/50, time: 35.18 s, training_loss: 0.935
Epoch    2/50, time: 10.68 s, val_loss: 0.957
Epoch    3/50, time: 31.16 s, training_loss: 0.857
Epoch    3/50, time: 8.62 s, val_loss: 0.811
Epoch    4/50, time: 33.08 s, training_loss: 0.808
Epoch    4/50, time: 10.09 s, val_loss: 0.796
Epoch    5/50, time: 32.62 s, training_loss: 0.788
Epoch    5/50, time: 8.67 s, val_loss: 0.767
Epoch    6/50, time: 30.64 s, training_loss: 0.773
Epoch    6/50, time: 8.64 s, val_loss: 0.776
Epoch    7/50, time: 31.42 s, training_loss: 0.772
Epoch    7/50, time: 9.91 s, val_loss: 0.760
Epoch    8/50, time: 33.85 s, training_loss: 0.759
Epoch    8/50, time: 8.87 s, val_loss: 0.744
Epoch    9/50, time: 32.77 s, training_loss: 0.754
Epoch    9/50, time: 8.32 s, val_loss: 0.732
Epoch   10/50, time: 33.80 s, training_loss: 0.730
Epoch   10/50, time: 8.19 s, val_loss: 0.722
Epoch   11/50, time: 30.95 s, training_loss: 0.715
Epoch   11/50, time: 8.60 s, val_loss: 0.690
Training Metrics:
Accuracy: 0.9879
Precision: 0.6079
Recall: 0.7782
F1 Score: 0.6543
IoU: 0.1868
Dice Coefficient: 0.3148
Validation Metrics:
Accuracy: 0.9887
Precision: 0.6126
Recall: 0.7830
F1 Score: 0.6600
IoU: 0.1945
Dice Coefficient: 0.3257
Epoch   12/50, time: 32.39 s, training_loss: 0.696
Epoch   12/50, time: 8.68 s, val_loss: 0.688
Epoch   13/50, time: 31.07 s, training_loss: 0.688
Epoch   13/50, time: 8.34 s, val_loss: 0.675
Epoch   14/50, time: 31.50 s, training_loss: 0.678
Epoch   14/50, time: 8.07 s, val_loss: 0.664
Epoch   15/50, time: 31.27 s, training_loss: 0.663
Epoch   15/50, time: 9.52 s, val_loss: 0.667
Epoch   16/50, time: 31.31 s, training_loss: 0.658
Epoch   16/50, time: 8.20 s, val_loss: 0.635
Epoch   17/50, time: 31.66 s, training_loss: 0.647
Epoch   17/50, time: 7.78 s, val_loss: 0.629
Epoch   18/50, time: 33.52 s, training_loss: 0.627
Epoch   18/50, time: 9.22 s, val_loss: 0.591
Epoch   19/50, time: 31.40 s, training_loss: 0.582
Epoch   19/50, time: 8.24 s, val_loss: 0.629
Epoch   20/50, time: 30.16 s, training_loss: 0.559
Epoch   20/50, time: 8.28 s, val_loss: 0.526
Epoch   21/50, time: 31.97 s, training_loss: 0.542
Epoch   21/50, time: 9.07 s, val_loss: 0.524
Training Metrics:
Accuracy: 0.9935
Precision: 0.6934
Recall: 0.7899
F1 Score: 0.7318
IoU: 0.3046
Dice Coefficient: 0.4670
Validation Metrics:
Accuracy: 0.9940
Precision: 0.7023
Recall: 0.7954
F1 Score: 0.7400
IoU: 0.3185
Dice Coefficient: 0.4831
Epoch   22/50, time: 31.88 s, training_loss: 0.521
Epoch   22/50, time: 8.78 s, val_loss: 0.496
Epoch   23/50, time: 30.90 s, training_loss: 0.501
Epoch   23/50, time: 8.29 s, val_loss: 0.501
Epoch   24/50, time: 31.58 s, training_loss: 0.491
Epoch   24/50, time: 8.30 s, val_loss: 0.489
Epoch   25/50, time: 34.37 s, training_loss: 0.479
Epoch   25/50, time: 9.24 s, val_loss: 0.462
Epoch   26/50, time: 29.80 s, training_loss: 0.472
Epoch   26/50, time: 8.32 s, val_loss: 0.482
Epoch   27/50, time: 31.58 s, training_loss: 0.464
Epoch   27/50, time: 8.73 s, val_loss: 0.433
Epoch   28/50, time: 30.62 s, training_loss: 0.453
Epoch   28/50, time: 10.64 s, val_loss: 0.442
Epoch   29/50, time: 34.97 s, training_loss: 0.447
Epoch   29/50, time: 8.50 s, val_loss: 0.424
Epoch   30/50, time: 32.26 s, training_loss: 0.433
Epoch   30/50, time: 10.25 s, val_loss: 0.415
Epoch   31/50, time: 30.94 s, training_loss: 0.425
Epoch   31/50, time: 8.43 s, val_loss: 0.449
Training Metrics:
Accuracy: 0.9955
Precision: 0.7671
Recall: 0.7991
F1 Score: 0.7822
IoU: 0.3953
Dice Coefficient: 0.5666
Validation Metrics:
Accuracy: 0.9957
Precision: 0.7718
Recall: 0.8010
F1 Score: 0.7857
IoU: 0.4020
Dice Coefficient: 0.5735
Epoch   32/50, time: 31.23 s, training_loss: 0.429
Epoch   32/50, time: 8.73 s, val_loss: 0.414
Epoch   33/50, time: 30.42 s, training_loss: 0.412
Epoch   33/50, time: 9.73 s, val_loss: 0.434
Epoch   34/50, time: 31.70 s, training_loss: 0.411
Epoch   34/50, time: 8.63 s, val_loss: 0.444
Epoch   35/50, time: 31.74 s, training_loss: 0.405
Epoch   35/50, time: 10.12 s, val_loss: 0.413
Epoch   36/50, time: 29.90 s, training_loss: 0.402
Epoch   36/50, time: 8.25 s, val_loss: 0.388
Epoch   37/50, time: 32.96 s, training_loss: 0.400
Epoch   37/50, time: 8.19 s, val_loss: 0.378
Epoch   38/50, time: 31.53 s, training_loss: 0.388
Epoch   38/50, time: 8.70 s, val_loss: 0.400
Epoch   39/50, time: 33.71 s, training_loss: 0.388
Epoch   39/50, time: 8.56 s, val_loss: 0.377
Epoch   40/50, time: 33.13 s, training_loss: 0.386
Epoch   40/50, time: 9.84 s, val_loss: 0.389
Epoch   41/50, time: 29.64 s, training_loss: 0.380
Epoch   41/50, time: 8.05 s, val_loss: 0.374
Training Metrics:
Accuracy: 0.9967
Precision: 0.8366
Recall: 0.8146
F1 Score: 0.8252
IoU: 0.4838
Dice Coefficient: 0.6521
Validation Metrics:
Accuracy: 0.9968
Precision: 0.8365
Recall: 0.8095
F1 Score: 0.8224
IoU: 0.4776
Dice Coefficient: 0.6465
Epoch   42/50, time: 32.04 s, training_loss: 0.374
Epoch   42/50, time: 8.95 s, val_loss: 0.367
Epoch   43/50, time: 31.01 s, training_loss: 0.372
Epoch   43/50, time: 8.54 s, val_loss: 0.380
Epoch   44/50, time: 32.51 s, training_loss: 0.371
Epoch   44/50, time: 9.47 s, val_loss: 0.364
Epoch   45/50, time: 30.55 s, training_loss: 0.371
Epoch   45/50, time: 8.45 s, val_loss: 0.370
Epoch   46/50, time: 31.13 s, training_loss: 0.365
Epoch   46/50, time: 8.22 s, val_loss: 0.395
Epoch   47/50, time: 35.96 s, training_loss: 0.362
Epoch   47/50, time: 8.49 s, val_loss: 0.358
Epoch   48/50, time: 30.39 s, training_loss: 0.361
Epoch   48/50, time: 9.52 s, val_loss: 0.360
Epoch   49/50, time: 31.52 s, training_loss: 0.357
Epoch   49/50, time: 8.19 s, val_loss: 0.348
Epoch   50/50, time: 30.36 s, training_loss: 0.352
Epoch   50/50, time: 8.28 s, val_loss: 0.368
Training Metrics:
Accuracy: 0.9967
Precision: 0.8313
Recall: 0.8250
F1 Score: 0.8281
IoU: 0.4902
Dice Coefficient: 0.6579
Validation Metrics:
Accuracy: 0.9968
Precision: 0.8379
Recall: 0.8155
F1 Score: 0.8263
IoU: 0.4861
Dice Coefficient: 0.6542
[I 2025-06-16 17:54:10,754] Trial 4 finished with value: 0.6541612153708668 and parameters: {'batch_size': 16, 'lr': 0.0008078921183289167, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9968
Precision: 0.8379
Recall: 0.8155
F1 Score: 0.8263
IoU: 0.4861
Dice Coefficient: 0.6542
[Trial 4] Finished with val_loss=inf
[Trial 4] Finished with dice_coeff=0.6541612153708668
[Trial 5] Trying batch_size=64, lr=0.0008019566403643441, loss_fn=dice_loss
Epoch    1/50, time: 39.89 s, training_loss: 0.977
Epoch    1/50, time: 8.21 s, val_loss: 0.984
Training Metrics:
Accuracy: 0.3281
Precision: 0.5036
Recall: 0.6623
F1 Score: 0.2524
IoU: 0.0072
Dice Coefficient: 0.0144
Validation Metrics:
Accuracy: 0.4434
Precision: 0.5042
Recall: 0.7203
F1 Score: 0.3143
IoU: 0.0084
Dice Coefficient: 0.0168
Epoch    2/50, time: 37.25 s, training_loss: 0.966
Epoch    2/50, time: 8.53 s, val_loss: 0.988
Epoch    3/50, time: 36.73 s, training_loss: 0.956
Epoch    3/50, time: 8.19 s, val_loss: 0.986
Epoch    4/50, time: 37.77 s, training_loss: 0.944
Epoch    4/50, time: 8.48 s, val_loss: 0.988
Epoch    5/50, time: 37.08 s, training_loss: 0.929
Epoch    5/50, time: 8.76 s, val_loss: 0.988
Epoch    6/50, time: 37.63 s, training_loss: 0.914
Epoch    6/50, time: 8.51 s, val_loss: 0.990
Epoch    7/50, time: 38.40 s, training_loss: 0.903
Epoch    7/50, time: 9.47 s, val_loss: 0.987
Epoch    8/50, time: 37.46 s, training_loss: 0.894
Epoch    8/50, time: 8.40 s, val_loss: 0.984
Epoch    9/50, time: 38.84 s, training_loss: 0.882
Epoch    9/50, time: 8.99 s, val_loss: 0.983
Epoch   10/50, time: 37.23 s, training_loss: 0.864
Epoch   10/50, time: 8.25 s, val_loss: 0.870
Epoch   11/50, time: 36.92 s, training_loss: 0.841
Epoch   11/50, time: 9.29 s, val_loss: 0.990
Training Metrics:
Accuracy: 0.3470
Precision: 0.5018
Recall: 0.5829
F1 Score: 0.2623
IoU: 0.0061
Dice Coefficient: 0.0122
Validation Metrics:
Accuracy: 0.0091
Precision: 0.5018
Recall: 0.5017
F1 Score: 0.0091
IoU: 0.0048
Dice Coefficient: 0.0095
Epoch   12/50, time: 35.31 s, training_loss: 0.831
Epoch   12/50, time: 8.40 s, val_loss: 0.961
Epoch   13/50, time: 39.23 s, training_loss: 0.815
Epoch   13/50, time: 8.52 s, val_loss: 0.912
Epoch   14/50, time: 35.21 s, training_loss: 0.812
Epoch   14/50, time: 8.88 s, val_loss: 0.783
Epoch   15/50, time: 39.90 s, training_loss: 0.793
Epoch   15/50, time: 8.27 s, val_loss: 0.787
Epoch   16/50, time: 40.18 s, training_loss: 0.784
Epoch   16/50, time: 8.12 s, val_loss: 0.766
Epoch   17/50, time: 39.39 s, training_loss: 0.790
Epoch   17/50, time: 8.52 s, val_loss: 0.827
Epoch   18/50, time: 40.96 s, training_loss: 0.776
Epoch   18/50, time: 8.69 s, val_loss: 0.787
Epoch   19/50, time: 38.85 s, training_loss: 0.767
Epoch   19/50, time: 8.20 s, val_loss: 0.768
Epoch   20/50, time: 36.68 s, training_loss: 0.764
Epoch   20/50, time: 9.08 s, val_loss: 0.817
Epoch   21/50, time: 39.00 s, training_loss: 0.760
Epoch   21/50, time: 8.46 s, val_loss: 0.776
Training Metrics:
Accuracy: 0.9151
Precision: 0.5166
Recall: 0.7679
F1 Score: 0.5111
IoU: 0.0345
Dice Coefficient: 0.0668
Validation Metrics:
Accuracy: 0.8829
Precision: 0.5125
Recall: 0.7775
F1 Score: 0.4946
IoU: 0.0265
Dice Coefficient: 0.0515
Epoch   22/50, time: 38.19 s, training_loss: 0.752
Epoch   22/50, time: 8.49 s, val_loss: 0.737
Epoch   23/50, time: 38.78 s, training_loss: 0.744
Epoch   23/50, time: 9.46 s, val_loss: 0.739
Epoch   24/50, time: 35.46 s, training_loss: 0.739
Epoch   24/50, time: 8.11 s, val_loss: 0.758
Epoch   25/50, time: 36.13 s, training_loss: 0.744
Epoch   25/50, time: 8.67 s, val_loss: 0.742
Epoch   26/50, time: 40.04 s, training_loss: 0.736
Epoch   26/50, time: 8.70 s, val_loss: 0.743
Epoch   27/50, time: 38.77 s, training_loss: 0.730
Epoch   27/50, time: 8.75 s, val_loss: 0.729
Epoch   28/50, time: 40.19 s, training_loss: 0.717
Epoch   28/50, time: 9.40 s, val_loss: 0.698
Epoch   29/50, time: 35.76 s, training_loss: 0.716
Epoch   29/50, time: 8.30 s, val_loss: 0.700
Epoch   30/50, time: 35.16 s, training_loss: 0.707
Epoch   30/50, time: 9.61 s, val_loss: 0.690
Epoch   31/50, time: 36.32 s, training_loss: 0.698
Epoch   31/50, time: 8.51 s, val_loss: 0.691
Training Metrics:
Accuracy: 0.9802
Precision: 0.5695
Recall: 0.7897
F1 Score: 0.6091
IoU: 0.1288
Dice Coefficient: 0.2282
Validation Metrics:
Accuracy: 0.9748
Precision: 0.5526
Recall: 0.7823
F1 Score: 0.5842
IoU: 0.0996
Dice Coefficient: 0.1812
Epoch   32/50, time: 36.63 s, training_loss: 0.692
Epoch   32/50, time: 9.18 s, val_loss: 0.678
Epoch   33/50, time: 37.97 s, training_loss: 0.684
Epoch   33/50, time: 9.21 s, val_loss: 0.687
Epoch   34/50, time: 35.74 s, training_loss: 0.679
Epoch   34/50, time: 10.75 s, val_loss: 0.676
Epoch   35/50, time: 40.06 s, training_loss: 0.688
Epoch   35/50, time: 8.54 s, val_loss: 0.679
Epoch   36/50, time: 36.26 s, training_loss: 0.689
Epoch   36/50, time: 8.70 s, val_loss: 0.668
Epoch   37/50, time: 40.14 s, training_loss: 0.672
Epoch   37/50, time: 8.44 s, val_loss: 0.661
Epoch   38/50, time: 37.40 s, training_loss: 0.660
Epoch   38/50, time: 8.31 s, val_loss: 0.653
Epoch   39/50, time: 38.51 s, training_loss: 0.659
Epoch   39/50, time: 8.85 s, val_loss: 0.660
Epoch   40/50, time: 37.05 s, training_loss: 0.620
Epoch   40/50, time: 8.47 s, val_loss: 0.586
Epoch   41/50, time: 35.42 s, training_loss: 0.589
Epoch   41/50, time: 8.63 s, val_loss: 0.664
Training Metrics:
Accuracy: 0.9922
Precision: 0.6203
Recall: 0.6379
F1 Score: 0.6285
IoU: 0.1501
Dice Coefficient: 0.2610
Validation Metrics:
Accuracy: 0.9934
Precision: 0.6515
Recall: 0.6534
F1 Score: 0.6524
IoU: 0.1821
Dice Coefficient: 0.3082
Epoch   42/50, time: 38.08 s, training_loss: 0.600
Epoch   42/50, time: 8.34 s, val_loss: 0.590
Epoch   43/50, time: 35.84 s, training_loss: 0.559
Epoch   43/50, time: 8.43 s, val_loss: 0.565
Epoch   44/50, time: 38.40 s, training_loss: 0.542
Epoch   44/50, time: 9.41 s, val_loss: 0.533
Epoch   45/50, time: 37.66 s, training_loss: 0.536
Epoch   45/50, time: 8.42 s, val_loss: 0.507
Epoch   46/50, time: 39.59 s, training_loss: 0.522
Epoch   46/50, time: 8.84 s, val_loss: 0.507
Epoch   47/50, time: 36.92 s, training_loss: 0.504
Epoch   47/50, time: 8.42 s, val_loss: 0.528
Epoch   48/50, time: 41.28 s, training_loss: 0.514
Epoch   48/50, time: 7.99 s, val_loss: 0.536
Epoch   49/50, time: 42.52 s, training_loss: 0.512
Epoch   49/50, time: 8.71 s, val_loss: 0.489
Epoch   50/50, time: 40.40 s, training_loss: 0.495
Epoch   50/50, time: 8.91 s, val_loss: 0.485
Training Metrics:
Accuracy: 0.9955
Precision: 0.7753
Recall: 0.7413
F1 Score: 0.7571
IoU: 0.3482
Dice Coefficient: 0.5165
Validation Metrics:
Accuracy: 0.9958
Precision: 0.7805
Recall: 0.7481
F1 Score: 0.7633
IoU: 0.3594
Dice Coefficient: 0.5288
[I 2025-06-16 18:42:19,933] Trial 5 finished with value: 0.5287598510982021 and parameters: {'batch_size': 64, 'lr': 0.0008019566403643441, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9958
Precision: 0.7805
Recall: 0.7481
F1 Score: 0.7633
IoU: 0.3594
Dice Coefficient: 0.5288
[Trial 5] Finished with val_loss=inf
[Trial 5] Finished with dice_coeff=0.5287598510982021
[Trial 6] Trying batch_size=128, lr=0.00025658449417878407, loss_fn=dice_loss
Epoch    1/50, time: 42.60 s, training_loss: 0.982
Epoch    1/50, time: 9.61 s, val_loss: 0.987
Training Metrics:
Accuracy: 0.6550
Precision: 0.5056
Recall: 0.7625
F1 Score: 0.4073
IoU: 0.0122
Dice Coefficient: 0.0242
Validation Metrics:
Accuracy: 0.6614
Precision: 0.5055
Recall: 0.7643
F1 Score: 0.4095
IoU: 0.0120
Dice Coefficient: 0.0237
Epoch    2/50, time: 46.87 s, training_loss: 0.979
Epoch    2/50, time: 9.77 s, val_loss: 0.987
Epoch    3/50, time: 48.68 s, training_loss: 0.976
Epoch    3/50, time: 8.73 s, val_loss: 0.984
Epoch    4/50, time: 47.42 s, training_loss: 0.972
Epoch    4/50, time: 8.64 s, val_loss: 0.976
Epoch    5/50, time: 47.91 s, training_loss: 0.969
Epoch    5/50, time: 8.57 s, val_loss: 0.917
Epoch    6/50, time: 48.53 s, training_loss: 0.966
Epoch    6/50, time: 8.36 s, val_loss: 0.944
Epoch    7/50, time: 43.02 s, training_loss: 0.961
Epoch    7/50, time: 9.43 s, val_loss: 0.949
Epoch    8/50, time: 43.65 s, training_loss: 0.957
Epoch    8/50, time: 8.35 s, val_loss: 0.952
Epoch    9/50, time: 48.32 s, training_loss: 0.952
Epoch    9/50, time: 8.47 s, val_loss: 0.986
Epoch   10/50, time: 49.01 s, training_loss: 0.955
Epoch   10/50, time: 8.40 s, val_loss: 0.981
Epoch   11/50, time: 43.82 s, training_loss: 0.950
Epoch   11/50, time: 9.65 s, val_loss: 0.982
Training Metrics:
Accuracy: 0.5871
Precision: 0.5013
Recall: 0.5643
F1 Score: 0.3758
IoU: 0.0064
Dice Coefficient: 0.0127
Validation Metrics:
Accuracy: 0.6559
Precision: 0.5008
Recall: 0.5362
F1 Score: 0.4015
IoU: 0.0057
Dice Coefficient: 0.0113
Epoch   12/50, time: 47.43 s, training_loss: 0.942
Epoch   12/50, time: 8.22 s, val_loss: 0.935
Epoch   13/50, time: 43.89 s, training_loss: 0.937
Epoch   13/50, time: 8.01 s, val_loss: 0.954
Epoch   14/50, time: 47.24 s, training_loss: 0.931
Epoch   14/50, time: 8.46 s, val_loss: 0.959
Epoch   15/50, time: 45.07 s, training_loss: 0.929
Epoch   15/50, time: 9.03 s, val_loss: 0.981
Epoch   16/50, time: 44.71 s, training_loss: 0.931
Epoch   16/50, time: 8.40 s, val_loss: 0.905
Epoch   17/50, time: 45.19 s, training_loss: 0.922
Epoch   17/50, time: 8.65 s, val_loss: 0.942
Epoch   18/50, time: 45.36 s, training_loss: 0.916
Epoch   18/50, time: 8.61 s, val_loss: 0.938
Epoch   19/50, time: 44.18 s, training_loss: 0.916
Epoch   19/50, time: 8.61 s, val_loss: 0.876
Epoch   20/50, time: 44.85 s, training_loss: 0.907
Epoch   20/50, time: 8.58 s, val_loss: 0.839
Epoch   21/50, time: 42.43 s, training_loss: 0.907
Epoch   21/50, time: 8.59 s, val_loss: 0.814
Training Metrics:
Accuracy: 0.5054
Precision: 0.5027
Recall: 0.6390
F1 Score: 0.3425
IoU: 0.0076
Dice Coefficient: 0.0151
Validation Metrics:
Accuracy: 0.8943
Precision: 0.5124
Recall: 0.7499
F1 Score: 0.4977
IoU: 0.0264
Dice Coefficient: 0.0514
Epoch   22/50, time: 41.59 s, training_loss: 0.903
Epoch   22/50, time: 8.65 s, val_loss: 0.800
Epoch   23/50, time: 43.07 s, training_loss: 0.896
Epoch   23/50, time: 9.41 s, val_loss: 0.834
Epoch   24/50, time: 47.13 s, training_loss: 0.888
Epoch   24/50, time: 9.15 s, val_loss: 0.927
Epoch   25/50, time: 44.53 s, training_loss: 0.884
Epoch   25/50, time: 9.19 s, val_loss: 0.947
Epoch   26/50, time: 44.22 s, training_loss: 0.881
Epoch   26/50, time: 8.44 s, val_loss: 0.973
Epoch   27/50, time: 45.00 s, training_loss: 0.882
Epoch   27/50, time: 8.06 s, val_loss: 0.939
Epoch   28/50, time: 46.42 s, training_loss: 0.874
Epoch   28/50, time: 9.20 s, val_loss: 0.866
Epoch   29/50, time: 43.84 s, training_loss: 0.866
Epoch   29/50, time: 8.49 s, val_loss: 0.781
Epoch   30/50, time: 43.58 s, training_loss: 0.859
Epoch   30/50, time: 8.54 s, val_loss: 0.800
Epoch   31/50, time: 45.17 s, training_loss: 0.851
Epoch   31/50, time: 8.39 s, val_loss: 0.800
Training Metrics:
Accuracy: 0.6558
Precision: 0.5033
Recall: 0.6522
F1 Score: 0.4047
IoU: 0.0092
Dice Coefficient: 0.0182
Validation Metrics:
Accuracy: 0.8471
Precision: 0.5076
Recall: 0.7079
F1 Score: 0.4755
IoU: 0.0173
Dice Coefficient: 0.0340
Epoch   32/50, time: 46.53 s, training_loss: 0.847
Epoch   32/50, time: 8.53 s, val_loss: 0.763
Epoch   33/50, time: 47.62 s, training_loss: 0.843
Epoch   33/50, time: 8.49 s, val_loss: 0.806
Epoch   34/50, time: 44.69 s, training_loss: 0.834
Epoch   34/50, time: 8.12 s, val_loss: 0.788
Epoch   35/50, time: 46.38 s, training_loss: 0.831
Epoch   35/50, time: 8.40 s, val_loss: 0.799
Epoch   36/50, time: 42.92 s, training_loss: 0.823
Epoch   36/50, time: 9.19 s, val_loss: 0.762
Epoch   37/50, time: 45.35 s, training_loss: 0.817
Epoch   37/50, time: 8.34 s, val_loss: 0.768
Epoch   38/50, time: 48.94 s, training_loss: 0.817
Epoch   38/50, time: 8.41 s, val_loss: 0.804
Epoch   39/50, time: 43.50 s, training_loss: 0.808
Epoch   39/50, time: 9.44 s, val_loss: 0.763
Epoch   40/50, time: 47.01 s, training_loss: 0.804
Epoch   40/50, time: 8.46 s, val_loss: 0.731
Epoch   41/50, time: 42.96 s, training_loss: 0.800
Epoch   41/50, time: 9.47 s, val_loss: 0.810
Training Metrics:
Accuracy: 0.4130
Precision: 0.5016
Recall: 0.5817
F1 Score: 0.2974
IoU: 0.0062
Dice Coefficient: 0.0124
Validation Metrics:
Accuracy: 0.5411
Precision: 0.5022
Recall: 0.6141
F1 Score: 0.3575
IoU: 0.0071
Dice Coefficient: 0.0140
Epoch   42/50, time: 43.49 s, training_loss: 0.793
Epoch   42/50, time: 9.43 s, val_loss: 0.784
Epoch   43/50, time: 42.55 s, training_loss: 0.802
Epoch   43/50, time: 8.41 s, val_loss: 0.769
Epoch   44/50, time: 44.44 s, training_loss: 0.800
Epoch   44/50, time: 8.72 s, val_loss: 0.731
Epoch   45/50, time: 46.57 s, training_loss: 0.787
Epoch   45/50, time: 8.45 s, val_loss: 0.712
Epoch   46/50, time: 45.18 s, training_loss: 0.764
Epoch   46/50, time: 8.22 s, val_loss: 0.716
Epoch   47/50, time: 43.87 s, training_loss: 0.752
Epoch   47/50, time: 9.45 s, val_loss: 0.700
Epoch   48/50, time: 48.52 s, training_loss: 0.742
Epoch   48/50, time: 8.45 s, val_loss: 0.692
Epoch   49/50, time: 42.25 s, training_loss: 0.731
Epoch   49/50, time: 9.35 s, val_loss: 0.808
Epoch   50/50, time: 45.22 s, training_loss: 0.729
Epoch   50/50, time: 9.34 s, val_loss: 0.649
Training Metrics:
Accuracy: 0.7038
Precision: 0.5037
Recall: 0.6586
F1 Score: 0.4227
IoU: 0.0101
Dice Coefficient: 0.0199
Validation Metrics:
Accuracy: 0.8281
Precision: 0.5059
Recall: 0.6796
F1 Score: 0.4670
IoU: 0.0144
Dice Coefficient: 0.0284
[I 2025-06-16 19:37:09,900] Trial 6 finished with value: 0.028394715855057137 and parameters: {'batch_size': 128, 'lr': 0.00025658449417878407, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.8281
Precision: 0.5059
Recall: 0.6796
F1 Score: 0.4670
IoU: 0.0144
Dice Coefficient: 0.0284
[Trial 6] Finished with val_loss=inf
[Trial 6] Finished with dice_coeff=0.028394715855057137
[Trial 7] Trying batch_size=64, lr=0.0005723943746197924, loss_fn=dice_loss
Epoch    1/50, time: 35.42 s, training_loss: 0.981
Epoch    1/50, time: 9.52 s, val_loss: 0.986
Training Metrics:
Accuracy: 0.1877
Precision: 0.5030
Recall: 0.5907
F1 Score: 0.1612
IoU: 0.0060
Dice Coefficient: 0.0119
Validation Metrics:
Accuracy: 0.3049
Precision: 0.5033
Recall: 0.6490
F1 Score: 0.2384
IoU: 0.0068
Dice Coefficient: 0.0134
Epoch    2/50, time: 38.92 s, training_loss: 0.971
Epoch    2/50, time: 9.72 s, val_loss: 0.969
Epoch    3/50, time: 38.03 s, training_loss: 0.961
Epoch    3/50, time: 8.28 s, val_loss: 0.948
Epoch    4/50, time: 36.58 s, training_loss: 0.947
Epoch    4/50, time: 9.22 s, val_loss: 0.981
Epoch    5/50, time: 35.26 s, training_loss: 0.932
Epoch    5/50, time: 8.81 s, val_loss: 0.879
Epoch    6/50, time: 40.05 s, training_loss: 0.921
Epoch    6/50, time: 9.36 s, val_loss: 0.990
Epoch    7/50, time: 39.21 s, training_loss: 0.911
Epoch    7/50, time: 8.83 s, val_loss: 0.922
Epoch    8/50, time: 35.51 s, training_loss: 0.899
Epoch    8/50, time: 8.37 s, val_loss: 0.886
Epoch    9/50, time: 41.66 s, training_loss: 0.890
Epoch    9/50, time: 8.48 s, val_loss: 0.827
Epoch   10/50, time: 40.12 s, training_loss: 0.872
Epoch   10/50, time: 8.48 s, val_loss: 0.964
Epoch   11/50, time: 37.64 s, training_loss: 0.861
Epoch   11/50, time: 8.80 s, val_loss: 0.831
Training Metrics:
Accuracy: 0.8180
Precision: 0.5036
Recall: 0.6093
F1 Score: 0.4603
IoU: 0.0106
Dice Coefficient: 0.0210
Validation Metrics:
Accuracy: 0.8372
Precision: 0.5042
Recall: 0.6204
F1 Score: 0.4670
IoU: 0.0116
Dice Coefficient: 0.0229
Epoch   12/50, time: 36.67 s, training_loss: 0.844
Epoch   12/50, time: 8.83 s, val_loss: 0.831
Epoch   13/50, time: 41.90 s, training_loss: 0.836
Epoch   13/50, time: 8.48 s, val_loss: 0.806
Epoch   14/50, time: 39.61 s, training_loss: 0.828
Epoch   14/50, time: 8.38 s, val_loss: 0.781
Epoch   15/50, time: 37.01 s, training_loss: 0.815
Epoch   15/50, time: 8.00 s, val_loss: 0.806
Epoch   16/50, time: 41.36 s, training_loss: 0.803
Epoch   16/50, time: 9.39 s, val_loss: 0.794
Epoch   17/50, time: 37.96 s, training_loss: 0.799
Epoch   17/50, time: 8.64 s, val_loss: 0.824
Epoch   18/50, time: 37.06 s, training_loss: 0.793
Epoch   18/50, time: 8.19 s, val_loss: 0.762
Epoch   19/50, time: 41.29 s, training_loss: 0.778
Epoch   19/50, time: 8.50 s, val_loss: 0.763
Epoch   20/50, time: 39.62 s, training_loss: 0.768
Epoch   20/50, time: 8.40 s, val_loss: 0.788
Epoch   21/50, time: 35.63 s, training_loss: 0.758
Epoch   21/50, time: 9.44 s, val_loss: 0.737
Training Metrics:
Accuracy: 0.8560
Precision: 0.5092
Recall: 0.7333
F1 Score: 0.4810
IoU: 0.0203
Dice Coefficient: 0.0399
Validation Metrics:
Accuracy: 0.9046
Precision: 0.5137
Recall: 0.7520
F1 Score: 0.5029
IoU: 0.0289
Dice Coefficient: 0.0561
Epoch   22/50, time: 36.78 s, training_loss: 0.751
Epoch   22/50, time: 8.34 s, val_loss: 0.728
Epoch   23/50, time: 38.08 s, training_loss: 0.736
Epoch   23/50, time: 8.33 s, val_loss: 0.717
Epoch   24/50, time: 36.64 s, training_loss: 0.721
Epoch   24/50, time: 8.22 s, val_loss: 0.694
Epoch   25/50, time: 36.29 s, training_loss: 0.705
Epoch   25/50, time: 8.18 s, val_loss: 0.713
Epoch   26/50, time: 36.84 s, training_loss: 0.691
Epoch   26/50, time: 9.89 s, val_loss: 0.681
Epoch   27/50, time: 34.62 s, training_loss: 0.696
Epoch   27/50, time: 9.57 s, val_loss: 0.691
Epoch   28/50, time: 36.84 s, training_loss: 0.709
Epoch   28/50, time: 9.22 s, val_loss: 0.663
Epoch   29/50, time: 38.88 s, training_loss: 0.680
Epoch   29/50, time: 8.66 s, val_loss: 0.687
Epoch   30/50, time: 36.11 s, training_loss: 0.653
Epoch   30/50, time: 8.57 s, val_loss: 0.647
Epoch   31/50, time: 34.71 s, training_loss: 0.639
Epoch   31/50, time: 9.16 s, val_loss: 0.624
Training Metrics:
Accuracy: 0.9314
Precision: 0.5153
Recall: 0.6998
F1 Score: 0.5134
IoU: 0.0322
Dice Coefficient: 0.0624
Validation Metrics:
Accuracy: 0.9245
Precision: 0.5134
Recall: 0.6979
F1 Score: 0.5081
IoU: 0.0286
Dice Coefficient: 0.0556
Epoch   32/50, time: 36.43 s, training_loss: 0.629
Epoch   32/50, time: 8.16 s, val_loss: 0.608
Epoch   33/50, time: 37.97 s, training_loss: 0.613
Epoch   33/50, time: 8.29 s, val_loss: 0.582
Epoch   34/50, time: 35.52 s, training_loss: 0.595
Epoch   34/50, time: 9.15 s, val_loss: 0.579
Epoch   35/50, time: 35.98 s, training_loss: 0.598
Epoch   35/50, time: 8.31 s, val_loss: 0.602
Epoch   36/50, time: 35.82 s, training_loss: 0.585
Epoch   36/50, time: 8.56 s, val_loss: 0.927
Epoch   37/50, time: 41.61 s, training_loss: 0.589
Epoch   37/50, time: 9.36 s, val_loss: 0.603
Epoch   38/50, time: 37.26 s, training_loss: 0.588
Epoch   38/50, time: 9.37 s, val_loss: 0.570
Epoch   39/50, time: 36.88 s, training_loss: 0.584
Epoch   39/50, time: 9.52 s, val_loss: 0.582
Epoch   40/50, time: 36.03 s, training_loss: 0.567
Epoch   40/50, time: 8.28 s, val_loss: 0.550
Epoch   41/50, time: 35.47 s, training_loss: 0.555
Epoch   41/50, time: 9.31 s, val_loss: 0.555
Training Metrics:
Accuracy: 0.9657
Precision: 0.5310
Recall: 0.7071
F1 Score: 0.5478
IoU: 0.0600
Dice Coefficient: 0.1132
Validation Metrics:
Accuracy: 0.9542
Precision: 0.5228
Recall: 0.7096
F1 Score: 0.5320
IoU: 0.0457
Dice Coefficient: 0.0874
Epoch   42/50, time: 37.26 s, training_loss: 0.539
Epoch   42/50, time: 8.17 s, val_loss: 0.532
Epoch   43/50, time: 35.45 s, training_loss: 0.531
Epoch   43/50, time: 8.79 s, val_loss: 0.518
Epoch   44/50, time: 34.88 s, training_loss: 0.526
Epoch   44/50, time: 8.32 s, val_loss: 0.516
Epoch   45/50, time: 35.12 s, training_loss: 0.524
Epoch   45/50, time: 8.53 s, val_loss: 0.514
Epoch   46/50, time: 36.91 s, training_loss: 0.510
Epoch   46/50, time: 8.58 s, val_loss: 0.527
Epoch   47/50, time: 36.96 s, training_loss: 0.499
Epoch   47/50, time: 8.40 s, val_loss: 0.514
Epoch   48/50, time: 34.79 s, training_loss: 0.503
Epoch   48/50, time: 8.10 s, val_loss: 0.534
Epoch   49/50, time: 36.50 s, training_loss: 0.613
Epoch   49/50, time: 8.55 s, val_loss: 0.564
Epoch   50/50, time: 35.20 s, training_loss: 0.566
Epoch   50/50, time: 8.37 s, val_loss: 0.541
Training Metrics:
Accuracy: 0.9695
Precision: 0.5356
Recall: 0.7125
F1 Score: 0.5558
IoU: 0.0678
Dice Coefficient: 0.1270
Validation Metrics:
Accuracy: 0.9620
Precision: 0.5286
Recall: 0.7206
F1 Score: 0.5435
IoU: 0.0562
Dice Coefficient: 0.1064
[I 2025-06-16 20:24:47,311] Trial 7 finished with value: 0.10638820063071719 and parameters: {'batch_size': 64, 'lr': 0.0005723943746197924, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9620
Precision: 0.5286
Recall: 0.7206
F1 Score: 0.5435
IoU: 0.0562
Dice Coefficient: 0.1064
[Trial 7] Finished with val_loss=inf
[Trial 7] Finished with dice_coeff=0.10638820063071719
[Trial 8] Trying batch_size=32, lr=0.00042707173595418676, loss_fn=dice_loss
Epoch    1/50, time: 31.76 s, training_loss: 0.979
Epoch    1/50, time: 8.43 s, val_loss: 0.940
Training Metrics:
Accuracy: 0.5682
Precision: 0.5028
Recall: 0.6422
F1 Score: 0.3697
IoU: 0.0081
Dice Coefficient: 0.0160
Validation Metrics:
Accuracy: 0.8388
Precision: 0.5057
Recall: 0.6632
F1 Score: 0.4700
IoU: 0.0141
Dice Coefficient: 0.0278
Epoch    2/50, time: 33.69 s, training_loss: 0.968
Epoch    2/50, time: 8.63 s, val_loss: 0.983
Epoch    3/50, time: 33.27 s, training_loss: 0.949
Epoch    3/50, time: 8.40 s, val_loss: 0.884
Epoch    4/50, time: 32.67 s, training_loss: 0.931
Epoch    4/50, time: 8.54 s, val_loss: 0.980
Epoch    5/50, time: 33.26 s, training_loss: 0.911
Epoch    5/50, time: 8.58 s, val_loss: 0.895
Epoch    6/50, time: 31.30 s, training_loss: 0.900
Epoch    6/50, time: 8.54 s, val_loss: 0.828
Epoch    7/50, time: 31.54 s, training_loss: 0.887
Epoch    7/50, time: 8.64 s, val_loss: 0.841
Epoch    8/50, time: 31.78 s, training_loss: 0.864
Epoch    8/50, time: 8.52 s, val_loss: 0.827
Epoch    9/50, time: 32.07 s, training_loss: 0.844
Epoch    9/50, time: 8.24 s, val_loss: 0.826
Epoch   10/50, time: 32.46 s, training_loss: 0.835
Epoch   10/50, time: 8.49 s, val_loss: 0.914
Epoch   11/50, time: 31.92 s, training_loss: 0.833
Epoch   11/50, time: 8.53 s, val_loss: 0.991
Training Metrics:
Accuracy: 0.1985
Precision: 0.5018
Recall: 0.5562
F1 Score: 0.1686
IoU: 0.0056
Dice Coefficient: 0.0111
Validation Metrics:
Accuracy: 0.0048
Precision: 0.5024
Recall: 0.5000
F1 Score: 0.0047
IoU: 0.0047
Dice Coefficient: 0.0094
Epoch   12/50, time: 32.62 s, training_loss: 0.837
Epoch   12/50, time: 8.70 s, val_loss: 0.819
Epoch   13/50, time: 32.10 s, training_loss: 0.801
Epoch   13/50, time: 8.44 s, val_loss: 0.767
Epoch   14/50, time: 33.75 s, training_loss: 0.779
Epoch   14/50, time: 8.25 s, val_loss: 0.789
Epoch   15/50, time: 31.84 s, training_loss: 0.773
Epoch   15/50, time: 8.24 s, val_loss: 0.765
Epoch   16/50, time: 31.89 s, training_loss: 0.751
Epoch   16/50, time: 8.39 s, val_loss: 0.734
Epoch   17/50, time: 32.34 s, training_loss: 0.752
Epoch   17/50, time: 8.32 s, val_loss: 0.721
Epoch   18/50, time: 33.23 s, training_loss: 0.734
Epoch   18/50, time: 8.29 s, val_loss: 0.689
Epoch   19/50, time: 33.00 s, training_loss: 0.720
Epoch   19/50, time: 8.25 s, val_loss: 0.693
Epoch   20/50, time: 32.22 s, training_loss: 0.709
Epoch   20/50, time: 8.53 s, val_loss: 0.680
Epoch   21/50, time: 32.95 s, training_loss: 0.692
Epoch   21/50, time: 8.59 s, val_loss: 0.655
Training Metrics:
Accuracy: 0.9015
Precision: 0.5121
Recall: 0.7210
F1 Score: 0.4995
IoU: 0.0261
Dice Coefficient: 0.0509
Validation Metrics:
Accuracy: 0.9028
Precision: 0.5125
Recall: 0.7336
F1 Score: 0.5004
IoU: 0.0267
Dice Coefficient: 0.0520
Epoch   22/50, time: 32.04 s, training_loss: 0.670
Epoch   22/50, time: 8.19 s, val_loss: 0.644
Epoch   23/50, time: 33.64 s, training_loss: 0.663
Epoch   23/50, time: 8.47 s, val_loss: 0.634
Epoch   24/50, time: 32.17 s, training_loss: 0.639
Epoch   24/50, time: 8.65 s, val_loss: 0.612
Epoch   25/50, time: 32.33 s, training_loss: 0.632
Epoch   25/50, time: 8.46 s, val_loss: 0.661
Epoch   26/50, time: 34.08 s, training_loss: 0.619
Epoch   26/50, time: 8.53 s, val_loss: 0.569
Epoch   27/50, time: 31.86 s, training_loss: 0.603
Epoch   27/50, time: 8.63 s, val_loss: 0.567
Epoch   28/50, time: 32.64 s, training_loss: 0.589
Epoch   28/50, time: 8.34 s, val_loss: 0.597
Epoch   29/50, time: 31.51 s, training_loss: 0.563
Epoch   29/50, time: 8.37 s, val_loss: 0.547
Epoch   30/50, time: 31.98 s, training_loss: 0.545
Epoch   30/50, time: 8.68 s, val_loss: 0.555
Epoch   31/50, time: 32.94 s, training_loss: 0.545
Epoch   31/50, time: 8.22 s, val_loss: 0.506
Training Metrics:
Accuracy: 0.9495
Precision: 0.5213
Recall: 0.7081
F1 Score: 0.5284
IoU: 0.0432
Dice Coefficient: 0.0828
Validation Metrics:
Accuracy: 0.9412
Precision: 0.5182
Recall: 0.7127
F1 Score: 0.5209
IoU: 0.0375
Dice Coefficient: 0.0722
Epoch   32/50, time: 32.44 s, training_loss: 0.533
Epoch   32/50, time: 8.41 s, val_loss: 0.528
Epoch   33/50, time: 31.26 s, training_loss: 0.516
Epoch   33/50, time: 8.30 s, val_loss: 0.515
Epoch   34/50, time: 33.81 s, training_loss: 0.503
Epoch   34/50, time: 8.62 s, val_loss: 0.528
Epoch   35/50, time: 32.16 s, training_loss: 0.514
Epoch   35/50, time: 8.30 s, val_loss: 0.491
Epoch   36/50, time: 31.62 s, training_loss: 0.497
Epoch   36/50, time: 8.42 s, val_loss: 0.494
Epoch   37/50, time: 31.34 s, training_loss: 0.492
Epoch   37/50, time: 8.46 s, val_loss: 0.490
Epoch   38/50, time: 32.15 s, training_loss: 0.484
Epoch   38/50, time: 8.42 s, val_loss: 0.450
Epoch   39/50, time: 31.99 s, training_loss: 0.467
Epoch   39/50, time: 8.61 s, val_loss: 0.442
Epoch   40/50, time: 31.92 s, training_loss: 0.470
Epoch   40/50, time: 8.57 s, val_loss: 0.456
Epoch   41/50, time: 32.34 s, training_loss: 0.466
Epoch   41/50, time: 8.71 s, val_loss: 0.453
Training Metrics:
Accuracy: 0.9674
Precision: 0.5412
Recall: 0.7713
F1 Score: 0.5653
IoU: 0.0795
Dice Coefficient: 0.1473
Validation Metrics:
Accuracy: 0.9556
Precision: 0.5294
Recall: 0.7687
F1 Score: 0.5438
IoU: 0.0584
Dice Coefficient: 0.1103
Epoch   42/50, time: 31.60 s, training_loss: 0.453
Epoch   42/50, time: 8.42 s, val_loss: 0.475
Epoch   43/50, time: 31.42 s, training_loss: 0.474
Epoch   43/50, time: 8.33 s, val_loss: 0.438
Epoch   44/50, time: 33.27 s, training_loss: 0.462
Epoch   44/50, time: 8.37 s, val_loss: 0.432
Epoch   45/50, time: 33.48 s, training_loss: 0.449
Epoch   45/50, time: 8.27 s, val_loss: 0.426
Epoch   46/50, time: 32.54 s, training_loss: 0.442
Epoch   46/50, time: 8.57 s, val_loss: 0.429
Epoch   47/50, time: 31.84 s, training_loss: 0.452
Epoch   47/50, time: 8.17 s, val_loss: 0.478
Epoch   48/50, time: 31.96 s, training_loss: 0.455
Epoch   48/50, time: 8.70 s, val_loss: 0.452
Epoch   49/50, time: 32.90 s, training_loss: 0.433
Epoch   49/50, time: 8.51 s, val_loss: 0.410
Epoch   50/50, time: 32.71 s, training_loss: 0.451
Epoch   50/50, time: 8.21 s, val_loss: 0.441
Training Metrics:
Accuracy: 0.9416
Precision: 0.5241
Recall: 0.7761
F1 Score: 0.5314
IoU: 0.0487
Dice Coefficient: 0.0929
Validation Metrics:
Accuracy: 0.9329
Precision: 0.5201
Recall: 0.7706
F1 Score: 0.5221
IoU: 0.0411
Dice Coefficient: 0.0789
[I 2025-06-16 21:07:34,797] Trial 8 finished with value: 0.07894949805938836 and parameters: {'batch_size': 32, 'lr': 0.00042707173595418676, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9329
Precision: 0.5201
Recall: 0.7706
F1 Score: 0.5221
IoU: 0.0411
Dice Coefficient: 0.0789
[Trial 8] Finished with val_loss=inf
[Trial 8] Finished with dice_coeff=0.07894949805938836
[Trial 9] Trying batch_size=16, lr=0.00012654958641423382, loss_fn=dice_loss
Epoch    1/50, time: 30.29 s, training_loss: 0.980
Epoch    1/50, time: 8.50 s, val_loss: 0.983
Training Metrics:
Accuracy: 0.5212
Precision: 0.5046
Recall: 0.7353
F1 Score: 0.3512
IoU: 0.0097
Dice Coefficient: 0.0191
Validation Metrics:
Accuracy: 0.3978
Precision: 0.5037
Recall: 0.6849
F1 Score: 0.2907
IoU: 0.0076
Dice Coefficient: 0.0151
Epoch    2/50, time: 31.76 s, training_loss: 0.972
Epoch    2/50, time: 8.87 s, val_loss: 0.946
Epoch    3/50, time: 30.43 s, training_loss: 0.963
Epoch    3/50, time: 8.19 s, val_loss: 0.954
Epoch    4/50, time: 30.54 s, training_loss: 0.947
Epoch    4/50, time: 8.38 s, val_loss: 0.932
Epoch    5/50, time: 29.87 s, training_loss: 0.934
Epoch    5/50, time: 8.34 s, val_loss: 0.841
Epoch    6/50, time: 31.20 s, training_loss: 0.923
Epoch    6/50, time: 8.43 s, val_loss: 0.908
Epoch    7/50, time: 30.85 s, training_loss: 0.910
Epoch    7/50, time: 8.18 s, val_loss: 0.891
Epoch    8/50, time: 30.92 s, training_loss: 0.899
Epoch    8/50, time: 8.37 s, val_loss: 0.848
Epoch    9/50, time: 31.03 s, training_loss: 0.889
Epoch    9/50, time: 8.30 s, val_loss: 0.962
Epoch   10/50, time: 31.21 s, training_loss: 0.876
Epoch   10/50, time: 8.67 s, val_loss: 0.895
Epoch   11/50, time: 30.81 s, training_loss: 0.863
Epoch   11/50, time: 8.44 s, val_loss: 0.844
Training Metrics:
Accuracy: 0.5627
Precision: 0.5029
Recall: 0.6459
F1 Score: 0.3675
IoU: 0.0081
Dice Coefficient: 0.0161
Validation Metrics:
Accuracy: 0.5468
Precision: 0.5028
Recall: 0.6496
F1 Score: 0.3606
IoU: 0.0078
Dice Coefficient: 0.0155
Epoch   12/50, time: 30.98 s, training_loss: 0.851
Epoch   12/50, time: 8.82 s, val_loss: 0.849
Epoch   13/50, time: 31.20 s, training_loss: 0.834
Epoch   13/50, time: 8.60 s, val_loss: 0.790
Epoch   14/50, time: 30.48 s, training_loss: 0.818
Epoch   14/50, time: 8.45 s, val_loss: 0.782
Epoch   15/50, time: 30.75 s, training_loss: 0.808
Epoch   15/50, time: 8.30 s, val_loss: 0.751
Epoch   16/50, time: 31.28 s, training_loss: 0.791
Epoch   16/50, time: 8.52 s, val_loss: 0.732
Epoch   17/50, time: 30.65 s, training_loss: 0.768
Epoch   17/50, time: 8.74 s, val_loss: 0.739
Epoch   18/50, time: 30.63 s, training_loss: 0.757
Epoch   18/50, time: 8.55 s, val_loss: 0.730
Epoch   19/50, time: 31.48 s, training_loss: 0.748
Epoch   19/50, time: 8.98 s, val_loss: 0.729
Epoch   20/50, time: 30.32 s, training_loss: 0.734
Epoch   20/50, time: 8.80 s, val_loss: 0.730
Epoch   21/50, time: 30.13 s, training_loss: 0.719
Epoch   21/50, time: 8.69 s, val_loss: 0.716
Training Metrics:
Accuracy: 0.7673
Precision: 0.5051
Recall: 0.6871
F1 Score: 0.4464
IoU: 0.0126
Dice Coefficient: 0.0249
Validation Metrics:
Accuracy: 0.7558
Precision: 0.5050
Recall: 0.6969
F1 Score: 0.4423
IoU: 0.0122
Dice Coefficient: 0.0242
Epoch   22/50, time: 31.83 s, training_loss: 0.711
Epoch   22/50, time: 8.96 s, val_loss: 0.662
Epoch   23/50, time: 30.98 s, training_loss: 0.695
Epoch   23/50, time: 8.80 s, val_loss: 0.662
Epoch   24/50, time: 30.06 s, training_loss: 0.671
Epoch   24/50, time: 8.66 s, val_loss: 0.599
Epoch   25/50, time: 31.08 s, training_loss: 0.657
Epoch   25/50, time: 8.64 s, val_loss: 0.608
Epoch   26/50, time: 32.24 s, training_loss: 0.637
Epoch   26/50, time: 8.50 s, val_loss: 0.599
Epoch   27/50, time: 30.16 s, training_loss: 0.620
Epoch   27/50, time: 8.74 s, val_loss: 0.579
Epoch   28/50, time: 30.54 s, training_loss: 0.601
Epoch   28/50, time: 8.73 s, val_loss: 0.566
Epoch   29/50, time: 30.26 s, training_loss: 0.594
Epoch   29/50, time: 8.37 s, val_loss: 0.550
Epoch   30/50, time: 30.05 s, training_loss: 0.585
Epoch   30/50, time: 8.26 s, val_loss: 0.554
Epoch   31/50, time: 30.42 s, training_loss: 0.569
Epoch   31/50, time: 8.40 s, val_loss: 0.526
Training Metrics:
Accuracy: 0.8951
Precision: 0.5127
Recall: 0.7470
F1 Score: 0.4987
IoU: 0.0272
Dice Coefficient: 0.0529
Validation Metrics:
Accuracy: 0.8594
Precision: 0.5092
Recall: 0.7358
F1 Score: 0.4819
IoU: 0.0202
Dice Coefficient: 0.0396
Epoch   32/50, time: 31.84 s, training_loss: 0.550
Epoch   32/50, time: 8.71 s, val_loss: 0.515
Epoch   33/50, time: 30.20 s, training_loss: 0.541
Epoch   33/50, time: 8.52 s, val_loss: 0.525
Epoch   34/50, time: 30.39 s, training_loss: 0.533
Epoch   34/50, time: 8.48 s, val_loss: 0.496
Epoch   35/50, time: 31.37 s, training_loss: 0.513
Epoch   35/50, time: 8.70 s, val_loss: 0.478
Epoch   36/50, time: 31.59 s, training_loss: 0.510
Epoch   36/50, time: 8.54 s, val_loss: 0.514
Epoch   37/50, time: 31.23 s, training_loss: 0.534
Epoch   37/50, time: 8.58 s, val_loss: 0.534
Epoch   38/50, time: 31.15 s, training_loss: 0.507
Epoch   38/50, time: 8.80 s, val_loss: 0.521
Epoch   39/50, time: 31.60 s, training_loss: 0.485
Epoch   39/50, time: 8.26 s, val_loss: 0.503
Epoch   40/50, time: 31.09 s, training_loss: 0.474
Epoch   40/50, time: 8.60 s, val_loss: 0.496
Epoch   41/50, time: 30.72 s, training_loss: 0.477
Epoch   41/50, time: 8.19 s, val_loss: 0.456
Training Metrics:
Accuracy: 0.9336
Precision: 0.5221
Recall: 0.7858
F1 Score: 0.5257
IoU: 0.0449
Dice Coefficient: 0.0859
Validation Metrics:
Accuracy: 0.9153
Precision: 0.5164
Recall: 0.7732
F1 Score: 0.5107
IoU: 0.0340
Dice Coefficient: 0.0658
Epoch   42/50, time: 31.27 s, training_loss: 0.460
Epoch   42/50, time: 8.63 s, val_loss: 0.463
Epoch   43/50, time: 30.56 s, training_loss: 0.496
Epoch   43/50, time: 8.68 s, val_loss: 0.521
Epoch   44/50, time: 31.27 s, training_loss: 0.471
Epoch   44/50, time: 8.25 s, val_loss: 0.444
Epoch   45/50, time: 30.59 s, training_loss: 0.447
Epoch   45/50, time: 8.28 s, val_loss: 0.436
Epoch   46/50, time: 31.12 s, training_loss: 0.464
Epoch   46/50, time: 8.28 s, val_loss: 0.423
Epoch   47/50, time: 31.91 s, training_loss: 0.453
Epoch   47/50, time: 8.52 s, val_loss: 0.424
Epoch   48/50, time: 30.49 s, training_loss: 0.448
Epoch   48/50, time: 8.51 s, val_loss: 0.433
Epoch   49/50, time: 30.32 s, training_loss: 0.442
Epoch   49/50, time: 8.58 s, val_loss: 0.433
Epoch   50/50, time: 31.52 s, training_loss: 0.431
Epoch   50/50, time: 8.44 s, val_loss: 0.400
Training Metrics:
Accuracy: 0.9593
Precision: 0.5363
Recall: 0.7990
F1 Score: 0.5562
IoU: 0.0714
Dice Coefficient: 0.1332
Validation Metrics:
Accuracy: 0.9401
Precision: 0.5237
Recall: 0.7882
F1 Score: 0.5301
IoU: 0.0478
Dice Coefficient: 0.0913
[I 2025-06-16 21:48:49,564] Trial 9 finished with value: 0.0912865478826731 and parameters: {'batch_size': 16, 'lr': 0.00012654958641423382, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9401
Precision: 0.5237
Recall: 0.7882
F1 Score: 0.5301
IoU: 0.0478
Dice Coefficient: 0.0913
[Trial 9] Finished with val_loss=inf
[Trial 9] Finished with dice_coeff=0.0912865478826731
[Trial 10] Trying batch_size=16, lr=0.0009743199603372303, loss_fn=dice_loss
Epoch    1/50, time: 32.28 s, training_loss: 0.969
Epoch    1/50, time: 8.68 s, val_loss: 0.886
Training Metrics:
Accuracy: 0.6857
Precision: 0.5036
Recall: 0.6613
F1 Score: 0.4162
IoU: 0.0098
Dice Coefficient: 0.0195
Validation Metrics:
Accuracy: 0.9198
Precision: 0.5155
Recall: 0.7447
F1 Score: 0.5105
IoU: 0.0325
Dice Coefficient: 0.0629
Epoch    2/50, time: 33.09 s, training_loss: 0.918
Epoch    2/50, time: 9.37 s, val_loss: 0.831
Epoch    3/50, time: 30.69 s, training_loss: 0.873
Epoch    3/50, time: 8.52 s, val_loss: 0.888
Epoch    4/50, time: 31.64 s, training_loss: 0.841
Epoch    4/50, time: 8.63 s, val_loss: 0.843
Epoch    5/50, time: 31.93 s, training_loss: 0.814
Epoch    5/50, time: 8.71 s, val_loss: 0.811
Epoch    6/50, time: 30.86 s, training_loss: 0.804
Epoch    6/50, time: 8.65 s, val_loss: 0.776
Epoch    7/50, time: 30.51 s, training_loss: 0.807
Epoch    7/50, time: 8.83 s, val_loss: 0.832
Epoch    8/50, time: 29.90 s, training_loss: 0.794
Epoch    8/50, time: 8.58 s, val_loss: 0.762
Epoch    9/50, time: 30.89 s, training_loss: 0.787
Epoch    9/50, time: 8.68 s, val_loss: 0.777
Epoch   10/50, time: 30.05 s, training_loss: 0.781
Epoch   10/50, time: 8.56 s, val_loss: 0.759
Epoch   11/50, time: 31.47 s, training_loss: 0.777
Epoch   11/50, time: 8.38 s, val_loss: 0.791
Training Metrics:
Accuracy: 0.9625
Precision: 0.5177
Recall: 0.6240
F1 Score: 0.5248
IoU: 0.0356
Dice Coefficient: 0.0687
Validation Metrics:
Accuracy: 0.9710
Precision: 0.5235
Recall: 0.6304
F1 Score: 0.5355
IoU: 0.0448
Dice Coefficient: 0.0858
Epoch   12/50, time: 33.09 s, training_loss: 0.767
Epoch   12/50, time: 8.95 s, val_loss: 0.766
Epoch   13/50, time: 30.79 s, training_loss: 0.769
Epoch   13/50, time: 8.68 s, val_loss: 0.756
Epoch   14/50, time: 30.57 s, training_loss: 0.759
Epoch   14/50, time: 8.63 s, val_loss: 0.747
Epoch   15/50, time: 30.49 s, training_loss: 0.754
Epoch   15/50, time: 8.58 s, val_loss: 0.751
Epoch   16/50, time: 30.71 s, training_loss: 0.749
Epoch   16/50, time: 8.32 s, val_loss: 0.741
Epoch   17/50, time: 31.20 s, training_loss: 0.748
Epoch   17/50, time: 8.76 s, val_loss: 0.763
Epoch   18/50, time: 30.60 s, training_loss: 0.736
Epoch   18/50, time: 8.62 s, val_loss: 0.725
Epoch   19/50, time: 30.98 s, training_loss: 0.728
Epoch   19/50, time: 8.73 s, val_loss: 0.708
Epoch   20/50, time: 31.85 s, training_loss: 0.719
Epoch   20/50, time: 8.70 s, val_loss: 0.713
Epoch   21/50, time: 30.56 s, training_loss: 0.708
Epoch   21/50, time: 8.93 s, val_loss: 0.691
Training Metrics:
Accuracy: 0.9884
Precision: 0.6060
Recall: 0.7531
F1 Score: 0.6485
IoU: 0.1784
Dice Coefficient: 0.3028
Validation Metrics:
Accuracy: 0.9893
Precision: 0.6128
Recall: 0.7602
F1 Score: 0.6566
IoU: 0.1894
Dice Coefficient: 0.3185
Epoch   22/50, time: 33.72 s, training_loss: 0.704
Epoch   22/50, time: 9.15 s, val_loss: 0.694
Epoch   23/50, time: 30.55 s, training_loss: 0.702
Epoch   23/50, time: 8.75 s, val_loss: 0.695
Epoch   24/50, time: 30.50 s, training_loss: 0.689
Epoch   24/50, time: 8.44 s, val_loss: 0.668
Epoch   25/50, time: 29.90 s, training_loss: 0.679
Epoch   25/50, time: 8.54 s, val_loss: 0.694
Epoch   26/50, time: 31.09 s, training_loss: 0.675
Epoch   26/50, time: 8.55 s, val_loss: 0.652
Epoch   27/50, time: 31.87 s, training_loss: 0.664
Epoch   27/50, time: 8.69 s, val_loss: 0.652
Epoch   28/50, time: 30.59 s, training_loss: 0.660
Epoch   28/50, time: 8.46 s, val_loss: 0.694
Epoch   29/50, time: 30.81 s, training_loss: 0.643
Epoch   29/50, time: 8.72 s, val_loss: 0.625
Epoch   30/50, time: 31.43 s, training_loss: 0.615
Epoch   30/50, time: 8.86 s, val_loss: 0.679
Epoch   31/50, time: 32.20 s, training_loss: 0.594
Epoch   31/50, time: 8.61 s, val_loss: 0.582
Training Metrics:
Accuracy: 0.9930
Precision: 0.6732
Recall: 0.7419
F1 Score: 0.7017
IoU: 0.2555
Dice Coefficient: 0.4070
Validation Metrics:
Accuracy: 0.9937
Precision: 0.6854
Recall: 0.7335
F1 Score: 0.7066
IoU: 0.2629
Dice Coefficient: 0.4164
Epoch   32/50, time: 32.58 s, training_loss: 0.579
Epoch   32/50, time: 9.13 s, val_loss: 0.556
Epoch   33/50, time: 31.64 s, training_loss: 0.556
Epoch   33/50, time: 8.77 s, val_loss: 0.557
Epoch   34/50, time: 31.50 s, training_loss: 0.544
Epoch   34/50, time: 8.63 s, val_loss: 0.554
Epoch   35/50, time: 31.65 s, training_loss: 0.526
Epoch   35/50, time: 9.06 s, val_loss: 0.507
Epoch   36/50, time: 31.46 s, training_loss: 0.513
Epoch   36/50, time: 9.16 s, val_loss: 0.548
Epoch   37/50, time: 30.70 s, training_loss: 0.496
Epoch   37/50, time: 8.39 s, val_loss: 0.480
Epoch   38/50, time: 30.74 s, training_loss: 0.491
Epoch   38/50, time: 8.82 s, val_loss: 0.481
Epoch   39/50, time: 30.52 s, training_loss: 0.474
Epoch   39/50, time: 8.56 s, val_loss: 0.480
Epoch   40/50, time: 30.70 s, training_loss: 0.464
Epoch   40/50, time: 8.60 s, val_loss: 0.455
Epoch   41/50, time: 31.49 s, training_loss: 0.456
Epoch   41/50, time: 8.82 s, val_loss: 0.457
Training Metrics:
Accuracy: 0.9957
Precision: 0.7778
Recall: 0.7791
F1 Score: 0.7784
IoU: 0.3880
Dice Coefficient: 0.5591
Validation Metrics:
Accuracy: 0.9961
Precision: 0.7933
Recall: 0.7762
F1 Score: 0.7845
IoU: 0.3995
Dice Coefficient: 0.5710
Epoch   42/50, time: 32.22 s, training_loss: 0.445
Epoch   42/50, time: 9.68 s, val_loss: 0.433
Epoch   43/50, time: 34.09 s, training_loss: 0.436
Epoch   43/50, time: 9.86 s, val_loss: 0.438
Epoch   44/50, time: 36.20 s, training_loss: 0.435
Epoch   44/50, time: 9.53 s, val_loss: 0.458
Epoch   45/50, time: 33.02 s, training_loss: 0.434
Epoch   45/50, time: 10.24 s, val_loss: 0.423
Epoch   46/50, time: 31.89 s, training_loss: 0.419
Epoch   46/50, time: 9.56 s, val_loss: 0.415
Epoch   47/50, time: 32.61 s, training_loss: 0.416
Epoch   47/50, time: 10.37 s, val_loss: 0.400
Epoch   48/50, time: 33.81 s, training_loss: 0.414
Epoch   48/50, time: 9.99 s, val_loss: 0.403
Epoch   49/50, time: 32.85 s, training_loss: 0.412
Epoch   49/50, time: 9.61 s, val_loss: 0.431
Epoch   50/50, time: 36.91 s, training_loss: 0.406
Epoch   50/50, time: 9.79 s, val_loss: 0.414
Training Metrics:
Accuracy: 0.9959
Precision: 0.7864
Recall: 0.8065
F1 Score: 0.7961
IoU: 0.4228
Dice Coefficient: 0.5943
Validation Metrics:
Accuracy: 0.9961
Precision: 0.7923
Recall: 0.8067
F1 Score: 0.7994
IoU: 0.4292
Dice Coefficient: 0.6007
[I 2025-06-16 22:31:40,967] Trial 10 finished with value: 0.6006584724033703 and parameters: {'batch_size': 16, 'lr': 0.0009743199603372303, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9961
Precision: 0.7923
Recall: 0.8067
F1 Score: 0.7994
IoU: 0.4292
Dice Coefficient: 0.6007
[Trial 10] Finished with val_loss=inf
[Trial 10] Finished with dice_coeff=0.6006584724033703
[Trial 11] Trying batch_size=16, lr=0.0009794403918120538, loss_fn=dice_loss
Epoch    1/50, time: 32.65 s, training_loss: 0.962
Epoch    1/50, time: 10.20 s, val_loss: 0.842
Training Metrics:
Accuracy: 0.5279
Precision: 0.5020
Recall: 0.6023
F1 Score: 0.3518
IoU: 0.0070
Dice Coefficient: 0.0139
Validation Metrics:
Accuracy: 0.8954
Precision: 0.5088
Recall: 0.6732
F1 Score: 0.4919
IoU: 0.0200
Dice Coefficient: 0.0391
Epoch    2/50, time: 31.88 s, training_loss: 0.908
Epoch    2/50, time: 9.88 s, val_loss: 0.853
Epoch    3/50, time: 34.62 s, training_loss: 0.866
Epoch    3/50, time: 10.19 s, val_loss: 0.816
Epoch    4/50, time: 32.68 s, training_loss: 0.828
Epoch    4/50, time: 11.14 s, val_loss: 0.812
Epoch    5/50, time: 36.58 s, training_loss: 0.818
Epoch    5/50, time: 9.98 s, val_loss: 0.792
Epoch    6/50, time: 32.50 s, training_loss: 0.800
Epoch    6/50, time: 10.25 s, val_loss: 0.785
Epoch    7/50, time: 33.66 s, training_loss: 0.796
Epoch    7/50, time: 9.18 s, val_loss: 0.779
Epoch    8/50, time: 31.46 s, training_loss: 0.781
Epoch    8/50, time: 8.67 s, val_loss: 0.751
Epoch    9/50, time: 31.40 s, training_loss: 0.769
Epoch    9/50, time: 9.78 s, val_loss: 0.752
Epoch   10/50, time: 31.46 s, training_loss: 0.763
Epoch   10/50, time: 9.43 s, val_loss: 0.746
Epoch   11/50, time: 30.92 s, training_loss: 0.747
Epoch   11/50, time: 9.37 s, val_loss: 0.739
Training Metrics:
Accuracy: 0.9826
Precision: 0.5716
Recall: 0.7546
F1 Score: 0.6095
IoU: 0.1285
Dice Coefficient: 0.2278
Validation Metrics:
Accuracy: 0.9831
Precision: 0.5712
Recall: 0.7527
F1 Score: 0.6089
IoU: 0.1276
Dice Coefficient: 0.2264
Epoch   12/50, time: 31.91 s, training_loss: 0.739
Epoch   12/50, time: 9.87 s, val_loss: 0.720
Epoch   13/50, time: 35.50 s, training_loss: 0.726
Epoch   13/50, time: 9.77 s, val_loss: 0.710
Epoch   14/50, time: 34.42 s, training_loss: 0.716
Epoch   14/50, time: 9.92 s, val_loss: 0.711
Epoch   15/50, time: 35.02 s, training_loss: 0.706
Epoch   15/50, time: 9.90 s, val_loss: 0.697
Epoch   16/50, time: 32.33 s, training_loss: 0.696
Epoch   16/50, time: 10.06 s, val_loss: 0.684
Epoch   17/50, time: 32.99 s, training_loss: 0.688
Epoch   17/50, time: 9.86 s, val_loss: 0.674
Epoch   18/50, time: 33.29 s, training_loss: 0.680
Epoch   18/50, time: 9.88 s, val_loss: 0.668
Epoch   19/50, time: 31.98 s, training_loss: 0.666
Epoch   19/50, time: 9.79 s, val_loss: 0.642
Epoch   20/50, time: 32.97 s, training_loss: 0.641
Epoch   20/50, time: 9.99 s, val_loss: 0.653
Epoch   21/50, time: 34.04 s, training_loss: 0.605
Epoch   21/50, time: 9.89 s, val_loss: 0.600
Training Metrics:
Accuracy: 0.9923
Precision: 0.6600
Recall: 0.7588
F1 Score: 0.6975
IoU: 0.2492
Dice Coefficient: 0.3989
Validation Metrics:
Accuracy: 0.9927
Precision: 0.6661
Recall: 0.7672
F1 Score: 0.7046
IoU: 0.2602
Dice Coefficient: 0.4130
Epoch   22/50, time: 33.37 s, training_loss: 0.590
Epoch   22/50, time: 9.34 s, val_loss: 0.571
Epoch   23/50, time: 32.71 s, training_loss: 0.578
Epoch   23/50, time: 9.57 s, val_loss: 0.530
Epoch   24/50, time: 33.57 s, training_loss: 0.556
Epoch   24/50, time: 9.94 s, val_loss: 0.572
Epoch   25/50, time: 32.28 s, training_loss: 0.542
Epoch   25/50, time: 9.76 s, val_loss: 0.521
Epoch   26/50, time: 33.02 s, training_loss: 0.534
Epoch   26/50, time: 9.92 s, val_loss: 0.524
Epoch   27/50, time: 33.85 s, training_loss: 0.526
Epoch   27/50, time: 10.08 s, val_loss: 0.499
Epoch   28/50, time: 32.70 s, training_loss: 0.515
Epoch   28/50, time: 9.69 s, val_loss: 0.520
Epoch   29/50, time: 32.78 s, training_loss: 0.503
Epoch   29/50, time: 10.17 s, val_loss: 0.533
Epoch   30/50, time: 33.11 s, training_loss: 0.501
Epoch   30/50, time: 10.01 s, val_loss: 0.497
Epoch   31/50, time: 32.26 s, training_loss: 0.485
Epoch   31/50, time: 9.76 s, val_loss: 0.484
Training Metrics:
Accuracy: 0.9953
Precision: 0.7584
Recall: 0.7659
F1 Score: 0.7621
IoU: 0.3574
Dice Coefficient: 0.5266
Validation Metrics:
Accuracy: 0.9956
Precision: 0.7654
Recall: 0.7692
F1 Score: 0.7673
IoU: 0.3669
Dice Coefficient: 0.5368
Epoch   32/50, time: 32.86 s, training_loss: 0.477
Epoch   32/50, time: 10.27 s, val_loss: 0.458
Epoch   33/50, time: 35.32 s, training_loss: 0.474
Epoch   33/50, time: 10.51 s, val_loss: 0.466
Epoch   34/50, time: 33.42 s, training_loss: 0.469
Epoch   34/50, time: 9.87 s, val_loss: 0.450
Epoch   35/50, time: 32.97 s, training_loss: 0.459
Epoch   35/50, time: 9.94 s, val_loss: 0.473
Epoch   36/50, time: 34.01 s, training_loss: 0.454
Epoch   36/50, time: 10.19 s, val_loss: 0.440
Epoch   37/50, time: 32.23 s, training_loss: 0.451
Epoch   37/50, time: 9.83 s, val_loss: 0.482
Epoch   38/50, time: 33.79 s, training_loss: 0.448
Epoch   38/50, time: 10.04 s, val_loss: 0.462
Epoch   39/50, time: 33.42 s, training_loss: 0.440
Epoch   39/50, time: 10.45 s, val_loss: 0.414
Epoch   40/50, time: 34.53 s, training_loss: 0.429
Epoch   40/50, time: 10.14 s, val_loss: 0.453
Epoch   41/50, time: 34.58 s, training_loss: 0.429
Epoch   41/50, time: 9.69 s, val_loss: 0.433
Training Metrics:
Accuracy: 0.9959
Precision: 0.7954
Recall: 0.7754
F1 Score: 0.7851
IoU: 0.4007
Dice Coefficient: 0.5721
Validation Metrics:
Accuracy: 0.9961
Precision: 0.7987
Recall: 0.7787
F1 Score: 0.7883
IoU: 0.4071
Dice Coefficient: 0.5786
Epoch   42/50, time: 33.35 s, training_loss: 0.423
Epoch   42/50, time: 9.77 s, val_loss: 0.430
Epoch   43/50, time: 33.06 s, training_loss: 0.418
Epoch   43/50, time: 10.33 s, val_loss: 0.404
Epoch   44/50, time: 32.29 s, training_loss: 0.416
Epoch   44/50, time: 10.06 s, val_loss: 0.413
Epoch   45/50, time: 33.08 s, training_loss: 0.413
Epoch   45/50, time: 10.28 s, val_loss: 0.429
Epoch   46/50, time: 33.73 s, training_loss: 0.410
Epoch   46/50, time: 9.89 s, val_loss: 0.409
Epoch   47/50, time: 32.39 s, training_loss: 0.407
Epoch   47/50, time: 10.13 s, val_loss: 0.404
Epoch   48/50, time: 33.04 s, training_loss: 0.407
Epoch   48/50, time: 10.36 s, val_loss: 0.394
Epoch   49/50, time: 33.88 s, training_loss: 0.397
Epoch   49/50, time: 9.99 s, val_loss: 0.399
Epoch   50/50, time: 32.51 s, training_loss: 0.395
Epoch   50/50, time: 10.05 s, val_loss: 0.389
Training Metrics:
Accuracy: 0.9965
Precision: 0.8309
Recall: 0.7855
F1 Score: 0.8065
IoU: 0.4439
Dice Coefficient: 0.6148
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8420
Recall: 0.7860
F1 Score: 0.8115
IoU: 0.4542
Dice Coefficient: 0.6247
[I 2025-06-16 23:17:10,554] Trial 11 finished with value: 0.6246639951931547 and parameters: {'batch_size': 16, 'lr': 0.0009794403918120538, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9967
Precision: 0.8420
Recall: 0.7860
F1 Score: 0.8115
IoU: 0.4542
Dice Coefficient: 0.6247
[Trial 11] Finished with val_loss=inf
[Trial 11] Finished with dice_coeff=0.6246639951931547
[Trial 12] Trying batch_size=16, lr=0.0007177856773547531, loss_fn=dice_loss
Epoch    1/50, time: 32.00 s, training_loss: 0.978
Epoch    1/50, time: 10.16 s, val_loss: 0.918
Training Metrics:
Accuracy: 0.6444
Precision: 0.5024
Recall: 0.6131
F1 Score: 0.3994
IoU: 0.0080
Dice Coefficient: 0.0158
Validation Metrics:
Accuracy: 0.9133
Precision: 0.5060
Recall: 0.5986
F1 Score: 0.4922
IoU: 0.0151
Dice Coefficient: 0.0298
Epoch    2/50, time: 32.47 s, training_loss: 0.944
Epoch    2/50, time: 10.62 s, val_loss: 0.887
Epoch    3/50, time: 32.69 s, training_loss: 0.907
Epoch    3/50, time: 10.25 s, val_loss: 0.876
Epoch    4/50, time: 32.91 s, training_loss: 0.875
Epoch    4/50, time: 9.91 s, val_loss: 0.836
Epoch    5/50, time: 35.09 s, training_loss: 0.849
Epoch    5/50, time: 9.78 s, val_loss: 0.822
Epoch    6/50, time: 33.14 s, training_loss: 0.827
Epoch    6/50, time: 9.64 s, val_loss: 0.797
Epoch    7/50, time: 32.20 s, training_loss: 0.808
Epoch    7/50, time: 9.79 s, val_loss: 0.791
Epoch    8/50, time: 32.41 s, training_loss: 0.801
Epoch    8/50, time: 9.84 s, val_loss: 0.778
Epoch    9/50, time: 32.91 s, training_loss: 0.792
Epoch    9/50, time: 9.74 s, val_loss: 0.945
Epoch   10/50, time: 32.40 s, training_loss: 0.785
Epoch   10/50, time: 9.84 s, val_loss: 0.760
Epoch   11/50, time: 32.78 s, training_loss: 0.772
Epoch   11/50, time: 9.67 s, val_loss: 0.761
Training Metrics:
Accuracy: 0.9228
Precision: 0.5156
Recall: 0.7285
F1 Score: 0.5116
IoU: 0.0327
Dice Coefficient: 0.0634
Validation Metrics:
Accuracy: 0.9178
Precision: 0.5140
Recall: 0.7244
F1 Score: 0.5073
IoU: 0.0296
Dice Coefficient: 0.0575
Epoch   12/50, time: 33.04 s, training_loss: 0.767
Epoch   12/50, time: 9.92 s, val_loss: 0.749
Epoch   13/50, time: 33.03 s, training_loss: 0.764
Epoch   13/50, time: 10.12 s, val_loss: 0.751
Epoch   14/50, time: 32.51 s, training_loss: 0.761
Epoch   14/50, time: 10.07 s, val_loss: 0.762
Epoch   15/50, time: 32.91 s, training_loss: 0.752
Epoch   15/50, time: 10.12 s, val_loss: 0.740
Epoch   16/50, time: 33.69 s, training_loss: 0.752
Epoch   16/50, time: 10.04 s, val_loss: 0.735
Epoch   17/50, time: 33.85 s, training_loss: 0.747
Epoch   17/50, time: 9.84 s, val_loss: 0.723
Epoch   18/50, time: 33.63 s, training_loss: 0.747
Epoch   18/50, time: 10.03 s, val_loss: 0.738
Epoch   19/50, time: 33.29 s, training_loss: 0.744
Epoch   19/50, time: 9.83 s, val_loss: 0.736
Epoch   20/50, time: 33.01 s, training_loss: 0.738
Epoch   20/50, time: 9.65 s, val_loss: 0.755
Epoch   21/50, time: 34.00 s, training_loss: 0.733
Epoch   21/50, time: 9.60 s, val_loss: 0.715
Training Metrics:
Accuracy: 0.9640
Precision: 0.5321
Recall: 0.7276
F1 Score: 0.5496
IoU: 0.0625
Dice Coefficient: 0.1176
Validation Metrics:
Accuracy: 0.9492
Precision: 0.5231
Recall: 0.7366
F1 Score: 0.5313
IoU: 0.0464
Dice Coefficient: 0.0888
Epoch   22/50, time: 32.06 s, training_loss: 0.735
Epoch   22/50, time: 10.21 s, val_loss: 0.719
Epoch   23/50, time: 33.33 s, training_loss: 0.725
Epoch   23/50, time: 10.25 s, val_loss: 0.707
Epoch   24/50, time: 32.82 s, training_loss: 0.718
Epoch   24/50, time: 10.08 s, val_loss: 0.705
Epoch   25/50, time: 33.14 s, training_loss: 0.697
Epoch   25/50, time: 10.01 s, val_loss: 0.661
Epoch   26/50, time: 33.05 s, training_loss: 0.674
Epoch   26/50, time: 10.35 s, val_loss: 0.648
Epoch   27/50, time: 33.09 s, training_loss: 0.668
Epoch   27/50, time: 9.72 s, val_loss: 0.649
Epoch   28/50, time: 32.21 s, training_loss: 0.652
Epoch   28/50, time: 9.81 s, val_loss: 0.628
Epoch   29/50, time: 32.86 s, training_loss: 0.629
Epoch   29/50, time: 10.14 s, val_loss: 0.606
Epoch   30/50, time: 34.40 s, training_loss: 0.622
Epoch   30/50, time: 9.86 s, val_loss: 0.604
Epoch   31/50, time: 32.66 s, training_loss: 0.633
Epoch   31/50, time: 9.87 s, val_loss: 0.604
Training Metrics:
Accuracy: 0.9706
Precision: 0.5301
Recall: 0.6682
F1 Score: 0.5466
IoU: 0.0571
Dice Coefficient: 0.1081
Validation Metrics:
Accuracy: 0.9532
Precision: 0.5191
Recall: 0.6773
F1 Score: 0.5254
IoU: 0.0388
Dice Coefficient: 0.0748
Epoch   32/50, time: 32.28 s, training_loss: 0.613
Epoch   32/50, time: 10.96 s, val_loss: 0.617
Epoch   33/50, time: 32.64 s, training_loss: 0.588
Epoch   33/50, time: 10.11 s, val_loss: 0.553
Epoch   34/50, time: 34.06 s, training_loss: 0.583
Epoch   34/50, time: 10.02 s, val_loss: 0.567
Epoch   35/50, time: 33.50 s, training_loss: 0.598
Epoch   35/50, time: 9.86 s, val_loss: 0.585
Epoch   36/50, time: 33.76 s, training_loss: 0.573
Epoch   36/50, time: 10.11 s, val_loss: 0.536
Epoch   37/50, time: 34.56 s, training_loss: 0.547
Epoch   37/50, time: 9.78 s, val_loss: 0.538
Epoch   38/50, time: 34.24 s, training_loss: 0.532
Epoch   38/50, time: 9.90 s, val_loss: 0.544
Epoch   39/50, time: 33.03 s, training_loss: 0.525
Epoch   39/50, time: 10.29 s, val_loss: 0.488
Epoch   40/50, time: 33.02 s, training_loss: 0.507
Epoch   40/50, time: 10.04 s, val_loss: 0.526
Epoch   41/50, time: 33.49 s, training_loss: 0.504
Epoch   41/50, time: 9.55 s, val_loss: 0.489
Training Metrics:
Accuracy: 0.9939
Precision: 0.7063
Recall: 0.7916
F1 Score: 0.7415
IoU: 0.3210
Dice Coefficient: 0.4861
Validation Metrics:
Accuracy: 0.9941
Precision: 0.7044
Recall: 0.7877
F1 Score: 0.7389
IoU: 0.3165
Dice Coefficient: 0.4808
Epoch   42/50, time: 32.97 s, training_loss: 0.493
Epoch   42/50, time: 9.78 s, val_loss: 0.487
Epoch   43/50, time: 34.10 s, training_loss: 0.488
Epoch   43/50, time: 10.03 s, val_loss: 0.461
Epoch   44/50, time: 32.35 s, training_loss: 0.478
Epoch   44/50, time: 9.98 s, val_loss: 0.483
Epoch   45/50, time: 33.72 s, training_loss: 0.475
Epoch   45/50, time: 10.32 s, val_loss: 0.482
Epoch   46/50, time: 33.04 s, training_loss: 0.463
Epoch   46/50, time: 9.60 s, val_loss: 0.468
Epoch   47/50, time: 35.84 s, training_loss: 0.460
Epoch   47/50, time: 10.37 s, val_loss: 0.457
Epoch   48/50, time: 33.04 s, training_loss: 0.451
Epoch   48/50, time: 10.12 s, val_loss: 0.436
Epoch   49/50, time: 33.77 s, training_loss: 0.443
Epoch   49/50, time: 10.07 s, val_loss: 0.460
Epoch   50/50, time: 33.64 s, training_loss: 0.451
Epoch   50/50, time: 9.85 s, val_loss: 0.462
Training Metrics:
Accuracy: 0.9958
Precision: 0.7819
Recall: 0.7866
F1 Score: 0.7842
IoU: 0.3992
Dice Coefficient: 0.5706
Validation Metrics:
Accuracy: 0.9960
Precision: 0.7881
Recall: 0.7857
F1 Score: 0.7869
IoU: 0.4043
Dice Coefficient: 0.5758
[I 2025-06-17 00:03:10,897] Trial 12 finished with value: 0.5757758724791692 and parameters: {'batch_size': 16, 'lr': 0.0007177856773547531, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9960
Precision: 0.7881
Recall: 0.7857
F1 Score: 0.7869
IoU: 0.4043
Dice Coefficient: 0.5758
[Trial 12] Finished with val_loss=inf
[Trial 12] Finished with dice_coeff=0.5757758724791692
[Trial 13] Trying batch_size=16, lr=0.000991501676768932, loss_fn=dice_loss
Epoch    1/50, time: 33.51 s, training_loss: 0.962
Epoch    1/50, time: 10.07 s, val_loss: 0.894
Training Metrics:
Accuracy: 0.6781
Precision: 0.5024
Recall: 0.6093
F1 Score: 0.4119
IoU: 0.0082
Dice Coefficient: 0.0162
Validation Metrics:
Accuracy: 0.8995
Precision: 0.5073
Recall: 0.6376
F1 Score: 0.4905
IoU: 0.0173
Dice Coefficient: 0.0340
Epoch    2/50, time: 32.36 s, training_loss: 0.906
Epoch    2/50, time: 10.23 s, val_loss: 0.883
Epoch    3/50, time: 32.58 s, training_loss: 0.859
Epoch    3/50, time: 9.87 s, val_loss: 0.828
Epoch    4/50, time: 33.27 s, training_loss: 0.826
Epoch    4/50, time: 9.86 s, val_loss: 0.795
Epoch    5/50, time: 35.21 s, training_loss: 0.808
Epoch    5/50, time: 9.68 s, val_loss: 0.783
Epoch    6/50, time: 32.99 s, training_loss: 0.794
Epoch    6/50, time: 9.98 s, val_loss: 0.774
Epoch    7/50, time: 33.38 s, training_loss: 0.789
Epoch    7/50, time: 10.01 s, val_loss: 0.761
Epoch    8/50, time: 32.97 s, training_loss: 0.775
Epoch    8/50, time: 9.97 s, val_loss: 0.753
Epoch    9/50, time: 33.26 s, training_loss: 0.766
Epoch    9/50, time: 9.84 s, val_loss: 0.747
Epoch   10/50, time: 33.21 s, training_loss: 0.755
Epoch   10/50, time: 9.74 s, val_loss: 0.728
Epoch   11/50, time: 32.88 s, training_loss: 0.750
Epoch   11/50, time: 10.81 s, val_loss: 0.767
Training Metrics:
Accuracy: 0.8955
Precision: 0.5126
Recall: 0.7443
F1 Score: 0.4987
IoU: 0.0270
Dice Coefficient: 0.0526
Validation Metrics:
Accuracy: 0.9092
Precision: 0.5134
Recall: 0.7352
F1 Score: 0.5038
IoU: 0.0284
Dice Coefficient: 0.0552
Epoch   12/50, time: 33.19 s, training_loss: 0.752
Epoch   12/50, time: 9.50 s, val_loss: 0.748
Epoch   13/50, time: 32.20 s, training_loss: 0.734
Epoch   13/50, time: 10.28 s, val_loss: 0.712
Epoch   14/50, time: 34.62 s, training_loss: 0.726
Epoch   14/50, time: 10.34 s, val_loss: 0.723
Epoch   15/50, time: 32.47 s, training_loss: 0.713
Epoch   15/50, time: 10.33 s, val_loss: 0.702
Epoch   16/50, time: 34.57 s, training_loss: 0.695
Epoch   16/50, time: 9.93 s, val_loss: 0.687
Epoch   17/50, time: 34.59 s, training_loss: 0.690
Epoch   17/50, time: 10.30 s, val_loss: 0.671
Epoch   18/50, time: 32.82 s, training_loss: 0.678
Epoch   18/50, time: 9.76 s, val_loss: 0.667
Epoch   19/50, time: 33.78 s, training_loss: 0.668
Epoch   19/50, time: 9.93 s, val_loss: 0.723
Epoch   20/50, time: 32.25 s, training_loss: 0.654
Epoch   20/50, time: 10.08 s, val_loss: 0.636
Epoch   21/50, time: 32.31 s, training_loss: 0.607
Epoch   21/50, time: 10.08 s, val_loss: 0.588
Training Metrics:
Accuracy: 0.9933
Precision: 0.6807
Recall: 0.7416
F1 Score: 0.7067
IoU: 0.2632
Dice Coefficient: 0.4168
Validation Metrics:
Accuracy: 0.9938
Precision: 0.6894
Recall: 0.7396
F1 Score: 0.7115
IoU: 0.2707
Dice Coefficient: 0.4261
Epoch   22/50, time: 32.07 s, training_loss: 0.587
Epoch   22/50, time: 9.70 s, val_loss: 0.571
Epoch   23/50, time: 33.16 s, training_loss: 0.564
Epoch   23/50, time: 9.90 s, val_loss: 0.541
Epoch   24/50, time: 32.77 s, training_loss: 0.550
Epoch   24/50, time: 9.93 s, val_loss: 0.540
Epoch   25/50, time: 32.19 s, training_loss: 0.546
Epoch   25/50, time: 10.16 s, val_loss: 0.537
Epoch   26/50, time: 34.26 s, training_loss: 0.530
Epoch   26/50, time: 10.04 s, val_loss: 0.504
Epoch   27/50, time: 33.26 s, training_loss: 0.512
Epoch   27/50, time: 9.66 s, val_loss: 0.502
Epoch   28/50, time: 33.13 s, training_loss: 0.500
Epoch   28/50, time: 9.97 s, val_loss: 0.516
Epoch   29/50, time: 32.38 s, training_loss: 0.486
Epoch   29/50, time: 10.40 s, val_loss: 0.478
Epoch   30/50, time: 34.07 s, training_loss: 0.481
Epoch   30/50, time: 9.87 s, val_loss: 0.509
Epoch   31/50, time: 32.00 s, training_loss: 0.471
Epoch   31/50, time: 10.09 s, val_loss: 0.451
Training Metrics:
Accuracy: 0.9955
Precision: 0.7698
Recall: 0.7879
F1 Score: 0.7786
IoU: 0.3883
Dice Coefficient: 0.5594
Validation Metrics:
Accuracy: 0.9959
Precision: 0.7843
Recall: 0.7841
F1 Score: 0.7842
IoU: 0.3990
Dice Coefficient: 0.5704
Epoch   32/50, time: 32.10 s, training_loss: 0.465
Epoch   32/50, time: 10.05 s, val_loss: 0.476
Epoch   33/50, time: 33.80 s, training_loss: 0.451
Epoch   33/50, time: 10.27 s, val_loss: 0.445
Epoch   34/50, time: 32.71 s, training_loss: 0.445
Epoch   34/50, time: 9.91 s, val_loss: 0.448
Epoch   35/50, time: 32.38 s, training_loss: 0.453
Epoch   35/50, time: 10.29 s, val_loss: 0.453
Epoch   36/50, time: 32.91 s, training_loss: 0.443
Epoch   36/50, time: 9.66 s, val_loss: 0.420
Epoch   37/50, time: 33.40 s, training_loss: 0.437
Epoch   37/50, time: 9.84 s, val_loss: 0.467
Epoch   38/50, time: 33.01 s, training_loss: 0.429
Epoch   38/50, time: 10.55 s, val_loss: 0.422
Epoch   39/50, time: 32.13 s, training_loss: 0.422
Epoch   39/50, time: 9.80 s, val_loss: 0.405
Epoch   40/50, time: 33.47 s, training_loss: 0.411
Epoch   40/50, time: 9.89 s, val_loss: 0.416
Epoch   41/50, time: 32.42 s, training_loss: 0.416
Epoch   41/50, time: 10.37 s, val_loss: 0.393
Training Metrics:
Accuracy: 0.9961
Precision: 0.7973
Recall: 0.8060
F1 Score: 0.8016
IoU: 0.4338
Dice Coefficient: 0.6051
Validation Metrics:
Accuracy: 0.9964
Precision: 0.8128
Recall: 0.8007
F1 Score: 0.8066
IoU: 0.4441
Dice Coefficient: 0.6150
Epoch   42/50, time: 32.25 s, training_loss: 0.414
Epoch   42/50, time: 10.49 s, val_loss: 0.433
Epoch   43/50, time: 33.67 s, training_loss: 0.406
Epoch   43/50, time: 10.57 s, val_loss: 0.416
Epoch   44/50, time: 33.55 s, training_loss: 0.412
Epoch   44/50, time: 9.25 s, val_loss: 0.404
Epoch   45/50, time: 32.61 s, training_loss: 0.400
Epoch   45/50, time: 10.80 s, val_loss: 0.415
Epoch   46/50, time: 33.95 s, training_loss: 0.394
Epoch   46/50, time: 9.87 s, val_loss: 0.390
Epoch   47/50, time: 33.72 s, training_loss: 0.395
Epoch   47/50, time: 9.74 s, val_loss: 0.397
Epoch   48/50, time: 33.39 s, training_loss: 0.391
Epoch   48/50, time: 9.87 s, val_loss: 0.383
Epoch   49/50, time: 32.02 s, training_loss: 0.386
Epoch   49/50, time: 10.00 s, val_loss: 0.387
Epoch   50/50, time: 33.52 s, training_loss: 0.394
Epoch   50/50, time: 10.04 s, val_loss: 0.401
Training Metrics:
Accuracy: 0.9966
Precision: 0.8392
Recall: 0.7916
F1 Score: 0.8136
IoU: 0.4586
Dice Coefficient: 0.6289
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8356
Recall: 0.7900
F1 Score: 0.8111
IoU: 0.4534
Dice Coefficient: 0.6239
[I 2025-06-17 00:49:07,815] Trial 13 finished with value: 0.6239239787161767 and parameters: {'batch_size': 16, 'lr': 0.000991501676768932, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
/home/sethih1/masque_new/composnet/ters_gen/hyperopt.py:32: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9967
Precision: 0.8356
Recall: 0.7900
F1 Score: 0.8111
IoU: 0.4534
Dice Coefficient: 0.6239
[Trial 13] Finished with val_loss=inf
[Trial 13] Finished with dice_coeff=0.6239239787161767
[Trial 14] Trying batch_size=16, lr=0.0006289623963493286, loss_fn=dice_loss
Epoch    1/50, time: 34.57 s, training_loss: 0.968
Epoch    1/50, time: 10.55 s, val_loss: 0.868
Training Metrics:
Accuracy: 0.5120
Precision: 0.5020
Recall: 0.6000
F1 Score: 0.3447
IoU: 0.0069
Dice Coefficient: 0.0137
Validation Metrics:
Accuracy: 0.8277
Precision: 0.5045
Recall: 0.6364
F1 Score: 0.4647
IoU: 0.0121
Dice Coefficient: 0.0238
Epoch    2/50, time: 33.50 s, training_loss: 0.935
Epoch    2/50, time: 10.24 s, val_loss: 0.991
Epoch    3/50, time: 34.03 s, training_loss: 0.892
Epoch    3/50, time: 10.00 s, val_loss: 0.840
Epoch    4/50, time: 32.44 s, training_loss: 0.851
Epoch    4/50, time: 9.84 s, val_loss: 0.861
Epoch    5/50, time: 33.22 s, training_loss: 0.823
Epoch    5/50, time: 10.84 s, val_loss: 0.825
Epoch    6/50, time: 34.06 s, training_loss: 0.799
Epoch    6/50, time: 10.44 s, val_loss: 0.785
Epoch    7/50, time: 33.89 s, training_loss: 0.781
Epoch    7/50, time: 10.00 s, val_loss: 0.754
Epoch    8/50, time: 33.51 s, training_loss: 0.769
Epoch    8/50, time: 9.78 s, val_loss: 0.775
Epoch    9/50, time: 32.62 s, training_loss: 0.758
Epoch    9/50, time: 10.05 s, val_loss: 0.742
Epoch   10/50, time: 33.37 s, training_loss: 0.746
Epoch   10/50, time: 10.36 s, val_loss: 0.729
Epoch   11/50, time: 33.02 s, training_loss: 0.726
Epoch   11/50, time: 10.11 s, val_loss: 0.711
Training Metrics:
Accuracy: 0.9422
Precision: 0.5227
Recall: 0.7560
F1 Score: 0.5290
IoU: 0.0460
Dice Coefficient: 0.0879
Validation Metrics:
Accuracy: 0.9353
Precision: 0.5196
Recall: 0.7530
F1 Score: 0.5218
IoU: 0.0401
Dice Coefficient: 0.0770
Epoch   12/50, time: 32.82 s, training_loss: 0.719
Epoch   12/50, time: 10.23 s, val_loss: 0.706
Epoch   13/50, time: 33.36 s, training_loss: 0.710
Epoch   13/50, time: 10.34 s, val_loss: 0.705
Epoch   14/50, time: 33.12 s, training_loss: 0.692
Epoch   14/50, time: 9.83 s, val_loss: 0.649
Epoch   15/50, time: 33.13 s, training_loss: 0.664
Epoch   15/50, time: 10.12 s, val_loss: 0.650
Epoch   16/50, time: 34.48 s, training_loss: 0.638
Epoch   16/50, time: 10.15 s, val_loss: 0.617
Epoch   17/50, time: 33.69 s, training_loss: 0.611
Epoch   17/50, time: 9.85 s, val_loss: 0.598
Epoch   18/50, time: 33.99 s, training_loss: 0.586
Epoch   18/50, time: 9.88 s, val_loss: 0.563
Epoch   19/50, time: 34.46 s, training_loss: 0.569
Epoch   19/50, time: 10.29 s, val_loss: 0.560
Epoch   20/50, time: 33.86 s, training_loss: 0.547
Epoch   20/50, time: 10.13 s, val_loss: 0.525
Epoch   21/50, time: 33.61 s, training_loss: 0.525
Epoch   21/50, time: 9.87 s, val_loss: 0.508
Training Metrics:
Accuracy: 0.9953
Precision: 0.7601
Recall: 0.7455
F1 Score: 0.7526
IoU: 0.3400
Dice Coefficient: 0.5075
Validation Metrics:
Accuracy: 0.9957
Precision: 0.7748
Recall: 0.7468
F1 Score: 0.7601
IoU: 0.3534
Dice Coefficient: 0.5223
Epoch   22/50, time: 33.07 s, training_loss: 0.509
Epoch   22/50, time: 10.48 s, val_loss: 0.486
Epoch   23/50, time: 32.72 s, training_loss: 0.498
Epoch   23/50, time: 10.67 s, val_loss: 0.485
Epoch   24/50, time: 34.27 s, training_loss: 0.490
Epoch   24/50, time: 10.45 s, val_loss: 0.471
Epoch   25/50, time: 32.26 s, training_loss: 0.475
Epoch   25/50, time: 10.00 s, val_loss: 0.463
Epoch   26/50, time: 33.30 s, training_loss: 0.464
Epoch   26/50, time: 10.46 s, val_loss: 0.469
Epoch   27/50, time: 33.53 s, training_loss: 0.460
Epoch   27/50, time: 10.11 s, val_loss: 0.440
Epoch   28/50, time: 32.97 s, training_loss: 0.456
Epoch   28/50, time: 10.52 s, val_loss: 0.442
Epoch   29/50, time: 35.49 s, training_loss: 0.444
Epoch   29/50, time: 10.48 s, val_loss: 0.446
Epoch   30/50, time: 32.92 s, training_loss: 0.438
Epoch   30/50, time: 10.71 s, val_loss: 0.433
Epoch   31/50, time: 32.37 s, training_loss: 0.424
Epoch   31/50, time: 10.06 s, val_loss: 0.426
Training Metrics:
Accuracy: 0.9961
Precision: 0.8036
Recall: 0.7809
F1 Score: 0.7918
IoU: 0.4140
Dice Coefficient: 0.5855
Validation Metrics:
Accuracy: 0.9964
Precision: 0.8124
Recall: 0.7892
F1 Score: 0.8003
IoU: 0.4311
Dice Coefficient: 0.6025
Epoch   32/50, time: 33.40 s, training_loss: 0.425
Epoch   32/50, time: 10.61 s, val_loss: 0.433
Epoch   33/50, time: 35.02 s, training_loss: 0.426
Epoch   33/50, time: 10.22 s, val_loss: 0.484
Epoch   34/50, time: 33.36 s, training_loss: 0.420
Epoch   34/50, time: 9.81 s, val_loss: 0.404
Epoch   35/50, time: 33.69 s, training_loss: 0.407
Epoch   35/50, time: 10.25 s, val_loss: 0.399
Epoch   36/50, time: 32.67 s, training_loss: 0.409
Epoch   36/50, time: 9.90 s, val_loss: 0.408
Epoch   37/50, time: 32.97 s, training_loss: 0.404
Epoch   37/50, time: 9.78 s, val_loss: 0.400
Epoch   38/50, time: 33.19 s, training_loss: 0.406
Epoch   38/50, time: 10.74 s, val_loss: 0.386
Epoch   39/50, time: 35.10 s, training_loss: 0.398
Epoch   39/50, time: 10.65 s, val_loss: 0.388
Epoch   40/50, time: 32.62 s, training_loss: 0.396
Epoch   40/50, time: 10.34 s, val_loss: 0.416
Epoch   41/50, time: 32.44 s, training_loss: 0.397
Epoch   41/50, time: 9.96 s, val_loss: 0.398
Training Metrics:
Accuracy: 0.9965
Precision: 0.8282
Recall: 0.8038
F1 Score: 0.8155
IoU: 0.4629
Dice Coefficient: 0.6328
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8309
Recall: 0.8058
F1 Score: 0.8179
IoU: 0.4678
Dice Coefficient: 0.6375
Epoch   42/50, time: 32.14 s, training_loss: 0.386
Epoch   42/50, time: 10.36 s, val_loss: 0.406
Epoch   43/50, time: 34.35 s, training_loss: 0.387
Epoch   43/50, time: 10.20 s, val_loss: 0.408
Epoch   44/50, time: 33.27 s, training_loss: 0.385
Epoch   44/50, time: 10.07 s, val_loss: 0.374
Epoch   45/50, time: 33.76 s, training_loss: 0.382
Epoch   45/50, time: 10.31 s, val_loss: 0.380
Epoch   46/50, time: 33.48 s, training_loss: 0.377
Epoch   46/50, time: 10.62 s, val_loss: 0.378
Epoch   47/50, time: 32.55 s, training_loss: 0.379
Epoch   47/50, time: 10.03 s, val_loss: 0.405
Epoch   48/50, time: 32.44 s, training_loss: 0.372
Epoch   48/50, time: 10.20 s, val_loss: 0.392
Epoch   49/50, time: 33.27 s, training_loss: 0.368
Epoch   49/50, time: 10.00 s, val_loss: 0.367
Epoch   50/50, time: 33.62 s, training_loss: 0.367
Epoch   50/50, time: 9.98 s, val_loss: 0.381
Training Metrics:
Accuracy: 0.9967
Precision: 0.8401
Recall: 0.8009
F1 Score: 0.8193
IoU: 0.4708
Dice Coefficient: 0.6402
Validation Metrics:
Accuracy: 0.9967
Precision: 0.8364
Recall: 0.7969
F1 Score: 0.8154
IoU: 0.4625
Dice Coefficient: 0.6325
[I 2025-06-17 01:35:04,508] Trial 14 finished with value: 0.6324856379454954 and parameters: {'batch_size': 16, 'lr': 0.0006289623963493286, 'loss_fn': 'dice_loss'}. Best is trial 4 with value: 0.6541612153708668.
Test Metrics:
Accuracy: 0.9967
Precision: 0.8364
Recall: 0.7969
F1 Score: 0.8154
IoU: 0.4625
Dice Coefficient: 0.6325
[Trial 14] Finished with val_loss=inf
[Trial 14] Finished with dice_coeff=0.6324856379454954
Best params: {'batch_size': 16, 'lr': 0.0008078921183289167, 'loss_fn': 'dice_loss'}
Best val loss: 0.6541612153708668
