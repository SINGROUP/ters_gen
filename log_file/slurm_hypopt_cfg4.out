[I 2025-06-09 16:00:17,461] A new study created in memory with name: no-name-1df5913b-e8ba-4f75-93f9-3e007f6662e1
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
======= Loaded Configuration =======
data:
  circle_radius: 5
  split_by_id: 0
  train_path: /scratch/phys/sin/sethih1/data_files/all_group_plane_fchk_split_images_ters/train
  val_path: /scratch/phys/sin/sethih1/data_files/all_group_plane_fchk_split_images_ters/val
log_path: /scratch/phys/sin/sethih1/runs_ters/all_group_plane_fchk_split_images_ters/hyperopt/config4/
model:
  att_channels: 32
  filters:
  - 16
  - 32
  - 64
  - 128
  - 256
  in_channels: 100
  kernel_size:
  - 3
  - 3
  - 3
  - 3
  - 3
  out_channels: 1
  type: AttentionUNet
save_path: /scratch/phys/sin/sethih1/models/all_group_plane_fchk_split_images_ters/hyperopt/config4/
training:
  batch_sizes:
  - 16
  - 32
  - 64
  - 128
  epochs: 50
  learning_rates:
  - 0.0001
  - 0.001
  loss_functions:
  - dice_loss
  n_jobs: 1
  n_trials: 15

====================================
[Trial 0] Trying batch_size=16, lr=0.0006562779876684399, loss_fn=dice_loss
Epoch    1/50, time: 44.87 s, training_loss: 0.821
Epoch    1/50, time: 61.66 s, val_loss: 0.765
Training Metrics:
Accuracy: 0.9119
Precision: 0.1663
Recall: 0.8689
F1 Score: 0.2791
IoU: 0.1622
Dice Coefficient: 0.2791
Validation Metrics:
Accuracy: 0.9141
Precision: 0.1662
Recall: 0.8776
F1 Score: 0.2794
IoU: 0.1624
Dice Coefficient: 0.2794
Epoch    2/50, time: 22.67 s, training_loss: 0.749
Epoch    2/50, time: 33.38 s, val_loss: 0.766
Epoch    3/50, time: 22.57 s, training_loss: 0.719
Epoch    3/50, time: 33.27 s, val_loss: 0.697
Epoch    4/50, time: 21.89 s, training_loss: 0.674
Epoch    4/50, time: 32.41 s, val_loss: 0.646
Epoch    5/50, time: 21.87 s, training_loss: 0.625
Epoch    5/50, time: 32.59 s, val_loss: 0.601
Epoch    6/50, time: 22.32 s, training_loss: 0.586
Epoch    6/50, time: 32.80 s, val_loss: 0.590
Epoch    7/50, time: 22.23 s, training_loss: 0.548
Epoch    7/50, time: 32.93 s, val_loss: 0.549
Epoch    8/50, time: 23.11 s, training_loss: 0.503
Epoch    8/50, time: 33.69 s, val_loss: 0.621
Epoch    9/50, time: 23.50 s, training_loss: 0.476
Epoch    9/50, time: 34.01 s, val_loss: 0.480
Epoch   10/50, time: 22.57 s, training_loss: 0.447
Epoch   10/50, time: 33.29 s, val_loss: 0.445
Epoch   11/50, time: 22.53 s, training_loss: 0.425
Epoch   11/50, time: 33.10 s, val_loss: 0.458
Training Metrics:
Accuracy: 0.9811
Precision: 0.5150
Recall: 0.6307
F1 Score: 0.5671
IoU: 0.3957
Dice Coefficient: 0.5671
Validation Metrics:
Accuracy: 0.9808
Precision: 0.4944
Recall: 0.6028
F1 Score: 0.5432
IoU: 0.3729
Dice Coefficient: 0.5432
Epoch   12/50, time: 22.61 s, training_loss: 0.393
Epoch   12/50, time: 33.23 s, val_loss: 0.435
Epoch   13/50, time: 22.52 s, training_loss: 0.371
Epoch   13/50, time: 33.25 s, val_loss: 0.417
Epoch   14/50, time: 22.48 s, training_loss: 0.350
Epoch   14/50, time: 33.22 s, val_loss: 0.375
Epoch   15/50, time: 23.18 s, training_loss: 0.333
Epoch   15/50, time: 34.00 s, val_loss: 0.449
Epoch   16/50, time: 22.79 s, training_loss: 0.323
Epoch   16/50, time: 33.53 s, val_loss: 0.376
Epoch   17/50, time: 22.89 s, training_loss: 0.306
Epoch   17/50, time: 33.59 s, val_loss: 0.361
Epoch   18/50, time: 22.23 s, training_loss: 0.291
Epoch   18/50, time: 32.85 s, val_loss: 0.369
Epoch   19/50, time: 22.59 s, training_loss: 0.283
Epoch   19/50, time: 33.10 s, val_loss: 0.346
Epoch   20/50, time: 22.88 s, training_loss: 0.271
Epoch   20/50, time: 33.54 s, val_loss: 0.329
Epoch   21/50, time: 22.18 s, training_loss: 0.269
Epoch   21/50, time: 32.82 s, val_loss: 0.328
Training Metrics:
Accuracy: 0.9893
Precision: 0.7013
Recall: 0.7932
F1 Score: 0.7444
IoU: 0.5929
Dice Coefficient: 0.7444
Validation Metrics:
Accuracy: 0.9869
Precision: 0.6395
Recall: 0.7143
F1 Score: 0.6748
IoU: 0.5092
Dice Coefficient: 0.6748
Epoch   22/50, time: 22.00 s, training_loss: 0.253
Epoch   22/50, time: 32.65 s, val_loss: 0.316
Epoch   23/50, time: 22.08 s, training_loss: 0.244
Epoch   23/50, time: 32.76 s, val_loss: 0.330
Epoch   24/50, time: 22.34 s, training_loss: 0.241
Epoch   24/50, time: 32.86 s, val_loss: 0.328
Epoch   25/50, time: 23.08 s, training_loss: 0.231
Epoch   25/50, time: 33.74 s, val_loss: 0.368
Epoch   26/50, time: 23.25 s, training_loss: 0.220
Epoch   26/50, time: 33.96 s, val_loss: 0.301
Epoch   27/50, time: 22.79 s, training_loss: 0.215
Epoch   27/50, time: 33.52 s, val_loss: 0.310
Epoch   28/50, time: 22.87 s, training_loss: 0.211
Epoch   28/50, time: 33.51 s, val_loss: 0.321
Epoch   29/50, time: 22.41 s, training_loss: 0.208
Epoch   29/50, time: 33.02 s, val_loss: 0.301
Epoch   30/50, time: 22.36 s, training_loss: 0.202
Epoch   30/50, time: 32.89 s, val_loss: 0.298
Epoch   31/50, time: 22.99 s, training_loss: 0.199
Epoch   31/50, time: 33.54 s, val_loss: 0.308
Training Metrics:
Accuracy: 0.9923
Precision: 0.7894
Recall: 0.8270
F1 Score: 0.8078
IoU: 0.6775
Dice Coefficient: 0.8078
Validation Metrics:
Accuracy: 0.9884
Precision: 0.6893
Recall: 0.7105
F1 Score: 0.6998
IoU: 0.5382
Dice Coefficient: 0.6998
Epoch   32/50, time: 22.84 s, training_loss: 0.192
Epoch   32/50, time: 33.25 s, val_loss: 0.295
Epoch   33/50, time: 22.70 s, training_loss: 0.197
Epoch   33/50, time: 33.33 s, val_loss: 0.328
Epoch   34/50, time: 22.60 s, training_loss: 0.188
Epoch   34/50, time: 33.12 s, val_loss: 0.292
Epoch   35/50, time: 22.71 s, training_loss: 0.180
Epoch   35/50, time: 33.39 s, val_loss: 0.308
Epoch   36/50, time: 21.78 s, training_loss: 0.185
Epoch   36/50, time: 32.26 s, val_loss: 0.310
Epoch   37/50, time: 22.04 s, training_loss: 0.178
Epoch   37/50, time: 32.68 s, val_loss: 0.281
Epoch   38/50, time: 22.10 s, training_loss: 0.180
Epoch   38/50, time: 32.82 s, val_loss: 0.298
Epoch   39/50, time: 22.81 s, training_loss: 0.178
Epoch   39/50, time: 33.50 s, val_loss: 0.299
Epoch   40/50, time: 23.18 s, training_loss: 0.170
Epoch   40/50, time: 33.77 s, val_loss: 0.292
Epoch   41/50, time: 22.74 s, training_loss: 0.164
Epoch   41/50, time: 33.52 s, val_loss: 0.287
Training Metrics:
Accuracy: 0.9940
Precision: 0.8320
Recall: 0.8669
F1 Score: 0.8491
IoU: 0.7378
Dice Coefficient: 0.8491
Validation Metrics:
Accuracy: 0.9894
Precision: 0.7169
Recall: 0.7315
F1 Score: 0.7241
IoU: 0.5676
Dice Coefficient: 0.7241
Epoch   42/50, time: 23.22 s, training_loss: 0.163
Epoch   42/50, time: 33.94 s, val_loss: 0.286
Epoch   43/50, time: 22.86 s, training_loss: 0.161
Epoch   43/50, time: 33.42 s, val_loss: 0.299
Epoch   44/50, time: 23.06 s, training_loss: 0.161
Epoch   44/50, time: 33.72 s, val_loss: 0.292
Epoch   45/50, time: 22.45 s, training_loss: 0.158
Epoch   45/50, time: 33.24 s, val_loss: 0.288
Epoch   46/50, time: 22.64 s, training_loss: 0.159
Epoch   46/50, time: 33.32 s, val_loss: 0.289
Epoch   47/50, time: 21.98 s, training_loss: 0.156
Epoch   47/50, time: 32.70 s, val_loss: 0.294
Epoch   48/50, time: 23.32 s, training_loss: 0.155
Epoch   48/50, time: 33.98 s, val_loss: 0.285
Epoch   49/50, time: 23.04 s, training_loss: 0.152
Epoch   49/50, time: 33.73 s, val_loss: 0.287
Epoch   50/50, time: 22.75 s, training_loss: 0.147
Epoch   50/50, time: 33.31 s, val_loss: 0.294
Training Metrics:
Accuracy: 0.9941
Precision: 0.8457
Recall: 0.8529
F1 Score: 0.8493
IoU: 0.7381
Dice Coefficient: 0.8493
Validation Metrics:
Accuracy: 0.9895
Precision: 0.7312
Recall: 0.7045
F1 Score: 0.7176
IoU: 0.5596
Dice Coefficient: 0.7176
[I 2025-06-09 16:33:30,235] Trial 0 finished with value: 0.7176096104382447 and parameters: {'batch_size': 16, 'lr': 0.0006562779876684399, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.7176096104382447.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9895
Precision: 0.7312
Recall: 0.7045
F1 Score: 0.7176
IoU: 0.5596
Dice Coefficient: 0.7176
[Trial 0] Finished with val_loss=inf
[Trial 0] Finished with dice_coeff=0.7176096104382447
[Trial 1] Trying batch_size=128, lr=0.0005279767694803884, loss_fn=dice_loss
Epoch    1/50, time: 34.32 s, training_loss: 0.907
Epoch    1/50, time: 44.99 s, val_loss: 0.957
Training Metrics:
Accuracy: 0.9782
Precision: 0.1527
Recall: 0.0249
F1 Score: 0.0428
IoU: 0.0219
Dice Coefficient: 0.0428
Validation Metrics:
Accuracy: 0.9792
Precision: 0.1611
Recall: 0.0235
F1 Score: 0.0410
IoU: 0.0209
Dice Coefficient: 0.0410
Epoch    2/50, time: 35.18 s, training_loss: 0.861
Epoch    2/50, time: 45.82 s, val_loss: 0.925
Epoch    3/50, time: 34.71 s, training_loss: 0.844
Epoch    3/50, time: 45.43 s, val_loss: 0.887
Epoch    4/50, time: 34.06 s, training_loss: 0.828
Epoch    4/50, time: 44.83 s, val_loss: 0.835
Epoch    5/50, time: 34.37 s, training_loss: 0.815
Epoch    5/50, time: 45.06 s, val_loss: 0.823
Epoch    6/50, time: 34.78 s, training_loss: 0.800
Epoch    6/50, time: 45.38 s, val_loss: 0.817
Epoch    7/50, time: 34.39 s, training_loss: 0.791
Epoch    7/50, time: 45.09 s, val_loss: 0.794
Epoch    8/50, time: 34.01 s, training_loss: 0.782
Epoch    8/50, time: 44.76 s, val_loss: 0.798
Epoch    9/50, time: 34.17 s, training_loss: 0.773
Epoch    9/50, time: 44.93 s, val_loss: 0.771
Epoch   10/50, time: 34.56 s, training_loss: 0.765
Epoch   10/50, time: 45.29 s, val_loss: 0.770
Epoch   11/50, time: 34.15 s, training_loss: 0.755
Epoch   11/50, time: 44.86 s, val_loss: 0.742
Training Metrics:
Accuracy: 0.9249
Precision: 0.1819
Recall: 0.8079
F1 Score: 0.2969
IoU: 0.1744
Dice Coefficient: 0.2969
Validation Metrics:
Accuracy: 0.9291
Precision: 0.1845
Recall: 0.7997
F1 Score: 0.2998
IoU: 0.1763
Dice Coefficient: 0.2998
Epoch   12/50, time: 34.06 s, training_loss: 0.742
Epoch   12/50, time: 44.76 s, val_loss: 0.733
Epoch   13/50, time: 34.59 s, training_loss: 0.733
Epoch   13/50, time: 45.48 s, val_loss: 0.751
Epoch   14/50, time: 34.25 s, training_loss: 0.723
Epoch   14/50, time: 45.06 s, val_loss: 0.719
Epoch   15/50, time: 34.77 s, training_loss: 0.710
Epoch   15/50, time: 45.50 s, val_loss: 0.697
Epoch   16/50, time: 34.75 s, training_loss: 0.696
Epoch   16/50, time: 45.38 s, val_loss: 0.682
Epoch   17/50, time: 35.12 s, training_loss: 0.683
Epoch   17/50, time: 45.88 s, val_loss: 0.661
Epoch   18/50, time: 34.52 s, training_loss: 0.674
Epoch   18/50, time: 45.29 s, val_loss: 0.660
Epoch   19/50, time: 34.58 s, training_loss: 0.654
Epoch   19/50, time: 45.29 s, val_loss: 0.656
Epoch   20/50, time: 34.23 s, training_loss: 0.636
Epoch   20/50, time: 45.15 s, val_loss: 0.674
Epoch   21/50, time: 33.90 s, training_loss: 0.635
Epoch   21/50, time: 44.73 s, val_loss: 0.672
Training Metrics:
Accuracy: 0.9515
Precision: 0.2406
Recall: 0.6828
F1 Score: 0.3558
IoU: 0.2164
Dice Coefficient: 0.3558
Validation Metrics:
Accuracy: 0.9535
Precision: 0.2381
Recall: 0.6609
F1 Score: 0.3501
IoU: 0.2122
Dice Coefficient: 0.3501
Epoch   22/50, time: 35.15 s, training_loss: 0.610
Epoch   22/50, time: 45.95 s, val_loss: 0.703
Epoch   23/50, time: 34.78 s, training_loss: 0.597
Epoch   23/50, time: 45.58 s, val_loss: 0.596
Epoch   24/50, time: 34.09 s, training_loss: 0.555
Epoch   24/50, time: 44.87 s, val_loss: 0.704
Epoch   25/50, time: 34.44 s, training_loss: 0.534
Epoch   25/50, time: 45.25 s, val_loss: 0.602
Epoch   26/50, time: 34.59 s, training_loss: 0.518
Epoch   26/50, time: 45.25 s, val_loss: 0.609
Epoch   27/50, time: 34.60 s, training_loss: 0.503
Epoch   27/50, time: 45.17 s, val_loss: 0.534
Epoch   28/50, time: 33.86 s, training_loss: 0.486
Epoch   28/50, time: 44.58 s, val_loss: 0.579
Epoch   29/50, time: 34.54 s, training_loss: 0.488
Epoch   29/50, time: 45.23 s, val_loss: 0.565
Epoch   30/50, time: 33.85 s, training_loss: 0.471
Epoch   30/50, time: 44.57 s, val_loss: 0.543
Epoch   31/50, time: 34.98 s, training_loss: 0.440
Epoch   31/50, time: 45.64 s, val_loss: 0.593
Training Metrics:
Accuracy: 0.9795
Precision: 0.4768
Recall: 0.4451
F1 Score: 0.4604
IoU: 0.2990
Dice Coefficient: 0.4604
Validation Metrics:
Accuracy: 0.9800
Precision: 0.4686
Recall: 0.4126
F1 Score: 0.4388
IoU: 0.2811
Dice Coefficient: 0.4388
Epoch   32/50, time: 34.20 s, training_loss: 0.423
Epoch   32/50, time: 44.96 s, val_loss: 0.486
Epoch   33/50, time: 34.00 s, training_loss: 0.418
Epoch   33/50, time: 44.82 s, val_loss: 0.489
Epoch   34/50, time: 34.23 s, training_loss: 0.384
Epoch   34/50, time: 45.02 s, val_loss: 0.492
Epoch   35/50, time: 34.04 s, training_loss: 0.363
Epoch   35/50, time: 44.74 s, val_loss: 0.554
Epoch   36/50, time: 34.18 s, training_loss: 0.387
Epoch   36/50, time: 45.11 s, val_loss: 0.476
Epoch   37/50, time: 34.90 s, training_loss: 0.374
Epoch   37/50, time: 45.92 s, val_loss: 0.439
Epoch   38/50, time: 35.26 s, training_loss: 0.365
Epoch   38/50, time: 46.11 s, val_loss: 0.499
Epoch   39/50, time: 33.95 s, training_loss: 0.369
Epoch   39/50, time: 44.68 s, val_loss: 0.477
Epoch   40/50, time: 34.80 s, training_loss: 0.334
Epoch   40/50, time: 45.55 s, val_loss: 0.471
Epoch   41/50, time: 34.36 s, training_loss: 0.346
Epoch   41/50, time: 45.23 s, val_loss: 0.425
Training Metrics:
Accuracy: 0.9826
Precision: 0.5419
Recall: 0.7399
F1 Score: 0.6256
IoU: 0.4552
Dice Coefficient: 0.6256
Validation Metrics:
Accuracy: 0.9819
Precision: 0.5169
Recall: 0.6783
F1 Score: 0.5867
IoU: 0.4151
Dice Coefficient: 0.5867
Epoch   42/50, time: 34.13 s, training_loss: 0.313
Epoch   42/50, time: 45.03 s, val_loss: 0.397
Epoch   43/50, time: 34.67 s, training_loss: 0.308
Epoch   43/50, time: 45.39 s, val_loss: 0.544
Epoch   44/50, time: 34.59 s, training_loss: 0.339
Epoch   44/50, time: 45.35 s, val_loss: 0.381
Epoch   45/50, time: 34.35 s, training_loss: 0.321
Epoch   45/50, time: 45.02 s, val_loss: 0.363
Epoch   46/50, time: 33.66 s, training_loss: 0.299
Epoch   46/50, time: 44.32 s, val_loss: 0.495
Epoch   47/50, time: 34.57 s, training_loss: 0.309
Epoch   47/50, time: 45.52 s, val_loss: 0.376
Epoch   48/50, time: 34.41 s, training_loss: 0.267
Epoch   48/50, time: 45.29 s, val_loss: 0.353
Epoch   49/50, time: 35.28 s, training_loss: 0.261
Epoch   49/50, time: 46.04 s, val_loss: 0.348
Epoch   50/50, time: 34.13 s, training_loss: 0.249
Epoch   50/50, time: 44.87 s, val_loss: 0.428
Training Metrics:
Accuracy: 0.9863
Precision: 0.6451
Recall: 0.6741
F1 Score: 0.6593
IoU: 0.4917
Dice Coefficient: 0.6593
Validation Metrics:
Accuracy: 0.9841
Precision: 0.5792
Recall: 0.5824
F1 Score: 0.5808
IoU: 0.4093
Dice Coefficient: 0.5808
[I 2025-06-09 17:17:15,968] Trial 1 finished with value: 0.5808117216521134 and parameters: {'batch_size': 128, 'lr': 0.0005279767694803884, 'loss_fn': 'dice_loss'}. Best is trial 0 with value: 0.7176096104382447.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9841
Precision: 0.5792
Recall: 0.5824
F1 Score: 0.5808
IoU: 0.4093
Dice Coefficient: 0.5808
[Trial 1] Finished with val_loss=inf
[Trial 1] Finished with dice_coeff=0.5808117216521134
[Trial 2] Trying batch_size=16, lr=0.0007213203122753679, loss_fn=dice_loss
Epoch    1/50, time: 23.10 s, training_loss: 0.866
Epoch    1/50, time: 33.94 s, val_loss: 0.815
Training Metrics:
Accuracy: 0.9029
Precision: 0.1532
Recall: 0.8714
F1 Score: 0.2606
IoU: 0.1498
Dice Coefficient: 0.2606
Validation Metrics:
Accuracy: 0.9051
Precision: 0.1526
Recall: 0.8784
F1 Score: 0.2600
IoU: 0.1494
Dice Coefficient: 0.2600
Epoch    2/50, time: 22.76 s, training_loss: 0.788
Epoch    2/50, time: 33.58 s, val_loss: 0.762
Epoch    3/50, time: 23.03 s, training_loss: 0.738
Epoch    3/50, time: 33.77 s, val_loss: 0.719
Epoch    4/50, time: 22.79 s, training_loss: 0.701
Epoch    4/50, time: 33.51 s, val_loss: 0.682
Epoch    5/50, time: 23.28 s, training_loss: 0.664
Epoch    5/50, time: 34.11 s, val_loss: 0.666
Epoch    6/50, time: 22.35 s, training_loss: 0.619
Epoch    6/50, time: 33.12 s, val_loss: 0.614
Epoch    7/50, time: 23.39 s, training_loss: 0.579
Epoch    7/50, time: 34.28 s, val_loss: 0.577
Epoch    8/50, time: 22.65 s, training_loss: 0.547
Epoch    8/50, time: 33.39 s, val_loss: 0.538
Epoch    9/50, time: 22.32 s, training_loss: 0.513
Epoch    9/50, time: 33.08 s, val_loss: 0.503
Epoch   10/50, time: 22.94 s, training_loss: 0.477
Epoch   10/50, time: 33.67 s, val_loss: 0.629
Epoch   11/50, time: 23.40 s, training_loss: 0.466
Epoch   11/50, time: 34.07 s, val_loss: 0.467
Training Metrics:
Accuracy: 0.9779
Precision: 0.4584
Recall: 0.6948
F1 Score: 0.5524
IoU: 0.3816
Dice Coefficient: 0.5524
Validation Metrics:
Accuracy: 0.9780
Precision: 0.4473
Recall: 0.6746
F1 Score: 0.5379
IoU: 0.3679
Dice Coefficient: 0.5379
Epoch   12/50, time: 23.30 s, training_loss: 0.438
Epoch   12/50, time: 33.95 s, val_loss: 0.503
Epoch   13/50, time: 22.91 s, training_loss: 0.401
Epoch   13/50, time: 33.62 s, val_loss: 0.474
Epoch   14/50, time: 23.33 s, training_loss: 0.384
Epoch   14/50, time: 34.13 s, val_loss: 0.412
Epoch   15/50, time: 22.86 s, training_loss: 0.369
Epoch   15/50, time: 33.49 s, val_loss: 0.405
Epoch   16/50, time: 22.49 s, training_loss: 0.335
Epoch   16/50, time: 33.13 s, val_loss: 0.402
Epoch   17/50, time: 22.67 s, training_loss: 0.320
Epoch   17/50, time: 33.29 s, val_loss: 0.361
Epoch   18/50, time: 22.60 s, training_loss: 0.313
Epoch   18/50, time: 33.29 s, val_loss: 0.354
Epoch   19/50, time: 22.63 s, training_loss: 0.295
Epoch   19/50, time: 33.47 s, val_loss: 0.356
Epoch   20/50, time: 22.79 s, training_loss: 0.275
Epoch   20/50, time: 33.46 s, val_loss: 0.348
Epoch   21/50, time: 22.69 s, training_loss: 0.263
Epoch   21/50, time: 33.44 s, val_loss: 0.377
Training Metrics:
Accuracy: 0.9871
Precision: 0.6577
Recall: 0.7157
F1 Score: 0.6854
IoU: 0.5214
Dice Coefficient: 0.6854
Validation Metrics:
Accuracy: 0.9853
Precision: 0.6037
Recall: 0.6508
F1 Score: 0.6264
IoU: 0.4560
Dice Coefficient: 0.6264
Epoch   22/50, time: 22.51 s, training_loss: 0.256
Epoch   22/50, time: 33.26 s, val_loss: 0.331
Epoch   23/50, time: 22.74 s, training_loss: 0.245
Epoch   23/50, time: 33.48 s, val_loss: 0.318
Epoch   24/50, time: 23.18 s, training_loss: 0.232
Epoch   24/50, time: 33.74 s, val_loss: 0.351
Epoch   25/50, time: 23.44 s, training_loss: 0.224
Epoch   25/50, time: 34.19 s, val_loss: 0.299
Epoch   26/50, time: 23.17 s, training_loss: 0.220
Epoch   26/50, time: 33.92 s, val_loss: 0.302
Epoch   27/50, time: 22.56 s, training_loss: 0.218
Epoch   27/50, time: 33.39 s, val_loss: 0.308
Epoch   28/50, time: 22.16 s, training_loss: 0.212
Epoch   28/50, time: 32.89 s, val_loss: 0.308
Epoch   29/50, time: 22.77 s, training_loss: 0.203
Epoch   29/50, time: 33.50 s, val_loss: 0.308
Epoch   30/50, time: 22.80 s, training_loss: 0.201
Epoch   30/50, time: 33.55 s, val_loss: 0.330
Epoch   31/50, time: 23.13 s, training_loss: 0.192
Epoch   31/50, time: 33.93 s, val_loss: 0.308
Training Metrics:
Accuracy: 0.9922
Precision: 0.7728
Recall: 0.8509
F1 Score: 0.8100
IoU: 0.6806
Dice Coefficient: 0.8100
Validation Metrics:
Accuracy: 0.9881
Precision: 0.6729
Recall: 0.7269
F1 Score: 0.6989
IoU: 0.5371
Dice Coefficient: 0.6989
Epoch   32/50, time: 22.50 s, training_loss: 0.192
Epoch   32/50, time: 33.28 s, val_loss: 0.298
Epoch   33/50, time: 22.75 s, training_loss: 0.187
Epoch   33/50, time: 33.57 s, val_loss: 0.298
Epoch   34/50, time: 22.74 s, training_loss: 0.176
Epoch   34/50, time: 33.51 s, val_loss: 0.294
Epoch   35/50, time: 22.36 s, training_loss: 0.181
Epoch   35/50, time: 33.15 s, val_loss: 0.309
Epoch   36/50, time: 22.73 s, training_loss: 0.172
Epoch   36/50, time: 33.62 s, val_loss: 0.292
Epoch   37/50, time: 22.21 s, training_loss: 0.166
Epoch   37/50, time: 33.00 s, val_loss: 0.295
Epoch   38/50, time: 22.73 s, training_loss: 0.163
Epoch   38/50, time: 33.33 s, val_loss: 0.313
Epoch   39/50, time: 22.17 s, training_loss: 0.171
Epoch   39/50, time: 32.97 s, val_loss: 0.291
Epoch   40/50, time: 22.35 s, training_loss: 0.165
Epoch   40/50, time: 33.23 s, val_loss: 0.289
Epoch   41/50, time: 22.69 s, training_loss: 0.156
Epoch   41/50, time: 33.37 s, val_loss: 0.318
Training Metrics:
Accuracy: 0.9924
Precision: 0.7956
Recall: 0.8249
F1 Score: 0.8100
IoU: 0.6807
Dice Coefficient: 0.8100
Validation Metrics:
Accuracy: 0.9881
Precision: 0.6821
Recall: 0.7020
F1 Score: 0.6919
IoU: 0.5290
Dice Coefficient: 0.6919
Epoch   42/50, time: 23.36 s, training_loss: 0.152
Epoch   42/50, time: 34.04 s, val_loss: 0.286
Epoch   43/50, time: 22.41 s, training_loss: 0.152
Epoch   43/50, time: 33.16 s, val_loss: 0.283
Epoch   44/50, time: 23.16 s, training_loss: 0.149
Epoch   44/50, time: 33.98 s, val_loss: 0.292
Epoch   45/50, time: 22.96 s, training_loss: 0.148
Epoch   45/50, time: 33.66 s, val_loss: 0.288
Epoch   46/50, time: 22.84 s, training_loss: 0.142
Epoch   46/50, time: 33.68 s, val_loss: 0.281
Epoch   47/50, time: 23.67 s, training_loss: 0.142
Epoch   47/50, time: 34.51 s, val_loss: 0.288
Epoch   48/50, time: 23.05 s, training_loss: 0.141
Epoch   48/50, time: 33.74 s, val_loss: 0.286
Epoch   49/50, time: 22.41 s, training_loss: 0.141
Epoch   49/50, time: 33.21 s, val_loss: 0.292
Epoch   50/50, time: 22.73 s, training_loss: 0.141
Epoch   50/50, time: 33.42 s, val_loss: 0.276
Training Metrics:
Accuracy: 0.9950
Precision: 0.8735
Recall: 0.8719
F1 Score: 0.8727
IoU: 0.7742
Dice Coefficient: 0.8727
Validation Metrics:
Accuracy: 0.9900
Precision: 0.7434
Recall: 0.7218
F1 Score: 0.7324
IoU: 0.5778
Dice Coefficient: 0.7324
[I 2025-06-09 17:50:18,187] Trial 2 finished with value: 0.7324309503072226 and parameters: {'batch_size': 16, 'lr': 0.0007213203122753679, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9900
Precision: 0.7434
Recall: 0.7218
F1 Score: 0.7324
IoU: 0.5778
Dice Coefficient: 0.7324
[Trial 2] Finished with val_loss=inf
[Trial 2] Finished with dice_coeff=0.7324309503072226
[Trial 3] Trying batch_size=64, lr=0.0004180858784237589, loss_fn=dice_loss
Epoch    1/50, time: 27.04 s, training_loss: 0.909
Epoch    1/50, time: 37.90 s, val_loss: 0.956
Training Metrics:
Accuracy: 0.9760
Precision: 0.1580
Recall: 0.0512
F1 Score: 0.0774
IoU: 0.0402
Dice Coefficient: 0.0774
Validation Metrics:
Accuracy: 0.9764
Precision: 0.1632
Recall: 0.0593
F1 Score: 0.0870
IoU: 0.0455
Dice Coefficient: 0.0870
Epoch    2/50, time: 27.01 s, training_loss: 0.880
Epoch    2/50, time: 37.82 s, val_loss: 0.928
Epoch    3/50, time: 27.34 s, training_loss: 0.857
Epoch    3/50, time: 38.05 s, val_loss: 0.953
Epoch    4/50, time: 27.59 s, training_loss: 0.842
Epoch    4/50, time: 38.32 s, val_loss: 0.914
Epoch    5/50, time: 27.34 s, training_loss: 0.828
Epoch    5/50, time: 38.10 s, val_loss: 0.950
Epoch    6/50, time: 27.36 s, training_loss: 0.815
Epoch    6/50, time: 38.04 s, val_loss: 0.885
Epoch    7/50, time: 27.21 s, training_loss: 0.804
Epoch    7/50, time: 37.93 s, val_loss: 0.853
Epoch    8/50, time: 27.81 s, training_loss: 0.790
Epoch    8/50, time: 38.49 s, val_loss: 0.852
Epoch    9/50, time: 27.67 s, training_loss: 0.775
Epoch    9/50, time: 38.47 s, val_loss: 0.816
Epoch   10/50, time: 27.54 s, training_loss: 0.761
Epoch   10/50, time: 38.33 s, val_loss: 0.812
Epoch   11/50, time: 26.66 s, training_loss: 0.740
Epoch   11/50, time: 37.52 s, val_loss: 0.759
Training Metrics:
Accuracy: 0.7906
Precision: 0.0797
Recall: 0.9170
F1 Score: 0.1467
IoU: 0.0792
Dice Coefficient: 0.1467
Validation Metrics:
Accuracy: 0.7507
Precision: 0.0652
Recall: 0.9104
F1 Score: 0.1217
IoU: 0.0648
Dice Coefficient: 0.1217
Epoch   12/50, time: 27.72 s, training_loss: 0.717
Epoch   12/50, time: 38.52 s, val_loss: 0.746
Epoch   13/50, time: 27.24 s, training_loss: 0.695
Epoch   13/50, time: 38.23 s, val_loss: 0.734
Epoch   14/50, time: 28.03 s, training_loss: 0.666
Epoch   14/50, time: 38.86 s, val_loss: 0.739
Epoch   15/50, time: 27.37 s, training_loss: 0.649
Epoch   15/50, time: 38.12 s, val_loss: 0.726
Epoch   16/50, time: 27.40 s, training_loss: 0.609
Epoch   16/50, time: 38.19 s, val_loss: 0.673
Epoch   17/50, time: 27.58 s, training_loss: 0.587
Epoch   17/50, time: 38.24 s, val_loss: 0.614
Epoch   18/50, time: 27.88 s, training_loss: 0.546
Epoch   18/50, time: 38.53 s, val_loss: 0.596
Epoch   19/50, time: 27.92 s, training_loss: 0.534
Epoch   19/50, time: 38.76 s, val_loss: 0.618
Epoch   20/50, time: 27.52 s, training_loss: 0.521
Epoch   20/50, time: 38.34 s, val_loss: 0.610
Epoch   21/50, time: 27.72 s, training_loss: 0.496
Epoch   21/50, time: 38.48 s, val_loss: 0.574
Training Metrics:
Accuracy: 0.8611
Precision: 0.0979
Recall: 0.7403
F1 Score: 0.1730
IoU: 0.0947
Dice Coefficient: 0.1730
Validation Metrics:
Accuracy: 0.8335
Precision: 0.0752
Recall: 0.6881
F1 Score: 0.1355
IoU: 0.0727
Dice Coefficient: 0.1355
Epoch   22/50, time: 27.40 s, training_loss: 0.463
Epoch   22/50, time: 38.21 s, val_loss: 0.761
Epoch   23/50, time: 27.95 s, training_loss: 0.458
Epoch   23/50, time: 38.69 s, val_loss: 0.646
Epoch   24/50, time: 28.52 s, training_loss: 0.433
Epoch   24/50, time: 39.26 s, val_loss: 0.490
Epoch   25/50, time: 28.58 s, training_loss: 0.399
Epoch   25/50, time: 39.31 s, val_loss: 0.428
Epoch   26/50, time: 27.17 s, training_loss: 0.366
Epoch   26/50, time: 37.98 s, val_loss: 0.407
Epoch   27/50, time: 27.38 s, training_loss: 0.357
Epoch   27/50, time: 38.26 s, val_loss: 0.487
Epoch   28/50, time: 27.01 s, training_loss: 0.367
Epoch   28/50, time: 37.68 s, val_loss: 0.463
Epoch   29/50, time: 27.79 s, training_loss: 0.353
Epoch   29/50, time: 38.64 s, val_loss: 0.458
Epoch   30/50, time: 27.50 s, training_loss: 0.332
Epoch   30/50, time: 38.24 s, val_loss: 0.440
Epoch   31/50, time: 27.77 s, training_loss: 0.354
Epoch   31/50, time: 38.60 s, val_loss: 0.402
Training Metrics:
Accuracy: 0.9682
Precision: 0.3564
Recall: 0.7715
F1 Score: 0.4876
IoU: 0.3224
Dice Coefficient: 0.4876
Validation Metrics:
Accuracy: 0.9574
Precision: 0.2628
Recall: 0.6894
F1 Score: 0.3805
IoU: 0.2349
Dice Coefficient: 0.3805
Epoch   32/50, time: 27.09 s, training_loss: 0.320
Epoch   32/50, time: 37.82 s, val_loss: 0.378
Epoch   33/50, time: 27.37 s, training_loss: 0.317
Epoch   33/50, time: 38.08 s, val_loss: 0.462
Epoch   34/50, time: 26.48 s, training_loss: 0.319
Epoch   34/50, time: 37.16 s, val_loss: 0.381
Epoch   35/50, time: 26.96 s, training_loss: 0.295
Epoch   35/50, time: 37.78 s, val_loss: 0.379
Epoch   36/50, time: 27.55 s, training_loss: 0.292
Epoch   36/50, time: 38.35 s, val_loss: 0.426
Epoch   37/50, time: 27.14 s, training_loss: 0.275
Epoch   37/50, time: 38.00 s, val_loss: 0.350
Epoch   38/50, time: 27.59 s, training_loss: 0.267
Epoch   38/50, time: 38.35 s, val_loss: 0.431
Epoch   39/50, time: 27.42 s, training_loss: 0.290
Epoch   39/50, time: 38.32 s, val_loss: 0.347
Epoch   40/50, time: 27.34 s, training_loss: 0.251
Epoch   40/50, time: 38.04 s, val_loss: 0.372
Epoch   41/50, time: 27.46 s, training_loss: 0.245
Epoch   41/50, time: 38.26 s, val_loss: 0.384
Training Metrics:
Accuracy: 0.9686
Precision: 0.3599
Recall: 0.7712
F1 Score: 0.4907
IoU: 0.3252
Dice Coefficient: 0.4907
Validation Metrics:
Accuracy: 0.9575
Precision: 0.2570
Recall: 0.6567
F1 Score: 0.3695
IoU: 0.2266
Dice Coefficient: 0.3695
Epoch   42/50, time: 27.36 s, training_loss: 0.244
Epoch   42/50, time: 38.20 s, val_loss: 0.349
Epoch   43/50, time: 27.52 s, training_loss: 0.235
Epoch   43/50, time: 38.29 s, val_loss: 0.335
Epoch   44/50, time: 27.80 s, training_loss: 0.231
Epoch   44/50, time: 38.73 s, val_loss: 0.355
Epoch   45/50, time: 28.15 s, training_loss: 0.223
Epoch   45/50, time: 38.97 s, val_loss: 0.354
Epoch   46/50, time: 27.70 s, training_loss: 0.224
Epoch   46/50, time: 38.61 s, val_loss: 0.406
Epoch   47/50, time: 27.23 s, training_loss: 0.218
Epoch   47/50, time: 37.96 s, val_loss: 0.360
Epoch   48/50, time: 27.98 s, training_loss: 0.206
Epoch   48/50, time: 38.78 s, val_loss: 0.326
Epoch   49/50, time: 27.42 s, training_loss: 0.211
Epoch   49/50, time: 38.24 s, val_loss: 0.354
Epoch   50/50, time: 28.20 s, training_loss: 0.211
Epoch   50/50, time: 39.06 s, val_loss: 0.346
Training Metrics:
Accuracy: 0.9923
Precision: 0.7859
Recall: 0.8350
F1 Score: 0.8097
IoU: 0.6803
Dice Coefficient: 0.8097
Validation Metrics:
Accuracy: 0.9871
Precision: 0.6517
Recall: 0.6836
F1 Score: 0.6673
IoU: 0.5007
Dice Coefficient: 0.6673
[I 2025-06-09 18:27:38,923] Trial 3 finished with value: 0.6672639205580366 and parameters: {'batch_size': 64, 'lr': 0.0004180858784237589, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9871
Precision: 0.6517
Recall: 0.6836
F1 Score: 0.6673
IoU: 0.5007
Dice Coefficient: 0.6673
[Trial 3] Finished with val_loss=inf
[Trial 3] Finished with dice_coeff=0.6672639205580366
[Trial 4] Trying batch_size=64, lr=0.00014754292193642747, loss_fn=dice_loss
Epoch    1/50, time: 27.24 s, training_loss: 0.902
Epoch    1/50, time: 37.97 s, val_loss: 0.949
Training Metrics:
Accuracy: 0.9746
Precision: 0.1490
Recall: 0.0620
F1 Score: 0.0876
IoU: 0.0458
Dice Coefficient: 0.0876
Validation Metrics:
Accuracy: 0.9755
Precision: 0.1591
Recall: 0.0681
F1 Score: 0.0953
IoU: 0.0501
Dice Coefficient: 0.0953
Epoch    2/50, time: 27.57 s, training_loss: 0.867
Epoch    2/50, time: 38.55 s, val_loss: 0.873
Epoch    3/50, time: 29.36 s, training_loss: 0.848
Epoch    3/50, time: 40.26 s, val_loss: 0.877
Epoch    4/50, time: 27.95 s, training_loss: 0.831
Epoch    4/50, time: 38.97 s, val_loss: 0.940
Epoch    5/50, time: 27.80 s, training_loss: 0.819
Epoch    5/50, time: 38.69 s, val_loss: 0.877
Epoch    6/50, time: 27.80 s, training_loss: 0.811
Epoch    6/50, time: 38.61 s, val_loss: 0.857
Epoch    7/50, time: 27.58 s, training_loss: 0.804
Epoch    7/50, time: 38.68 s, val_loss: 0.823
Epoch    8/50, time: 27.18 s, training_loss: 0.793
Epoch    8/50, time: 37.96 s, val_loss: 0.820
Epoch    9/50, time: 27.65 s, training_loss: 0.785
Epoch    9/50, time: 38.35 s, val_loss: 0.813
Epoch   10/50, time: 27.04 s, training_loss: 0.778
Epoch   10/50, time: 37.74 s, val_loss: 0.793
Epoch   11/50, time: 27.13 s, training_loss: 0.763
Epoch   11/50, time: 37.87 s, val_loss: 0.796
Training Metrics:
Accuracy: 0.7958
Precision: 0.0853
Recall: 0.9673
F1 Score: 0.1568
IoU: 0.0851
Dice Coefficient: 0.1568
Validation Metrics:
Accuracy: 0.7796
Precision: 0.0762
Recall: 0.9553
F1 Score: 0.1412
IoU: 0.0760
Dice Coefficient: 0.1412
Epoch   12/50, time: 27.11 s, training_loss: 0.754
Epoch   12/50, time: 38.10 s, val_loss: 0.785
Epoch   13/50, time: 27.14 s, training_loss: 0.745
Epoch   13/50, time: 38.00 s, val_loss: 0.766
Epoch   14/50, time: 27.70 s, training_loss: 0.729
Epoch   14/50, time: 38.51 s, val_loss: 0.786
Epoch   15/50, time: 27.11 s, training_loss: 0.713
Epoch   15/50, time: 37.94 s, val_loss: 0.789
Epoch   16/50, time: 26.86 s, training_loss: 0.693
Epoch   16/50, time: 37.78 s, val_loss: 0.739
Epoch   17/50, time: 27.19 s, training_loss: 0.677
Epoch   17/50, time: 38.01 s, val_loss: 0.685
Epoch   18/50, time: 27.92 s, training_loss: 0.656
Epoch   18/50, time: 38.86 s, val_loss: 0.704
Epoch   19/50, time: 28.39 s, training_loss: 0.635
Epoch   19/50, time: 39.39 s, val_loss: 0.761
Epoch   20/50, time: 27.27 s, training_loss: 0.620
Epoch   20/50, time: 37.99 s, val_loss: 0.666
Epoch   21/50, time: 28.34 s, training_loss: 0.604
Epoch   21/50, time: 39.05 s, val_loss: 0.674
Training Metrics:
Accuracy: 0.7801
Precision: 0.0729
Recall: 0.8708
F1 Score: 0.1345
IoU: 0.0721
Dice Coefficient: 0.1345
Validation Metrics:
Accuracy: 0.7245
Precision: 0.0527
Recall: 0.7971
F1 Score: 0.0989
IoU: 0.0520
Dice Coefficient: 0.0989
Epoch   22/50, time: 27.07 s, training_loss: 0.581
Epoch   22/50, time: 37.84 s, val_loss: 0.748
Epoch   23/50, time: 27.55 s, training_loss: 0.560
Epoch   23/50, time: 38.33 s, val_loss: 0.636
Epoch   24/50, time: 27.18 s, training_loss: 0.536
Epoch   24/50, time: 37.98 s, val_loss: 0.656
Epoch   25/50, time: 27.17 s, training_loss: 0.515
Epoch   25/50, time: 38.38 s, val_loss: 0.650
Epoch   26/50, time: 27.78 s, training_loss: 0.516
Epoch   26/50, time: 38.49 s, val_loss: 0.629
Epoch   27/50, time: 27.59 s, training_loss: 0.500
Epoch   27/50, time: 38.33 s, val_loss: 0.623
Epoch   28/50, time: 27.48 s, training_loss: 0.476
Epoch   28/50, time: 38.22 s, val_loss: 0.623
Epoch   29/50, time: 26.88 s, training_loss: 0.463
Epoch   29/50, time: 37.52 s, val_loss: 0.546
Epoch   30/50, time: 27.67 s, training_loss: 0.434
Epoch   30/50, time: 38.30 s, val_loss: 0.558
Epoch   31/50, time: 26.92 s, training_loss: 0.432
Epoch   31/50, time: 37.69 s, val_loss: 0.544
Training Metrics:
Accuracy: 0.8463
Precision: 0.0921
Recall: 0.7708
F1 Score: 0.1645
IoU: 0.0896
Dice Coefficient: 0.1645
Validation Metrics:
Accuracy: 0.8521
Precision: 0.0794
Recall: 0.6412
F1 Score: 0.1412
IoU: 0.0760
Dice Coefficient: 0.1412
Epoch   32/50, time: 27.49 s, training_loss: 0.424
Epoch   32/50, time: 38.23 s, val_loss: 0.546
Epoch   33/50, time: 27.28 s, training_loss: 0.400
Epoch   33/50, time: 38.09 s, val_loss: 0.523
Epoch   34/50, time: 27.65 s, training_loss: 0.395
Epoch   34/50, time: 38.51 s, val_loss: 0.544
Epoch   35/50, time: 27.11 s, training_loss: 0.382
Epoch   35/50, time: 37.93 s, val_loss: 0.508
Epoch   36/50, time: 26.95 s, training_loss: 0.371
Epoch   36/50, time: 37.66 s, val_loss: 0.558
Epoch   37/50, time: 27.73 s, training_loss: 0.389
Epoch   37/50, time: 38.42 s, val_loss: 0.533
Epoch   38/50, time: 28.64 s, training_loss: 0.383
Epoch   38/50, time: 40.32 s, val_loss: 0.505
Epoch   39/50, time: 27.41 s, training_loss: 0.362
Epoch   39/50, time: 38.22 s, val_loss: 0.501
Epoch   40/50, time: 27.29 s, training_loss: 0.358
Epoch   40/50, time: 38.09 s, val_loss: 0.466
Epoch   41/50, time: 27.33 s, training_loss: 0.337
Epoch   41/50, time: 38.16 s, val_loss: 0.476
Training Metrics:
Accuracy: 0.8643
Precision: 0.1129
Recall: 0.8626
F1 Score: 0.1997
IoU: 0.1109
Dice Coefficient: 0.1997
Validation Metrics:
Accuracy: 0.8705
Precision: 0.0943
Recall: 0.6772
F1 Score: 0.1655
IoU: 0.0902
Dice Coefficient: 0.1655
Epoch   42/50, time: 27.80 s, training_loss: 0.321
Epoch   42/50, time: 38.46 s, val_loss: 0.469
Epoch   43/50, time: 27.48 s, training_loss: 0.314
Epoch   43/50, time: 38.28 s, val_loss: 0.488
Epoch   44/50, time: 27.62 s, training_loss: 0.308
Epoch   44/50, time: 38.33 s, val_loss: 0.473
Epoch   45/50, time: 28.14 s, training_loss: 0.315
Epoch   45/50, time: 39.07 s, val_loss: 0.443
Epoch   46/50, time: 27.02 s, training_loss: 0.309
Epoch   46/50, time: 37.80 s, val_loss: 0.446
Epoch   47/50, time: 27.50 s, training_loss: 0.308
Epoch   47/50, time: 38.34 s, val_loss: 0.452
Epoch   48/50, time: 26.94 s, training_loss: 0.313
Epoch   48/50, time: 37.72 s, val_loss: 0.465
Epoch   49/50, time: 27.46 s, training_loss: 0.299
Epoch   49/50, time: 38.31 s, val_loss: 0.424
Epoch   50/50, time: 27.97 s, training_loss: 0.278
Epoch   50/50, time: 38.82 s, val_loss: 0.473
Training Metrics:
Accuracy: 0.9035
Precision: 0.1401
Recall: 0.7631
F1 Score: 0.2368
IoU: 0.1343
Dice Coefficient: 0.2368
Validation Metrics:
Accuracy: 0.9141
Precision: 0.1261
Recall: 0.5948
F1 Score: 0.2081
IoU: 0.1161
Dice Coefficient: 0.2081
[I 2025-06-09 19:05:02,597] Trial 4 finished with value: 0.20805398006787154 and parameters: {'batch_size': 64, 'lr': 0.00014754292193642747, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9141
Precision: 0.1261
Recall: 0.5948
F1 Score: 0.2081
IoU: 0.1161
Dice Coefficient: 0.2081
[Trial 4] Finished with val_loss=inf
[Trial 4] Finished with dice_coeff=0.20805398006787154
[Trial 5] Trying batch_size=32, lr=0.00047202630129124305, loss_fn=dice_loss
Epoch    1/50, time: 23.77 s, training_loss: 0.890
Epoch    1/50, time: 34.46 s, val_loss: 0.925
Training Metrics:
Accuracy: 0.6422
Precision: 0.0519
Recall: 0.9975
F1 Score: 0.0986
IoU: 0.0519
Dice Coefficient: 0.0986
Validation Metrics:
Accuracy: 0.6200
Precision: 0.0474
Recall: 0.9978
F1 Score: 0.0906
IoU: 0.0474
Dice Coefficient: 0.0906
Epoch    2/50, time: 23.89 s, training_loss: 0.849
Epoch    2/50, time: 34.57 s, val_loss: 0.947
Epoch    3/50, time: 23.46 s, training_loss: 0.820
Epoch    3/50, time: 34.30 s, val_loss: 0.872
Epoch    4/50, time: 23.14 s, training_loss: 0.797
Epoch    4/50, time: 33.87 s, val_loss: 0.936
Epoch    5/50, time: 23.56 s, training_loss: 0.772
Epoch    5/50, time: 34.32 s, val_loss: 0.815
Epoch    6/50, time: 24.19 s, training_loss: 0.745
Epoch    6/50, time: 34.87 s, val_loss: 0.727
Epoch    7/50, time: 23.58 s, training_loss: 0.715
Epoch    7/50, time: 34.24 s, val_loss: 0.684
Epoch    8/50, time: 24.93 s, training_loss: 0.679
Epoch    8/50, time: 35.62 s, val_loss: 0.681
Epoch    9/50, time: 23.62 s, training_loss: 0.626
Epoch    9/50, time: 34.48 s, val_loss: 0.614
Epoch   10/50, time: 23.48 s, training_loss: 0.575
Epoch   10/50, time: 34.24 s, val_loss: 0.593
Epoch   11/50, time: 23.81 s, training_loss: 0.528
Epoch   11/50, time: 35.27 s, val_loss: 0.522
Training Metrics:
Accuracy: 0.9738
Precision: 0.4064
Recall: 0.7278
F1 Score: 0.5216
IoU: 0.3528
Dice Coefficient: 0.5216
Validation Metrics:
Accuracy: 0.9742
Precision: 0.3973
Recall: 0.7009
F1 Score: 0.5071
IoU: 0.3397
Dice Coefficient: 0.5071
Epoch   12/50, time: 23.76 s, training_loss: 0.495
Epoch   12/50, time: 34.46 s, val_loss: 0.502
Epoch   13/50, time: 23.73 s, training_loss: 0.460
Epoch   13/50, time: 34.57 s, val_loss: 0.535
Epoch   14/50, time: 24.28 s, training_loss: 0.439
Epoch   14/50, time: 35.16 s, val_loss: 0.467
Epoch   15/50, time: 24.44 s, training_loss: 0.395
Epoch   15/50, time: 35.08 s, val_loss: 0.424
Epoch   16/50, time: 25.00 s, training_loss: 0.364
Epoch   16/50, time: 35.81 s, val_loss: 0.384
Epoch   17/50, time: 24.66 s, training_loss: 0.334
Epoch   17/50, time: 35.42 s, val_loss: 0.404
Epoch   18/50, time: 24.66 s, training_loss: 0.310
Epoch   18/50, time: 35.46 s, val_loss: 0.366
Epoch   19/50, time: 23.48 s, training_loss: 0.296
Epoch   19/50, time: 34.13 s, val_loss: 0.378
Epoch   20/50, time: 23.69 s, training_loss: 0.290
Epoch   20/50, time: 34.55 s, val_loss: 0.371
Epoch   21/50, time: 23.40 s, training_loss: 0.273
Epoch   21/50, time: 34.12 s, val_loss: 0.423
Training Metrics:
Accuracy: 0.9856
Precision: 0.6146
Recall: 0.7128
F1 Score: 0.6601
IoU: 0.4926
Dice Coefficient: 0.6601
Validation Metrics:
Accuracy: 0.9832
Precision: 0.5502
Recall: 0.6283
F1 Score: 0.5867
IoU: 0.4151
Dice Coefficient: 0.5867
Epoch   22/50, time: 23.64 s, training_loss: 0.257
Epoch   22/50, time: 34.45 s, val_loss: 0.345
Epoch   23/50, time: 23.40 s, training_loss: 0.247
Epoch   23/50, time: 34.24 s, val_loss: 0.408
Epoch   24/50, time: 24.39 s, training_loss: 0.239
Epoch   24/50, time: 35.25 s, val_loss: 0.318
Epoch   25/50, time: 23.62 s, training_loss: 0.238
Epoch   25/50, time: 34.40 s, val_loss: 0.420
Epoch   26/50, time: 23.61 s, training_loss: 0.254
Epoch   26/50, time: 34.24 s, val_loss: 0.332
Epoch   27/50, time: 25.15 s, training_loss: 0.229
Epoch   27/50, time: 35.93 s, val_loss: 0.338
Epoch   28/50, time: 24.94 s, training_loss: 0.225
Epoch   28/50, time: 35.58 s, val_loss: 0.319
Epoch   29/50, time: 23.68 s, training_loss: 0.207
Epoch   29/50, time: 34.41 s, val_loss: 0.315
Epoch   30/50, time: 24.56 s, training_loss: 0.196
Epoch   30/50, time: 35.33 s, val_loss: 0.325
Epoch   31/50, time: 24.48 s, training_loss: 0.191
Epoch   31/50, time: 35.27 s, val_loss: 0.307
Training Metrics:
Accuracy: 0.9927
Precision: 0.7903
Recall: 0.8566
F1 Score: 0.8221
IoU: 0.6979
Dice Coefficient: 0.8221
Validation Metrics:
Accuracy: 0.9883
Precision: 0.6795
Recall: 0.7234
F1 Score: 0.7008
IoU: 0.5394
Dice Coefficient: 0.7008
Epoch   32/50, time: 24.17 s, training_loss: 0.191
Epoch   32/50, time: 34.88 s, val_loss: 0.308
Epoch   33/50, time: 24.13 s, training_loss: 0.186
Epoch   33/50, time: 34.96 s, val_loss: 0.301
Epoch   34/50, time: 24.01 s, training_loss: 0.180
Epoch   34/50, time: 34.79 s, val_loss: 0.312
Epoch   35/50, time: 23.77 s, training_loss: 0.171
Epoch   35/50, time: 34.50 s, val_loss: 0.318
Epoch   36/50, time: 23.62 s, training_loss: 0.177
Epoch   36/50, time: 34.30 s, val_loss: 0.310
Epoch   37/50, time: 24.37 s, training_loss: 0.173
Epoch   37/50, time: 35.17 s, val_loss: 0.312
Epoch   38/50, time: 24.01 s, training_loss: 0.171
Epoch   38/50, time: 34.71 s, val_loss: 0.319
Epoch   39/50, time: 23.57 s, training_loss: 0.166
Epoch   39/50, time: 34.48 s, val_loss: 0.338
Epoch   40/50, time: 23.38 s, training_loss: 0.180
Epoch   40/50, time: 34.06 s, val_loss: 0.291
Epoch   41/50, time: 23.43 s, training_loss: 0.154
Epoch   41/50, time: 34.05 s, val_loss: 0.327
Training Metrics:
Accuracy: 0.9925
Precision: 0.7986
Recall: 0.8239
F1 Score: 0.8110
IoU: 0.6822
Dice Coefficient: 0.8110
Validation Metrics:
Accuracy: 0.9881
Precision: 0.6864
Recall: 0.6896
F1 Score: 0.6880
IoU: 0.5244
Dice Coefficient: 0.6880
Epoch   42/50, time: 23.43 s, training_loss: 0.156
Epoch   42/50, time: 34.08 s, val_loss: 0.290
Epoch   43/50, time: 23.35 s, training_loss: 0.153
Epoch   43/50, time: 34.05 s, val_loss: 0.314
Epoch   44/50, time: 23.42 s, training_loss: 0.149
Epoch   44/50, time: 34.31 s, val_loss: 0.315
Epoch   45/50, time: 23.53 s, training_loss: 0.154
Epoch   45/50, time: 34.51 s, val_loss: 0.347
Epoch   46/50, time: 24.17 s, training_loss: 0.154
Epoch   46/50, time: 35.02 s, val_loss: 0.309
Epoch   47/50, time: 23.69 s, training_loss: 0.150
Epoch   47/50, time: 34.39 s, val_loss: 0.298
Epoch   48/50, time: 24.16 s, training_loss: 0.142
Epoch   48/50, time: 34.91 s, val_loss: 0.324
Epoch   49/50, time: 23.91 s, training_loss: 0.144
Epoch   49/50, time: 34.74 s, val_loss: 0.293
Epoch   50/50, time: 23.23 s, training_loss: 0.136
Epoch   50/50, time: 34.01 s, val_loss: 0.287
Training Metrics:
Accuracy: 0.9951
Precision: 0.8698
Recall: 0.8834
F1 Score: 0.8766
IoU: 0.7803
Dice Coefficient: 0.8766
Validation Metrics:
Accuracy: 0.9896
Precision: 0.7293
Recall: 0.7194
F1 Score: 0.7243
IoU: 0.5678
Dice Coefficient: 0.7243
[I 2025-06-09 19:39:02,928] Trial 5 finished with value: 0.7243062252894295 and parameters: {'batch_size': 32, 'lr': 0.00047202630129124305, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9896
Precision: 0.7293
Recall: 0.7194
F1 Score: 0.7243
IoU: 0.5678
Dice Coefficient: 0.7243
[Trial 5] Finished with val_loss=inf
[Trial 5] Finished with dice_coeff=0.7243062252894295
[Trial 6] Trying batch_size=32, lr=0.0003872844281240538, loss_fn=dice_loss
Epoch    1/50, time: 24.30 s, training_loss: 0.882
Epoch    1/50, time: 34.95 s, val_loss: 0.878
Training Metrics:
Accuracy: 0.9088
Precision: 0.1495
Recall: 0.7775
F1 Score: 0.2508
IoU: 0.1434
Dice Coefficient: 0.2508
Validation Metrics:
Accuracy: 0.9101
Precision: 0.1488
Recall: 0.7926
F1 Score: 0.2506
IoU: 0.1433
Dice Coefficient: 0.2506
Epoch    2/50, time: 24.34 s, training_loss: 0.842
Epoch    2/50, time: 35.01 s, val_loss: 0.935
Epoch    3/50, time: 24.27 s, training_loss: 0.813
Epoch    3/50, time: 35.00 s, val_loss: 0.909
Epoch    4/50, time: 23.99 s, training_loss: 0.793
Epoch    4/50, time: 34.87 s, val_loss: 0.800
Epoch    5/50, time: 23.41 s, training_loss: 0.774
Epoch    5/50, time: 34.22 s, val_loss: 0.811
Epoch    6/50, time: 23.88 s, training_loss: 0.755
Epoch    6/50, time: 34.64 s, val_loss: 0.754
Epoch    7/50, time: 23.92 s, training_loss: 0.729
Epoch    7/50, time: 34.74 s, val_loss: 0.716
Epoch    8/50, time: 23.04 s, training_loss: 0.704
Epoch    8/50, time: 33.87 s, val_loss: 0.727
Epoch    9/50, time: 23.43 s, training_loss: 0.670
Epoch    9/50, time: 34.41 s, val_loss: 0.750
Epoch   10/50, time: 23.62 s, training_loss: 0.640
Epoch   10/50, time: 34.52 s, val_loss: 0.638
Epoch   11/50, time: 23.82 s, training_loss: 0.592
Epoch   11/50, time: 34.53 s, val_loss: 0.640
Training Metrics:
Accuracy: 0.8753
Precision: 0.0986
Recall: 0.6574
F1 Score: 0.1715
IoU: 0.0938
Dice Coefficient: 0.1715
Validation Metrics:
Accuracy: 0.8555
Precision: 0.0817
Recall: 0.6465
F1 Score: 0.1451
IoU: 0.0782
Dice Coefficient: 0.1451
Epoch   12/50, time: 25.30 s, training_loss: 0.566
Epoch   12/50, time: 36.05 s, val_loss: 0.564
Epoch   13/50, time: 23.56 s, training_loss: 0.526
Epoch   13/50, time: 34.26 s, val_loss: 0.558
Epoch   14/50, time: 23.98 s, training_loss: 0.495
Epoch   14/50, time: 34.75 s, val_loss: 0.507
Epoch   15/50, time: 24.52 s, training_loss: 0.459
Epoch   15/50, time: 35.06 s, val_loss: 0.496
Epoch   16/50, time: 23.56 s, training_loss: 0.420
Epoch   16/50, time: 34.26 s, val_loss: 0.499
Epoch   17/50, time: 24.29 s, training_loss: 0.405
Epoch   17/50, time: 35.17 s, val_loss: 0.455
Epoch   18/50, time: 24.39 s, training_loss: 0.377
Epoch   18/50, time: 35.10 s, val_loss: 0.408
Epoch   19/50, time: 23.71 s, training_loss: 0.348
Epoch   19/50, time: 34.32 s, val_loss: 0.460
Epoch   20/50, time: 23.33 s, training_loss: 0.363
Epoch   20/50, time: 34.10 s, val_loss: 0.376
Epoch   21/50, time: 24.30 s, training_loss: 0.304
Epoch   21/50, time: 35.04 s, val_loss: 0.376
Training Metrics:
Accuracy: 0.9871
Precision: 0.6398
Recall: 0.7893
F1 Score: 0.7067
IoU: 0.5465
Dice Coefficient: 0.7067
Validation Metrics:
Accuracy: 0.9846
Precision: 0.5788
Recall: 0.6978
F1 Score: 0.6327
IoU: 0.4628
Dice Coefficient: 0.6327
Epoch   22/50, time: 24.74 s, training_loss: 0.302
Epoch   22/50, time: 35.43 s, val_loss: 0.363
Epoch   23/50, time: 25.00 s, training_loss: 0.280
Epoch   23/50, time: 35.69 s, val_loss: 0.361
Epoch   24/50, time: 24.34 s, training_loss: 0.255
Epoch   24/50, time: 35.16 s, val_loss: 0.380
Epoch   25/50, time: 23.63 s, training_loss: 0.257
Epoch   25/50, time: 34.42 s, val_loss: 0.360
Epoch   26/50, time: 24.63 s, training_loss: 0.251
Epoch   26/50, time: 35.35 s, val_loss: 0.341
Epoch   27/50, time: 24.10 s, training_loss: 0.236
Epoch   27/50, time: 34.82 s, val_loss: 0.354
Epoch   28/50, time: 24.10 s, training_loss: 0.247
Epoch   28/50, time: 34.78 s, val_loss: 0.334
Epoch   29/50, time: 25.49 s, training_loss: 0.220
Epoch   29/50, time: 36.40 s, val_loss: 0.330
Epoch   30/50, time: 23.75 s, training_loss: 0.223
Epoch   30/50, time: 34.45 s, val_loss: 0.349
Epoch   31/50, time: 23.63 s, training_loss: 0.226
Epoch   31/50, time: 34.37 s, val_loss: 0.360
Training Metrics:
Accuracy: 0.9900
Precision: 0.7428
Recall: 0.7534
F1 Score: 0.7481
IoU: 0.5975
Dice Coefficient: 0.7481
Validation Metrics:
Accuracy: 0.9868
Precision: 0.6533
Recall: 0.6513
F1 Score: 0.6523
IoU: 0.4840
Dice Coefficient: 0.6523
Epoch   32/50, time: 23.83 s, training_loss: 0.204
Epoch   32/50, time: 34.61 s, val_loss: 0.337
Epoch   33/50, time: 23.48 s, training_loss: 0.195
Epoch   33/50, time: 34.45 s, val_loss: 0.309
Epoch   34/50, time: 24.75 s, training_loss: 0.190
Epoch   34/50, time: 35.55 s, val_loss: 0.328
Epoch   35/50, time: 25.39 s, training_loss: 0.195
Epoch   35/50, time: 36.02 s, val_loss: 0.330
Epoch   36/50, time: 23.03 s, training_loss: 0.190
Epoch   36/50, time: 33.78 s, val_loss: 0.324
Epoch   37/50, time: 24.33 s, training_loss: 0.187
Epoch   37/50, time: 35.06 s, val_loss: 0.313
Epoch   38/50, time: 24.15 s, training_loss: 0.179
Epoch   38/50, time: 34.99 s, val_loss: 0.311
Epoch   39/50, time: 23.37 s, training_loss: 0.175
Epoch   39/50, time: 34.09 s, val_loss: 0.340
Epoch   40/50, time: 23.53 s, training_loss: 0.172
Epoch   40/50, time: 34.31 s, val_loss: 0.336
Epoch   41/50, time: 24.11 s, training_loss: 0.187
Epoch   41/50, time: 34.71 s, val_loss: 0.335
Training Metrics:
Accuracy: 0.9921
Precision: 0.7767
Recall: 0.8415
F1 Score: 0.8078
IoU: 0.6776
Dice Coefficient: 0.8078
Validation Metrics:
Accuracy: 0.9873
Precision: 0.6549
Recall: 0.6980
F1 Score: 0.6758
IoU: 0.5103
Dice Coefficient: 0.6758
Epoch   42/50, time: 23.96 s, training_loss: 0.174
Epoch   42/50, time: 34.72 s, val_loss: 0.348
Epoch   43/50, time: 23.34 s, training_loss: 0.172
Epoch   43/50, time: 34.19 s, val_loss: 0.311
Epoch   44/50, time: 23.69 s, training_loss: 0.158
Epoch   44/50, time: 34.42 s, val_loss: 0.301
Epoch   45/50, time: 24.47 s, training_loss: 0.146
Epoch   45/50, time: 35.31 s, val_loss: 0.311
Epoch   46/50, time: 24.17 s, training_loss: 0.145
Epoch   46/50, time: 36.81 s, val_loss: 0.308
Epoch   47/50, time: 23.99 s, training_loss: 0.154
Epoch   47/50, time: 34.86 s, val_loss: 0.323
Epoch   48/50, time: 23.58 s, training_loss: 0.152
Epoch   48/50, time: 34.51 s, val_loss: 0.316
Epoch   49/50, time: 23.23 s, training_loss: 0.142
Epoch   49/50, time: 34.04 s, val_loss: 0.303
Epoch   50/50, time: 23.65 s, training_loss: 0.134
Epoch   50/50, time: 34.34 s, val_loss: 0.296
Training Metrics:
Accuracy: 0.9955
Precision: 0.8870
Recall: 0.8843
F1 Score: 0.8856
IoU: 0.7947
Dice Coefficient: 0.8856
Validation Metrics:
Accuracy: 0.9894
Precision: 0.7273
Recall: 0.7063
F1 Score: 0.7166
IoU: 0.5584
Dice Coefficient: 0.7166
[I 2025-06-09 20:13:12,391] Trial 6 finished with value: 0.7166393201228491 and parameters: {'batch_size': 32, 'lr': 0.0003872844281240538, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9894
Precision: 0.7273
Recall: 0.7063
F1 Score: 0.7166
IoU: 0.5584
Dice Coefficient: 0.7166
[Trial 6] Finished with val_loss=inf
[Trial 6] Finished with dice_coeff=0.7166393201228491
[Trial 7] Trying batch_size=32, lr=0.00013710990794775954, loss_fn=dice_loss
Epoch    1/50, time: 23.54 s, training_loss: 0.905
Epoch    1/50, time: 34.31 s, val_loss: 0.895
Training Metrics:
Accuracy: 0.9005
Precision: 0.1453
Recall: 0.8335
F1 Score: 0.2475
IoU: 0.1412
Dice Coefficient: 0.2475
Validation Metrics:
Accuracy: 0.9029
Precision: 0.1454
Recall: 0.8450
F1 Score: 0.2482
IoU: 0.1417
Dice Coefficient: 0.2482
Epoch    2/50, time: 24.35 s, training_loss: 0.872
Epoch    2/50, time: 35.25 s, val_loss: 0.937
Epoch    3/50, time: 23.58 s, training_loss: 0.850
Epoch    3/50, time: 34.48 s, val_loss: 0.911
Epoch    4/50, time: 23.98 s, training_loss: 0.837
Epoch    4/50, time: 34.74 s, val_loss: 0.867
Epoch    5/50, time: 24.59 s, training_loss: 0.825
Epoch    5/50, time: 35.33 s, val_loss: 0.833
Epoch    6/50, time: 24.47 s, training_loss: 0.813
Epoch    6/50, time: 35.22 s, val_loss: 0.810
Epoch    7/50, time: 23.53 s, training_loss: 0.801
Epoch    7/50, time: 34.33 s, val_loss: 0.818
Epoch    8/50, time: 24.33 s, training_loss: 0.788
Epoch    8/50, time: 35.15 s, val_loss: 0.815
Epoch    9/50, time: 25.01 s, training_loss: 0.772
Epoch    9/50, time: 35.76 s, val_loss: 0.769
Epoch   10/50, time: 23.47 s, training_loss: 0.751
Epoch   10/50, time: 34.36 s, val_loss: 0.790
Epoch   11/50, time: 23.47 s, training_loss: 0.726
Epoch   11/50, time: 34.23 s, val_loss: 0.743
Training Metrics:
Accuracy: 0.7648
Precision: 0.0678
Recall: 0.8614
F1 Score: 0.1257
IoU: 0.0671
Dice Coefficient: 0.1257
Validation Metrics:
Accuracy: 0.7327
Precision: 0.0564
Recall: 0.8323
F1 Score: 0.1057
IoU: 0.0558
Dice Coefficient: 0.1057
Epoch   12/50, time: 23.81 s, training_loss: 0.701
Epoch   12/50, time: 34.63 s, val_loss: 0.727
Epoch   13/50, time: 24.03 s, training_loss: 0.681
Epoch   13/50, time: 34.80 s, val_loss: 0.689
Epoch   14/50, time: 24.09 s, training_loss: 0.659
Epoch   14/50, time: 34.94 s, val_loss: 0.723
Epoch   15/50, time: 24.04 s, training_loss: 0.630
Epoch   15/50, time: 34.81 s, val_loss: 0.685
Epoch   16/50, time: 23.43 s, training_loss: 0.606
Epoch   16/50, time: 34.21 s, val_loss: 0.659
Epoch   17/50, time: 23.22 s, training_loss: 0.576
Epoch   17/50, time: 33.87 s, val_loss: 0.609
Epoch   18/50, time: 24.51 s, training_loss: 0.539
Epoch   18/50, time: 35.41 s, val_loss: 0.582
Epoch   19/50, time: 23.99 s, training_loss: 0.519
Epoch   19/50, time: 34.71 s, val_loss: 0.638
Epoch   20/50, time: 23.16 s, training_loss: 0.491
Epoch   20/50, time: 34.64 s, val_loss: 0.575
Epoch   21/50, time: 23.71 s, training_loss: 0.477
Epoch   21/50, time: 34.33 s, val_loss: 0.613
Training Metrics:
Accuracy: 0.8239
Precision: 0.0749
Recall: 0.7025
F1 Score: 0.1354
IoU: 0.0726
Dice Coefficient: 0.1354
Validation Metrics:
Accuracy: 0.8034
Precision: 0.0587
Recall: 0.6227
F1 Score: 0.1073
IoU: 0.0567
Dice Coefficient: 0.1073
Epoch   22/50, time: 23.13 s, training_loss: 0.465
Epoch   22/50, time: 33.85 s, val_loss: 0.527
Epoch   23/50, time: 24.15 s, training_loss: 0.434
Epoch   23/50, time: 35.00 s, val_loss: 0.540
Epoch   24/50, time: 23.65 s, training_loss: 0.421
Epoch   24/50, time: 34.45 s, val_loss: 0.539
Epoch   25/50, time: 23.56 s, training_loss: 0.407
Epoch   25/50, time: 34.29 s, val_loss: 0.499
Epoch   26/50, time: 23.53 s, training_loss: 0.387
Epoch   26/50, time: 34.39 s, val_loss: 0.482
Epoch   27/50, time: 23.22 s, training_loss: 0.364
Epoch   27/50, time: 33.91 s, val_loss: 0.466
Epoch   28/50, time: 24.87 s, training_loss: 0.350
Epoch   28/50, time: 35.69 s, val_loss: 0.464
Epoch   29/50, time: 24.75 s, training_loss: 0.342
Epoch   29/50, time: 35.48 s, val_loss: 0.486
Epoch   30/50, time: 24.69 s, training_loss: 0.356
Epoch   30/50, time: 35.64 s, val_loss: 0.441
Epoch   31/50, time: 24.90 s, training_loss: 0.324
Epoch   31/50, time: 35.71 s, val_loss: 0.430
Training Metrics:
Accuracy: 0.9029
Precision: 0.1527
Recall: 0.8680
F1 Score: 0.2597
IoU: 0.1492
Dice Coefficient: 0.2597
Validation Metrics:
Accuracy: 0.9121
Precision: 0.1398
Recall: 0.7054
F1 Score: 0.2334
IoU: 0.1321
Dice Coefficient: 0.2334
Epoch   32/50, time: 23.96 s, training_loss: 0.334
Epoch   32/50, time: 34.68 s, val_loss: 0.446
Epoch   33/50, time: 24.73 s, training_loss: 0.315
Epoch   33/50, time: 35.39 s, val_loss: 0.438
Epoch   34/50, time: 24.15 s, training_loss: 0.308
Epoch   34/50, time: 34.97 s, val_loss: 0.538
Epoch   35/50, time: 24.77 s, training_loss: 0.309
Epoch   35/50, time: 35.58 s, val_loss: 0.421
Epoch   36/50, time: 24.68 s, training_loss: 0.275
Epoch   36/50, time: 35.39 s, val_loss: 0.406
Epoch   37/50, time: 23.20 s, training_loss: 0.267
Epoch   37/50, time: 34.06 s, val_loss: 0.406
Epoch   38/50, time: 24.83 s, training_loss: 0.264
Epoch   38/50, time: 35.75 s, val_loss: 0.410
Epoch   39/50, time: 23.59 s, training_loss: 0.261
Epoch   39/50, time: 34.38 s, val_loss: 0.404
Epoch   40/50, time: 24.08 s, training_loss: 0.255
Epoch   40/50, time: 34.82 s, val_loss: 0.451
Epoch   41/50, time: 24.03 s, training_loss: 0.255
Epoch   41/50, time: 34.84 s, val_loss: 0.401
Training Metrics:
Accuracy: 0.9356
Precision: 0.2154
Recall: 0.8622
F1 Score: 0.3446
IoU: 0.2082
Dice Coefficient: 0.3446
Validation Metrics:
Accuracy: 0.9288
Precision: 0.1609
Recall: 0.6535
F1 Score: 0.2582
IoU: 0.1482
Dice Coefficient: 0.2582
Epoch   42/50, time: 24.31 s, training_loss: 0.237
Epoch   42/50, time: 35.06 s, val_loss: 0.396
Epoch   43/50, time: 23.58 s, training_loss: 0.239
Epoch   43/50, time: 34.27 s, val_loss: 0.433
Epoch   44/50, time: 24.41 s, training_loss: 0.247
Epoch   44/50, time: 35.13 s, val_loss: 0.396
Epoch   45/50, time: 24.20 s, training_loss: 0.246
Epoch   45/50, time: 35.10 s, val_loss: 0.389
Epoch   46/50, time: 24.89 s, training_loss: 0.231
Epoch   46/50, time: 36.61 s, val_loss: 0.411
Epoch   47/50, time: 24.37 s, training_loss: 0.227
Epoch   47/50, time: 35.18 s, val_loss: 0.389
Epoch   48/50, time: 24.02 s, training_loss: 0.214
Epoch   48/50, time: 34.71 s, val_loss: 0.383
Epoch   49/50, time: 24.36 s, training_loss: 0.208
Epoch   49/50, time: 35.09 s, val_loss: 0.381
Epoch   50/50, time: 24.74 s, training_loss: 0.209
Epoch   50/50, time: 35.41 s, val_loss: 0.395
Training Metrics:
Accuracy: 0.9382
Precision: 0.2230
Recall: 0.8650
F1 Score: 0.3545
IoU: 0.2155
Dice Coefficient: 0.3545
Validation Metrics:
Accuracy: 0.9330
Precision: 0.1729
Recall: 0.6699
F1 Score: 0.2749
IoU: 0.1593
Dice Coefficient: 0.2749
[I 2025-06-09 20:47:23,848] Trial 7 finished with value: 0.27489314009311105 and parameters: {'batch_size': 32, 'lr': 0.00013710990794775954, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9330
Precision: 0.1729
Recall: 0.6699
F1 Score: 0.2749
IoU: 0.1593
Dice Coefficient: 0.2749
[Trial 7] Finished with val_loss=inf
[Trial 7] Finished with dice_coeff=0.27489314009311105
[Trial 8] Trying batch_size=64, lr=0.00020048576394114084, loss_fn=dice_loss
Epoch    1/50, time: 27.83 s, training_loss: 0.885
Epoch    1/50, time: 38.72 s, val_loss: 0.938
Training Metrics:
Accuracy: 0.9707
Precision: 0.1632
Recall: 0.1198
F1 Score: 0.1381
IoU: 0.0742
Dice Coefficient: 0.1381
Validation Metrics:
Accuracy: 0.9726
Precision: 0.1623
Recall: 0.1063
F1 Score: 0.1285
IoU: 0.0686
Dice Coefficient: 0.1285
Epoch    2/50, time: 26.87 s, training_loss: 0.845
Epoch    2/50, time: 37.76 s, val_loss: 0.865
Epoch    3/50, time: 28.01 s, training_loss: 0.824
Epoch    3/50, time: 38.82 s, val_loss: 0.838
Epoch    4/50, time: 28.28 s, training_loss: 0.811
Epoch    4/50, time: 38.98 s, val_loss: 0.833
Epoch    5/50, time: 27.68 s, training_loss: 0.799
Epoch    5/50, time: 38.43 s, val_loss: 0.824
Epoch    6/50, time: 26.95 s, training_loss: 0.790
Epoch    6/50, time: 37.64 s, val_loss: 0.803
Epoch    7/50, time: 27.37 s, training_loss: 0.781
Epoch    7/50, time: 38.11 s, val_loss: 0.805
Epoch    8/50, time: 26.83 s, training_loss: 0.771
Epoch    8/50, time: 37.60 s, val_loss: 0.787
Epoch    9/50, time: 28.13 s, training_loss: 0.757
Epoch    9/50, time: 38.96 s, val_loss: 0.772
Epoch   10/50, time: 27.33 s, training_loss: 0.751
Epoch   10/50, time: 38.22 s, val_loss: 0.768
Epoch   11/50, time: 27.31 s, training_loss: 0.733
Epoch   11/50, time: 37.98 s, val_loss: 0.770
Training Metrics:
Accuracy: 0.8834
Precision: 0.0961
Recall: 0.5874
F1 Score: 0.1652
IoU: 0.0900
Dice Coefficient: 0.1652
Validation Metrics:
Accuracy: 0.8581
Precision: 0.0756
Recall: 0.5768
F1 Score: 0.1336
IoU: 0.0716
Dice Coefficient: 0.1336
Epoch   12/50, time: 27.18 s, training_loss: 0.713
Epoch   12/50, time: 38.01 s, val_loss: 0.763
Epoch   13/50, time: 29.05 s, training_loss: 0.697
Epoch   13/50, time: 39.77 s, val_loss: 0.794
Epoch   14/50, time: 27.35 s, training_loss: 0.668
Epoch   14/50, time: 38.06 s, val_loss: 0.711
Epoch   15/50, time: 29.50 s, training_loss: 0.646
Epoch   15/50, time: 40.26 s, val_loss: 0.690
Epoch   16/50, time: 27.06 s, training_loss: 0.613
Epoch   16/50, time: 37.78 s, val_loss: 0.711
Epoch   17/50, time: 27.46 s, training_loss: 0.594
Epoch   17/50, time: 38.22 s, val_loss: 0.693
Epoch   18/50, time: 27.74 s, training_loss: 0.574
Epoch   18/50, time: 38.69 s, val_loss: 0.635
Epoch   19/50, time: 27.81 s, training_loss: 0.530
Epoch   19/50, time: 38.53 s, val_loss: 0.641
Epoch   20/50, time: 27.34 s, training_loss: 0.502
Epoch   20/50, time: 37.98 s, val_loss: 0.628
Epoch   21/50, time: 28.05 s, training_loss: 0.487
Epoch   21/50, time: 38.85 s, val_loss: 0.580
Training Metrics:
Accuracy: 0.8858
Precision: 0.1335
Recall: 0.8777
F1 Score: 0.2317
IoU: 0.1311
Dice Coefficient: 0.2317
Validation Metrics:
Accuracy: 0.8835
Precision: 0.1169
Recall: 0.7843
F1 Score: 0.2034
IoU: 0.1132
Dice Coefficient: 0.2034
Epoch   22/50, time: 27.73 s, training_loss: 0.470
Epoch   22/50, time: 38.55 s, val_loss: 0.530
Epoch   23/50, time: 27.69 s, training_loss: 0.436
Epoch   23/50, time: 38.54 s, val_loss: 0.556
Epoch   24/50, time: 28.01 s, training_loss: 0.434
Epoch   24/50, time: 38.74 s, val_loss: 0.545
Epoch   25/50, time: 27.52 s, training_loss: 0.415
Epoch   25/50, time: 38.16 s, val_loss: 0.568
Epoch   26/50, time: 27.64 s, training_loss: 0.376
Epoch   26/50, time: 38.32 s, val_loss: 0.465
Epoch   27/50, time: 27.85 s, training_loss: 0.387
Epoch   27/50, time: 38.54 s, val_loss: 0.511
Epoch   28/50, time: 27.59 s, training_loss: 0.361
Epoch   28/50, time: 38.26 s, val_loss: 0.518
Epoch   29/50, time: 27.48 s, training_loss: 0.352
Epoch   29/50, time: 38.17 s, val_loss: 0.470
Epoch   30/50, time: 27.42 s, training_loss: 0.315
Epoch   30/50, time: 38.24 s, val_loss: 0.470
Epoch   31/50, time: 27.43 s, training_loss: 0.313
Epoch   31/50, time: 38.23 s, val_loss: 0.458
Training Metrics:
Accuracy: 0.9216
Precision: 0.1800
Recall: 0.8423
F1 Score: 0.2966
IoU: 0.1741
Dice Coefficient: 0.2966
Validation Metrics:
Accuracy: 0.9278
Precision: 0.1631
Recall: 0.6796
F1 Score: 0.2631
IoU: 0.1514
Dice Coefficient: 0.2631
Epoch   32/50, time: 26.86 s, training_loss: 0.328
Epoch   32/50, time: 37.52 s, val_loss: 0.493
Epoch   33/50, time: 27.34 s, training_loss: 0.308
Epoch   33/50, time: 38.18 s, val_loss: 0.493
Epoch   34/50, time: 27.54 s, training_loss: 0.305
Epoch   34/50, time: 38.27 s, val_loss: 0.483
Epoch   35/50, time: 27.61 s, training_loss: 0.291
Epoch   35/50, time: 38.51 s, val_loss: 0.451
Epoch   36/50, time: 27.33 s, training_loss: 0.285
Epoch   36/50, time: 38.13 s, val_loss: 0.436
Epoch   37/50, time: 27.21 s, training_loss: 0.286
Epoch   37/50, time: 37.92 s, val_loss: 0.422
Epoch   38/50, time: 27.19 s, training_loss: 0.266
Epoch   38/50, time: 38.01 s, val_loss: 0.467
Epoch   39/50, time: 27.60 s, training_loss: 0.268
Epoch   39/50, time: 38.36 s, val_loss: 0.453
Epoch   40/50, time: 27.58 s, training_loss: 0.250
Epoch   40/50, time: 38.30 s, val_loss: 0.437
Epoch   41/50, time: 27.18 s, training_loss: 0.256
Epoch   41/50, time: 37.98 s, val_loss: 0.414
Training Metrics:
Accuracy: 0.9481
Precision: 0.2550
Recall: 0.8547
F1 Score: 0.3928
IoU: 0.2444
Dice Coefficient: 0.3928
Validation Metrics:
Accuracy: 0.9342
Precision: 0.1733
Recall: 0.6547
F1 Score: 0.2740
IoU: 0.1588
Dice Coefficient: 0.2740
Epoch   42/50, time: 27.34 s, training_loss: 0.261
Epoch   42/50, time: 38.39 s, val_loss: 0.415
Epoch   43/50, time: 27.66 s, training_loss: 0.251
Epoch   43/50, time: 38.43 s, val_loss: 0.414
Epoch   44/50, time: 27.35 s, training_loss: 0.240
Epoch   44/50, time: 38.14 s, val_loss: 0.403
Epoch   45/50, time: 26.90 s, training_loss: 0.246
Epoch   45/50, time: 37.61 s, val_loss: 0.425
Epoch   46/50, time: 27.59 s, training_loss: 0.232
Epoch   46/50, time: 38.30 s, val_loss: 0.411
Epoch   47/50, time: 28.11 s, training_loss: 0.216
Epoch   47/50, time: 38.87 s, val_loss: 0.402
Epoch   48/50, time: 27.46 s, training_loss: 0.207
Epoch   48/50, time: 38.34 s, val_loss: 0.400
Epoch   49/50, time: 27.21 s, training_loss: 0.191
Epoch   49/50, time: 38.05 s, val_loss: 0.394
Epoch   50/50, time: 27.67 s, training_loss: 0.189
Epoch   50/50, time: 38.51 s, val_loss: 0.420
Training Metrics:
Accuracy: 0.9862
Precision: 0.6104
Recall: 0.8235
F1 Score: 0.7011
IoU: 0.5398
Dice Coefficient: 0.7011
Validation Metrics:
Accuracy: 0.9760
Precision: 0.4122
Recall: 0.6204
F1 Score: 0.4953
IoU: 0.3292
Dice Coefficient: 0.4953
[I 2025-06-09 21:24:47,628] Trial 8 finished with value: 0.4953285673611096 and parameters: {'batch_size': 64, 'lr': 0.00020048576394114084, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9760
Precision: 0.4122
Recall: 0.6204
F1 Score: 0.4953
IoU: 0.3292
Dice Coefficient: 0.4953
[Trial 8] Finished with val_loss=inf
[Trial 8] Finished with dice_coeff=0.4953285673611096
[Trial 9] Trying batch_size=128, lr=0.0005026938750805082, loss_fn=dice_loss
Epoch    1/50, time: 34.27 s, training_loss: 0.904
Epoch    1/50, time: 45.05 s, val_loss: 0.951
Training Metrics:
Accuracy: 0.9734
Precision: 0.1590
Recall: 0.0833
F1 Score: 0.1093
IoU: 0.0578
Dice Coefficient: 0.1093
Validation Metrics:
Accuracy: 0.9748
Precision: 0.1667
Recall: 0.0826
F1 Score: 0.1105
IoU: 0.0585
Dice Coefficient: 0.1105
Epoch    2/50, time: 34.86 s, training_loss: 0.867
Epoch    2/50, time: 45.63 s, val_loss: 0.909
Epoch    3/50, time: 34.18 s, training_loss: 0.854
Epoch    3/50, time: 44.99 s, val_loss: 0.849
Epoch    4/50, time: 34.08 s, training_loss: 0.843
Epoch    4/50, time: 44.77 s, val_loss: 0.843
Epoch    5/50, time: 34.70 s, training_loss: 0.829
Epoch    5/50, time: 45.44 s, val_loss: 0.840
Epoch    6/50, time: 34.25 s, training_loss: 0.817
Epoch    6/50, time: 45.12 s, val_loss: 0.917
Epoch    7/50, time: 34.63 s, training_loss: 0.809
Epoch    7/50, time: 45.53 s, val_loss: 0.960
Epoch    8/50, time: 34.47 s, training_loss: 0.795
Epoch    8/50, time: 46.01 s, val_loss: 0.960
Epoch    9/50, time: 34.50 s, training_loss: 0.785
Epoch    9/50, time: 45.45 s, val_loss: 0.915
Epoch   10/50, time: 34.26 s, training_loss: 0.775
Epoch   10/50, time: 45.08 s, val_loss: 0.852
Epoch   11/50, time: 34.47 s, training_loss: 0.769
Epoch   11/50, time: 45.14 s, val_loss: 0.906
Training Metrics:
Accuracy: 0.4800
Precision: 0.0354
Recall: 0.9716
F1 Score: 0.0683
IoU: 0.0354
Dice Coefficient: 0.0683
Validation Metrics:
Accuracy: 0.4542
Precision: 0.0329
Recall: 0.9771
F1 Score: 0.0636
IoU: 0.0328
Dice Coefficient: 0.0636
Epoch   12/50, time: 34.41 s, training_loss: 0.763
Epoch   12/50, time: 45.21 s, val_loss: 0.891
Epoch   13/50, time: 34.15 s, training_loss: 0.757
Epoch   13/50, time: 44.87 s, val_loss: 0.894
Epoch   14/50, time: 35.47 s, training_loss: 0.752
Epoch   14/50, time: 46.15 s, val_loss: 0.847
Epoch   15/50, time: 34.14 s, training_loss: 0.745
Epoch   15/50, time: 44.83 s, val_loss: 0.766
Epoch   16/50, time: 34.30 s, training_loss: 0.740
Epoch   16/50, time: 45.07 s, val_loss: 0.757
Epoch   17/50, time: 35.23 s, training_loss: 0.727
Epoch   17/50, time: 45.95 s, val_loss: 0.762
Epoch   18/50, time: 33.70 s, training_loss: 0.717
Epoch   18/50, time: 44.41 s, val_loss: 0.789
Epoch   19/50, time: 34.51 s, training_loss: 0.704
Epoch   19/50, time: 45.35 s, val_loss: 0.751
Epoch   20/50, time: 34.68 s, training_loss: 0.694
Epoch   20/50, time: 45.64 s, val_loss: 0.706
Epoch   21/50, time: 34.72 s, training_loss: 0.688
Epoch   21/50, time: 45.48 s, val_loss: 0.684
Training Metrics:
Accuracy: 0.9145
Precision: 0.1572
Recall: 0.7693
F1 Score: 0.2611
IoU: 0.1501
Dice Coefficient: 0.2611
Validation Metrics:
Accuracy: 0.9198
Precision: 0.1587
Recall: 0.7503
F1 Score: 0.2620
IoU: 0.1507
Dice Coefficient: 0.2620
Epoch   22/50, time: 34.35 s, training_loss: 0.674
Epoch   22/50, time: 45.25 s, val_loss: 0.712
Epoch   23/50, time: 34.38 s, training_loss: 0.650
Epoch   23/50, time: 45.19 s, val_loss: 0.687
Epoch   24/50, time: 34.68 s, training_loss: 0.630
Epoch   24/50, time: 45.33 s, val_loss: 0.693
Epoch   25/50, time: 35.07 s, training_loss: 0.618
Epoch   25/50, time: 45.84 s, val_loss: 0.644
Epoch   26/50, time: 34.80 s, training_loss: 0.600
Epoch   26/50, time: 45.67 s, val_loss: 0.642
Epoch   27/50, time: 34.63 s, training_loss: 0.592
Epoch   27/50, time: 45.34 s, val_loss: 0.647
Epoch   28/50, time: 34.19 s, training_loss: 0.579
Epoch   28/50, time: 45.05 s, val_loss: 0.637
Epoch   29/50, time: 35.33 s, training_loss: 0.562
Epoch   29/50, time: 46.36 s, val_loss: 0.680
Epoch   30/50, time: 35.13 s, training_loss: 0.561
Epoch   30/50, time: 45.84 s, val_loss: 0.787
Epoch   31/50, time: 34.50 s, training_loss: 0.545
Epoch   31/50, time: 45.21 s, val_loss: 0.895
Training Metrics:
Accuracy: 0.5098
Precision: 0.0375
Recall: 0.9708
F1 Score: 0.0721
IoU: 0.0374
Dice Coefficient: 0.0721
Validation Metrics:
Accuracy: 0.4837
Precision: 0.0344
Recall: 0.9674
F1 Score: 0.0664
IoU: 0.0343
Dice Coefficient: 0.0664
Epoch   32/50, time: 34.95 s, training_loss: 0.525
Epoch   32/50, time: 45.80 s, val_loss: 0.722
Epoch   33/50, time: 34.48 s, training_loss: 0.508
Epoch   33/50, time: 45.19 s, val_loss: 0.572
Epoch   34/50, time: 33.99 s, training_loss: 0.483
Epoch   34/50, time: 44.94 s, val_loss: 0.558
Epoch   35/50, time: 34.65 s, training_loss: 0.456
Epoch   35/50, time: 45.51 s, val_loss: 0.501
Epoch   36/50, time: 34.54 s, training_loss: 0.460
Epoch   36/50, time: 45.34 s, val_loss: 0.569
Epoch   37/50, time: 34.74 s, training_loss: 0.456
Epoch   37/50, time: 45.36 s, val_loss: 0.512
Epoch   38/50, time: 33.95 s, training_loss: 0.448
Epoch   38/50, time: 44.75 s, val_loss: 0.495
Epoch   39/50, time: 34.61 s, training_loss: 0.423
Epoch   39/50, time: 45.44 s, val_loss: 0.490
Epoch   40/50, time: 34.87 s, training_loss: 0.394
Epoch   40/50, time: 45.72 s, val_loss: 0.526
Epoch   41/50, time: 34.05 s, training_loss: 0.418
Epoch   41/50, time: 44.89 s, val_loss: 0.460
Training Metrics:
Accuracy: 0.9576
Precision: 0.2795
Recall: 0.7369
F1 Score: 0.4053
IoU: 0.2542
Dice Coefficient: 0.4053
Validation Metrics:
Accuracy: 0.9576
Precision: 0.2597
Recall: 0.6669
F1 Score: 0.3739
IoU: 0.2299
Dice Coefficient: 0.3739
Epoch   42/50, time: 33.94 s, training_loss: 0.376
Epoch   42/50, time: 44.81 s, val_loss: 0.516
Epoch   43/50, time: 34.65 s, training_loss: 0.378
Epoch   43/50, time: 45.52 s, val_loss: 0.408
Epoch   44/50, time: 35.33 s, training_loss: 0.368
Epoch   44/50, time: 46.01 s, val_loss: 0.507
Epoch   45/50, time: 34.04 s, training_loss: 0.362
Epoch   45/50, time: 44.91 s, val_loss: 0.601
Epoch   46/50, time: 34.00 s, training_loss: 0.367
Epoch   46/50, time: 44.61 s, val_loss: 0.512
Epoch   47/50, time: 34.57 s, training_loss: 0.359
Epoch   47/50, time: 45.36 s, val_loss: 0.442
Epoch   48/50, time: 34.70 s, training_loss: 0.343
Epoch   48/50, time: 45.55 s, val_loss: 0.423
Epoch   49/50, time: 34.90 s, training_loss: 0.316
Epoch   49/50, time: 45.71 s, val_loss: 0.433
Epoch   50/50, time: 34.21 s, training_loss: 0.313
Epoch   50/50, time: 45.07 s, val_loss: 0.383
Training Metrics:
Accuracy: 0.9815
Precision: 0.5200
Recall: 0.7704
F1 Score: 0.6209
IoU: 0.4502
Dice Coefficient: 0.6209
Validation Metrics:
Accuracy: 0.9691
Precision: 0.3412
Recall: 0.6754
F1 Score: 0.4533
IoU: 0.2931
Dice Coefficient: 0.4533
[I 2025-06-09 22:08:42,067] Trial 9 finished with value: 0.45333239322416313 and parameters: {'batch_size': 128, 'lr': 0.0005026938750805082, 'loss_fn': 'dice_loss'}. Best is trial 2 with value: 0.7324309503072226.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9691
Precision: 0.3412
Recall: 0.6754
F1 Score: 0.4533
IoU: 0.2931
Dice Coefficient: 0.4533
[Trial 9] Finished with val_loss=inf
[Trial 9] Finished with dice_coeff=0.45333239322416313
[Trial 10] Trying batch_size=16, lr=0.0008394187240212755, loss_fn=dice_loss
Epoch    1/50, time: 23.34 s, training_loss: 0.852
Epoch    1/50, time: 34.10 s, val_loss: 0.796
Training Metrics:
Accuracy: 0.9126
Precision: 0.1660
Recall: 0.8580
F1 Score: 0.2782
IoU: 0.1616
Dice Coefficient: 0.2782
Validation Metrics:
Accuracy: 0.9153
Precision: 0.1659
Recall: 0.8606
F1 Score: 0.2782
IoU: 0.1616
Dice Coefficient: 0.2782
Epoch    2/50, time: 22.56 s, training_loss: 0.761
Epoch    2/50, time: 33.49 s, val_loss: 0.735
Epoch    3/50, time: 22.34 s, training_loss: 0.732
Epoch    3/50, time: 33.28 s, val_loss: 0.724
Epoch    4/50, time: 23.03 s, training_loss: 0.709
Epoch    4/50, time: 33.77 s, val_loss: 0.721
Epoch    5/50, time: 22.29 s, training_loss: 0.674
Epoch    5/50, time: 33.17 s, val_loss: 0.642
Epoch    6/50, time: 22.91 s, training_loss: 0.632
Epoch    6/50, time: 33.75 s, val_loss: 0.665
Epoch    7/50, time: 22.42 s, training_loss: 0.604
Epoch    7/50, time: 33.22 s, val_loss: 0.601
Epoch    8/50, time: 23.69 s, training_loss: 0.574
Epoch    8/50, time: 34.51 s, val_loss: 0.590
Epoch    9/50, time: 23.22 s, training_loss: 0.545
Epoch    9/50, time: 34.10 s, val_loss: 0.559
Epoch   10/50, time: 23.27 s, training_loss: 0.529
Epoch   10/50, time: 34.01 s, val_loss: 0.636
Epoch   11/50, time: 23.10 s, training_loss: 0.498
Epoch   11/50, time: 33.91 s, val_loss: 0.507
Training Metrics:
Accuracy: 0.9718
Precision: 0.3890
Recall: 0.7633
F1 Score: 0.5154
IoU: 0.3471
Dice Coefficient: 0.5154
Validation Metrics:
Accuracy: 0.9716
Precision: 0.3731
Recall: 0.7338
F1 Score: 0.4947
IoU: 0.3286
Dice Coefficient: 0.4947
Epoch   12/50, time: 22.96 s, training_loss: 0.459
Epoch   12/50, time: 33.69 s, val_loss: 0.502
Epoch   13/50, time: 22.56 s, training_loss: 0.429
Epoch   13/50, time: 33.24 s, val_loss: 0.421
Epoch   14/50, time: 22.52 s, training_loss: 0.404
Epoch   14/50, time: 33.27 s, val_loss: 0.405
Epoch   15/50, time: 22.09 s, training_loss: 0.379
Epoch   15/50, time: 32.94 s, val_loss: 0.390
Epoch   16/50, time: 22.91 s, training_loss: 0.355
Epoch   16/50, time: 33.74 s, val_loss: 0.420
Epoch   17/50, time: 22.84 s, training_loss: 0.332
Epoch   17/50, time: 33.62 s, val_loss: 0.366
Epoch   18/50, time: 22.86 s, training_loss: 0.317
Epoch   18/50, time: 33.62 s, val_loss: 0.382
Epoch   19/50, time: 23.07 s, training_loss: 0.303
Epoch   19/50, time: 33.86 s, val_loss: 0.345
Epoch   20/50, time: 23.30 s, training_loss: 0.285
Epoch   20/50, time: 34.19 s, val_loss: 0.323
Epoch   21/50, time: 22.57 s, training_loss: 0.268
Epoch   21/50, time: 33.28 s, val_loss: 0.345
Training Metrics:
Accuracy: 0.9892
Precision: 0.7022
Recall: 0.7789
F1 Score: 0.7385
IoU: 0.5854
Dice Coefficient: 0.7385
Validation Metrics:
Accuracy: 0.9863
Precision: 0.6261
Recall: 0.6893
F1 Score: 0.6562
IoU: 0.4883
Dice Coefficient: 0.6562
Epoch   22/50, time: 22.65 s, training_loss: 0.263
Epoch   22/50, time: 33.70 s, val_loss: 0.328
Epoch   23/50, time: 22.62 s, training_loss: 0.256
Epoch   23/50, time: 33.65 s, val_loss: 0.333
Epoch   24/50, time: 22.95 s, training_loss: 0.247
Epoch   24/50, time: 33.93 s, val_loss: 0.319
Epoch   25/50, time: 23.00 s, training_loss: 0.236
Epoch   25/50, time: 34.18 s, val_loss: 0.322
Epoch   26/50, time: 24.73 s, training_loss: 0.224
Epoch   26/50, time: 35.39 s, val_loss: 0.344
Epoch   27/50, time: 22.45 s, training_loss: 0.221
Epoch   27/50, time: 33.18 s, val_loss: 0.316
Epoch   28/50, time: 23.47 s, training_loss: 0.212
Epoch   28/50, time: 34.09 s, val_loss: 0.330
Epoch   29/50, time: 22.69 s, training_loss: 0.209
Epoch   29/50, time: 33.54 s, val_loss: 0.313
Epoch   30/50, time: 22.90 s, training_loss: 0.204
Epoch   30/50, time: 33.73 s, val_loss: 0.324
Epoch   31/50, time: 22.78 s, training_loss: 0.197
Epoch   31/50, time: 33.62 s, val_loss: 0.330
Training Metrics:
Accuracy: 0.9907
Precision: 0.7474
Recall: 0.7984
F1 Score: 0.7720
IoU: 0.6287
Dice Coefficient: 0.7720
Validation Metrics:
Accuracy: 0.9874
Precision: 0.6579
Recall: 0.6956
F1 Score: 0.6762
IoU: 0.5108
Dice Coefficient: 0.6762
Epoch   32/50, time: 22.88 s, training_loss: 0.197
Epoch   32/50, time: 33.63 s, val_loss: 0.292
Epoch   33/50, time: 23.01 s, training_loss: 0.191
Epoch   33/50, time: 33.79 s, val_loss: 0.323
Epoch   34/50, time: 23.20 s, training_loss: 0.179
Epoch   34/50, time: 33.88 s, val_loss: 0.292
Epoch   35/50, time: 23.42 s, training_loss: 0.174
Epoch   35/50, time: 34.10 s, val_loss: 0.299
Epoch   36/50, time: 23.73 s, training_loss: 0.177
Epoch   36/50, time: 34.63 s, val_loss: 0.343
Epoch   37/50, time: 23.17 s, training_loss: 0.171
Epoch   37/50, time: 33.96 s, val_loss: 0.289
Epoch   38/50, time: 22.83 s, training_loss: 0.162
Epoch   38/50, time: 33.70 s, val_loss: 0.293
Epoch   39/50, time: 22.44 s, training_loss: 0.160
Epoch   39/50, time: 33.27 s, val_loss: 0.290
Epoch   40/50, time: 22.21 s, training_loss: 0.162
Epoch   40/50, time: 33.14 s, val_loss: 0.330
Epoch   41/50, time: 23.00 s, training_loss: 0.159
Epoch   41/50, time: 33.88 s, val_loss: 0.281
Training Metrics:
Accuracy: 0.9940
Precision: 0.8293
Recall: 0.8770
F1 Score: 0.8525
IoU: 0.7429
Dice Coefficient: 0.8525
Validation Metrics:
Accuracy: 0.9894
Precision: 0.7072
Recall: 0.7501
F1 Score: 0.7280
IoU: 0.5724
Dice Coefficient: 0.7280
Epoch   42/50, time: 22.53 s, training_loss: 0.163
Epoch   42/50, time: 33.29 s, val_loss: 0.295
Epoch   43/50, time: 23.34 s, training_loss: 0.157
Epoch   43/50, time: 34.11 s, val_loss: 0.287
Epoch   44/50, time: 23.10 s, training_loss: 0.142
Epoch   44/50, time: 33.83 s, val_loss: 0.284
Epoch   45/50, time: 23.42 s, training_loss: 0.144
Epoch   45/50, time: 34.25 s, val_loss: 0.286
Epoch   46/50, time: 22.33 s, training_loss: 0.145
Epoch   46/50, time: 33.05 s, val_loss: 0.288
Epoch   47/50, time: 22.77 s, training_loss: 0.149
Epoch   47/50, time: 33.69 s, val_loss: 0.282
Epoch   48/50, time: 22.58 s, training_loss: 0.142
Epoch   48/50, time: 33.23 s, val_loss: 0.317
Epoch   49/50, time: 22.95 s, training_loss: 0.140
Epoch   49/50, time: 33.72 s, val_loss: 0.278
Epoch   50/50, time: 22.32 s, training_loss: 0.136
Epoch   50/50, time: 33.22 s, val_loss: 0.273
Training Metrics:
Accuracy: 0.9949
Precision: 0.8582
Recall: 0.8890
F1 Score: 0.8734
IoU: 0.7752
Dice Coefficient: 0.8734
Validation Metrics:
Accuracy: 0.9899
Precision: 0.7270
Recall: 0.7465
F1 Score: 0.7366
IoU: 0.5830
Dice Coefficient: 0.7366
[I 2025-06-09 22:41:52,882] Trial 10 finished with value: 0.7366099679228403 and parameters: {'batch_size': 16, 'lr': 0.0008394187240212755, 'loss_fn': 'dice_loss'}. Best is trial 10 with value: 0.7366099679228403.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9899
Precision: 0.7270
Recall: 0.7465
F1 Score: 0.7366
IoU: 0.5830
Dice Coefficient: 0.7366
[Trial 10] Finished with val_loss=inf
[Trial 10] Finished with dice_coeff=0.7366099679228403
[Trial 11] Trying batch_size=16, lr=0.0009776976788328476, loss_fn=dice_loss
Epoch    1/50, time: 22.95 s, training_loss: 0.824
Epoch    1/50, time: 33.92 s, val_loss: 0.811
Training Metrics:
Accuracy: 0.9498
Precision: 0.1713
Recall: 0.4065
F1 Score: 0.2410
IoU: 0.1370
Dice Coefficient: 0.2410
Validation Metrics:
Accuracy: 0.9517
Precision: 0.1725
Recall: 0.4072
F1 Score: 0.2423
IoU: 0.1379
Dice Coefficient: 0.2423
Epoch    2/50, time: 23.16 s, training_loss: 0.743
Epoch    2/50, time: 34.00 s, val_loss: 0.726
Epoch    3/50, time: 23.52 s, training_loss: 0.724
Epoch    3/50, time: 34.29 s, val_loss: 0.756
Epoch    4/50, time: 23.10 s, training_loss: 0.703
Epoch    4/50, time: 33.90 s, val_loss: 0.690
Epoch    5/50, time: 22.89 s, training_loss: 0.662
Epoch    5/50, time: 33.60 s, val_loss: 0.636
Epoch    6/50, time: 22.46 s, training_loss: 0.624
Epoch    6/50, time: 33.19 s, val_loss: 0.647
Epoch    7/50, time: 22.63 s, training_loss: 0.590
Epoch    7/50, time: 33.24 s, val_loss: 0.573
Epoch    8/50, time: 23.28 s, training_loss: 0.554
Epoch    8/50, time: 33.93 s, val_loss: 0.536
Epoch    9/50, time: 23.02 s, training_loss: 0.520
Epoch    9/50, time: 33.67 s, val_loss: 0.545
Epoch   10/50, time: 22.59 s, training_loss: 0.493
Epoch   10/50, time: 33.18 s, val_loss: 0.495
Epoch   11/50, time: 22.69 s, training_loss: 0.466
Epoch   11/50, time: 33.35 s, val_loss: 0.471
Training Metrics:
Accuracy: 0.9809
Precision: 0.5121
Recall: 0.5918
F1 Score: 0.5490
IoU: 0.3784
Dice Coefficient: 0.5490
Validation Metrics:
Accuracy: 0.9808
Precision: 0.4951
Recall: 0.5717
F1 Score: 0.5307
IoU: 0.3612
Dice Coefficient: 0.5307
Epoch   12/50, time: 22.99 s, training_loss: 0.428
Epoch   12/50, time: 33.79 s, val_loss: 0.494
Epoch   13/50, time: 22.55 s, training_loss: 0.406
Epoch   13/50, time: 33.24 s, val_loss: 0.422
Epoch   14/50, time: 22.62 s, training_loss: 0.384
Epoch   14/50, time: 33.27 s, val_loss: 0.426
Epoch   15/50, time: 22.84 s, training_loss: 0.373
Epoch   15/50, time: 33.58 s, val_loss: 0.382
Epoch   16/50, time: 22.65 s, training_loss: 0.344
Epoch   16/50, time: 33.48 s, val_loss: 0.372
Epoch   17/50, time: 22.47 s, training_loss: 0.330
Epoch   17/50, time: 33.12 s, val_loss: 0.410
Epoch   18/50, time: 22.53 s, training_loss: 0.320
Epoch   18/50, time: 33.43 s, val_loss: 0.388
Epoch   19/50, time: 22.99 s, training_loss: 0.316
Epoch   19/50, time: 33.80 s, val_loss: 0.355
Epoch   20/50, time: 22.76 s, training_loss: 0.300
Epoch   20/50, time: 33.60 s, val_loss: 0.329
Epoch   21/50, time: 23.11 s, training_loss: 0.287
Epoch   21/50, time: 34.04 s, val_loss: 0.348
Training Metrics:
Accuracy: 0.9877
Precision: 0.6691
Recall: 0.7349
F1 Score: 0.7004
IoU: 0.5390
Dice Coefficient: 0.7004
Validation Metrics:
Accuracy: 0.9864
Precision: 0.6303
Recall: 0.6836
F1 Score: 0.6559
IoU: 0.4880
Dice Coefficient: 0.6559
Epoch   22/50, time: 22.91 s, training_loss: 0.273
Epoch   22/50, time: 33.63 s, val_loss: 0.318
Epoch   23/50, time: 23.36 s, training_loss: 0.271
Epoch   23/50, time: 33.91 s, val_loss: 0.322
Epoch   24/50, time: 23.39 s, training_loss: 0.257
Epoch   24/50, time: 34.14 s, val_loss: 0.332
Epoch   25/50, time: 22.93 s, training_loss: 0.263
Epoch   25/50, time: 33.62 s, val_loss: 0.359
Epoch   26/50, time: 23.07 s, training_loss: 0.250
Epoch   26/50, time: 33.80 s, val_loss: 0.342
Epoch   27/50, time: 22.38 s, training_loss: 0.240
Epoch   27/50, time: 33.07 s, val_loss: 0.337
Epoch   28/50, time: 22.32 s, training_loss: 0.226
Epoch   28/50, time: 33.03 s, val_loss: 0.301
Epoch   29/50, time: 22.51 s, training_loss: 0.229
Epoch   29/50, time: 33.20 s, val_loss: 0.327
Epoch   30/50, time: 22.83 s, training_loss: 0.232
Epoch   30/50, time: 33.47 s, val_loss: 0.315
Epoch   31/50, time: 22.59 s, training_loss: 0.214
Epoch   31/50, time: 33.41 s, val_loss: 0.289
Training Metrics:
Accuracy: 0.9915
Precision: 0.7500
Recall: 0.8515
F1 Score: 0.7975
IoU: 0.6632
Dice Coefficient: 0.7975
Validation Metrics:
Accuracy: 0.9886
Precision: 0.6758
Recall: 0.7619
F1 Score: 0.7163
IoU: 0.5580
Dice Coefficient: 0.7163
Epoch   32/50, time: 22.02 s, training_loss: 0.215
Epoch   32/50, time: 32.82 s, val_loss: 0.293
Epoch   33/50, time: 22.55 s, training_loss: 0.204
Epoch   33/50, time: 33.29 s, val_loss: 0.324
Epoch   34/50, time: 23.17 s, training_loss: 0.201
Epoch   34/50, time: 33.99 s, val_loss: 0.343
Epoch   35/50, time: 22.66 s, training_loss: 0.197
Epoch   35/50, time: 33.47 s, val_loss: 0.288
Epoch   36/50, time: 23.11 s, training_loss: 0.202
Epoch   36/50, time: 33.88 s, val_loss: 0.298
Epoch   37/50, time: 22.25 s, training_loss: 0.193
Epoch   37/50, time: 33.11 s, val_loss: 0.293
Epoch   38/50, time: 22.85 s, training_loss: 0.188
Epoch   38/50, time: 33.53 s, val_loss: 0.299
Epoch   39/50, time: 23.35 s, training_loss: 0.196
Epoch   39/50, time: 34.06 s, val_loss: 0.282
Epoch   40/50, time: 22.15 s, training_loss: 0.185
Epoch   40/50, time: 32.90 s, val_loss: 0.290
Epoch   41/50, time: 23.18 s, training_loss: 0.186
Epoch   41/50, time: 34.01 s, val_loss: 0.293
Training Metrics:
Accuracy: 0.9933
Precision: 0.8326
Recall: 0.8223
F1 Score: 0.8274
IoU: 0.7057
Dice Coefficient: 0.8274
Validation Metrics:
Accuracy: 0.9895
Precision: 0.7318
Recall: 0.7037
F1 Score: 0.7175
IoU: 0.5594
Dice Coefficient: 0.7175
Epoch   42/50, time: 22.80 s, training_loss: 0.175
Epoch   42/50, time: 33.59 s, val_loss: 0.298
Epoch   43/50, time: 22.99 s, training_loss: 0.175
Epoch   43/50, time: 33.76 s, val_loss: 0.287
Epoch   44/50, time: 23.10 s, training_loss: 0.166
Epoch   44/50, time: 33.71 s, val_loss: 0.274
Epoch   45/50, time: 23.35 s, training_loss: 0.169
Epoch   45/50, time: 34.03 s, val_loss: 0.274
Epoch   46/50, time: 22.39 s, training_loss: 0.168
Epoch   46/50, time: 33.17 s, val_loss: 0.281
Epoch   47/50, time: 22.39 s, training_loss: 0.166
Epoch   47/50, time: 33.31 s, val_loss: 0.285
Epoch   48/50, time: 23.10 s, training_loss: 0.159
Epoch   48/50, time: 33.97 s, val_loss: 0.279
Epoch   49/50, time: 22.56 s, training_loss: 0.160
Epoch   49/50, time: 33.32 s, val_loss: 0.282
Epoch   50/50, time: 23.77 s, training_loss: 0.157
Epoch   50/50, time: 34.60 s, val_loss: 0.273
Training Metrics:
Accuracy: 0.9940
Precision: 0.8284
Recall: 0.8773
F1 Score: 0.8522
IoU: 0.7424
Dice Coefficient: 0.8522
Validation Metrics:
Accuracy: 0.9896
Precision: 0.7160
Recall: 0.7496
F1 Score: 0.7324
IoU: 0.5778
Dice Coefficient: 0.7324
[I 2025-06-09 23:14:54,351] Trial 11 finished with value: 0.7324023553562746 and parameters: {'batch_size': 16, 'lr': 0.0009776976788328476, 'loss_fn': 'dice_loss'}. Best is trial 10 with value: 0.7366099679228403.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9896
Precision: 0.7160
Recall: 0.7496
F1 Score: 0.7324
IoU: 0.5778
Dice Coefficient: 0.7324
[Trial 11] Finished with val_loss=inf
[Trial 11] Finished with dice_coeff=0.7324023553562746
[Trial 12] Trying batch_size=16, lr=0.0009318300763931924, loss_fn=dice_loss
Epoch    1/50, time: 22.97 s, training_loss: 0.844
Epoch    1/50, time: 33.89 s, val_loss: 0.791
Training Metrics:
Accuracy: 0.9056
Precision: 0.1554
Recall: 0.8587
F1 Score: 0.2632
IoU: 0.1515
Dice Coefficient: 0.2632
Validation Metrics:
Accuracy: 0.9088
Precision: 0.1560
Recall: 0.8636
F1 Score: 0.2643
IoU: 0.1522
Dice Coefficient: 0.2643
Epoch    2/50, time: 22.53 s, training_loss: 0.760
Epoch    2/50, time: 33.34 s, val_loss: 0.740
Epoch    3/50, time: 23.32 s, training_loss: 0.724
Epoch    3/50, time: 34.12 s, val_loss: 0.727
Epoch    4/50, time: 23.02 s, training_loss: 0.692
Epoch    4/50, time: 33.70 s, val_loss: 0.687
Epoch    5/50, time: 22.71 s, training_loss: 0.645
Epoch    5/50, time: 33.56 s, val_loss: 0.636
Epoch    6/50, time: 23.35 s, training_loss: 0.607
Epoch    6/50, time: 34.03 s, val_loss: 0.594
Epoch    7/50, time: 23.06 s, training_loss: 0.575
Epoch    7/50, time: 33.88 s, val_loss: 0.579
Epoch    8/50, time: 22.92 s, training_loss: 0.540
Epoch    8/50, time: 33.63 s, val_loss: 0.543
Epoch    9/50, time: 22.59 s, training_loss: 0.502
Epoch    9/50, time: 33.39 s, val_loss: 0.546
Epoch   10/50, time: 22.67 s, training_loss: 0.470
Epoch   10/50, time: 33.45 s, val_loss: 0.526
Epoch   11/50, time: 23.30 s, training_loss: 0.447
Epoch   11/50, time: 34.06 s, val_loss: 0.475
Training Metrics:
Accuracy: 0.9811
Precision: 0.5159
Recall: 0.5994
F1 Score: 0.5545
IoU: 0.3836
Dice Coefficient: 0.5545
Validation Metrics:
Accuracy: 0.9807
Precision: 0.4932
Recall: 0.5648
F1 Score: 0.5266
IoU: 0.3574
Dice Coefficient: 0.5266
Epoch   12/50, time: 22.62 s, training_loss: 0.424
Epoch   12/50, time: 33.34 s, val_loss: 0.446
Epoch   13/50, time: 22.86 s, training_loss: 0.384
Epoch   13/50, time: 33.70 s, val_loss: 0.450
Epoch   14/50, time: 23.15 s, training_loss: 0.372
Epoch   14/50, time: 33.79 s, val_loss: 0.460
Epoch   15/50, time: 22.56 s, training_loss: 0.348
Epoch   15/50, time: 33.36 s, val_loss: 0.380
Epoch   16/50, time: 22.59 s, training_loss: 0.331
Epoch   16/50, time: 33.36 s, val_loss: 0.390
Epoch   17/50, time: 22.70 s, training_loss: 0.319
Epoch   17/50, time: 33.44 s, val_loss: 0.408
Epoch   18/50, time: 22.89 s, training_loss: 0.313
Epoch   18/50, time: 33.77 s, val_loss: 0.342
Epoch   19/50, time: 23.37 s, training_loss: 0.297
Epoch   19/50, time: 34.06 s, val_loss: 0.378
Epoch   20/50, time: 22.98 s, training_loss: 0.283
Epoch   20/50, time: 33.75 s, val_loss: 0.427
Epoch   21/50, time: 22.96 s, training_loss: 0.276
Epoch   21/50, time: 33.82 s, val_loss: 0.369
Training Metrics:
Accuracy: 0.9878
Precision: 0.6841
Recall: 0.7016
F1 Score: 0.6927
IoU: 0.5299
Dice Coefficient: 0.6927
Validation Metrics:
Accuracy: 0.9859
Precision: 0.6276
Recall: 0.6361
F1 Score: 0.6318
IoU: 0.4618
Dice Coefficient: 0.6318
Epoch   22/50, time: 22.54 s, training_loss: 0.257
Epoch   22/50, time: 33.18 s, val_loss: 0.363
Epoch   23/50, time: 22.81 s, training_loss: 0.245
Epoch   23/50, time: 33.72 s, val_loss: 0.338
Epoch   24/50, time: 22.97 s, training_loss: 0.250
Epoch   24/50, time: 33.77 s, val_loss: 0.312
Epoch   25/50, time: 22.29 s, training_loss: 0.251
Epoch   25/50, time: 33.09 s, val_loss: 0.332
Epoch   26/50, time: 22.36 s, training_loss: 0.231
Epoch   26/50, time: 33.23 s, val_loss: 0.345
Epoch   27/50, time: 22.08 s, training_loss: 0.225
Epoch   27/50, time: 32.74 s, val_loss: 0.323
Epoch   28/50, time: 22.58 s, training_loss: 0.217
Epoch   28/50, time: 33.45 s, val_loss: 0.327
Epoch   29/50, time: 23.30 s, training_loss: 0.206
Epoch   29/50, time: 34.06 s, val_loss: 0.300
Epoch   30/50, time: 22.63 s, training_loss: 0.216
Epoch   30/50, time: 33.33 s, val_loss: 0.330
Epoch   31/50, time: 22.54 s, training_loss: 0.203
Epoch   31/50, time: 33.19 s, val_loss: 0.308
Training Metrics:
Accuracy: 0.9916
Precision: 0.7655
Recall: 0.8243
F1 Score: 0.7938
IoU: 0.6581
Dice Coefficient: 0.7938
Validation Metrics:
Accuracy: 0.9882
Precision: 0.6786
Recall: 0.7211
F1 Score: 0.6992
IoU: 0.5375
Dice Coefficient: 0.6992
Epoch   32/50, time: 22.41 s, training_loss: 0.203
Epoch   32/50, time: 33.07 s, val_loss: 0.323
Epoch   33/50, time: 23.58 s, training_loss: 0.190
Epoch   33/50, time: 34.48 s, val_loss: 0.304
Epoch   34/50, time: 22.48 s, training_loss: 0.180
Epoch   34/50, time: 33.17 s, val_loss: 0.318
Epoch   35/50, time: 23.23 s, training_loss: 0.177
Epoch   35/50, time: 34.00 s, val_loss: 0.289
Epoch   36/50, time: 22.69 s, training_loss: 0.177
Epoch   36/50, time: 33.55 s, val_loss: 0.286
Epoch   37/50, time: 22.71 s, training_loss: 0.175
Epoch   37/50, time: 33.42 s, val_loss: 0.366
Epoch   38/50, time: 23.45 s, training_loss: 0.178
Epoch   38/50, time: 34.26 s, val_loss: 0.289
Epoch   39/50, time: 23.23 s, training_loss: 0.175
Epoch   39/50, time: 33.98 s, val_loss: 0.300
Epoch   40/50, time: 23.15 s, training_loss: 0.173
Epoch   40/50, time: 33.82 s, val_loss: 0.281
Epoch   41/50, time: 22.54 s, training_loss: 0.162
Epoch   41/50, time: 33.20 s, val_loss: 0.285
Training Metrics:
Accuracy: 0.9940
Precision: 0.8366
Recall: 0.8643
F1 Score: 0.8502
IoU: 0.7395
Dice Coefficient: 0.8502
Validation Metrics:
Accuracy: 0.9896
Precision: 0.7217
Recall: 0.7325
F1 Score: 0.7270
IoU: 0.5711
Dice Coefficient: 0.7270
Epoch   42/50, time: 22.49 s, training_loss: 0.155
Epoch   42/50, time: 33.21 s, val_loss: 0.295
Epoch   43/50, time: 22.92 s, training_loss: 0.155
Epoch   43/50, time: 33.60 s, val_loss: 0.295
Epoch   44/50, time: 23.48 s, training_loss: 0.156
Epoch   44/50, time: 34.20 s, val_loss: 0.281
Epoch   45/50, time: 22.73 s, training_loss: 0.155
Epoch   45/50, time: 34.32 s, val_loss: 0.286
Epoch   46/50, time: 23.05 s, training_loss: 0.148
Epoch   46/50, time: 33.77 s, val_loss: 0.300
Epoch   47/50, time: 22.57 s, training_loss: 0.154
Epoch   47/50, time: 33.37 s, val_loss: 0.338
Epoch   48/50, time: 22.47 s, training_loss: 0.153
Epoch   48/50, time: 33.32 s, val_loss: 0.277
Epoch   49/50, time: 23.13 s, training_loss: 0.147
Epoch   49/50, time: 33.88 s, val_loss: 0.279
Epoch   50/50, time: 22.57 s, training_loss: 0.140
Epoch   50/50, time: 34.48 s, val_loss: 0.280
Training Metrics:
Accuracy: 0.9942
Precision: 0.8434
Recall: 0.8646
F1 Score: 0.8538
IoU: 0.7450
Dice Coefficient: 0.8538
Validation Metrics:
Accuracy: 0.9897
Precision: 0.7301
Recall: 0.7289
F1 Score: 0.7295
IoU: 0.5742
Dice Coefficient: 0.7295
[I 2025-06-09 23:48:00,777] Trial 12 finished with value: 0.7294906663198989 and parameters: {'batch_size': 16, 'lr': 0.0009318300763931924, 'loss_fn': 'dice_loss'}. Best is trial 10 with value: 0.7366099679228403.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9897
Precision: 0.7301
Recall: 0.7289
F1 Score: 0.7295
IoU: 0.5742
Dice Coefficient: 0.7295
[Trial 12] Finished with val_loss=inf
[Trial 12] Finished with dice_coeff=0.7294906663198989
[Trial 13] Trying batch_size=16, lr=0.00028048514305985056, loss_fn=dice_loss
Epoch    1/50, time: 23.48 s, training_loss: 0.859
Epoch    1/50, time: 34.34 s, val_loss: 0.861
Training Metrics:
Accuracy: 0.8919
Precision: 0.1315
Recall: 0.8043
F1 Score: 0.2261
IoU: 0.1275
Dice Coefficient: 0.2261
Validation Metrics:
Accuracy: 0.8917
Precision: 0.1276
Recall: 0.8070
F1 Score: 0.2204
IoU: 0.1238
Dice Coefficient: 0.2204
Epoch    2/50, time: 23.19 s, training_loss: 0.810
Epoch    2/50, time: 34.09 s, val_loss: 0.848
Epoch    3/50, time: 23.23 s, training_loss: 0.774
Epoch    3/50, time: 33.91 s, val_loss: 0.747
Epoch    4/50, time: 22.60 s, training_loss: 0.740
Epoch    4/50, time: 33.29 s, val_loss: 0.714
Epoch    5/50, time: 23.02 s, training_loss: 0.703
Epoch    5/50, time: 33.76 s, val_loss: 0.671
Epoch    6/50, time: 22.88 s, training_loss: 0.667
Epoch    6/50, time: 33.62 s, val_loss: 0.650
Epoch    7/50, time: 23.11 s, training_loss: 0.611
Epoch    7/50, time: 33.64 s, val_loss: 0.616
Epoch    8/50, time: 22.49 s, training_loss: 0.562
Epoch    8/50, time: 33.16 s, val_loss: 0.563
Epoch    9/50, time: 22.24 s, training_loss: 0.511
Epoch    9/50, time: 33.08 s, val_loss: 0.565
Epoch   10/50, time: 22.55 s, training_loss: 0.470
Epoch   10/50, time: 33.39 s, val_loss: 0.484
Epoch   11/50, time: 22.89 s, training_loss: 0.433
Epoch   11/50, time: 33.63 s, val_loss: 0.458
Training Metrics:
Accuracy: 0.9841
Precision: 0.5896
Recall: 0.6219
F1 Score: 0.6053
IoU: 0.4340
Dice Coefficient: 0.6053
Validation Metrics:
Accuracy: 0.9832
Precision: 0.5566
Recall: 0.5688
F1 Score: 0.5626
IoU: 0.3914
Dice Coefficient: 0.5626
Epoch   12/50, time: 23.05 s, training_loss: 0.400
Epoch   12/50, time: 33.57 s, val_loss: 0.425
Epoch   13/50, time: 22.89 s, training_loss: 0.361
Epoch   13/50, time: 33.52 s, val_loss: 0.379
Epoch   14/50, time: 23.01 s, training_loss: 0.337
Epoch   14/50, time: 33.76 s, val_loss: 0.379
Epoch   15/50, time: 22.86 s, training_loss: 0.308
Epoch   15/50, time: 33.69 s, val_loss: 0.376
Epoch   16/50, time: 22.04 s, training_loss: 0.294
Epoch   16/50, time: 32.85 s, val_loss: 0.353
Epoch   17/50, time: 23.44 s, training_loss: 0.274
Epoch   17/50, time: 34.19 s, val_loss: 0.345
Epoch   18/50, time: 22.84 s, training_loss: 0.261
Epoch   18/50, time: 33.71 s, val_loss: 0.338
Epoch   19/50, time: 23.46 s, training_loss: 0.251
Epoch   19/50, time: 34.13 s, val_loss: 0.382
Epoch   20/50, time: 23.33 s, training_loss: 0.253
Epoch   20/50, time: 34.02 s, val_loss: 0.371
Epoch   21/50, time: 23.43 s, training_loss: 0.225
Epoch   21/50, time: 34.27 s, val_loss: 0.317
Training Metrics:
Accuracy: 0.9917
Precision: 0.7739
Recall: 0.8150
F1 Score: 0.7939
IoU: 0.6583
Dice Coefficient: 0.7939
Validation Metrics:
Accuracy: 0.9880
Precision: 0.6768
Recall: 0.7028
F1 Score: 0.6896
IoU: 0.5262
Dice Coefficient: 0.6896
Epoch   22/50, time: 22.71 s, training_loss: 0.219
Epoch   22/50, time: 33.27 s, val_loss: 0.331
Epoch   23/50, time: 22.83 s, training_loss: 0.204
Epoch   23/50, time: 33.55 s, val_loss: 0.316
Epoch   24/50, time: 22.91 s, training_loss: 0.197
Epoch   24/50, time: 33.73 s, val_loss: 0.322
Epoch   25/50, time: 22.58 s, training_loss: 0.202
Epoch   25/50, time: 33.33 s, val_loss: 0.313
Epoch   26/50, time: 22.58 s, training_loss: 0.190
Epoch   26/50, time: 33.23 s, val_loss: 0.305
Epoch   27/50, time: 22.74 s, training_loss: 0.183
Epoch   27/50, time: 33.39 s, val_loss: 0.319
Epoch   28/50, time: 22.95 s, training_loss: 0.173
Epoch   28/50, time: 33.69 s, val_loss: 0.298
Epoch   29/50, time: 22.43 s, training_loss: 0.175
Epoch   29/50, time: 33.31 s, val_loss: 0.302
Epoch   30/50, time: 22.50 s, training_loss: 0.165
Epoch   30/50, time: 33.19 s, val_loss: 0.337
Epoch   31/50, time: 22.41 s, training_loss: 0.165
Epoch   31/50, time: 33.19 s, val_loss: 0.304
Training Metrics:
Accuracy: 0.9944
Precision: 0.8560
Recall: 0.8565
F1 Score: 0.8563
IoU: 0.7487
Dice Coefficient: 0.8563
Validation Metrics:
Accuracy: 0.9890
Precision: 0.7140
Recall: 0.7023
F1 Score: 0.7081
IoU: 0.5481
Dice Coefficient: 0.7081
Epoch   32/50, time: 22.43 s, training_loss: 0.168
Epoch   32/50, time: 33.18 s, val_loss: 0.300
Epoch   33/50, time: 23.74 s, training_loss: 0.161
Epoch   33/50, time: 34.43 s, val_loss: 0.301
Epoch   34/50, time: 23.22 s, training_loss: 0.154
Epoch   34/50, time: 34.13 s, val_loss: 0.297
Epoch   35/50, time: 23.14 s, training_loss: 0.148
Epoch   35/50, time: 33.99 s, val_loss: 0.297
Epoch   36/50, time: 23.07 s, training_loss: 0.149
Epoch   36/50, time: 33.74 s, val_loss: 0.291
Epoch   37/50, time: 22.67 s, training_loss: 0.144
Epoch   37/50, time: 33.42 s, val_loss: 0.300
Epoch   38/50, time: 23.09 s, training_loss: 0.138
Epoch   38/50, time: 33.82 s, val_loss: 0.288
Epoch   39/50, time: 23.78 s, training_loss: 0.135
Epoch   39/50, time: 34.56 s, val_loss: 0.286
Epoch   40/50, time: 22.96 s, training_loss: 0.135
Epoch   40/50, time: 33.66 s, val_loss: 0.293
Epoch   41/50, time: 23.19 s, training_loss: 0.137
Epoch   41/50, time: 33.98 s, val_loss: 0.308
Training Metrics:
Accuracy: 0.9942
Precision: 0.8507
Recall: 0.8564
F1 Score: 0.8536
IoU: 0.7445
Dice Coefficient: 0.8536
Validation Metrics:
Accuracy: 0.9889
Precision: 0.7088
Recall: 0.7011
F1 Score: 0.7049
IoU: 0.5443
Dice Coefficient: 0.7049
Epoch   42/50, time: 23.10 s, training_loss: 0.136
Epoch   42/50, time: 33.87 s, val_loss: 0.300
Epoch   43/50, time: 23.48 s, training_loss: 0.138
Epoch   43/50, time: 34.13 s, val_loss: 0.293
Epoch   44/50, time: 23.09 s, training_loss: 0.128
Epoch   44/50, time: 33.82 s, val_loss: 0.285
Epoch   45/50, time: 22.67 s, training_loss: 0.125
Epoch   45/50, time: 33.42 s, val_loss: 0.291
Epoch   46/50, time: 22.93 s, training_loss: 0.123
Epoch   46/50, time: 33.68 s, val_loss: 0.295
Epoch   47/50, time: 23.87 s, training_loss: 0.128
Epoch   47/50, time: 34.71 s, val_loss: 0.302
Epoch   48/50, time: 22.94 s, training_loss: 0.127
Epoch   48/50, time: 33.63 s, val_loss: 0.292
Epoch   49/50, time: 23.14 s, training_loss: 0.122
Epoch   49/50, time: 33.95 s, val_loss: 0.301
Epoch   50/50, time: 22.67 s, training_loss: 0.121
Epoch   50/50, time: 33.47 s, val_loss: 0.297
Training Metrics:
Accuracy: 0.9950
Precision: 0.8677
Recall: 0.8812
F1 Score: 0.8744
IoU: 0.7768
Dice Coefficient: 0.8744
Validation Metrics:
Accuracy: 0.9891
Precision: 0.7146
Recall: 0.7118
F1 Score: 0.7132
IoU: 0.5542
Dice Coefficient: 0.7132
[I 2025-06-10 00:21:11,506] Trial 13 finished with value: 0.7131682671933124 and parameters: {'batch_size': 16, 'lr': 0.00028048514305985056, 'loss_fn': 'dice_loss'}. Best is trial 10 with value: 0.7366099679228403.
/home/sethih1/masque_new/ters_gen/hyperopt.py:33: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', config.training.learning_rates[0], config.training.learning_rates[-1])
Test Metrics:
Accuracy: 0.9891
Precision: 0.7146
Recall: 0.7118
F1 Score: 0.7132
IoU: 0.5542
Dice Coefficient: 0.7132
[Trial 13] Finished with val_loss=inf
[Trial 13] Finished with dice_coeff=0.7131682671933124
[Trial 14] Trying batch_size=16, lr=0.0007054713524369181, loss_fn=dice_loss
Epoch    1/50, time: 22.74 s, training_loss: 0.871
Epoch    1/50, time: 33.43 s, val_loss: 0.850
Training Metrics:
Accuracy: 0.8777
Precision: 0.1342
Recall: 0.9600
F1 Score: 0.2355
IoU: 0.1335
Dice Coefficient: 0.2355
Validation Metrics:
Accuracy: 0.8799
Precision: 0.1330
Recall: 0.9661
F1 Score: 0.2339
IoU: 0.1324
Dice Coefficient: 0.2339
Epoch    2/50, time: 23.31 s, training_loss: 0.803
Epoch    2/50, time: 34.01 s, val_loss: 0.790
Epoch    3/50, time: 22.45 s, training_loss: 0.751
Epoch    3/50, time: 33.15 s, val_loss: 0.736
Epoch    4/50, time: 22.10 s, training_loss: 0.717
Epoch    4/50, time: 32.86 s, val_loss: 0.700
Epoch    5/50, time: 22.68 s, training_loss: 0.683
Epoch    5/50, time: 33.53 s, val_loss: 0.663
Epoch    6/50, time: 22.03 s, training_loss: 0.642
Epoch    6/50, time: 32.71 s, val_loss: 0.734
Epoch    7/50, time: 23.35 s, training_loss: 0.598
Epoch    7/50, time: 34.00 s, val_loss: 0.614
Epoch    8/50, time: 22.18 s, training_loss: 0.563
Epoch    8/50, time: 32.86 s, val_loss: 0.578
Epoch    9/50, time: 22.64 s, training_loss: 0.519
Epoch    9/50, time: 33.45 s, val_loss: 0.563
Epoch   10/50, time: 23.27 s, training_loss: 0.485
Epoch   10/50, time: 34.01 s, val_loss: 0.591
Epoch   11/50, time: 22.48 s, training_loss: 0.449
Epoch   11/50, time: 33.18 s, val_loss: 0.466
Training Metrics:
Accuracy: 0.9782
Precision: 0.4640
Recall: 0.7175
F1 Score: 0.5636
IoU: 0.3923
Dice Coefficient: 0.5636
Validation Metrics:
Accuracy: 0.9783
Precision: 0.4525
Recall: 0.6869
F1 Score: 0.5456
IoU: 0.3751
Dice Coefficient: 0.5456
Epoch   12/50, time: 23.55 s, training_loss: 0.417
Epoch   12/50, time: 34.27 s, val_loss: 0.526
Epoch   13/50, time: 23.29 s, training_loss: 0.380
Epoch   13/50, time: 34.18 s, val_loss: 0.449
Epoch   14/50, time: 22.98 s, training_loss: 0.361
Epoch   14/50, time: 33.67 s, val_loss: 0.379
Epoch   15/50, time: 22.78 s, training_loss: 0.340
Epoch   15/50, time: 33.60 s, val_loss: 0.367
Epoch   16/50, time: 22.67 s, training_loss: 0.314
Epoch   16/50, time: 33.51 s, val_loss: 0.362
Epoch   17/50, time: 23.59 s, training_loss: 0.310
Epoch   17/50, time: 34.52 s, val_loss: 0.408
Epoch   18/50, time: 23.06 s, training_loss: 0.307
Epoch   18/50, time: 33.85 s, val_loss: 0.373
Epoch   19/50, time: 22.80 s, training_loss: 0.289
Epoch   19/50, time: 33.64 s, val_loss: 0.334
Epoch   20/50, time: 23.04 s, training_loss: 0.277
Epoch   20/50, time: 33.72 s, val_loss: 0.329
Epoch   21/50, time: 22.55 s, training_loss: 0.261
Epoch   21/50, time: 33.29 s, val_loss: 0.324
Training Metrics:
Accuracy: 0.9891
Precision: 0.7011
Recall: 0.7794
F1 Score: 0.7382
IoU: 0.5850
Dice Coefficient: 0.7382
Validation Metrics:
Accuracy: 0.9872
Precision: 0.6457
Recall: 0.7153
F1 Score: 0.6788
IoU: 0.5137
Dice Coefficient: 0.6788
Epoch   22/50, time: 22.89 s, training_loss: 0.256
Epoch   22/50, time: 33.66 s, val_loss: 0.336
Epoch   23/50, time: 22.68 s, training_loss: 0.242
Epoch   23/50, time: 33.61 s, val_loss: 0.307
Epoch   24/50, time: 22.28 s, training_loss: 0.228
Epoch   24/50, time: 33.14 s, val_loss: 0.302
Epoch   25/50, time: 22.28 s, training_loss: 0.228
Epoch   25/50, time: 33.13 s, val_loss: 0.316
Epoch   26/50, time: 22.58 s, training_loss: 0.227
Epoch   26/50, time: 33.21 s, val_loss: 0.343
Epoch   27/50, time: 22.58 s, training_loss: 0.213
Epoch   27/50, time: 33.32 s, val_loss: 0.313
Epoch   28/50, time: 23.08 s, training_loss: 0.203
Epoch   28/50, time: 34.02 s, val_loss: 0.297
Epoch   29/50, time: 22.52 s, training_loss: 0.203
Epoch   29/50, time: 33.33 s, val_loss: 0.308
Epoch   30/50, time: 22.83 s, training_loss: 0.205
Epoch   30/50, time: 33.60 s, val_loss: 0.301
Epoch   31/50, time: 22.93 s, training_loss: 0.190
Epoch   31/50, time: 33.62 s, val_loss: 0.292
Training Metrics:
Accuracy: 0.9931
Precision: 0.8175
Recall: 0.8316
F1 Score: 0.8245
IoU: 0.7014
Dice Coefficient: 0.8245
Validation Metrics:
Accuracy: 0.9892
Precision: 0.7153
Recall: 0.7173
F1 Score: 0.7163
IoU: 0.5580
Dice Coefficient: 0.7163
Epoch   32/50, time: 22.92 s, training_loss: 0.192
Epoch   32/50, time: 33.61 s, val_loss: 0.301
Epoch   33/50, time: 22.47 s, training_loss: 0.192
Epoch   33/50, time: 33.20 s, val_loss: 0.299
Epoch   34/50, time: 22.44 s, training_loss: 0.185
Epoch   34/50, time: 33.29 s, val_loss: 0.291
Epoch   35/50, time: 22.76 s, training_loss: 0.176
Epoch   35/50, time: 33.57 s, val_loss: 0.323
Epoch   36/50, time: 23.06 s, training_loss: 0.176
Epoch   36/50, time: 33.93 s, val_loss: 0.278
Epoch   37/50, time: 23.08 s, training_loss: 0.170
Epoch   37/50, time: 33.71 s, val_loss: 0.286
Epoch   38/50, time: 22.73 s, training_loss: 0.164
Epoch   38/50, time: 33.50 s, val_loss: 0.279
Epoch   39/50, time: 22.28 s, training_loss: 0.162
Epoch   39/50, time: 33.03 s, val_loss: 0.278
Epoch   40/50, time: 23.00 s, training_loss: 0.163
Epoch   40/50, time: 33.76 s, val_loss: 0.289
Epoch   41/50, time: 22.77 s, training_loss: 0.160
Epoch   41/50, time: 33.44 s, val_loss: 0.278
Training Metrics:
Accuracy: 0.9942
Precision: 0.8546
Recall: 0.8513
F1 Score: 0.8529
IoU: 0.7436
Dice Coefficient: 0.8529
Validation Metrics:
Accuracy: 0.9900
Precision: 0.7400
Recall: 0.7276
F1 Score: 0.7337
IoU: 0.5795
Dice Coefficient: 0.7337
Epoch   42/50, time: 22.56 s, training_loss: 0.163
Epoch   42/50, time: 33.28 s, val_loss: 0.291
Epoch   43/50, time: 23.28 s, training_loss: 0.154
Epoch   43/50, time: 34.06 s, val_loss: 0.294
Epoch   44/50, time: 23.79 s, training_loss: 0.155
Epoch   44/50, time: 34.71 s, val_loss: 0.274
Epoch   45/50, time: 23.01 s, training_loss: 0.151
Epoch   45/50, time: 33.82 s, val_loss: 0.277
Epoch   46/50, time: 22.99 s, training_loss: 0.150
Epoch   46/50, time: 33.67 s, val_loss: 0.274
Epoch   47/50, time: 22.71 s, training_loss: 0.148
Epoch   47/50, time: 33.44 s, val_loss: 0.290
Epoch   48/50, time: 22.33 s, training_loss: 0.143
Epoch   48/50, time: 33.16 s, val_loss: 0.276
Epoch   49/50, time: 23.16 s, training_loss: 0.151
Epoch   49/50, time: 34.02 s, val_loss: 0.285
Epoch   50/50, time: 23.29 s, training_loss: 0.142
Epoch   50/50, time: 34.91 s, val_loss: 0.276
Training Metrics:
Accuracy: 0.9950
Precision: 0.8735
Recall: 0.8735
F1 Score: 0.8735
IoU: 0.7754
Dice Coefficient: 0.8735
Validation Metrics:
Accuracy: 0.9900
Precision: 0.7405
Recall: 0.7306
F1 Score: 0.7355
IoU: 0.5817
Dice Coefficient: 0.7355
[I 2025-06-10 00:54:16,367] Trial 14 finished with value: 0.7355062077487622 and parameters: {'batch_size': 16, 'lr': 0.0007054713524369181, 'loss_fn': 'dice_loss'}. Best is trial 10 with value: 0.7366099679228403.
Test Metrics:
Accuracy: 0.9900
Precision: 0.7405
Recall: 0.7306
F1 Score: 0.7355
IoU: 0.5817
Dice Coefficient: 0.7355
[Trial 14] Finished with val_loss=inf
[Trial 14] Finished with dice_coeff=0.7355062077487622
Best params: {'batch_size': 16, 'lr': 0.0008394187240212755, 'loss_fn': 'dice_loss'}
Best val loss: 0.7366099679228403
