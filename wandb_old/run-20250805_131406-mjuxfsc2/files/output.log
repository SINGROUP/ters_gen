Epoch   19/50, time: 130.00 s, training_loss: 0.865
Epoch   13/50, time: 149.29 s, training_loss: 0.822
Epoch   19/50, time: 36.08 s, val_loss: 0.952
Epoch   13/50, time: 36.55 s, val_loss: 0.784
Epoch   27/50, time: 188.48 s, training_loss: 0.706
Epoch    1/50, time: 140.55 s, training_loss: 0.890
Epoch   27/50, time: 38.43 s, val_loss: 0.694
Epoch    1/50, time: 38.26 s, val_loss: 0.948
Epoch   20/50, time: 125.47 s, training_loss: 0.860
Epoch   14/50, time: 140.42 s, training_loss: 0.819
Epoch   20/50, time: 38.22 s, val_loss: 0.953
Epoch   14/50, time: 39.68 s, val_loss: 0.779
Epoch   28/50, time: 187.08 s, training_loss: 0.694
Epoch   21/50, time: 123.68 s, training_loss: 0.861
Epoch   28/50, time: 33.04 s, val_loss: 0.707
Epoch   21/50, time: 33.53 s, val_loss: 0.946
Training Metrics:
Accuracy: 0.9790
Precision: 0.1547
Recall: 0.0152
F1 Score: 0.0277
IoU: 0.0141
Dice Coefficient: 0.0277
Validation Metrics:
Accuracy: 0.9781
Precision: 0.1441
Recall: 0.0315
F1 Score: 0.0517
IoU: 0.0265
Dice Coefficient: 0.0517
Epoch   15/50, time: 145.26 s, training_loss: 0.818
Epoch   15/50, time: 45.23 s, val_loss: 0.776
Epoch    2/50, time: 149.68 s, training_loss: 0.848
Epoch    2/50, time: 31.78 s, val_loss: 0.813
Epoch   29/50, time: 189.85 s, training_loss: 0.689
Training Metrics:
Accuracy: 0.6639
Precision: 0.0510
Recall: 0.9160
F1 Score: 0.0966
IoU: 0.0508
Dice Coefficient: 0.0966
Validation Metrics:
Accuracy: 0.3921
Precision: 0.0300
Recall: 0.9915
F1 Score: 0.0583
IoU: 0.0300
Dice Coefficient: 0.0583
Epoch   16/50, time: 140.49 s, training_loss: 0.816
Epoch   29/50, time: 38.18 s, val_loss: 0.687
Epoch   16/50, time: 37.81 s, val_loss: 0.784
Epoch   22/50, time: 131.43 s, training_loss: 0.860
Epoch    3/50, time: 154.60 s, training_loss: 0.827
Epoch   22/50, time: 36.11 s, val_loss: 0.941
Epoch    3/50, time: 35.01 s, val_loss: 0.791
Epoch   17/50, time: 147.78 s, training_loss: 0.813
Epoch   30/50, time: 188.53 s, training_loss: 0.683
Epoch   17/50, time: 36.06 s, val_loss: 0.777
Epoch   30/50, time: 41.95 s, val_loss: 0.674
Epoch   23/50, time: 129.60 s, training_loss: 0.857
Epoch    4/50, time: 145.86 s, training_loss: 0.814
Epoch   23/50, time: 38.01 s, val_loss: 0.945
Epoch    4/50, time: 35.75 s, val_loss: 0.781
Epoch   18/50, time: 144.82 s, training_loss: 0.811
Epoch   18/50, time: 37.40 s, val_loss: 0.767
Epoch   31/50, time: 190.04 s, training_loss: 0.672
Epoch   24/50, time: 125.71 s, training_loss: 0.855
Epoch   31/50, time: 38.52 s, val_loss: 0.667
Epoch   24/50, time: 35.03 s, val_loss: 0.942
Epoch    5/50, time: 140.30 s, training_loss: 0.805
Epoch    5/50, time: 39.09 s, val_loss: 0.766
Epoch   19/50, time: 146.73 s, training_loss: 0.808
Epoch   19/50, time: 40.38 s, val_loss: 0.778
Epoch   25/50, time: 128.64 s, training_loss: 0.853
Epoch   25/50, time: 35.19 s, val_loss: 0.937
Epoch    6/50, time: 142.25 s, training_loss: 0.803
Epoch    6/50, time: 36.97 s, val_loss: 0.756
Epoch   20/50, time: 140.06 s, training_loss: 0.805
Training Metrics:
Accuracy: 0.9481
Precision: 0.2392
Recall: 0.7539
F1 Score: 0.3631
IoU: 0.2218
Dice Coefficient: 0.3631
Validation Metrics:
Accuracy: 0.9519
Precision: 0.2472
Recall: 0.7503
F1 Score: 0.3719
IoU: 0.2284
Dice Coefficient: 0.3719
Epoch   20/50, time: 40.65 s, val_loss: 0.770
Epoch   26/50, time: 127.66 s, training_loss: 0.850
Epoch   26/50, time: 40.13 s, val_loss: 0.947
Epoch    7/50, time: 144.93 s, training_loss: 0.795
Epoch    7/50, time: 34.92 s, val_loss: 0.755
Epoch   21/50, time: 144.76 s, training_loss: 0.804
Epoch   32/50, time: 186.49 s, training_loss: 0.660
Epoch   27/50, time: 123.62 s, training_loss: 0.849
Epoch   21/50, time: 36.12 s, val_loss: 0.764
Epoch   32/50, time: 36.39 s, val_loss: 0.647
Epoch   27/50, time: 40.92 s, val_loss: 0.949
Epoch    8/50, time: 154.95 s, training_loss: 0.789
Epoch    8/50, time: 39.18 s, val_loss: 0.752
Epoch   28/50, time: 123.20 s, training_loss: 0.847
Epoch   33/50, time: 183.42 s, training_loss: 0.647
Epoch   28/50, time: 34.28 s, val_loss: 0.942
Training Metrics:
Accuracy: 0.7881
Precision: 0.0772
Recall: 0.8945
F1 Score: 0.1422
IoU: 0.0765
Dice Coefficient: 0.1422
Validation Metrics:
Accuracy: 0.9234
Precision: 0.1809
Recall: 0.8615
F1 Score: 0.2991
IoU: 0.1758
Dice Coefficient: 0.2991
Epoch   33/50, time: 36.02 s, val_loss: 0.675
Epoch    9/50, time: 144.07 s, training_loss: 0.785
Epoch    9/50, time: 40.43 s, val_loss: 0.758
Epoch   29/50, time: 130.44 s, training_loss: 0.847
Epoch   29/50, time: 34.90 s, val_loss: 0.922
Epoch   22/50, time: 144.39 s, training_loss: 0.802
Epoch   22/50, time: 37.78 s, val_loss: 0.764
Epoch   34/50, time: 186.15 s, training_loss: 0.643
Epoch   34/50, time: 39.04 s, val_loss: 0.666
Epoch   10/50, time: 144.95 s, training_loss: 0.785
Epoch   30/50, time: 129.27 s, training_loss: 0.844
Epoch   10/50, time: 37.80 s, val_loss: 0.761
Epoch   30/50, time: 37.10 s, val_loss: 0.948
Epoch   23/50, time: 139.99 s, training_loss: 0.799
Epoch   23/50, time: 41.80 s, val_loss: 0.758
Epoch   35/50, time: 186.34 s, training_loss: 0.622
Epoch   11/50, time: 140.79 s, training_loss: 0.776
Epoch   31/50, time: 129.52 s, training_loss: 0.844
Epoch   35/50, time: 36.70 s, val_loss: 0.627
Epoch   11/50, time: 34.54 s, val_loss: 0.752
Epoch   31/50, time: 35.75 s, val_loss: 0.896
Epoch   24/50, time: 141.17 s, training_loss: 0.795
Epoch   24/50, time: 43.32 s, val_loss: 0.750
Epoch   36/50, time: 185.90 s, training_loss: 0.607
Training Metrics:
Accuracy: 0.8547
Precision: 0.1129
Recall: 0.9337
F1 Score: 0.2014
IoU: 0.1120
Dice Coefficient: 0.2014
Validation Metrics:
Accuracy: 0.7948
Precision: 0.0841
Recall: 0.9931
F1 Score: 0.1551
IoU: 0.0841
Dice Coefficient: 0.1551
Training Metrics:
Accuracy: 0.8418
Precision: 0.1006
Recall: 0.8895
F1 Score: 0.1808
IoU: 0.0994
Dice Coefficient: 0.1808
Validation Metrics:
Accuracy: 0.9221
Precision: 0.1771
Recall: 0.8523
F1 Score: 0.2933
IoU: 0.1718
Dice Coefficient: 0.2933
Epoch   36/50, time: 32.74 s, val_loss: 0.622
Epoch   25/50, time: 144.85 s, training_loss: 0.795
Epoch   25/50, time: 41.54 s, val_loss: 0.742
Epoch   32/50, time: 137.08 s, training_loss: 0.841
Epoch   12/50, time: 149.93 s, training_loss: 0.770
Epoch   32/50, time: 33.18 s, val_loss: 0.952
Epoch   12/50, time: 33.80 s, val_loss: 0.745
Epoch   37/50, time: 180.92 s, training_loss: 0.598
Epoch   26/50, time: 141.44 s, training_loss: 0.790
Epoch   37/50, time: 37.91 s, val_loss: 0.608
Epoch   26/50, time: 39.08 s, val_loss: 0.748
Epoch   33/50, time: 134.24 s, training_loss: 0.838
Epoch   33/50, time: 38.49 s, val_loss: 0.940
Epoch   13/50, time: 149.48 s, training_loss: 0.765
Epoch   13/50, time: 35.45 s, val_loss: 0.737
Epoch   27/50, time: 150.14 s, training_loss: 0.789
Epoch   38/50, time: 194.84 s, training_loss: 0.586
Epoch   27/50, time: 37.77 s, val_loss: 0.743
Epoch   38/50, time: 39.56 s, val_loss: 0.618
Epoch   34/50, time: 125.67 s, training_loss: 0.840
Epoch   34/50, time: 38.39 s, val_loss: 0.885
Epoch   14/50, time: 142.07 s, training_loss: 0.766
Epoch   14/50, time: 39.64 s, val_loss: 0.758
Epoch   28/50, time: 145.50 s, training_loss: 0.787
Epoch   28/50, time: 37.22 s, val_loss: 0.748
Epoch   35/50, time: 130.05 s, training_loss: 0.837
Epoch   39/50, time: 185.42 s, training_loss: 0.570
Epoch   35/50, time: 35.46 s, val_loss: 0.917
Epoch   39/50, time: 36.35 s, val_loss: 0.570
Epoch   15/50, time: 136.27 s, training_loss: 0.760
Epoch   15/50, time: 40.77 s, val_loss: 0.748
Epoch   29/50, time: 147.83 s, training_loss: 0.784
Epoch   36/50, time: 128.41 s, training_loss: 0.836
Epoch   29/50, time: 36.54 s, val_loss: 0.739
Epoch   36/50, time: 36.81 s, val_loss: 0.882
Epoch   40/50, time: 186.94 s, training_loss: 0.562
Epoch   16/50, time: 142.31 s, training_loss: 0.753
Epoch   40/50, time: 38.85 s, val_loss: 0.582
Epoch   16/50, time: 38.01 s, val_loss: 0.740
Epoch   30/50, time: 146.20 s, training_loss: 0.780
Epoch   37/50, time: 127.82 s, training_loss: 0.833
Epoch   30/50, time: 38.93 s, val_loss: 0.736
Epoch   37/50, time: 40.12 s, val_loss: 0.878
Epoch   17/50, time: 142.87 s, training_loss: 0.746
Epoch   17/50, time: 36.40 s, val_loss: 0.737
Epoch   41/50, time: 189.81 s, training_loss: 0.550
Epoch   31/50, time: 138.53 s, training_loss: 0.778
Epoch   38/50, time: 132.15 s, training_loss: 0.833
Epoch   41/50, time: 35.33 s, val_loss: 0.566
Epoch   31/50, time: 37.44 s, val_loss: 0.725
Epoch   38/50, time: 38.68 s, val_loss: 0.877
Epoch   18/50, time: 153.85 s, training_loss: 0.740
Epoch   18/50, time: 40.20 s, val_loss: 0.729
Epoch   39/50, time: 129.93 s, training_loss: 0.830
Epoch   39/50, time: 34.32 s, val_loss: 0.878
Training Metrics:
Accuracy: 0.7738
Precision: 0.0745
Recall: 0.9212
F1 Score: 0.1378
IoU: 0.0740
Dice Coefficient: 0.1378
Validation Metrics:
Accuracy: 0.9300
Precision: 0.1992
Recall: 0.8901
F1 Score: 0.3255
IoU: 0.1944
Dice Coefficient: 0.3255
Training Metrics:
Accuracy: 0.9614
Precision: 0.3109
Recall: 0.7950
F1 Score: 0.4470
IoU: 0.2878
Dice Coefficient: 0.4470
Validation Metrics:
Accuracy: 0.9675
Precision: 0.3400
Recall: 0.7560
F1 Score: 0.4690
IoU: 0.3063
Dice Coefficient: 0.4690
Epoch   19/50, time: 145.97 s, training_loss: 0.734
Epoch   40/50, time: 135.60 s, training_loss: 0.827
Epoch   19/50, time: 43.35 s, val_loss: 0.725
Epoch   40/50, time: 36.27 s, val_loss: 0.887
Epoch   32/50, time: 156.68 s, training_loss: 0.777
Epoch   32/50, time: 37.78 s, val_loss: 0.732
Epoch   42/50, time: 196.18 s, training_loss: 0.534
Epoch   20/50, time: 142.47 s, training_loss: 0.729
Epoch   42/50, time: 37.85 s, val_loss: 0.553
Epoch   41/50, time: 123.84 s, training_loss: 0.827
Epoch   20/50, time: 39.78 s, val_loss: 0.720
Epoch   41/50, time: 37.31 s, val_loss: 0.848
Epoch   33/50, time: 142.92 s, training_loss: 0.773
Epoch   33/50, time: 42.35 s, val_loss: 0.708
Epoch   21/50, time: 140.21 s, training_loss: 0.722
Epoch   43/50, time: 178.06 s, training_loss: 0.526
Epoch   21/50, time: 37.71 s, val_loss: 0.709
Epoch   43/50, time: 37.31 s, val_loss: 0.593
Training Metrics:
Accuracy: 0.8937
Precision: 0.1480
Recall: 0.9277
F1 Score: 0.2552
IoU: 0.1463
Dice Coefficient: 0.2552
Validation Metrics:
Accuracy: 0.8781
Precision: 0.1320
Recall: 0.9730
F1 Score: 0.2325
IoU: 0.1315
Dice Coefficient: 0.2325
Epoch   34/50, time: 143.22 s, training_loss: 0.769
Epoch   34/50, time: 42.69 s, val_loss: 0.712
Epoch   42/50, time: 130.39 s, training_loss: 0.824
Epoch   42/50, time: 34.40 s, val_loss: 0.851
Epoch   44/50, time: 189.98 s, training_loss: 0.504
Training Metrics:
Accuracy: 0.9358
Precision: 0.2147
Recall: 0.8551
F1 Score: 0.3432
IoU: 0.2071
Dice Coefficient: 0.3432
Validation Metrics:
Accuracy: 0.9387
Precision: 0.2184
Recall: 0.8659
F1 Score: 0.3488
IoU: 0.2112
Dice Coefficient: 0.3488
Epoch   44/50, time: 36.90 s, val_loss: 0.648
Epoch   35/50, time: 145.95 s, training_loss: 0.769
Epoch   35/50, time: 43.67 s, val_loss: 0.713
Epoch   43/50, time: 134.94 s, training_loss: 0.823
Epoch   22/50, time: 148.49 s, training_loss: 0.716
Epoch   43/50, time: 34.83 s, val_loss: 0.849
Epoch   22/50, time: 36.22 s, val_loss: 0.697
Epoch   45/50, time: 181.76 s, training_loss: 0.520
Epoch   36/50, time: 136.83 s, training_loss: 0.765
Epoch   45/50, time: 38.04 s, val_loss: 0.533
Epoch   36/50, time: 40.29 s, val_loss: 0.712
Epoch   44/50, time: 126.12 s, training_loss: 0.820
Epoch   44/50, time: 39.64 s, val_loss: 0.842
Epoch   23/50, time: 150.11 s, training_loss: 0.709
Epoch   23/50, time: 41.15 s, val_loss: 0.702
Epoch   37/50, time: 138.45 s, training_loss: 0.762
Epoch   46/50, time: 194.72 s, training_loss: 0.496
Epoch   37/50, time: 35.61 s, val_loss: 0.706
Epoch   45/50, time: 118.75 s, training_loss: 0.817
Epoch   46/50, time: 38.29 s, val_loss: 0.496
Epoch   45/50, time: 37.49 s, val_loss: 0.835
Epoch   24/50, time: 145.20 s, training_loss: 0.704
Epoch   24/50, time: 40.71 s, val_loss: 0.696
Epoch   38/50, time: 148.82 s, training_loss: 0.756
Epoch   46/50, time: 129.89 s, training_loss: 0.815
Epoch   38/50, time: 35.81 s, val_loss: 0.699
Epoch   46/50, time: 35.47 s, val_loss: 0.835
Epoch   47/50, time: 187.69 s, training_loss: 0.472
Epoch   25/50, time: 137.41 s, training_loss: 0.698
Epoch   47/50, time: 39.27 s, val_loss: 0.510
Epoch   25/50, time: 40.21 s, val_loss: 0.689
Epoch   39/50, time: 141.26 s, training_loss: 0.754
Epoch   47/50, time: 134.95 s, training_loss: 0.813
Epoch   39/50, time: 36.83 s, val_loss: 0.683
Epoch   47/50, time: 36.93 s, val_loss: 0.827
Epoch   26/50, time: 145.10 s, training_loss: 0.693
Epoch   48/50, time: 185.21 s, training_loss: 0.463
Epoch   26/50, time: 37.19 s, val_loss: 0.691
Epoch   48/50, time: 37.53 s, val_loss: 0.484
Epoch   40/50, time: 138.53 s, training_loss: 0.752
Epoch   48/50, time: 125.81 s, training_loss: 0.810
Epoch   40/50, time: 38.46 s, val_loss: 0.670
Epoch   48/50, time: 38.36 s, val_loss: 0.822
Epoch   27/50, time: 143.95 s, training_loss: 0.687
Epoch   27/50, time: 35.53 s, val_loss: 0.687
Epoch   49/50, time: 184.01 s, training_loss: 0.446
Epoch   49/50, time: 132.23 s, training_loss: 0.808
Epoch   41/50, time: 148.31 s, training_loss: 0.743
Epoch   49/50, time: 35.28 s, val_loss: 0.531
Epoch   49/50, time: 35.82 s, val_loss: 0.821
Epoch   41/50, time: 36.69 s, val_loss: 0.681
Epoch   28/50, time: 152.59 s, training_loss: 0.681
Epoch   50/50, time: 133.86 s, training_loss: 0.805
Epoch   28/50, time: 36.32 s, val_loss: 0.667
Epoch   50/50, time: 31.67 s, val_loss: 0.816
Epoch   50/50, time: 186.74 s, training_loss: 0.473
Epoch   50/50, time: 39.79 s, val_loss: 0.456
Training Metrics:
Accuracy: 0.7596
Precision: 0.0634
Recall: 0.8164
F1 Score: 0.1176
IoU: 0.0625
Dice Coefficient: 0.1176
Validation Metrics:
Accuracy: 0.9544
Precision: 0.2573
Recall: 0.7447
F1 Score: 0.3824
IoU: 0.2364
Dice Coefficient: 0.3824
Exception in trial 9: DataLoader worker (pid(s) 1327619, 1327748, 1327812, 1327876) exited unexpectedly
Traceback (most recent call last):
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1243, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/appl/scibuilder-spack/aalto-rhel9-prod/2024-01/software/linux-rhel9-haswell/gcc-12.3.0/python-3.11.6-nvttrbg/lib/python3.11/multiprocessing/queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/sethih1/masque_new/ters_gen/hyperopt.py", line 117, in objective
    trainer.train(epochs=config.training.epochs)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 89, in train
    self.evaluate_model_metrics(self.model, epoch)
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 205, in evaluate_model_metrics
    train_metrics = self.compute_metrics(model, train_loader)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sethih1/masque_new/ters_gen/src/trainer/trainer_image_to_image.py", line 160, in compute_metrics
    for batch in data_loader:
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/scratch/phys/sin/sethih1/venv/masque_env/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 1327619, 1327748, 1327812, 1327876) exited unexpectedly
[I 2025-08-05 14:52:49,329] Trial 9 finished with value: 0.0 and parameters: {'batch_size': 16, 'lr': 2.1473979988634143e-05, 'loss_fn': 'dice_loss', 'augmentation': True, 'filters_idx': 0, 'in_channels': 400, 'att_channels': 64}. Best is trial 8 with value: 0.7411194148943364.
Epoch   29/50, time: 167.23 s, training_loss: 0.678
wandb: Finishing previous runs because reinit is set to True.
